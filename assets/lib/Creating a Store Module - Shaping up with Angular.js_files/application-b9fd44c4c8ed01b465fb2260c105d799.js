!function(global,factory){"object"==typeof module&&"object"==typeof module.exports?module.exports=global.document?factory(global,!0):function(w){if(!w.document)throw new Error("jQuery requires a window with a document");return factory(w)}:factory(global)}("undefined"!=typeof window?window:this,function(window,noGlobal){function isArraylike(obj){var length=obj.length,type=jQuery.type(obj);return"function"===type||jQuery.isWindow(obj)?!1:1===obj.nodeType&&length?!0:"array"===type||0===length||"number"==typeof length&&length>0&&length-1 in obj}function winnow(elements,qualifier,not){if(jQuery.isFunction(qualifier))return jQuery.grep(elements,function(elem,i){return!!qualifier.call(elem,i,elem)!==not});if(qualifier.nodeType)return jQuery.grep(elements,function(elem){return elem===qualifier!==not});if("string"==typeof qualifier){if(risSimple.test(qualifier))return jQuery.filter(qualifier,elements,not);qualifier=jQuery.filter(qualifier,elements)}return jQuery.grep(elements,function(elem){return jQuery.inArray(elem,qualifier)>=0!==not})}function sibling(cur,dir){do cur=cur[dir];while(cur&&1!==cur.nodeType);return cur}function createOptions(options){var object=optionsCache[options]={};return jQuery.each(options.match(rnotwhite)||[],function(_,flag){object[flag]=!0}),object}function detach(){document.addEventListener?(document.removeEventListener("DOMContentLoaded",completed,!1),window.removeEventListener("load",completed,!1)):(document.detachEvent("onreadystatechange",completed),window.detachEvent("onload",completed))}function completed(){(document.addEventListener||"load"===event.type||"complete"===document.readyState)&&(detach(),jQuery.ready())}function dataAttr(elem,key,data){if(void 0===data&&1===elem.nodeType){var name="data-"+key.replace(rmultiDash,"-$1").toLowerCase();if(data=elem.getAttribute(name),"string"==typeof data){try{data="true"===data?!0:"false"===data?!1:"null"===data?null:+data+""===data?+data:rbrace.test(data)?jQuery.parseJSON(data):data}catch(e){}jQuery.data(elem,key,data)}else data=void 0}return data}function isEmptyDataObject(obj){var name;for(name in obj)if(("data"!==name||!jQuery.isEmptyObject(obj[name]))&&"toJSON"!==name)return!1;return!0}function internalData(elem,name,data,pvt){if(jQuery.acceptData(elem)){var ret,thisCache,internalKey=jQuery.expando,isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[internalKey]:elem[internalKey]&&internalKey;if(id&&cache[id]&&(pvt||cache[id].data)||void 0!==data||"string"!=typeof name)return id||(id=isNode?elem[internalKey]=deletedIds.pop()||jQuery.guid++:internalKey),cache[id]||(cache[id]=isNode?{}:{toJSON:jQuery.noop}),("object"==typeof name||"function"==typeof name)&&(pvt?cache[id]=jQuery.extend(cache[id],name):cache[id].data=jQuery.extend(cache[id].data,name)),thisCache=cache[id],pvt||(thisCache.data||(thisCache.data={}),thisCache=thisCache.data),void 0!==data&&(thisCache[jQuery.camelCase(name)]=data),"string"==typeof name?(ret=thisCache[name],null==ret&&(ret=thisCache[jQuery.camelCase(name)])):ret=thisCache,ret}}function internalRemoveData(elem,name,pvt){if(jQuery.acceptData(elem)){var thisCache,i,isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[jQuery.expando]:jQuery.expando;if(cache[id]){if(name&&(thisCache=pvt?cache[id]:cache[id].data)){jQuery.isArray(name)?name=name.concat(jQuery.map(name,jQuery.camelCase)):name in thisCache?name=[name]:(name=jQuery.camelCase(name),name=name in thisCache?[name]:name.split(" ")),i=name.length;for(;i--;)delete thisCache[name[i]];if(pvt?!isEmptyDataObject(thisCache):!jQuery.isEmptyObject(thisCache))return}(pvt||(delete cache[id].data,isEmptyDataObject(cache[id])))&&(isNode?jQuery.cleanData([elem],!0):support.deleteExpando||cache!=cache.window?delete cache[id]:cache[id]=null)}}}function returnTrue(){return!0}function returnFalse(){return!1}function safeActiveElement(){try{return document.activeElement}catch(err){}}function createSafeFragment(document){var list=nodeNames.split("|"),safeFrag=document.createDocumentFragment();if(safeFrag.createElement)for(;list.length;)safeFrag.createElement(list.pop());return safeFrag}function getAll(context,tag){var elems,elem,i=0,found=typeof context.getElementsByTagName!==strundefined?context.getElementsByTagName(tag||"*"):typeof context.querySelectorAll!==strundefined?context.querySelectorAll(tag||"*"):void 0;if(!found)for(found=[],elems=context.childNodes||context;null!=(elem=elems[i]);i++)!tag||jQuery.nodeName(elem,tag)?found.push(elem):jQuery.merge(found,getAll(elem,tag));return void 0===tag||tag&&jQuery.nodeName(context,tag)?jQuery.merge([context],found):found}function fixDefaultChecked(elem){rcheckableType.test(elem.type)&&(elem.defaultChecked=elem.checked)}function manipulationTarget(elem,content){return jQuery.nodeName(elem,"table")&&jQuery.nodeName(11!==content.nodeType?content:content.firstChild,"tr")?elem.getElementsByTagName("tbody")[0]||elem.appendChild(elem.ownerDocument.createElement("tbody")):elem}function disableScript(elem){return elem.type=(null!==jQuery.find.attr(elem,"type"))+"/"+elem.type,elem}function restoreScript(elem){var match=rscriptTypeMasked.exec(elem.type);return match?elem.type=match[1]:elem.removeAttribute("type"),elem}function setGlobalEval(elems,refElements){for(var elem,i=0;null!=(elem=elems[i]);i++)jQuery._data(elem,"globalEval",!refElements||jQuery._data(refElements[i],"globalEval"))}function cloneCopyEvent(src,dest){if(1===dest.nodeType&&jQuery.hasData(src)){var type,i,l,oldData=jQuery._data(src),curData=jQuery._data(dest,oldData),events=oldData.events;if(events){delete curData.handle,curData.events={};for(type in events)for(i=0,l=events[type].length;l>i;i++)jQuery.event.add(dest,type,events[type][i])}curData.data&&(curData.data=jQuery.extend({},curData.data))}}function fixCloneNodeIssues(src,dest){var nodeName,e,data;if(1===dest.nodeType){if(nodeName=dest.nodeName.toLowerCase(),!support.noCloneEvent&&dest[jQuery.expando]){data=jQuery._data(dest);for(e in data.events)jQuery.removeEvent(dest,e,data.handle);dest.removeAttribute(jQuery.expando)}"script"===nodeName&&dest.text!==src.text?(disableScript(dest).text=src.text,restoreScript(dest)):"object"===nodeName?(dest.parentNode&&(dest.outerHTML=src.outerHTML),support.html5Clone&&src.innerHTML&&!jQuery.trim(dest.innerHTML)&&(dest.innerHTML=src.innerHTML)):"input"===nodeName&&rcheckableType.test(src.type)?(dest.defaultChecked=dest.checked=src.checked,dest.value!==src.value&&(dest.value=src.value)):"option"===nodeName?dest.defaultSelected=dest.selected=src.defaultSelected:("input"===nodeName||"textarea"===nodeName)&&(dest.defaultValue=src.defaultValue)}}function actualDisplay(name,doc){var elem=jQuery(doc.createElement(name)).appendTo(doc.body),display=window.getDefaultComputedStyle?window.getDefaultComputedStyle(elem[0]).display:jQuery.css(elem[0],"display");return elem.detach(),display}function defaultDisplay(nodeName){var doc=document,display=elemdisplay[nodeName];return display||(display=actualDisplay(nodeName,doc),"none"!==display&&display||(iframe=(iframe||jQuery("<iframe frameborder='0' width='0' height='0'/>")).appendTo(doc.documentElement),doc=(iframe[0].contentWindow||iframe[0].contentDocument).document,doc.write(),doc.close(),display=actualDisplay(nodeName,doc),iframe.detach()),elemdisplay[nodeName]=display),display}function addGetHookIf(conditionFn,hookFn){return{get:function(){var condition=conditionFn();if(null!=condition)return condition?(delete this.get,void 0):(this.get=hookFn).apply(this,arguments)}}}function vendorPropName(style,name){if(name in style)return name;for(var capName=name.charAt(0).toUpperCase()+name.slice(1),origName=name,i=cssPrefixes.length;i--;)if(name=cssPrefixes[i]+capName,name in style)return name;return origName}function showHide(elements,show){for(var display,elem,hidden,values=[],index=0,length=elements.length;length>index;index++)elem=elements[index],elem.style&&(values[index]=jQuery._data(elem,"olddisplay"),display=elem.style.display,show?(values[index]||"none"!==display||(elem.style.display=""),""===elem.style.display&&isHidden(elem)&&(values[index]=jQuery._data(elem,"olddisplay",defaultDisplay(elem.nodeName)))):values[index]||(hidden=isHidden(elem),(display&&"none"!==display||!hidden)&&jQuery._data(elem,"olddisplay",hidden?display:jQuery.css(elem,"display"))));for(index=0;length>index;index++)elem=elements[index],elem.style&&(show&&"none"!==elem.style.display&&""!==elem.style.display||(elem.style.display=show?values[index]||"":"none"));return elements}function setPositiveNumber(elem,value,subtract){var matches=rnumsplit.exec(value);return matches?Math.max(0,matches[1]-(subtract||0))+(matches[2]||"px"):value}function augmentWidthOrHeight(elem,name,extra,isBorderBox,styles){for(var i=extra===(isBorderBox?"border":"content")?4:"width"===name?1:0,val=0;4>i;i+=2)"margin"===extra&&(val+=jQuery.css(elem,extra+cssExpand[i],!0,styles)),isBorderBox?("content"===extra&&(val-=jQuery.css(elem,"padding"+cssExpand[i],!0,styles)),"margin"!==extra&&(val-=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles))):(val+=jQuery.css(elem,"padding"+cssExpand[i],!0,styles),"padding"!==extra&&(val+=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles)));return val}function getWidthOrHeight(elem,name,extra){var valueIsBorderBox=!0,val="width"===name?elem.offsetWidth:elem.offsetHeight,styles=getStyles(elem),isBorderBox=support.boxSizing()&&"border-box"===jQuery.css(elem,"boxSizing",!1,styles);if(0>=val||null==val){if(val=curCSS(elem,name,styles),(0>val||null==val)&&(val=elem.style[name]),rnumnonpx.test(val))return val;valueIsBorderBox=isBorderBox&&(support.boxSizingReliable()||val===elem.style[name]),val=parseFloat(val)||0}return val+augmentWidthOrHeight(elem,name,extra||(isBorderBox?"border":"content"),valueIsBorderBox,styles)+"px"}function Tween(elem,options,prop,end,easing){return new Tween.prototype.init(elem,options,prop,end,easing)}function createFxNow(){return setTimeout(function(){fxNow=void 0}),fxNow=jQuery.now()}function genFx(type,includeWidth){var which,attrs={height:type},i=0;for(includeWidth=includeWidth?1:0;4>i;i+=2-includeWidth)which=cssExpand[i],attrs["margin"+which]=attrs["padding"+which]=type;return includeWidth&&(attrs.opacity=attrs.width=type),attrs}function createTween(value,prop,animation){for(var tween,collection=(tweeners[prop]||[]).concat(tweeners["*"]),index=0,length=collection.length;length>index;index++)if(tween=collection[index].call(animation,prop,value))return tween}function defaultPrefilter(elem,props,opts){var prop,value,toggle,tween,hooks,oldfire,display,dDisplay,anim=this,orig={},style=elem.style,hidden=elem.nodeType&&isHidden(elem),dataShow=jQuery._data(elem,"fxshow");opts.queue||(hooks=jQuery._queueHooks(elem,"fx"),null==hooks.unqueued&&(hooks.unqueued=0,oldfire=hooks.empty.fire,hooks.empty.fire=function(){hooks.unqueued||oldfire()}),hooks.unqueued++,anim.always(function(){anim.always(function(){hooks.unqueued--,jQuery.queue(elem,"fx").length||hooks.empty.fire()})})),1===elem.nodeType&&("height"in props||"width"in props)&&(opts.overflow=[style.overflow,style.overflowX,style.overflowY],display=jQuery.css(elem,"display"),dDisplay=defaultDisplay(elem.nodeName),"none"===display&&(display=dDisplay),"inline"===display&&"none"===jQuery.css(elem,"float")&&(support.inlineBlockNeedsLayout&&"inline"!==dDisplay?style.zoom=1:style.display="inline-block")),opts.overflow&&(style.overflow="hidden",support.shrinkWrapBlocks()||anim.always(function(){style.overflow=opts.overflow[0],style.overflowX=opts.overflow[1],style.overflowY=opts.overflow[2]}));for(prop in props)if(value=props[prop],rfxtypes.exec(value)){if(delete props[prop],toggle=toggle||"toggle"===value,value===(hidden?"hide":"show")){if("show"!==value||!dataShow||void 0===dataShow[prop])continue;hidden=!0}orig[prop]=dataShow&&dataShow[prop]||jQuery.style(elem,prop)}if(!jQuery.isEmptyObject(orig)){dataShow?"hidden"in dataShow&&(hidden=dataShow.hidden):dataShow=jQuery._data(elem,"fxshow",{}),toggle&&(dataShow.hidden=!hidden),hidden?jQuery(elem).show():anim.done(function(){jQuery(elem).hide()}),anim.done(function(){var prop;jQuery._removeData(elem,"fxshow");for(prop in orig)jQuery.style(elem,prop,orig[prop])});for(prop in orig)tween=createTween(hidden?dataShow[prop]:0,prop,anim),prop in dataShow||(dataShow[prop]=tween.start,hidden&&(tween.end=tween.start,tween.start="width"===prop||"height"===prop?1:0))}}function propFilter(props,specialEasing){var index,name,easing,value,hooks;for(index in props)if(name=jQuery.camelCase(index),easing=specialEasing[name],value=props[index],jQuery.isArray(value)&&(easing=value[1],value=props[index]=value[0]),index!==name&&(props[name]=value,delete props[index]),hooks=jQuery.cssHooks[name],hooks&&"expand"in hooks){value=hooks.expand(value),delete props[name];for(index in value)index in props||(props[index]=value[index],specialEasing[index]=easing)}else specialEasing[name]=easing}function Animation(elem,properties,options){var result,stopped,index=0,length=animationPrefilters.length,deferred=jQuery.Deferred().always(function(){delete tick.elem}),tick=function(){if(stopped)return!1;for(var currentTime=fxNow||createFxNow(),remaining=Math.max(0,animation.startTime+animation.duration-currentTime),temp=remaining/animation.duration||0,percent=1-temp,index=0,length=animation.tweens.length;length>index;index++)animation.tweens[index].run(percent);return deferred.notifyWith(elem,[animation,percent,remaining]),1>percent&&length?remaining:(deferred.resolveWith(elem,[animation]),!1)},animation=deferred.promise({elem:elem,props:jQuery.extend({},properties),opts:jQuery.extend(!0,{specialEasing:{}},options),originalProperties:properties,originalOptions:options,startTime:fxNow||createFxNow(),duration:options.duration,tweens:[],createTween:function(prop,end){var tween=jQuery.Tween(elem,animation.opts,prop,end,animation.opts.specialEasing[prop]||animation.opts.easing);return animation.tweens.push(tween),tween},stop:function(gotoEnd){var index=0,length=gotoEnd?animation.tweens.length:0;if(stopped)return this;for(stopped=!0;length>index;index++)animation.tweens[index].run(1);return gotoEnd?deferred.resolveWith(elem,[animation,gotoEnd]):deferred.rejectWith(elem,[animation,gotoEnd]),this}}),props=animation.props;for(propFilter(props,animation.opts.specialEasing);length>index;index++)if(result=animationPrefilters[index].call(animation,elem,props,animation.opts))return result;return jQuery.map(props,createTween,animation),jQuery.isFunction(animation.opts.start)&&animation.opts.start.call(elem,animation),jQuery.fx.timer(jQuery.extend(tick,{elem:elem,anim:animation,queue:animation.opts.queue})),animation.progress(animation.opts.progress).done(animation.opts.done,animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always)}function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){"string"!=typeof dataTypeExpression&&(func=dataTypeExpression,dataTypeExpression="*");var dataType,i=0,dataTypes=dataTypeExpression.toLowerCase().match(rnotwhite)||[];if(jQuery.isFunction(func))for(;dataType=dataTypes[i++];)"+"===dataType.charAt(0)?(dataType=dataType.slice(1)||"*",(structure[dataType]=structure[dataType]||[]).unshift(func)):(structure[dataType]=structure[dataType]||[]).push(func)}}function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR){function inspect(dataType){var selected;return inspected[dataType]=!0,jQuery.each(structure[dataType]||[],function(_,prefilterOrFactory){var dataTypeOrTransport=prefilterOrFactory(options,originalOptions,jqXHR);return"string"!=typeof dataTypeOrTransport||seekingTransport||inspected[dataTypeOrTransport]?seekingTransport?!(selected=dataTypeOrTransport):void 0:(options.dataTypes.unshift(dataTypeOrTransport),inspect(dataTypeOrTransport),!1)}),selected}var inspected={},seekingTransport=structure===transports;return inspect(options.dataTypes[0])||!inspected["*"]&&inspect("*")}function ajaxExtend(target,src){var deep,key,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src)void 0!==src[key]&&((flatOptions[key]?target:deep||(deep={}))[key]=src[key]);return deep&&jQuery.extend(!0,target,deep),target}function ajaxHandleResponses(s,jqXHR,responses){for(var firstDataType,ct,finalDataType,type,contents=s.contents,dataTypes=s.dataTypes;"*"===dataTypes[0];)dataTypes.shift(),void 0===ct&&(ct=s.mimeType||jqXHR.getResponseHeader("Content-Type"));if(ct)for(type in contents)if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break}if(dataTypes[0]in responses)finalDataType=dataTypes[0];else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break}firstDataType||(firstDataType=type)}finalDataType=finalDataType||firstDataType}return finalDataType?(finalDataType!==dataTypes[0]&&dataTypes.unshift(finalDataType),responses[finalDataType]):void 0}function ajaxConvert(s,response,jqXHR,isSuccess){var conv2,current,conv,tmp,prev,converters={},dataTypes=s.dataTypes.slice();if(dataTypes[1])for(conv in s.converters)converters[conv.toLowerCase()]=s.converters[conv];for(current=dataTypes.shift();current;)if(s.responseFields[current]&&(jqXHR[s.responseFields[current]]=response),!prev&&isSuccess&&s.dataFilter&&(response=s.dataFilter(response,s.dataType)),prev=current,current=dataTypes.shift())if("*"===current)current=prev;else if("*"!==prev&&prev!==current){if(conv=converters[prev+" "+current]||converters["* "+current],!conv)for(conv2 in converters)if(tmp=conv2.split(" "),tmp[1]===current&&(conv=converters[prev+" "+tmp[0]]||converters["* "+tmp[0]])){conv===!0?conv=converters[conv2]:converters[conv2]!==!0&&(current=tmp[0],dataTypes.unshift(tmp[1]));break}if(conv!==!0)if(conv&&s["throws"])response=conv(response);else try{response=conv(response)}catch(e){return{state:"parsererror",error:conv?e:"No conversion from "+prev+" to "+current}}}return{state:"success",data:response}}function buildParams(prefix,obj,traditional,add){var name;if(jQuery.isArray(obj))jQuery.each(obj,function(i,v){traditional||rbracket.test(prefix)?add(prefix,v):buildParams(prefix+"["+("object"==typeof v?i:"")+"]",v,traditional,add)});else if(traditional||"object"!==jQuery.type(obj))add(prefix,obj);else for(name in obj)buildParams(prefix+"["+name+"]",obj[name],traditional,add)}function createStandardXHR(){try{return new window.XMLHttpRequest}catch(e){}}function createActiveXHR(){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}function getWindow(elem){return jQuery.isWindow(elem)?elem:9===elem.nodeType?elem.defaultView||elem.parentWindow:!1}var deletedIds=[],slice=deletedIds.slice,concat=deletedIds.concat,push=deletedIds.push,indexOf=deletedIds.indexOf,class2type={},toString=class2type.toString,hasOwn=class2type.hasOwnProperty,trim="".trim,support={},version="1.11.0",jQuery=function(selector,context){return new jQuery.fn.init(selector,context)},rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,rmsPrefix=/^-ms-/,rdashAlpha=/-([\da-z])/gi,fcamelCase=function(all,letter){return letter.toUpperCase()};jQuery.fn=jQuery.prototype={jquery:version,constructor:jQuery,selector:"",length:0,toArray:function(){return slice.call(this)},get:function(num){return null!=num?0>num?this[num+this.length]:this[num]:slice.call(this)},pushStack:function(elems){var ret=jQuery.merge(this.constructor(),elems);return ret.prevObject=this,ret.context=this.context,ret},each:function(callback,args){return jQuery.each(this,callback,args)},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem)}))},slice:function(){return this.pushStack(slice.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(i){var len=this.length,j=+i+(0>i?len:0);return this.pushStack(j>=0&&len>j?[this[j]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:push,sort:deletedIds.sort,splice:deletedIds.splice},jQuery.extend=jQuery.fn.extend=function(){var src,copyIsArray,copy,name,options,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=!1;for("boolean"==typeof target&&(deep=target,target=arguments[i]||{},i++),"object"==typeof target||jQuery.isFunction(target)||(target={}),i===length&&(target=this,i--);length>i;i++)if(null!=(options=arguments[i]))for(name in options)src=target[name],copy=options[name],target!==copy&&(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=jQuery.isArray(copy)))?(copyIsArray?(copyIsArray=!1,clone=src&&jQuery.isArray(src)?src:[]):clone=src&&jQuery.isPlainObject(src)?src:{},target[name]=jQuery.extend(deep,clone,copy)):void 0!==copy&&(target[name]=copy));return target},jQuery.extend({expando:"jQuery"+(version+Math.random()).replace(/\D/g,""),isReady:!0,error:function(msg){throw new Error(msg)},noop:function(){},isFunction:function(obj){return"function"===jQuery.type(obj)},isArray:Array.isArray||function(obj){return"array"===jQuery.type(obj)},isWindow:function(obj){return null!=obj&&obj==obj.window},isNumeric:function(obj){return obj-parseFloat(obj)>=0},isEmptyObject:function(obj){var name;for(name in obj)return!1;return!0},isPlainObject:function(obj){var key;if(!obj||"object"!==jQuery.type(obj)||obj.nodeType||jQuery.isWindow(obj))return!1;try{if(obj.constructor&&!hasOwn.call(obj,"constructor")&&!hasOwn.call(obj.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}if(support.ownLast)for(key in obj)return hasOwn.call(obj,key);for(key in obj);return void 0===key||hasOwn.call(obj,key)},type:function(obj){return null==obj?obj+"":"object"==typeof obj||"function"==typeof obj?class2type[toString.call(obj)]||"object":typeof obj},globalEval:function(data){data&&jQuery.trim(data)&&(window.execScript||function(data){window.eval.call(window,data)})(data)},camelCase:function(string){return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase)},nodeName:function(elem,name){return elem.nodeName&&elem.nodeName.toLowerCase()===name.toLowerCase()},each:function(obj,callback,args){var value,i=0,length=obj.length,isArray=isArraylike(obj);if(args){if(isArray)for(;length>i&&(value=callback.apply(obj[i],args),value!==!1);i++);else for(i in obj)if(value=callback.apply(obj[i],args),value===!1)break}else if(isArray)for(;length>i&&(value=callback.call(obj[i],i,obj[i]),value!==!1);i++);else for(i in obj)if(value=callback.call(obj[i],i,obj[i]),value===!1)break;return obj},trim:trim&&!trim.call("﻿ ")?function(text){return null==text?"":trim.call(text)}:function(text){return null==text?"":(text+"").replace(rtrim,"")},makeArray:function(arr,results){var ret=results||[];return null!=arr&&(isArraylike(Object(arr))?jQuery.merge(ret,"string"==typeof arr?[arr]:arr):push.call(ret,arr)),ret},inArray:function(elem,arr,i){var len;if(arr){if(indexOf)return indexOf.call(arr,elem,i);for(len=arr.length,i=i?0>i?Math.max(0,len+i):i:0;len>i;i++)if(i in arr&&arr[i]===elem)return i}return-1},merge:function(first,second){for(var len=+second.length,j=0,i=first.length;len>j;)first[i++]=second[j++];if(len!==len)for(;void 0!==second[j];)first[i++]=second[j++];return first.length=i,first},grep:function(elems,callback,invert){for(var callbackInverse,matches=[],i=0,length=elems.length,callbackExpect=!invert;length>i;i++)callbackInverse=!callback(elems[i],i),callbackInverse!==callbackExpect&&matches.push(elems[i]);return matches},map:function(elems,callback,arg){var value,i=0,length=elems.length,isArray=isArraylike(elems),ret=[];if(isArray)for(;length>i;i++)value=callback(elems[i],i,arg),null!=value&&ret.push(value);else for(i in elems)value=callback(elems[i],i,arg),null!=value&&ret.push(value);return concat.apply([],ret)},guid:1,proxy:function(fn,context){var args,proxy,tmp;return"string"==typeof context&&(tmp=fn[context],context=fn,fn=tmp),jQuery.isFunction(fn)?(args=slice.call(arguments,2),proxy=function(){return fn.apply(context||this,args.concat(slice.call(arguments)))},proxy.guid=fn.guid=fn.guid||jQuery.guid++,proxy):void 0},now:function(){return+new Date},support:support}),jQuery.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(i,name){class2type["[object "+name+"]"]=name.toLowerCase()});var Sizzle=function(window){function Sizzle(selector,context,results,seed){var match,elem,m,nodeType,i,groups,old,nid,newContext,newSelector;if((context?context.ownerDocument||context:preferredDoc)!==document&&setDocument(context),context=context||document,results=results||[],!selector||"string"!=typeof selector)return results;if(1!==(nodeType=context.nodeType)&&9!==nodeType)return[];if(documentIsHTML&&!seed){if(match=rquickExpr.exec(selector))if(m=match[1]){if(9===nodeType){if(elem=context.getElementById(m),!elem||!elem.parentNode)return results;if(elem.id===m)return results.push(elem),results}else if(context.ownerDocument&&(elem=context.ownerDocument.getElementById(m))&&contains(context,elem)&&elem.id===m)return results.push(elem),results}else{if(match[2])return push.apply(results,context.getElementsByTagName(selector)),results;if((m=match[3])&&support.getElementsByClassName&&context.getElementsByClassName)return push.apply(results,context.getElementsByClassName(m)),results}if(support.qsa&&(!rbuggyQSA||!rbuggyQSA.test(selector))){if(nid=old=expando,newContext=context,newSelector=9===nodeType&&selector,1===nodeType&&"object"!==context.nodeName.toLowerCase()){for(groups=tokenize(selector),(old=context.getAttribute("id"))?nid=old.replace(rescape,"\\$&"):context.setAttribute("id",nid),nid="[id='"+nid+"'] ",i=groups.length;i--;)groups[i]=nid+toSelector(groups[i]);newContext=rsibling.test(selector)&&testContext(context.parentNode)||context,newSelector=groups.join(",")}if(newSelector)try{return push.apply(results,newContext.querySelectorAll(newSelector)),results}catch(qsaError){}finally{old||context.removeAttribute("id")}}}return select(selector.replace(rtrim,"$1"),context,results,seed)}function createCache(){function cache(key,value){return keys.push(key+" ")>Expr.cacheLength&&delete cache[keys.shift()],cache[key+" "]=value}var keys=[];return cache}function markFunction(fn){return fn[expando]=!0,fn}function assert(fn){var div=document.createElement("div");try{return!!fn(div)}catch(e){return!1}finally{div.parentNode&&div.parentNode.removeChild(div),div=null}}function addHandle(attrs,handler){for(var arr=attrs.split("|"),i=attrs.length;i--;)Expr.attrHandle[arr[i]]=handler}function siblingCheck(a,b){var cur=b&&a,diff=cur&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||MAX_NEGATIVE)-(~a.sourceIndex||MAX_NEGATIVE);if(diff)return diff;if(cur)for(;cur=cur.nextSibling;)if(cur===b)return-1;return a?1:-1}function createInputPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&elem.type===type}}function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return("input"===name||"button"===name)&&elem.type===type}}function createPositionalPseudo(fn){return markFunction(function(argument){return argument=+argument,markFunction(function(seed,matches){for(var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;i--;)seed[j=matchIndexes[i]]&&(seed[j]=!(matches[j]=seed[j]))})})}function testContext(context){return context&&typeof context.getElementsByTagName!==strundefined&&context}function setFilters(){}function tokenize(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached)return parseOnly?0:cached.slice(0);for(soFar=selector,groups=[],preFilters=Expr.preFilter;soFar;){(!matched||(match=rcomma.exec(soFar)))&&(match&&(soFar=soFar.slice(match[0].length)||soFar),groups.push(tokens=[])),matched=!1,(match=rcombinators.exec(soFar))&&(matched=match.shift(),tokens.push({value:matched,type:match[0].replace(rtrim," ")}),soFar=soFar.slice(matched.length));for(type in Expr.filter)!(match=matchExpr[type].exec(soFar))||preFilters[type]&&!(match=preFilters[type](match))||(matched=match.shift(),tokens.push({value:matched,type:type,matches:match}),soFar=soFar.slice(matched.length));if(!matched)break}return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0)}function toSelector(tokens){for(var i=0,len=tokens.length,selector="";len>i;i++)selector+=tokens[i].value;return selector}function addCombinator(matcher,combinator,base){var dir=combinator.dir,checkNonElements=base&&"parentNode"===dir,doneName=done++;return combinator.first?function(elem,context,xml){for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements)return matcher(elem,context,xml)}:function(elem,context,xml){var oldCache,outerCache,newCache=[dirruns,doneName];if(xml){for(;elem=elem[dir];)if((1===elem.nodeType||checkNonElements)&&matcher(elem,context,xml))return!0}else for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements){if(outerCache=elem[expando]||(elem[expando]={}),(oldCache=outerCache[dir])&&oldCache[0]===dirruns&&oldCache[1]===doneName)return newCache[2]=oldCache[2];if(outerCache[dir]=newCache,newCache[2]=matcher(elem,context,xml))return!0}}}function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){for(var i=matchers.length;i--;)if(!matchers[i](elem,context,xml))return!1;return!0}:matchers[0]}function condense(unmatched,map,filter,context,xml){for(var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=null!=map;len>i;i++)(elem=unmatched[i])&&(!filter||filter(elem,context,xml))&&(newUnmatched.push(elem),mapped&&map.push(i));return newUnmatched}function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){return postFilter&&!postFilter[expando]&&(postFilter=setMatcher(postFilter)),postFinder&&!postFinder[expando]&&(postFinder=setMatcher(postFinder,postSelector)),markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=!preFilter||!seed&&selector?elems:condense(elems,preMap,preFilter,context,xml),matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher&&matcher(matcherIn,matcherOut,context,xml),postFilter)for(temp=condense(matcherOut,postMap),postFilter(temp,[],context,xml),i=temp.length;i--;)(elem=temp[i])&&(matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem));if(seed){if(postFinder||preFilter){if(postFinder){for(temp=[],i=matcherOut.length;i--;)(elem=matcherOut[i])&&temp.push(matcherIn[i]=elem);postFinder(null,matcherOut=[],temp,xml)}for(i=matcherOut.length;i--;)(elem=matcherOut[i])&&(temp=postFinder?indexOf.call(seed,elem):preMap[i])>-1&&(seed[temp]=!(results[temp]=elem))}}else matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut),postFinder?postFinder(null,results,matcherOut,xml):push.apply(results,matcherOut)})}function matcherFromTokens(tokens){for(var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext},implicitRelative,!0),matchAnyContext=addCombinator(function(elem){return indexOf.call(checkContext,elem)>-1},implicitRelative,!0),matchers=[function(elem,context,xml){return!leadingRelative&&(xml||context!==outermostContext)||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml))}];len>i;i++)if(matcher=Expr.relative[tokens[i].type])matchers=[addCombinator(elementMatcher(matchers),matcher)];else{if(matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches),matcher[expando]){for(j=++i;len>j&&!Expr.relative[tokens[j].type];j++);return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:" "===tokens[i-2].type?"*":""})).replace(rtrim,"$1"),matcher,j>i&&matcherFromTokens(tokens.slice(i,j)),len>j&&matcherFromTokens(tokens=tokens.slice(j)),len>j&&toSelector(tokens))}matchers.push(matcher)}return elementMatcher(matchers)}function matcherFromGroupMatchers(elementMatchers,setMatchers){var bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function(seed,context,xml,results,outermost){var elem,j,matcher,matchedCount=0,i="0",unmatched=seed&&[],setMatched=[],contextBackup=outermostContext,elems=seed||byElement&&Expr.find.TAG("*",outermost),dirrunsUnique=dirruns+=null==contextBackup?1:Math.random()||.1,len=elems.length;for(outermost&&(outermostContext=context!==document&&context);i!==len&&null!=(elem=elems[i]);i++){if(byElement&&elem){for(j=0;matcher=elementMatchers[j++];)if(matcher(elem,context,xml)){results.push(elem);break}outermost&&(dirruns=dirrunsUnique)}bySet&&((elem=!matcher&&elem)&&matchedCount--,seed&&unmatched.push(elem))}if(matchedCount+=i,bySet&&i!==matchedCount){for(j=0;matcher=setMatchers[j++];)matcher(unmatched,setMatched,context,xml);
if(seed){if(matchedCount>0)for(;i--;)unmatched[i]||setMatched[i]||(setMatched[i]=pop.call(results));setMatched=condense(setMatched)}push.apply(results,setMatched),outermost&&!seed&&setMatched.length>0&&matchedCount+setMatchers.length>1&&Sizzle.uniqueSort(results)}return outermost&&(dirruns=dirrunsUnique,outermostContext=contextBackup),unmatched};return bySet?markFunction(superMatcher):superMatcher}function multipleContexts(selector,contexts,results){for(var i=0,len=contexts.length;len>i;i++)Sizzle(selector,contexts[i],results);return results}function select(selector,context,results,seed){var i,tokens,token,type,find,match=tokenize(selector);if(!seed&&1===match.length){if(tokens=match[0]=match[0].slice(0),tokens.length>2&&"ID"===(token=tokens[0]).type&&support.getById&&9===context.nodeType&&documentIsHTML&&Expr.relative[tokens[1].type]){if(context=(Expr.find.ID(token.matches[0].replace(runescape,funescape),context)||[])[0],!context)return results;selector=selector.slice(tokens.shift().value.length)}for(i=matchExpr.needsContext.test(selector)?0:tokens.length;i--&&(token=tokens[i],!Expr.relative[type=token.type]);)if((find=Expr.find[type])&&(seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&testContext(context.parentNode)||context))){if(tokens.splice(i,1),selector=seed.length&&toSelector(tokens),!selector)return push.apply(results,seed),results;break}}return compile(selector,match)(seed,context,!documentIsHTML,results,rsibling.test(selector)&&testContext(context.parentNode)||context),results}var i,support,Expr,getText,isXML,compile,outermostContext,sortInput,hasDuplicate,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains,expando="sizzle"+-new Date,preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),sortOrder=function(a,b){return a===b&&(hasDuplicate=!0),0},strundefined="undefined",MAX_NEGATIVE=1<<31,hasOwn={}.hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push=arr.push,slice=arr.slice,indexOf=arr.indexOf||function(elem){for(var i=0,len=this.length;len>i;i++)if(this[i]===elem)return i;return-1},booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",whitespace="[\\x20\\t\\r\\n\\f]",characterEncoding="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",identifier=characterEncoding.replace("w","w#"),attributes="\\["+whitespace+"*("+characterEncoding+")"+whitespace+"*(?:([*^$|!~]?=)"+whitespace+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+identifier+")|)|)"+whitespace+"*\\]",pseudos=":("+characterEncoding+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+attributes.replace(3,8)+")*)|.*)\\)|)",rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),rattributeQuotes=new RegExp("="+whitespace+"*([^\\]'\"]*?)"+whitespace+"*\\]","g"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={ID:new RegExp("^#("+characterEncoding+")"),CLASS:new RegExp("^\\.("+characterEncoding+")"),TAG:new RegExp("^("+characterEncoding.replace("w","w*")+")"),ATTR:new RegExp("^"+attributes),PSEUDO:new RegExp("^"+pseudos),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),bool:new RegExp("^(?:"+booleans+")$","i"),needsContext:new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rsibling=/[+~]/,rescape=/'|\\/g,runescape=new RegExp("\\\\([\\da-f]{1,6}"+whitespace+"?|("+whitespace+")|.)","ig"),funescape=function(_,escaped,escapedWhitespace){var high="0x"+escaped-65536;return high!==high||escapedWhitespace?escaped:0>high?String.fromCharCode(high+65536):String.fromCharCode(high>>10|55296,1023&high|56320)};try{push.apply(arr=slice.call(preferredDoc.childNodes),preferredDoc.childNodes),arr[preferredDoc.childNodes.length].nodeType}catch(e){push={apply:arr.length?function(target,els){push_native.apply(target,slice.call(els))}:function(target,els){for(var j=target.length,i=0;target[j++]=els[i++];);target.length=j-1}}}support=Sizzle.support={},isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return documentElement?"HTML"!==documentElement.nodeName:!1},setDocument=Sizzle.setDocument=function(node){var hasCompare,doc=node?node.ownerDocument||node:preferredDoc,parent=doc.defaultView;return doc!==document&&9===doc.nodeType&&doc.documentElement?(document=doc,docElem=doc.documentElement,documentIsHTML=!isXML(doc),parent&&parent!==parent.top&&(parent.addEventListener?parent.addEventListener("unload",function(){setDocument()},!1):parent.attachEvent&&parent.attachEvent("onunload",function(){setDocument()})),support.attributes=assert(function(div){return div.className="i",!div.getAttribute("className")}),support.getElementsByTagName=assert(function(div){return div.appendChild(doc.createComment("")),!div.getElementsByTagName("*").length}),support.getElementsByClassName=rnative.test(doc.getElementsByClassName)&&assert(function(div){return div.innerHTML="<div class='a'></div><div class='a i'></div>",div.firstChild.className="i",2===div.getElementsByClassName("i").length}),support.getById=assert(function(div){return docElem.appendChild(div).id=expando,!doc.getElementsByName||!doc.getElementsByName(expando).length}),support.getById?(Expr.find.ID=function(id,context){if(typeof context.getElementById!==strundefined&&documentIsHTML){var m=context.getElementById(id);return m&&m.parentNode?[m]:[]}},Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId}}):(delete Expr.find.ID,Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){var node=typeof elem.getAttributeNode!==strundefined&&elem.getAttributeNode("id");return node&&node.value===attrId}}),Expr.find.TAG=support.getElementsByTagName?function(tag,context){return typeof context.getElementsByTagName!==strundefined?context.getElementsByTagName(tag):void 0}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if("*"===tag){for(;elem=results[i++];)1===elem.nodeType&&tmp.push(elem);return tmp}return results},Expr.find.CLASS=support.getElementsByClassName&&function(className,context){return typeof context.getElementsByClassName!==strundefined&&documentIsHTML?context.getElementsByClassName(className):void 0},rbuggyMatches=[],rbuggyQSA=[],(support.qsa=rnative.test(doc.querySelectorAll))&&(assert(function(div){div.innerHTML="<select t=''><option selected=''></option></select>",div.querySelectorAll("[t^='']").length&&rbuggyQSA.push("[*^$]="+whitespace+"*(?:''|\"\")"),div.querySelectorAll("[selected]").length||rbuggyQSA.push("\\["+whitespace+"*(?:value|"+booleans+")"),div.querySelectorAll(":checked").length||rbuggyQSA.push(":checked")}),assert(function(div){var input=doc.createElement("input");input.setAttribute("type","hidden"),div.appendChild(input).setAttribute("name","D"),div.querySelectorAll("[name=d]").length&&rbuggyQSA.push("name"+whitespace+"*[*^$|!~]?="),div.querySelectorAll(":enabled").length||rbuggyQSA.push(":enabled",":disabled"),div.querySelectorAll("*,:x"),rbuggyQSA.push(",.*:")})),(support.matchesSelector=rnative.test(matches=docElem.webkitMatchesSelector||docElem.mozMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector))&&assert(function(div){support.disconnectedMatch=matches.call(div,"div"),matches.call(div,"[s!='']:x"),rbuggyMatches.push("!=",pseudos)}),rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|")),rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|")),hasCompare=rnative.test(docElem.compareDocumentPosition),contains=hasCompare||rnative.test(docElem.contains)?function(a,b){var adown=9===a.nodeType?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!(!bup||1!==bup.nodeType||!(adown.contains?adown.contains(bup):a.compareDocumentPosition&&16&a.compareDocumentPosition(bup)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},sortOrder=hasCompare?function(a,b){if(a===b)return hasDuplicate=!0,0;var compare=!a.compareDocumentPosition-!b.compareDocumentPosition;return compare?compare:(compare=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&compare||!support.sortDetached&&b.compareDocumentPosition(a)===compare?a===doc||a.ownerDocument===preferredDoc&&contains(preferredDoc,a)?-1:b===doc||b.ownerDocument===preferredDoc&&contains(preferredDoc,b)?1:sortInput?indexOf.call(sortInput,a)-indexOf.call(sortInput,b):0:4&compare?-1:1)}:function(a,b){if(a===b)return hasDuplicate=!0,0;var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(!aup||!bup)return a===doc?-1:b===doc?1:aup?-1:bup?1:sortInput?indexOf.call(sortInput,a)-indexOf.call(sortInput,b):0;if(aup===bup)return siblingCheck(a,b);for(cur=a;cur=cur.parentNode;)ap.unshift(cur);for(cur=b;cur=cur.parentNode;)bp.unshift(cur);for(;ap[i]===bp[i];)i++;return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0},doc):document},Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements)},Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document&&setDocument(elem),expr=expr.replace(rattributeQuotes,"='$1']"),!(!support.matchesSelector||!documentIsHTML||rbuggyMatches&&rbuggyMatches.test(expr)||rbuggyQSA&&rbuggyQSA.test(expr)))try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&11!==elem.document.nodeType)return ret}catch(e){}return Sizzle(expr,document,null,[elem]).length>0},Sizzle.contains=function(context,elem){return(context.ownerDocument||context)!==document&&setDocument(context),contains(context,elem)},Sizzle.attr=function(elem,name){(elem.ownerDocument||elem)!==document&&setDocument(elem);var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):void 0;return void 0!==val?val:support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null},Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg)},Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;if(hasDuplicate=!support.detectDuplicates,sortInput=!support.sortStable&&results.slice(0),results.sort(sortOrder),hasDuplicate){for(;elem=results[i++];)elem===results[i]&&(j=duplicates.push(i));for(;j--;)results.splice(duplicates[j],1)}return sortInput=null,results},getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(nodeType){if(1===nodeType||9===nodeType||11===nodeType){if("string"==typeof elem.textContent)return elem.textContent;for(elem=elem.firstChild;elem;elem=elem.nextSibling)ret+=getText(elem)}else if(3===nodeType||4===nodeType)return elem.nodeValue}else for(;node=elem[i++];)ret+=getText(node);return ret},Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(match){return match[1]=match[1].replace(runescape,funescape),match[3]=(match[4]||match[5]||"").replace(runescape,funescape),"~="===match[2]&&(match[3]=" "+match[3]+" "),match.slice(0,4)},CHILD:function(match){return match[1]=match[1].toLowerCase(),"nth"===match[1].slice(0,3)?(match[3]||Sizzle.error(match[0]),match[4]=+(match[4]?match[5]+(match[6]||1):2*("even"===match[3]||"odd"===match[3])),match[5]=+(match[7]+match[8]||"odd"===match[3])):match[3]&&Sizzle.error(match[0]),match},PSEUDO:function(match){var excess,unquoted=!match[5]&&match[2];return matchExpr.CHILD.test(match[0])?null:(match[3]&&void 0!==match[4]?match[2]=match[4]:unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,!0))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)&&(match[0]=match[0].slice(0,excess),match[2]=unquoted.slice(0,excess)),match.slice(0,3))}},filter:{TAG:function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return"*"===nodeNameSelector?function(){return!0}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName}},CLASS:function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test("string"==typeof elem.className&&elem.className||typeof elem.getAttribute!==strundefined&&elem.getAttribute("class")||"")})},ATTR:function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);return null==result?"!="===operator:operator?(result+="","="===operator?result===check:"!="===operator?result!==check:"^="===operator?check&&0===result.indexOf(check):"*="===operator?check&&result.indexOf(check)>-1:"$="===operator?check&&result.slice(-check.length)===check:"~="===operator?(" "+result+" ").indexOf(check)>-1:"|="===operator?result===check||result.slice(0,check.length+1)===check+"-":!1):!0}},CHILD:function(type,what,argument,first,last){var simple="nth"!==type.slice(0,3),forward="last"!==type.slice(-4),ofType="of-type"===what;return 1===first&&0===last?function(elem){return!!elem.parentNode}:function(elem,context,xml){var cache,outerCache,node,diff,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType;if(parent){if(simple){for(;dir;){for(node=elem;node=node[dir];)if(ofType?node.nodeName.toLowerCase()===name:1===node.nodeType)return!1;start=dir="only"===type&&!start&&"nextSibling"}return!0}if(start=[forward?parent.firstChild:parent.lastChild],forward&&useCache){for(outerCache=parent[expando]||(parent[expando]={}),cache=outerCache[type]||[],nodeIndex=cache[0]===dirruns&&cache[1],diff=cache[0]===dirruns&&cache[2],node=nodeIndex&&parent.childNodes[nodeIndex];node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop();)if(1===node.nodeType&&++diff&&node===elem){outerCache[type]=[dirruns,nodeIndex,diff];break}}else if(useCache&&(cache=(elem[expando]||(elem[expando]={}))[type])&&cache[0]===dirruns)diff=cache[1];else for(;(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())&&((ofType?node.nodeName.toLowerCase()!==name:1!==node.nodeType)||!++diff||(useCache&&((node[expando]||(node[expando]={}))[type]=[dirruns,diff]),node!==elem)););return diff-=last,diff===first||diff%first===0&&diff/first>=0}}},PSEUDO:function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);return fn[expando]?fn(argument):fn.length>1?(args=[pseudo,pseudo,"",argument],Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){for(var idx,matched=fn(seed,argument),i=matched.length;i--;)idx=indexOf.call(seed,matched[i]),seed[idx]=!(matches[idx]=matched[i])}):function(elem){return fn(elem,0,args)}):fn}},pseudos:{not:markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,context,xml){for(var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;i--;)(elem=unmatched[i])&&(seed[i]=!(matches[i]=elem))}):function(elem,context,xml){return input[0]=elem,matcher(input,null,xml,results),!results.pop()}}),has:markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0}}),contains:markFunction(function(text){return function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1}}),lang:markFunction(function(lang){return ridentifier.test(lang||"")||Sizzle.error("unsupported lang: "+lang),lang=lang.replace(runescape,funescape).toLowerCase(),function(elem){var elemLang;do if(elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang"))return elemLang=elemLang.toLowerCase(),elemLang===lang||0===elemLang.indexOf(lang+"-");while((elem=elem.parentNode)&&1===elem.nodeType);return!1}}),target:function(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id},root:function(elem){return elem===docElem},focus:function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex)},enabled:function(elem){return elem.disabled===!1},disabled:function(elem){return elem.disabled===!0},checked:function(elem){var nodeName=elem.nodeName.toLowerCase();return"input"===nodeName&&!!elem.checked||"option"===nodeName&&!!elem.selected},selected:function(elem){return elem.parentNode&&elem.parentNode.selectedIndex,elem.selected===!0},empty:function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling)if(elem.nodeType<6)return!1;return!0},parent:function(elem){return!Expr.pseudos.empty(elem)},header:function(elem){return rheader.test(elem.nodeName)},input:function(elem){return rinputs.test(elem.nodeName)},button:function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&"button"===elem.type||"button"===name},text:function(elem){var attr;return"input"===elem.nodeName.toLowerCase()&&"text"===elem.type&&(null==(attr=elem.getAttribute("type"))||"text"===attr.toLowerCase())},first:createPositionalPseudo(function(){return[0]}),last:createPositionalPseudo(function(matchIndexes,length){return[length-1]}),eq:createPositionalPseudo(function(matchIndexes,length,argument){return[0>argument?argument+length:argument]}),even:createPositionalPseudo(function(matchIndexes,length){for(var i=0;length>i;i+=2)matchIndexes.push(i);return matchIndexes}),odd:createPositionalPseudo(function(matchIndexes,length){for(var i=1;length>i;i+=2)matchIndexes.push(i);return matchIndexes}),lt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=0>argument?argument+length:argument;--i>=0;)matchIndexes.push(i);return matchIndexes}),gt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=0>argument?argument+length:argument;++i<length;)matchIndexes.push(i);return matchIndexes})}},Expr.pseudos.nth=Expr.pseudos.eq;for(i in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})Expr.pseudos[i]=createInputPseudo(i);for(i in{submit:!0,reset:!0})Expr.pseudos[i]=createButtonPseudo(i);return setFilters.prototype=Expr.filters=Expr.pseudos,Expr.setFilters=new setFilters,compile=Sizzle.compile=function(selector,group){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){for(group||(group=tokenize(selector)),i=group.length;i--;)cached=matcherFromTokens(group[i]),cached[expando]?setMatchers.push(cached):elementMatchers.push(cached);cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers))}return cached},support.sortStable=expando.split("").sort(sortOrder).join("")===expando,support.detectDuplicates=!!hasDuplicate,setDocument(),support.sortDetached=assert(function(div1){return 1&div1.compareDocumentPosition(document.createElement("div"))}),assert(function(div){return div.innerHTML="<a href='#'></a>","#"===div.firstChild.getAttribute("href")})||addHandle("type|href|height|width",function(elem,name,isXML){return isXML?void 0:elem.getAttribute(name,"type"===name.toLowerCase()?1:2)}),support.attributes&&assert(function(div){return div.innerHTML="<input/>",div.firstChild.setAttribute("value",""),""===div.firstChild.getAttribute("value")})||addHandle("value",function(elem,name,isXML){return isXML||"input"!==elem.nodeName.toLowerCase()?void 0:elem.defaultValue}),assert(function(div){return null==div.getAttribute("disabled")})||addHandle(booleans,function(elem,name,isXML){var val;return isXML?void 0:elem[name]===!0?name.toLowerCase():(val=elem.getAttributeNode(name))&&val.specified?val.value:null}),Sizzle}(window);jQuery.find=Sizzle,jQuery.expr=Sizzle.selectors,jQuery.expr[":"]=jQuery.expr.pseudos,jQuery.unique=Sizzle.uniqueSort,jQuery.text=Sizzle.getText,jQuery.isXMLDoc=Sizzle.isXML,jQuery.contains=Sizzle.contains;var rneedsContext=jQuery.expr.match.needsContext,rsingleTag=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,risSimple=/^.[^:#\[\.,]*$/;jQuery.filter=function(expr,elems,not){var elem=elems[0];return not&&(expr=":not("+expr+")"),1===elems.length&&1===elem.nodeType?jQuery.find.matchesSelector(elem,expr)?[elem]:[]:jQuery.find.matches(expr,jQuery.grep(elems,function(elem){return 1===elem.nodeType}))},jQuery.fn.extend({find:function(selector){var i,ret=[],self=this,len=self.length;if("string"!=typeof selector)return this.pushStack(jQuery(selector).filter(function(){for(i=0;len>i;i++)if(jQuery.contains(self[i],this))return!0}));for(i=0;len>i;i++)jQuery.find(selector,self[i],ret);return ret=this.pushStack(len>1?jQuery.unique(ret):ret),ret.selector=this.selector?this.selector+" "+selector:selector,ret},filter:function(selector){return this.pushStack(winnow(this,selector||[],!1))},not:function(selector){return this.pushStack(winnow(this,selector||[],!0))},is:function(selector){return!!winnow(this,"string"==typeof selector&&rneedsContext.test(selector)?jQuery(selector):selector||[],!1).length}});var rootjQuery,document=window.document,rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,init=jQuery.fn.init=function(selector,context){var match,elem;if(!selector)return this;if("string"==typeof selector){if(match="<"===selector.charAt(0)&&">"===selector.charAt(selector.length-1)&&selector.length>=3?[null,selector,null]:rquickExpr.exec(selector),!match||!match[1]&&context)return!context||context.jquery?(context||rootjQuery).find(selector):this.constructor(context).find(selector);if(match[1]){if(context=context instanceof jQuery?context[0]:context,jQuery.merge(this,jQuery.parseHTML(match[1],context&&context.nodeType?context.ownerDocument||context:document,!0)),rsingleTag.test(match[1])&&jQuery.isPlainObject(context))for(match in context)jQuery.isFunction(this[match])?this[match](context[match]):this.attr(match,context[match]);return this}if(elem=document.getElementById(match[2]),elem&&elem.parentNode){if(elem.id!==match[2])return rootjQuery.find(selector);this.length=1,this[0]=elem}return this.context=document,this.selector=selector,this}return selector.nodeType?(this.context=this[0]=selector,this.length=1,this):jQuery.isFunction(selector)?"undefined"!=typeof rootjQuery.ready?rootjQuery.ready(selector):selector(jQuery):(void 0!==selector.selector&&(this.selector=selector.selector,this.context=selector.context),jQuery.makeArray(selector,this))};init.prototype=jQuery.fn,rootjQuery=jQuery(document);var rparentsprev=/^(?:parents|prev(?:Until|All))/,guaranteedUnique={children:!0,contents:!0,next:!0,prev:!0};jQuery.extend({dir:function(elem,dir,until){for(var matched=[],cur=elem[dir];cur&&9!==cur.nodeType&&(void 0===until||1!==cur.nodeType||!jQuery(cur).is(until));)1===cur.nodeType&&matched.push(cur),cur=cur[dir];return matched},sibling:function(n,elem){for(var r=[];n;n=n.nextSibling)1===n.nodeType&&n!==elem&&r.push(n);return r}}),jQuery.fn.extend({has:function(target){var i,targets=jQuery(target,this),len=targets.length;return this.filter(function(){for(i=0;len>i;i++)if(jQuery.contains(this,targets[i]))return!0})},closest:function(selectors,context){for(var cur,i=0,l=this.length,matched=[],pos=rneedsContext.test(selectors)||"string"!=typeof selectors?jQuery(selectors,context||this.context):0;l>i;i++)for(cur=this[i];cur&&cur!==context;cur=cur.parentNode)if(cur.nodeType<11&&(pos?pos.index(cur)>-1:1===cur.nodeType&&jQuery.find.matchesSelector(cur,selectors))){matched.push(cur);break}return this.pushStack(matched.length>1?jQuery.unique(matched):matched)},index:function(elem){return elem?"string"==typeof elem?jQuery.inArray(this[0],jQuery(elem)):jQuery.inArray(elem.jquery?elem[0]:elem,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(selector,context){return this.pushStack(jQuery.unique(jQuery.merge(this.get(),jQuery(selector,context))))},addBack:function(selector){return this.add(null==selector?this.prevObject:this.prevObject.filter(selector))}}),jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&11!==parent.nodeType?parent:null},parents:function(elem){return jQuery.dir(elem,"parentNode")},parentsUntil:function(elem,i,until){return jQuery.dir(elem,"parentNode",until)},next:function(elem){return sibling(elem,"nextSibling")},prev:function(elem){return sibling(elem,"previousSibling")},nextAll:function(elem){return jQuery.dir(elem,"nextSibling")},prevAll:function(elem){return jQuery.dir(elem,"previousSibling")},nextUntil:function(elem,i,until){return jQuery.dir(elem,"nextSibling",until)},prevUntil:function(elem,i,until){return jQuery.dir(elem,"previousSibling",until)},siblings:function(elem){return jQuery.sibling((elem.parentNode||{}).firstChild,elem)},children:function(elem){return jQuery.sibling(elem.firstChild)},contents:function(elem){return jQuery.nodeName(elem,"iframe")?elem.contentDocument||elem.contentWindow.document:jQuery.merge([],elem.childNodes)}},function(name,fn){jQuery.fn[name]=function(until,selector){var ret=jQuery.map(this,fn,until);return"Until"!==name.slice(-5)&&(selector=until),selector&&"string"==typeof selector&&(ret=jQuery.filter(selector,ret)),this.length>1&&(guaranteedUnique[name]||(ret=jQuery.unique(ret)),rparentsprev.test(name)&&(ret=ret.reverse())),this.pushStack(ret)}});var rnotwhite=/\S+/g,optionsCache={};jQuery.Callbacks=function(options){options="string"==typeof options?optionsCache[options]||createOptions(options):jQuery.extend({},options);var firing,memory,fired,firingLength,firingIndex,firingStart,list=[],stack=!options.once&&[],fire=function(data){for(memory=options.memory&&data,fired=!0,firingIndex=firingStart||0,firingStart=0,firingLength=list.length,firing=!0;list&&firingLength>firingIndex;firingIndex++)if(list[firingIndex].apply(data[0],data[1])===!1&&options.stopOnFalse){memory=!1;break}firing=!1,list&&(stack?stack.length&&fire(stack.shift()):memory?list=[]:self.disable())},self={add:function(){if(list){var start=list.length;!function add(args){jQuery.each(args,function(_,arg){var type=jQuery.type(arg);"function"===type?options.unique&&self.has(arg)||list.push(arg):arg&&arg.length&&"string"!==type&&add(arg)})}(arguments),firing?firingLength=list.length:memory&&(firingStart=start,fire(memory))}return this},remove:function(){return list&&jQuery.each(arguments,function(_,arg){for(var index;(index=jQuery.inArray(arg,list,index))>-1;)list.splice(index,1),firing&&(firingLength>=index&&firingLength--,firingIndex>=index&&firingIndex--)}),this},has:function(fn){return fn?jQuery.inArray(fn,list)>-1:!(!list||!list.length)},empty:function(){return list=[],firingLength=0,this},disable:function(){return list=stack=memory=void 0,this},disabled:function(){return!list},lock:function(){return stack=void 0,memory||self.disable(),this},locked:function(){return!stack},fireWith:function(context,args){return!list||fired&&!stack||(args=args||[],args=[context,args.slice?args.slice():args],firing?stack.push(args):fire(args)),this},fire:function(){return self.fireWith(this,arguments),this},fired:function(){return!!fired}};return self},jQuery.extend({Deferred:function(func){var tuples=[["resolve","done",jQuery.Callbacks("once memory"),"resolved"],["reject","fail",jQuery.Callbacks("once memory"),"rejected"],["notify","progress",jQuery.Callbacks("memory")]],state="pending",promise={state:function(){return state},always:function(){return deferred.done(arguments).fail(arguments),this},then:function(){var fns=arguments;return jQuery.Deferred(function(newDefer){jQuery.each(tuples,function(i,tuple){var fn=jQuery.isFunction(fns[i])&&fns[i];deferred[tuple[1]](function(){var returned=fn&&fn.apply(this,arguments);returned&&jQuery.isFunction(returned.promise)?returned.promise().done(newDefer.resolve).fail(newDefer.reject).progress(newDefer.notify):newDefer[tuple[0]+"With"](this===promise?newDefer.promise():this,fn?[returned]:arguments)})}),fns=null}).promise()},promise:function(obj){return null!=obj?jQuery.extend(obj,promise):promise}},deferred={};return promise.pipe=promise.then,jQuery.each(tuples,function(i,tuple){var list=tuple[2],stateString=tuple[3];promise[tuple[1]]=list.add,stateString&&list.add(function(){state=stateString},tuples[1^i][2].disable,tuples[2][2].lock),deferred[tuple[0]]=function(){return deferred[tuple[0]+"With"](this===deferred?promise:this,arguments),this},deferred[tuple[0]+"With"]=list.fireWith}),promise.promise(deferred),func&&func.call(deferred,deferred),deferred},when:function(subordinate){var progressValues,progressContexts,resolveContexts,i=0,resolveValues=slice.call(arguments),length=resolveValues.length,remaining=1!==length||subordinate&&jQuery.isFunction(subordinate.promise)?length:0,deferred=1===remaining?subordinate:jQuery.Deferred(),updateFunc=function(i,contexts,values){return function(value){contexts[i]=this,values[i]=arguments.length>1?slice.call(arguments):value,values===progressValues?deferred.notifyWith(contexts,values):--remaining||deferred.resolveWith(contexts,values)}};if(length>1)for(progressValues=new Array(length),progressContexts=new Array(length),resolveContexts=new Array(length);length>i;i++)resolveValues[i]&&jQuery.isFunction(resolveValues[i].promise)?resolveValues[i].promise().done(updateFunc(i,resolveContexts,resolveValues)).fail(deferred.reject).progress(updateFunc(i,progressContexts,progressValues)):--remaining;return remaining||deferred.resolveWith(resolveContexts,resolveValues),deferred.promise()}});var readyList;jQuery.fn.ready=function(fn){return jQuery.ready.promise().done(fn),this},jQuery.extend({isReady:!1,readyWait:1,holdReady:function(hold){hold?jQuery.readyWait++:jQuery.ready(!0)},ready:function(wait){if(wait===!0?!--jQuery.readyWait:!jQuery.isReady){if(!document.body)return setTimeout(jQuery.ready);jQuery.isReady=!0,wait!==!0&&--jQuery.readyWait>0||(readyList.resolveWith(document,[jQuery]),jQuery.fn.trigger&&jQuery(document).trigger("ready").off("ready"))}}}),jQuery.ready.promise=function(obj){if(!readyList)if(readyList=jQuery.Deferred(),"complete"===document.readyState)setTimeout(jQuery.ready);else if(document.addEventListener)document.addEventListener("DOMContentLoaded",completed,!1),window.addEventListener("load",completed,!1);else{document.attachEvent("onreadystatechange",completed),window.attachEvent("onload",completed);var top=!1;try{top=null==window.frameElement&&document.documentElement}catch(e){}top&&top.doScroll&&!function doScrollCheck(){if(!jQuery.isReady){try{top.doScroll("left")}catch(e){return setTimeout(doScrollCheck,50)}detach(),jQuery.ready()}}()}return readyList.promise(obj)};var i,strundefined="undefined";for(i in jQuery(support))break;support.ownLast="0"!==i,support.inlineBlockNeedsLayout=!1,jQuery(function(){var container,div,body=document.getElementsByTagName("body")[0];body&&(container=document.createElement("div"),container.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",div=document.createElement("div"),body.appendChild(container).appendChild(div),typeof div.style.zoom!==strundefined&&(div.style.cssText="border:0;margin:0;width:1px;padding:1px;display:inline;zoom:1",(support.inlineBlockNeedsLayout=3===div.offsetWidth)&&(body.style.zoom=1)),body.removeChild(container),container=div=null)}),function(){var div=document.createElement("div");if(null==support.deleteExpando){support.deleteExpando=!0;try{delete div.test}catch(e){support.deleteExpando=!1}}div=null}(),jQuery.acceptData=function(elem){var noData=jQuery.noData[(elem.nodeName+" ").toLowerCase()],nodeType=+elem.nodeType||1;return 1!==nodeType&&9!==nodeType?!1:!noData||noData!==!0&&elem.getAttribute("classid")===noData};var rbrace=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,rmultiDash=/([A-Z])/g;jQuery.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(elem){return elem=elem.nodeType?jQuery.cache[elem[jQuery.expando]]:elem[jQuery.expando],!!elem&&!isEmptyDataObject(elem)},data:function(elem,name,data){return internalData(elem,name,data)},removeData:function(elem,name){return internalRemoveData(elem,name)},_data:function(elem,name,data){return internalData(elem,name,data,!0)},_removeData:function(elem,name){return internalRemoveData(elem,name,!0)}}),jQuery.fn.extend({data:function(key,value){var i,name,data,elem=this[0],attrs=elem&&elem.attributes;
if(void 0===key){if(this.length&&(data=jQuery.data(elem),1===elem.nodeType&&!jQuery._data(elem,"parsedAttrs"))){for(i=attrs.length;i--;)name=attrs[i].name,0===name.indexOf("data-")&&(name=jQuery.camelCase(name.slice(5)),dataAttr(elem,name,data[name]));jQuery._data(elem,"parsedAttrs",!0)}return data}return"object"==typeof key?this.each(function(){jQuery.data(this,key)}):arguments.length>1?this.each(function(){jQuery.data(this,key,value)}):elem?dataAttr(elem,key,jQuery.data(elem,key)):void 0},removeData:function(key){return this.each(function(){jQuery.removeData(this,key)})}}),jQuery.extend({queue:function(elem,type,data){var queue;return elem?(type=(type||"fx")+"queue",queue=jQuery._data(elem,type),data&&(!queue||jQuery.isArray(data)?queue=jQuery._data(elem,type,jQuery.makeArray(data)):queue.push(data)),queue||[]):void 0},dequeue:function(elem,type){type=type||"fx";var queue=jQuery.queue(elem,type),startLength=queue.length,fn=queue.shift(),hooks=jQuery._queueHooks(elem,type),next=function(){jQuery.dequeue(elem,type)};"inprogress"===fn&&(fn=queue.shift(),startLength--),fn&&("fx"===type&&queue.unshift("inprogress"),delete hooks.stop,fn.call(elem,next,hooks)),!startLength&&hooks&&hooks.empty.fire()},_queueHooks:function(elem,type){var key=type+"queueHooks";return jQuery._data(elem,key)||jQuery._data(elem,key,{empty:jQuery.Callbacks("once memory").add(function(){jQuery._removeData(elem,type+"queue"),jQuery._removeData(elem,key)})})}}),jQuery.fn.extend({queue:function(type,data){var setter=2;return"string"!=typeof type&&(data=type,type="fx",setter--),arguments.length<setter?jQuery.queue(this[0],type):void 0===data?this:this.each(function(){var queue=jQuery.queue(this,type,data);jQuery._queueHooks(this,type),"fx"===type&&"inprogress"!==queue[0]&&jQuery.dequeue(this,type)})},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type)})},clearQueue:function(type){return this.queue(type||"fx",[])},promise:function(type,obj){var tmp,count=1,defer=jQuery.Deferred(),elements=this,i=this.length,resolve=function(){--count||defer.resolveWith(elements,[elements])};for("string"!=typeof type&&(obj=type,type=void 0),type=type||"fx";i--;)tmp=jQuery._data(elements[i],type+"queueHooks"),tmp&&tmp.empty&&(count++,tmp.empty.add(resolve));return resolve(),defer.promise(obj)}});var pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,cssExpand=["Top","Right","Bottom","Left"],isHidden=function(elem,el){return elem=el||elem,"none"===jQuery.css(elem,"display")||!jQuery.contains(elem.ownerDocument,elem)},access=jQuery.access=function(elems,fn,key,value,chainable,emptyGet,raw){var i=0,length=elems.length,bulk=null==key;if("object"===jQuery.type(key)){chainable=!0;for(i in key)jQuery.access(elems,fn,i,key[i],!0,emptyGet,raw)}else if(void 0!==value&&(chainable=!0,jQuery.isFunction(value)||(raw=!0),bulk&&(raw?(fn.call(elems,value),fn=null):(bulk=fn,fn=function(elem,key,value){return bulk.call(jQuery(elem),value)})),fn))for(;length>i;i++)fn(elems[i],key,raw?value:value.call(elems[i],i,fn(elems[i],key)));return chainable?elems:bulk?fn.call(elems):length?fn(elems[0],key):emptyGet},rcheckableType=/^(?:checkbox|radio)$/i;!function(){var fragment=document.createDocumentFragment(),div=document.createElement("div"),input=document.createElement("input");if(div.setAttribute("className","t"),div.innerHTML="  <link/><table></table><a href='/a'>a</a>",support.leadingWhitespace=3===div.firstChild.nodeType,support.tbody=!div.getElementsByTagName("tbody").length,support.htmlSerialize=!!div.getElementsByTagName("link").length,support.html5Clone="<:nav></:nav>"!==document.createElement("nav").cloneNode(!0).outerHTML,input.type="checkbox",input.checked=!0,fragment.appendChild(input),support.appendChecked=input.checked,div.innerHTML="<textarea>x</textarea>",support.noCloneChecked=!!div.cloneNode(!0).lastChild.defaultValue,fragment.appendChild(div),div.innerHTML="<input type='radio' checked='checked' name='t'/>",support.checkClone=div.cloneNode(!0).cloneNode(!0).lastChild.checked,support.noCloneEvent=!0,div.attachEvent&&(div.attachEvent("onclick",function(){support.noCloneEvent=!1}),div.cloneNode(!0).click()),null==support.deleteExpando){support.deleteExpando=!0;try{delete div.test}catch(e){support.deleteExpando=!1}}fragment=div=input=null}(),function(){var i,eventName,div=document.createElement("div");for(i in{submit:!0,change:!0,focusin:!0})eventName="on"+i,(support[i+"Bubbles"]=eventName in window)||(div.setAttribute(eventName,"t"),support[i+"Bubbles"]=div.attributes[eventName].expando===!1);div=null}();var rformElems=/^(?:input|select|textarea)$/i,rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|contextmenu)|click/,rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,rtypenamespace=/^([^.]*)(?:\.(.+)|)$/;jQuery.event={global:{},add:function(elem,types,handler,data,selector){var tmp,events,t,handleObjIn,special,eventHandle,handleObj,handlers,type,namespaces,origType,elemData=jQuery._data(elem);if(elemData){for(handler.handler&&(handleObjIn=handler,handler=handleObjIn.handler,selector=handleObjIn.selector),handler.guid||(handler.guid=jQuery.guid++),(events=elemData.events)||(events=elemData.events={}),(eventHandle=elemData.handle)||(eventHandle=elemData.handle=function(e){return typeof jQuery===strundefined||e&&jQuery.event.triggered===e.type?void 0:jQuery.event.dispatch.apply(eventHandle.elem,arguments)},eventHandle.elem=elem),types=(types||"").match(rnotwhite)||[""],t=types.length;t--;)tmp=rtypenamespace.exec(types[t])||[],type=origType=tmp[1],namespaces=(tmp[2]||"").split(".").sort(),type&&(special=jQuery.event.special[type]||{},type=(selector?special.delegateType:special.bindType)||type,special=jQuery.event.special[type]||{},handleObj=jQuery.extend({type:type,origType:origType,data:data,handler:handler,guid:handler.guid,selector:selector,needsContext:selector&&jQuery.expr.match.needsContext.test(selector),namespace:namespaces.join(".")},handleObjIn),(handlers=events[type])||(handlers=events[type]=[],handlers.delegateCount=0,special.setup&&special.setup.call(elem,data,namespaces,eventHandle)!==!1||(elem.addEventListener?elem.addEventListener(type,eventHandle,!1):elem.attachEvent&&elem.attachEvent("on"+type,eventHandle))),special.add&&(special.add.call(elem,handleObj),handleObj.handler.guid||(handleObj.handler.guid=handler.guid)),selector?handlers.splice(handlers.delegateCount++,0,handleObj):handlers.push(handleObj),jQuery.event.global[type]=!0);elem=null}},remove:function(elem,types,handler,selector,mappedTypes){var j,handleObj,tmp,origCount,t,events,special,handlers,type,namespaces,origType,elemData=jQuery.hasData(elem)&&jQuery._data(elem);if(elemData&&(events=elemData.events)){for(types=(types||"").match(rnotwhite)||[""],t=types.length;t--;)if(tmp=rtypenamespace.exec(types[t])||[],type=origType=tmp[1],namespaces=(tmp[2]||"").split(".").sort(),type){for(special=jQuery.event.special[type]||{},type=(selector?special.delegateType:special.bindType)||type,handlers=events[type]||[],tmp=tmp[2]&&new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"),origCount=j=handlers.length;j--;)handleObj=handlers[j],!mappedTypes&&origType!==handleObj.origType||handler&&handler.guid!==handleObj.guid||tmp&&!tmp.test(handleObj.namespace)||selector&&selector!==handleObj.selector&&("**"!==selector||!handleObj.selector)||(handlers.splice(j,1),handleObj.selector&&handlers.delegateCount--,special.remove&&special.remove.call(elem,handleObj));origCount&&!handlers.length&&(special.teardown&&special.teardown.call(elem,namespaces,elemData.handle)!==!1||jQuery.removeEvent(elem,type,elemData.handle),delete events[type])}else for(type in events)jQuery.event.remove(elem,type+types[t],handler,selector,!0);jQuery.isEmptyObject(events)&&(delete elemData.handle,jQuery._removeData(elem,"events"))}},trigger:function(event,data,elem,onlyHandlers){var handle,ontype,cur,bubbleType,special,tmp,i,eventPath=[elem||document],type=hasOwn.call(event,"type")?event.type:event,namespaces=hasOwn.call(event,"namespace")?event.namespace.split("."):[];if(cur=tmp=elem=elem||document,3!==elem.nodeType&&8!==elem.nodeType&&!rfocusMorph.test(type+jQuery.event.triggered)&&(type.indexOf(".")>=0&&(namespaces=type.split("."),type=namespaces.shift(),namespaces.sort()),ontype=type.indexOf(":")<0&&"on"+type,event=event[jQuery.expando]?event:new jQuery.Event(type,"object"==typeof event&&event),event.isTrigger=onlyHandlers?2:3,event.namespace=namespaces.join("."),event.namespace_re=event.namespace?new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,event.result=void 0,event.target||(event.target=elem),data=null==data?[event]:jQuery.makeArray(data,[event]),special=jQuery.event.special[type]||{},onlyHandlers||!special.trigger||special.trigger.apply(elem,data)!==!1)){if(!onlyHandlers&&!special.noBubble&&!jQuery.isWindow(elem)){for(bubbleType=special.delegateType||type,rfocusMorph.test(bubbleType+type)||(cur=cur.parentNode);cur;cur=cur.parentNode)eventPath.push(cur),tmp=cur;tmp===(elem.ownerDocument||document)&&eventPath.push(tmp.defaultView||tmp.parentWindow||window)}for(i=0;(cur=eventPath[i++])&&!event.isPropagationStopped();)event.type=i>1?bubbleType:special.bindType||type,handle=(jQuery._data(cur,"events")||{})[event.type]&&jQuery._data(cur,"handle"),handle&&handle.apply(cur,data),handle=ontype&&cur[ontype],handle&&handle.apply&&jQuery.acceptData(cur)&&(event.result=handle.apply(cur,data),event.result===!1&&event.preventDefault());if(event.type=type,!onlyHandlers&&!event.isDefaultPrevented()&&(!special._default||special._default.apply(eventPath.pop(),data)===!1)&&jQuery.acceptData(elem)&&ontype&&elem[type]&&!jQuery.isWindow(elem)){tmp=elem[ontype],tmp&&(elem[ontype]=null),jQuery.event.triggered=type;try{elem[type]()}catch(e){}jQuery.event.triggered=void 0,tmp&&(elem[ontype]=tmp)}return event.result}},dispatch:function(event){event=jQuery.event.fix(event);var i,ret,handleObj,matched,j,handlerQueue=[],args=slice.call(arguments),handlers=(jQuery._data(this,"events")||{})[event.type]||[],special=jQuery.event.special[event.type]||{};if(args[0]=event,event.delegateTarget=this,!special.preDispatch||special.preDispatch.call(this,event)!==!1){for(handlerQueue=jQuery.event.handlers.call(this,event,handlers),i=0;(matched=handlerQueue[i++])&&!event.isPropagationStopped();)for(event.currentTarget=matched.elem,j=0;(handleObj=matched.handlers[j++])&&!event.isImmediatePropagationStopped();)(!event.namespace_re||event.namespace_re.test(handleObj.namespace))&&(event.handleObj=handleObj,event.data=handleObj.data,ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,args),void 0!==ret&&(event.result=ret)===!1&&(event.preventDefault(),event.stopPropagation()));return special.postDispatch&&special.postDispatch.call(this,event),event.result}},handlers:function(event,handlers){var sel,handleObj,matches,i,handlerQueue=[],delegateCount=handlers.delegateCount,cur=event.target;if(delegateCount&&cur.nodeType&&(!event.button||"click"!==event.type))for(;cur!=this;cur=cur.parentNode||this)if(1===cur.nodeType&&(cur.disabled!==!0||"click"!==event.type)){for(matches=[],i=0;delegateCount>i;i++)handleObj=handlers[i],sel=handleObj.selector+" ",void 0===matches[sel]&&(matches[sel]=handleObj.needsContext?jQuery(sel,this).index(cur)>=0:jQuery.find(sel,this,null,[cur]).length),matches[sel]&&matches.push(handleObj);matches.length&&handlerQueue.push({elem:cur,handlers:matches})}return delegateCount<handlers.length&&handlerQueue.push({elem:this,handlers:handlers.slice(delegateCount)}),handlerQueue},fix:function(event){if(event[jQuery.expando])return event;var i,prop,copy,type=event.type,originalEvent=event,fixHook=this.fixHooks[type];for(fixHook||(this.fixHooks[type]=fixHook=rmouseEvent.test(type)?this.mouseHooks:rkeyEvent.test(type)?this.keyHooks:{}),copy=fixHook.props?this.props.concat(fixHook.props):this.props,event=new jQuery.Event(originalEvent),i=copy.length;i--;)prop=copy[i],event[prop]=originalEvent[prop];return event.target||(event.target=originalEvent.srcElement||document),3===event.target.nodeType&&(event.target=event.target.parentNode),event.metaKey=!!event.metaKey,fixHook.filter?fixHook.filter(event,originalEvent):event},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(event,original){return null==event.which&&(event.which=null!=original.charCode?original.charCode:original.keyCode),event}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(event,original){var body,eventDoc,doc,button=original.button,fromElement=original.fromElement;return null==event.pageX&&null!=original.clientX&&(eventDoc=event.target.ownerDocument||document,doc=eventDoc.documentElement,body=eventDoc.body,event.pageX=original.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0),event.pageY=original.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0)),!event.relatedTarget&&fromElement&&(event.relatedTarget=fromElement===event.target?original.toElement:fromElement),event.which||void 0===button||(event.which=1&button?1:2&button?3:4&button?2:0),event}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==safeActiveElement()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){return this===safeActiveElement()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return jQuery.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(event){return jQuery.nodeName(event.target,"a")}},beforeunload:{postDispatch:function(event){void 0!==event.result&&(event.originalEvent.returnValue=event.result)}}},simulate:function(type,elem,event,bubble){var e=jQuery.extend(new jQuery.Event,event,{type:type,isSimulated:!0,originalEvent:{}});bubble?jQuery.event.trigger(e,null,elem):jQuery.event.dispatch.call(elem,e),e.isDefaultPrevented()&&event.preventDefault()}},jQuery.removeEvent=document.removeEventListener?function(elem,type,handle){elem.removeEventListener&&elem.removeEventListener(type,handle,!1)}:function(elem,type,handle){var name="on"+type;elem.detachEvent&&(typeof elem[name]===strundefined&&(elem[name]=null),elem.detachEvent(name,handle))},jQuery.Event=function(src,props){return this instanceof jQuery.Event?(src&&src.type?(this.originalEvent=src,this.type=src.type,this.isDefaultPrevented=src.defaultPrevented||void 0===src.defaultPrevented&&(src.returnValue===!1||src.getPreventDefault&&src.getPreventDefault())?returnTrue:returnFalse):this.type=src,props&&jQuery.extend(this,props),this.timeStamp=src&&src.timeStamp||jQuery.now(),this[jQuery.expando]=!0,void 0):new jQuery.Event(src,props)},jQuery.Event.prototype={isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=returnTrue,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=returnTrue,this.stopPropagation()}},jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function(event){var ret,target=this,related=event.relatedTarget,handleObj=event.handleObj;return(!related||related!==target&&!jQuery.contains(target,related))&&(event.type=handleObj.origType,ret=handleObj.handler.apply(this,arguments),event.type=fix),ret}}}),support.submitBubbles||(jQuery.event.special.submit={setup:function(){return jQuery.nodeName(this,"form")?!1:(jQuery.event.add(this,"click._submit keypress._submit",function(e){var elem=e.target,form=jQuery.nodeName(elem,"input")||jQuery.nodeName(elem,"button")?elem.form:void 0;form&&!jQuery._data(form,"submitBubbles")&&(jQuery.event.add(form,"submit._submit",function(event){event._submit_bubble=!0}),jQuery._data(form,"submitBubbles",!0))}),void 0)},postDispatch:function(event){event._submit_bubble&&(delete event._submit_bubble,this.parentNode&&!event.isTrigger&&jQuery.event.simulate("submit",this.parentNode,event,!0))},teardown:function(){return jQuery.nodeName(this,"form")?!1:(jQuery.event.remove(this,"._submit"),void 0)}}),support.changeBubbles||(jQuery.event.special.change={setup:function(){return rformElems.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(jQuery.event.add(this,"propertychange._change",function(event){"checked"===event.originalEvent.propertyName&&(this._just_changed=!0)}),jQuery.event.add(this,"click._change",function(event){this._just_changed&&!event.isTrigger&&(this._just_changed=!1),jQuery.event.simulate("change",this,event,!0)})),!1):(jQuery.event.add(this,"beforeactivate._change",function(e){var elem=e.target;rformElems.test(elem.nodeName)&&!jQuery._data(elem,"changeBubbles")&&(jQuery.event.add(elem,"change._change",function(event){!this.parentNode||event.isSimulated||event.isTrigger||jQuery.event.simulate("change",this.parentNode,event,!0)}),jQuery._data(elem,"changeBubbles",!0))}),void 0)},handle:function(event){var elem=event.target;return this!==elem||event.isSimulated||event.isTrigger||"radio"!==elem.type&&"checkbox"!==elem.type?event.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return jQuery.event.remove(this,"._change"),!rformElems.test(this.nodeName)}}),support.focusinBubbles||jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var handler=function(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event),!0)};jQuery.event.special[fix]={setup:function(){var doc=this.ownerDocument||this,attaches=jQuery._data(doc,fix);attaches||doc.addEventListener(orig,handler,!0),jQuery._data(doc,fix,(attaches||0)+1)},teardown:function(){var doc=this.ownerDocument||this,attaches=jQuery._data(doc,fix)-1;attaches?jQuery._data(doc,fix,attaches):(doc.removeEventListener(orig,handler,!0),jQuery._removeData(doc,fix))}}}),jQuery.fn.extend({on:function(types,selector,data,fn,one){var type,origFn;if("object"==typeof types){"string"!=typeof selector&&(data=data||selector,selector=void 0);for(type in types)this.on(type,selector,data,types[type],one);return this}if(null==data&&null==fn?(fn=selector,data=selector=void 0):null==fn&&("string"==typeof selector?(fn=data,data=void 0):(fn=data,data=selector,selector=void 0)),fn===!1)fn=returnFalse;else if(!fn)return this;return 1===one&&(origFn=fn,fn=function(event){return jQuery().off(event),origFn.apply(this,arguments)},fn.guid=origFn.guid||(origFn.guid=jQuery.guid++)),this.each(function(){jQuery.event.add(this,types,fn,data,selector)})},one:function(types,selector,data,fn){return this.on(types,selector,data,fn,1)},off:function(types,selector,fn){var handleObj,type;if(types&&types.preventDefault&&types.handleObj)return handleObj=types.handleObj,jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.origType+"."+handleObj.namespace:handleObj.origType,handleObj.selector,handleObj.handler),this;if("object"==typeof types){for(type in types)this.off(type,selector,types[type]);return this}return(selector===!1||"function"==typeof selector)&&(fn=selector,selector=void 0),fn===!1&&(fn=returnFalse),this.each(function(){jQuery.event.remove(this,types,fn,selector)})},trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this)})},triggerHandler:function(type,data){var elem=this[0];return elem?jQuery.event.trigger(type,data,elem,!0):void 0}});var nodeNames="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",rinlinejQuery=/ jQuery\d+="(?:null|\d+)"/g,rnoshimcache=new RegExp("<(?:"+nodeNames+")[\\s/>]","i"),rleadingWhitespace=/^\s+/,rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,rtagName=/<([\w:]+)/,rtbody=/<tbody/i,rhtml=/<|&#?\w+;/,rnoInnerhtml=/<(?:script|style|link)/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptType=/^$|\/(?:java|ecma)script/i,rscriptTypeMasked=/^true\/(.*)/,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},safeFragment=createSafeFragment(document),fragmentDiv=safeFragment.appendChild(document.createElement("div"));wrapMap.optgroup=wrapMap.option,wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead,wrapMap.th=wrapMap.td,jQuery.extend({clone:function(elem,dataAndEvents,deepDataAndEvents){var destElements,node,clone,i,srcElements,inPage=jQuery.contains(elem.ownerDocument,elem);if(support.html5Clone||jQuery.isXMLDoc(elem)||!rnoshimcache.test("<"+elem.nodeName+">")?clone=elem.cloneNode(!0):(fragmentDiv.innerHTML=elem.outerHTML,fragmentDiv.removeChild(clone=fragmentDiv.firstChild)),!(support.noCloneEvent&&support.noCloneChecked||1!==elem.nodeType&&11!==elem.nodeType||jQuery.isXMLDoc(elem)))for(destElements=getAll(clone),srcElements=getAll(elem),i=0;null!=(node=srcElements[i]);++i)destElements[i]&&fixCloneNodeIssues(node,destElements[i]);if(dataAndEvents)if(deepDataAndEvents)for(srcElements=srcElements||getAll(elem),destElements=destElements||getAll(clone),i=0;null!=(node=srcElements[i]);i++)cloneCopyEvent(node,destElements[i]);else cloneCopyEvent(elem,clone);return destElements=getAll(clone,"script"),destElements.length>0&&setGlobalEval(destElements,!inPage&&getAll(elem,"script")),destElements=srcElements=node=null,clone},buildFragment:function(elems,context,scripts,selection){for(var j,elem,contains,tmp,tag,tbody,wrap,l=elems.length,safe=createSafeFragment(context),nodes=[],i=0;l>i;i++)if(elem=elems[i],elem||0===elem)if("object"===jQuery.type(elem))jQuery.merge(nodes,elem.nodeType?[elem]:elem);else if(rhtml.test(elem)){for(tmp=tmp||safe.appendChild(context.createElement("div")),tag=(rtagName.exec(elem)||["",""])[1].toLowerCase(),wrap=wrapMap[tag]||wrapMap._default,tmp.innerHTML=wrap[1]+elem.replace(rxhtmlTag,"<$1></$2>")+wrap[2],j=wrap[0];j--;)tmp=tmp.lastChild;if(!support.leadingWhitespace&&rleadingWhitespace.test(elem)&&nodes.push(context.createTextNode(rleadingWhitespace.exec(elem)[0])),!support.tbody)for(elem="table"!==tag||rtbody.test(elem)?"<table>"!==wrap[1]||rtbody.test(elem)?0:tmp:tmp.firstChild,j=elem&&elem.childNodes.length;j--;)jQuery.nodeName(tbody=elem.childNodes[j],"tbody")&&!tbody.childNodes.length&&elem.removeChild(tbody);for(jQuery.merge(nodes,tmp.childNodes),tmp.textContent="";tmp.firstChild;)tmp.removeChild(tmp.firstChild);tmp=safe.lastChild}else nodes.push(context.createTextNode(elem));for(tmp&&safe.removeChild(tmp),support.appendChecked||jQuery.grep(getAll(nodes,"input"),fixDefaultChecked),i=0;elem=nodes[i++];)if((!selection||-1===jQuery.inArray(elem,selection))&&(contains=jQuery.contains(elem.ownerDocument,elem),tmp=getAll(safe.appendChild(elem),"script"),contains&&setGlobalEval(tmp),scripts))for(j=0;elem=tmp[j++];)rscriptType.test(elem.type||"")&&scripts.push(elem);return tmp=null,safe},cleanData:function(elems,acceptData){for(var elem,type,id,data,i=0,internalKey=jQuery.expando,cache=jQuery.cache,deleteExpando=support.deleteExpando,special=jQuery.event.special;null!=(elem=elems[i]);i++)if((acceptData||jQuery.acceptData(elem))&&(id=elem[internalKey],data=id&&cache[id])){if(data.events)for(type in data.events)special[type]?jQuery.event.remove(elem,type):jQuery.removeEvent(elem,type,data.handle);cache[id]&&(delete cache[id],deleteExpando?delete elem[internalKey]:typeof elem.removeAttribute!==strundefined?elem.removeAttribute(internalKey):elem[internalKey]=null,deletedIds.push(id))}}}),jQuery.fn.extend({text:function(value){return access(this,function(value){return void 0===value?jQuery.text(this):this.empty().append((this[0]&&this[0].ownerDocument||document).createTextNode(value))},null,value,arguments.length)},append:function(){return this.domManip(arguments,function(elem){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var target=manipulationTarget(this,elem);target.appendChild(elem)}})},prepend:function(){return this.domManip(arguments,function(elem){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var target=manipulationTarget(this,elem);target.insertBefore(elem,target.firstChild)}})},before:function(){return this.domManip(arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this)})},after:function(){return this.domManip(arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this.nextSibling)})},remove:function(selector,keepData){for(var elem,elems=selector?jQuery.filter(selector,this):this,i=0;null!=(elem=elems[i]);i++)keepData||1!==elem.nodeType||jQuery.cleanData(getAll(elem)),elem.parentNode&&(keepData&&jQuery.contains(elem.ownerDocument,elem)&&setGlobalEval(getAll(elem,"script")),elem.parentNode.removeChild(elem));return this},empty:function(){for(var elem,i=0;null!=(elem=this[i]);i++){for(1===elem.nodeType&&jQuery.cleanData(getAll(elem,!1));elem.firstChild;)elem.removeChild(elem.firstChild);elem.options&&jQuery.nodeName(elem,"select")&&(elem.options.length=0)}return this},clone:function(dataAndEvents,deepDataAndEvents){return dataAndEvents=null==dataAndEvents?!1:dataAndEvents,deepDataAndEvents=null==deepDataAndEvents?dataAndEvents:deepDataAndEvents,this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents)})},html:function(value){return access(this,function(value){var elem=this[0]||{},i=0,l=this.length;if(void 0===value)return 1===elem.nodeType?elem.innerHTML.replace(rinlinejQuery,""):void 0;if(!("string"!=typeof value||rnoInnerhtml.test(value)||!support.htmlSerialize&&rnoshimcache.test(value)||!support.leadingWhitespace&&rleadingWhitespace.test(value)||wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()])){value=value.replace(rxhtmlTag,"<$1></$2>");try{for(;l>i;i++)elem=this[i]||{},1===elem.nodeType&&(jQuery.cleanData(getAll(elem,!1)),elem.innerHTML=value);elem=0}catch(e){}}elem&&this.empty().append(value)},null,value,arguments.length)},replaceWith:function(){var arg=arguments[0];return this.domManip(arguments,function(elem){arg=this.parentNode,jQuery.cleanData(getAll(this)),arg&&arg.replaceChild(elem,this)}),arg&&(arg.length||arg.nodeType)?this:this.remove()},detach:function(selector){return this.remove(selector,!0)},domManip:function(args,callback){args=concat.apply([],args);var first,node,hasScripts,scripts,doc,fragment,i=0,l=this.length,set=this,iNoClone=l-1,value=args[0],isFunction=jQuery.isFunction(value);if(isFunction||l>1&&"string"==typeof value&&!support.checkClone&&rchecked.test(value))return this.each(function(index){var self=set.eq(index);isFunction&&(args[0]=value.call(this,index,self.html())),self.domManip(args,callback)});if(l&&(fragment=jQuery.buildFragment(args,this[0].ownerDocument,!1,this),first=fragment.firstChild,1===fragment.childNodes.length&&(fragment=first),first)){for(scripts=jQuery.map(getAll(fragment,"script"),disableScript),hasScripts=scripts.length;l>i;i++)node=fragment,i!==iNoClone&&(node=jQuery.clone(node,!0,!0),hasScripts&&jQuery.merge(scripts,getAll(node,"script"))),callback.call(this[i],node,i);if(hasScripts)for(doc=scripts[scripts.length-1].ownerDocument,jQuery.map(scripts,restoreScript),i=0;hasScripts>i;i++)node=scripts[i],rscriptType.test(node.type||"")&&!jQuery._data(node,"globalEval")&&jQuery.contains(doc,node)&&(node.src?jQuery._evalUrl&&jQuery._evalUrl(node.src):jQuery.globalEval((node.text||node.textContent||node.innerHTML||"").replace(rcleanScript,"")));fragment=first=null}return this}}),jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){for(var elems,i=0,ret=[],insert=jQuery(selector),last=insert.length-1;last>=i;i++)elems=i===last?this:this.clone(!0),jQuery(insert[i])[original](elems),push.apply(ret,elems.get());return this.pushStack(ret)}});var iframe,elemdisplay={};!function(){var a,shrinkWrapBlocksVal,div=document.createElement("div"),divReset="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0";div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",a=div.getElementsByTagName("a")[0],a.style.cssText="float:left;opacity:.5",support.opacity=/^0.5/.test(a.style.opacity),support.cssFloat=!!a.style.cssFloat,div.style.backgroundClip="content-box",div.cloneNode(!0).style.backgroundClip="",support.clearCloneStyle="content-box"===div.style.backgroundClip,a=div=null,support.shrinkWrapBlocks=function(){var body,container,div,containerStyles;if(null==shrinkWrapBlocksVal){if(body=document.getElementsByTagName("body")[0],!body)return;containerStyles="border:0;width:0;height:0;position:absolute;top:0;left:-9999px",container=document.createElement("div"),div=document.createElement("div"),body.appendChild(container).appendChild(div),shrinkWrapBlocksVal=!1,typeof div.style.zoom!==strundefined&&(div.style.cssText=divReset+";width:1px;padding:1px;zoom:1",div.innerHTML="<div></div>",div.firstChild.style.width="5px",shrinkWrapBlocksVal=3!==div.offsetWidth),body.removeChild(container),body=container=div=null}return shrinkWrapBlocksVal}}();var getStyles,curCSS,rmargin=/^margin/,rnumnonpx=new RegExp("^("+pnum+")(?!px)[a-z%]+$","i"),rposition=/^(top|right|bottom|left)$/;window.getComputedStyle?(getStyles=function(elem){return elem.ownerDocument.defaultView.getComputedStyle(elem,null)},curCSS=function(elem,name,computed){var width,minWidth,maxWidth,ret,style=elem.style;return computed=computed||getStyles(elem),ret=computed?computed.getPropertyValue(name)||computed[name]:void 0,computed&&(""!==ret||jQuery.contains(elem.ownerDocument,elem)||(ret=jQuery.style(elem,name)),rnumnonpx.test(ret)&&rmargin.test(name)&&(width=style.width,minWidth=style.minWidth,maxWidth=style.maxWidth,style.minWidth=style.maxWidth=style.width=ret,ret=computed.width,style.width=width,style.minWidth=minWidth,style.maxWidth=maxWidth)),void 0===ret?ret:ret+""}):document.documentElement.currentStyle&&(getStyles=function(elem){return elem.currentStyle},curCSS=function(elem,name,computed){var left,rs,rsLeft,ret,style=elem.style;return computed=computed||getStyles(elem),ret=computed?computed[name]:void 0,null==ret&&style&&style[name]&&(ret=style[name]),rnumnonpx.test(ret)&&!rposition.test(name)&&(left=style.left,rs=elem.runtimeStyle,rsLeft=rs&&rs.left,rsLeft&&(rs.left=elem.currentStyle.left),style.left="fontSize"===name?"1em":ret,ret=style.pixelLeft+"px",style.left=left,rsLeft&&(rs.left=rsLeft)),void 0===ret?ret:ret+""||"auto"}),function(){function computeStyleTests(){var container,div,body=document.getElementsByTagName("body")[0];body&&(container=document.createElement("div"),div=document.createElement("div"),container.style.cssText=containerStyles,body.appendChild(container).appendChild(div),div.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;display:block;padding:1px;border:1px;width:4px;margin-top:1%;top:1%",jQuery.swap(body,null!=body.style.zoom?{zoom:1}:{},function(){boxSizingVal=4===div.offsetWidth}),boxSizingReliableVal=!0,pixelPositionVal=!1,reliableMarginRightVal=!0,window.getComputedStyle&&(pixelPositionVal="1%"!==(window.getComputedStyle(div,null)||{}).top,boxSizingReliableVal="4px"===(window.getComputedStyle(div,null)||{width:"4px"}).width),body.removeChild(container),div=body=null)}var a,reliableHiddenOffsetsVal,boxSizingVal,boxSizingReliableVal,pixelPositionVal,reliableMarginRightVal,div=document.createElement("div"),containerStyles="border:0;width:0;height:0;position:absolute;top:0;left:-9999px",divReset="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0";div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",a=div.getElementsByTagName("a")[0],a.style.cssText="float:left;opacity:.5",support.opacity=/^0.5/.test(a.style.opacity),support.cssFloat=!!a.style.cssFloat,div.style.backgroundClip="content-box",div.cloneNode(!0).style.backgroundClip="",support.clearCloneStyle="content-box"===div.style.backgroundClip,a=div=null,jQuery.extend(support,{reliableHiddenOffsets:function(){if(null!=reliableHiddenOffsetsVal)return reliableHiddenOffsetsVal;
var container,tds,isSupported,div=document.createElement("div"),body=document.getElementsByTagName("body")[0];if(body)return div.setAttribute("className","t"),div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",container=document.createElement("div"),container.style.cssText=containerStyles,body.appendChild(container).appendChild(div),div.innerHTML="<table><tr><td></td><td>t</td></tr></table>",tds=div.getElementsByTagName("td"),tds[0].style.cssText="padding:0;margin:0;border:0;display:none",isSupported=0===tds[0].offsetHeight,tds[0].style.display="",tds[1].style.display="none",reliableHiddenOffsetsVal=isSupported&&0===tds[0].offsetHeight,body.removeChild(container),div=body=null,reliableHiddenOffsetsVal},boxSizing:function(){return null==boxSizingVal&&computeStyleTests(),boxSizingVal},boxSizingReliable:function(){return null==boxSizingReliableVal&&computeStyleTests(),boxSizingReliableVal},pixelPosition:function(){return null==pixelPositionVal&&computeStyleTests(),pixelPositionVal},reliableMarginRight:function(){var body,container,div,marginDiv;if(null==reliableMarginRightVal&&window.getComputedStyle){if(body=document.getElementsByTagName("body")[0],!body)return;container=document.createElement("div"),div=document.createElement("div"),container.style.cssText=containerStyles,body.appendChild(container).appendChild(div),marginDiv=div.appendChild(document.createElement("div")),marginDiv.style.cssText=div.style.cssText=divReset,marginDiv.style.marginRight=marginDiv.style.width="0",div.style.width="1px",reliableMarginRightVal=!parseFloat((window.getComputedStyle(marginDiv,null)||{}).marginRight),body.removeChild(container)}return reliableMarginRightVal}})}(),jQuery.swap=function(elem,options,callback,args){var ret,name,old={};for(name in options)old[name]=elem.style[name],elem.style[name]=options[name];ret=callback.apply(elem,args||[]);for(name in options)elem.style[name]=old[name];return ret};var ralpha=/alpha\([^)]*\)/i,ropacity=/opacity\s*=\s*([^)]*)/,rdisplayswap=/^(none|table(?!-c[ea]).+)/,rnumsplit=new RegExp("^("+pnum+")(.*)$","i"),rrelNum=new RegExp("^([+-])=("+pnum+")","i"),cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:0,fontWeight:400},cssPrefixes=["Webkit","O","Moz","ms"];jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity");return""===ret?"1":ret}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":support.cssFloat?"cssFloat":"styleFloat"},style:function(elem,name,value,extra){if(elem&&3!==elem.nodeType&&8!==elem.nodeType&&elem.style){var ret,type,hooks,origName=jQuery.camelCase(name),style=elem.style;if(name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(style,origName)),hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName],void 0===value)return hooks&&"get"in hooks&&void 0!==(ret=hooks.get(elem,!1,extra))?ret:style[name];if(type=typeof value,"string"===type&&(ret=rrelNum.exec(value))&&(value=(ret[1]+1)*ret[2]+parseFloat(jQuery.css(elem,name)),type="number"),null!=value&&value===value&&("number"!==type||jQuery.cssNumber[origName]||(value+="px"),support.clearCloneStyle||""!==value||0!==name.indexOf("background")||(style[name]="inherit"),!(hooks&&"set"in hooks&&void 0===(value=hooks.set(elem,value,extra)))))try{style[name]="",style[name]=value}catch(e){}}},css:function(elem,name,extra,styles){var num,val,hooks,origName=jQuery.camelCase(name);return name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(elem.style,origName)),hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName],hooks&&"get"in hooks&&(val=hooks.get(elem,!0,extra)),void 0===val&&(val=curCSS(elem,name,styles)),"normal"===val&&name in cssNormalTransform&&(val=cssNormalTransform[name]),""===extra||extra?(num=parseFloat(val),extra===!0||jQuery.isNumeric(num)?num||0:val):val}}),jQuery.each(["height","width"],function(i,name){jQuery.cssHooks[name]={get:function(elem,computed,extra){return computed?0===elem.offsetWidth&&rdisplayswap.test(jQuery.css(elem,"display"))?jQuery.swap(elem,cssShow,function(){return getWidthOrHeight(elem,name,extra)}):getWidthOrHeight(elem,name,extra):void 0},set:function(elem,value,extra){var styles=extra&&getStyles(elem);return setPositiveNumber(elem,value,extra?augmentWidthOrHeight(elem,name,extra,support.boxSizing()&&"border-box"===jQuery.css(elem,"boxSizing",!1,styles),styles):0)}}}),support.opacity||(jQuery.cssHooks.opacity={get:function(elem,computed){return ropacity.test((computed&&elem.currentStyle?elem.currentStyle.filter:elem.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":computed?"1":""},set:function(elem,value){var style=elem.style,currentStyle=elem.currentStyle,opacity=jQuery.isNumeric(value)?"alpha(opacity="+100*value+")":"",filter=currentStyle&&currentStyle.filter||style.filter||"";style.zoom=1,(value>=1||""===value)&&""===jQuery.trim(filter.replace(ralpha,""))&&style.removeAttribute&&(style.removeAttribute("filter"),""===value||currentStyle&&!currentStyle.filter)||(style.filter=ralpha.test(filter)?filter.replace(ralpha,opacity):filter+" "+opacity)}}),jQuery.cssHooks.marginRight=addGetHookIf(support.reliableMarginRight,function(elem,computed){return computed?jQuery.swap(elem,{display:"inline-block"},curCSS,[elem,"marginRight"]):void 0}),jQuery.each({margin:"",padding:"",border:"Width"},function(prefix,suffix){jQuery.cssHooks[prefix+suffix]={expand:function(value){for(var i=0,expanded={},parts="string"==typeof value?value.split(" "):[value];4>i;i++)expanded[prefix+cssExpand[i]+suffix]=parts[i]||parts[i-2]||parts[0];return expanded}},rmargin.test(prefix)||(jQuery.cssHooks[prefix+suffix].set=setPositiveNumber)}),jQuery.fn.extend({css:function(name,value){return access(this,function(elem,name,value){var styles,len,map={},i=0;if(jQuery.isArray(name)){for(styles=getStyles(elem),len=name.length;len>i;i++)map[name[i]]=jQuery.css(elem,name[i],!1,styles);return map}return void 0!==value?jQuery.style(elem,name,value):jQuery.css(elem,name)},name,value,arguments.length>1)},show:function(){return showHide(this,!0)},hide:function(){return showHide(this)},toggle:function(state){return"boolean"==typeof state?state?this.show():this.hide():this.each(function(){isHidden(this)?jQuery(this).show():jQuery(this).hide()})}}),jQuery.Tween=Tween,Tween.prototype={constructor:Tween,init:function(elem,options,prop,end,easing,unit){this.elem=elem,this.prop=prop,this.easing=easing||"swing",this.options=options,this.start=this.now=this.cur(),this.end=end,this.unit=unit||(jQuery.cssNumber[prop]?"":"px")},cur:function(){var hooks=Tween.propHooks[this.prop];return hooks&&hooks.get?hooks.get(this):Tween.propHooks._default.get(this)},run:function(percent){var eased,hooks=Tween.propHooks[this.prop];return this.pos=eased=this.options.duration?jQuery.easing[this.easing](percent,this.options.duration*percent,0,1,this.options.duration):percent,this.now=(this.end-this.start)*eased+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),hooks&&hooks.set?hooks.set(this):Tween.propHooks._default.set(this),this}},Tween.prototype.init.prototype=Tween.prototype,Tween.propHooks={_default:{get:function(tween){var result;return null==tween.elem[tween.prop]||tween.elem.style&&null!=tween.elem.style[tween.prop]?(result=jQuery.css(tween.elem,tween.prop,""),result&&"auto"!==result?result:0):tween.elem[tween.prop]},set:function(tween){jQuery.fx.step[tween.prop]?jQuery.fx.step[tween.prop](tween):tween.elem.style&&(null!=tween.elem.style[jQuery.cssProps[tween.prop]]||jQuery.cssHooks[tween.prop])?jQuery.style(tween.elem,tween.prop,tween.now+tween.unit):tween.elem[tween.prop]=tween.now}}},Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(tween){tween.elem.nodeType&&tween.elem.parentNode&&(tween.elem[tween.prop]=tween.now)}},jQuery.easing={linear:function(p){return p},swing:function(p){return.5-Math.cos(p*Math.PI)/2}},jQuery.fx=Tween.prototype.init,jQuery.fx.step={};var fxNow,timerId,rfxtypes=/^(?:toggle|show|hide)$/,rfxnum=new RegExp("^(?:([+-])=|)("+pnum+")([a-z%]*)$","i"),rrun=/queueHooks$/,animationPrefilters=[defaultPrefilter],tweeners={"*":[function(prop,value){var tween=this.createTween(prop,value),target=tween.cur(),parts=rfxnum.exec(value),unit=parts&&parts[3]||(jQuery.cssNumber[prop]?"":"px"),start=(jQuery.cssNumber[prop]||"px"!==unit&&+target)&&rfxnum.exec(jQuery.css(tween.elem,prop)),scale=1,maxIterations=20;if(start&&start[3]!==unit){unit=unit||start[3],parts=parts||[],start=+target||1;do scale=scale||".5",start/=scale,jQuery.style(tween.elem,prop,start+unit);while(scale!==(scale=tween.cur()/target)&&1!==scale&&--maxIterations)}return parts&&(start=tween.start=+start||+target||0,tween.unit=unit,tween.end=parts[1]?start+(parts[1]+1)*parts[2]:+parts[2]),tween}]};jQuery.Animation=jQuery.extend(Animation,{tweener:function(props,callback){jQuery.isFunction(props)?(callback=props,props=["*"]):props=props.split(" ");for(var prop,index=0,length=props.length;length>index;index++)prop=props[index],tweeners[prop]=tweeners[prop]||[],tweeners[prop].unshift(callback)},prefilter:function(callback,prepend){prepend?animationPrefilters.unshift(callback):animationPrefilters.push(callback)}}),jQuery.speed=function(speed,easing,fn){var opt=speed&&"object"==typeof speed?jQuery.extend({},speed):{complete:fn||!fn&&easing||jQuery.isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!jQuery.isFunction(easing)&&easing};return opt.duration=jQuery.fx.off?0:"number"==typeof opt.duration?opt.duration:opt.duration in jQuery.fx.speeds?jQuery.fx.speeds[opt.duration]:jQuery.fx.speeds._default,(null==opt.queue||opt.queue===!0)&&(opt.queue="fx"),opt.old=opt.complete,opt.complete=function(){jQuery.isFunction(opt.old)&&opt.old.call(this),opt.queue&&jQuery.dequeue(this,opt.queue)},opt},jQuery.fn.extend({fadeTo:function(speed,to,easing,callback){return this.filter(isHidden).css("opacity",0).show().end().animate({opacity:to},speed,easing,callback)},animate:function(prop,speed,easing,callback){var empty=jQuery.isEmptyObject(prop),optall=jQuery.speed(speed,easing,callback),doAnimation=function(){var anim=Animation(this,jQuery.extend({},prop),optall);(empty||jQuery._data(this,"finish"))&&anim.stop(!0)};return doAnimation.finish=doAnimation,empty||optall.queue===!1?this.each(doAnimation):this.queue(optall.queue,doAnimation)},stop:function(type,clearQueue,gotoEnd){var stopQueue=function(hooks){var stop=hooks.stop;delete hooks.stop,stop(gotoEnd)};return"string"!=typeof type&&(gotoEnd=clearQueue,clearQueue=type,type=void 0),clearQueue&&type!==!1&&this.queue(type||"fx",[]),this.each(function(){var dequeue=!0,index=null!=type&&type+"queueHooks",timers=jQuery.timers,data=jQuery._data(this);if(index)data[index]&&data[index].stop&&stopQueue(data[index]);else for(index in data)data[index]&&data[index].stop&&rrun.test(index)&&stopQueue(data[index]);for(index=timers.length;index--;)timers[index].elem!==this||null!=type&&timers[index].queue!==type||(timers[index].anim.stop(gotoEnd),dequeue=!1,timers.splice(index,1));(dequeue||!gotoEnd)&&jQuery.dequeue(this,type)})},finish:function(type){return type!==!1&&(type=type||"fx"),this.each(function(){var index,data=jQuery._data(this),queue=data[type+"queue"],hooks=data[type+"queueHooks"],timers=jQuery.timers,length=queue?queue.length:0;for(data.finish=!0,jQuery.queue(this,type,[]),hooks&&hooks.stop&&hooks.stop.call(this,!0),index=timers.length;index--;)timers[index].elem===this&&timers[index].queue===type&&(timers[index].anim.stop(!0),timers.splice(index,1));for(index=0;length>index;index++)queue[index]&&queue[index].finish&&queue[index].finish.call(this);delete data.finish})}}),jQuery.each(["toggle","show","hide"],function(i,name){var cssFn=jQuery.fn[name];jQuery.fn[name]=function(speed,easing,callback){return null==speed||"boolean"==typeof speed?cssFn.apply(this,arguments):this.animate(genFx(name,!0),speed,easing,callback)}}),jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback)}}),jQuery.timers=[],jQuery.fx.tick=function(){var timer,timers=jQuery.timers,i=0;for(fxNow=jQuery.now();i<timers.length;i++)timer=timers[i],timer()||timers[i]!==timer||timers.splice(i--,1);timers.length||jQuery.fx.stop(),fxNow=void 0},jQuery.fx.timer=function(timer){jQuery.timers.push(timer),timer()?jQuery.fx.start():jQuery.timers.pop()},jQuery.fx.interval=13,jQuery.fx.start=function(){timerId||(timerId=setInterval(jQuery.fx.tick,jQuery.fx.interval))},jQuery.fx.stop=function(){clearInterval(timerId),timerId=null},jQuery.fx.speeds={slow:600,fast:200,_default:400},jQuery.fn.delay=function(time,type){return time=jQuery.fx?jQuery.fx.speeds[time]||time:time,type=type||"fx",this.queue(type,function(next,hooks){var timeout=setTimeout(next,time);hooks.stop=function(){clearTimeout(timeout)}})},function(){var a,input,select,opt,div=document.createElement("div");div.setAttribute("className","t"),div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",a=div.getElementsByTagName("a")[0],select=document.createElement("select"),opt=select.appendChild(document.createElement("option")),input=div.getElementsByTagName("input")[0],a.style.cssText="top:1px",support.getSetAttribute="t"!==div.className,support.style=/top/.test(a.getAttribute("style")),support.hrefNormalized="/a"===a.getAttribute("href"),support.checkOn=!!input.value,support.optSelected=opt.selected,support.enctype=!!document.createElement("form").enctype,select.disabled=!0,support.optDisabled=!opt.disabled,input=document.createElement("input"),input.setAttribute("value",""),support.input=""===input.getAttribute("value"),input.value="t",input.setAttribute("type","radio"),support.radioValue="t"===input.value,a=input=select=opt=div=null}();var rreturn=/\r/g;jQuery.fn.extend({val:function(value){var hooks,ret,isFunction,elem=this[0];{if(arguments.length)return isFunction=jQuery.isFunction(value),this.each(function(i){var val;1===this.nodeType&&(val=isFunction?value.call(this,i,jQuery(this).val()):value,null==val?val="":"number"==typeof val?val+="":jQuery.isArray(val)&&(val=jQuery.map(val,function(value){return null==value?"":value+""})),hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()],hooks&&"set"in hooks&&void 0!==hooks.set(this,val,"value")||(this.value=val))});if(elem)return hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()],hooks&&"get"in hooks&&void 0!==(ret=hooks.get(elem,"value"))?ret:(ret=elem.value,"string"==typeof ret?ret.replace(rreturn,""):null==ret?"":ret)}}}),jQuery.extend({valHooks:{option:{get:function(elem){var val=jQuery.find.attr(elem,"value");return null!=val?val:jQuery.text(elem)}},select:{get:function(elem){for(var value,option,options=elem.options,index=elem.selectedIndex,one="select-one"===elem.type||0>index,values=one?null:[],max=one?index+1:options.length,i=0>index?max:one?index:0;max>i;i++)if(option=options[i],!(!option.selected&&i!==index||(support.optDisabled?option.disabled:null!==option.getAttribute("disabled"))||option.parentNode.disabled&&jQuery.nodeName(option.parentNode,"optgroup"))){if(value=jQuery(option).val(),one)return value;values.push(value)}return values},set:function(elem,value){for(var optionSet,option,options=elem.options,values=jQuery.makeArray(value),i=options.length;i--;)if(option=options[i],jQuery.inArray(jQuery.valHooks.option.get(option),values)>=0)try{option.selected=optionSet=!0}catch(_){option.scrollHeight}else option.selected=!1;return optionSet||(elem.selectedIndex=-1),options}}}}),jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function(elem,value){return jQuery.isArray(value)?elem.checked=jQuery.inArray(jQuery(elem).val(),value)>=0:void 0}},support.checkOn||(jQuery.valHooks[this].get=function(elem){return null===elem.getAttribute("value")?"on":elem.value})});var nodeHook,boolHook,attrHandle=jQuery.expr.attrHandle,ruseDefault=/^(?:checked|selected)$/i,getSetAttribute=support.getSetAttribute,getSetInput=support.input;jQuery.fn.extend({attr:function(name,value){return access(this,jQuery.attr,name,value,arguments.length>1)},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name)})}}),jQuery.extend({attr:function(elem,name,value){var hooks,ret,nType=elem.nodeType;if(elem&&3!==nType&&8!==nType&&2!==nType)return typeof elem.getAttribute===strundefined?jQuery.prop(elem,name,value):(1===nType&&jQuery.isXMLDoc(elem)||(name=name.toLowerCase(),hooks=jQuery.attrHooks[name]||(jQuery.expr.match.bool.test(name)?boolHook:nodeHook)),void 0===value?hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:(ret=jQuery.find.attr(elem,name),null==ret?void 0:ret):null!==value?hooks&&"set"in hooks&&void 0!==(ret=hooks.set(elem,value,name))?ret:(elem.setAttribute(name,value+""),value):(jQuery.removeAttr(elem,name),void 0))},removeAttr:function(elem,value){var name,propName,i=0,attrNames=value&&value.match(rnotwhite);if(attrNames&&1===elem.nodeType)for(;name=attrNames[i++];)propName=jQuery.propFix[name]||name,jQuery.expr.match.bool.test(name)?getSetInput&&getSetAttribute||!ruseDefault.test(name)?elem[propName]=!1:elem[jQuery.camelCase("default-"+name)]=elem[propName]=!1:jQuery.attr(elem,name,""),elem.removeAttribute(getSetAttribute?name:propName)},attrHooks:{type:{set:function(elem,value){if(!support.radioValue&&"radio"===value&&jQuery.nodeName(elem,"input")){var val=elem.value;return elem.setAttribute("type",value),val&&(elem.value=val),value}}}}}),boolHook={set:function(elem,value,name){return value===!1?jQuery.removeAttr(elem,name):getSetInput&&getSetAttribute||!ruseDefault.test(name)?elem.setAttribute(!getSetAttribute&&jQuery.propFix[name]||name,name):elem[jQuery.camelCase("default-"+name)]=elem[name]=!0,name}},jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(i,name){var getter=attrHandle[name]||jQuery.find.attr;attrHandle[name]=getSetInput&&getSetAttribute||!ruseDefault.test(name)?function(elem,name,isXML){var ret,handle;return isXML||(handle=attrHandle[name],attrHandle[name]=ret,ret=null!=getter(elem,name,isXML)?name.toLowerCase():null,attrHandle[name]=handle),ret}:function(elem,name,isXML){return isXML?void 0:elem[jQuery.camelCase("default-"+name)]?name.toLowerCase():null}}),getSetInput&&getSetAttribute||(jQuery.attrHooks.value={set:function(elem,value,name){return jQuery.nodeName(elem,"input")?(elem.defaultValue=value,void 0):nodeHook&&nodeHook.set(elem,value,name)}}),getSetAttribute||(nodeHook={set:function(elem,value,name){var ret=elem.getAttributeNode(name);return ret||elem.setAttributeNode(ret=elem.ownerDocument.createAttribute(name)),ret.value=value+="","value"===name||value===elem.getAttribute(name)?value:void 0}},attrHandle.id=attrHandle.name=attrHandle.coords=function(elem,name,isXML){var ret;return isXML?void 0:(ret=elem.getAttributeNode(name))&&""!==ret.value?ret.value:null},jQuery.valHooks.button={get:function(elem,name){var ret=elem.getAttributeNode(name);return ret&&ret.specified?ret.value:void 0},set:nodeHook.set},jQuery.attrHooks.contenteditable={set:function(elem,value,name){nodeHook.set(elem,""===value?!1:value,name)}},jQuery.each(["width","height"],function(i,name){jQuery.attrHooks[name]={set:function(elem,value){return""===value?(elem.setAttribute(name,"auto"),value):void 0}}})),support.style||(jQuery.attrHooks.style={get:function(elem){return elem.style.cssText||void 0},set:function(elem,value){return elem.style.cssText=value+""}});var rfocusable=/^(?:input|select|textarea|button|object)$/i,rclickable=/^(?:a|area)$/i;jQuery.fn.extend({prop:function(name,value){return access(this,jQuery.prop,name,value,arguments.length>1)},removeProp:function(name){return name=jQuery.propFix[name]||name,this.each(function(){try{this[name]=void 0,delete this[name]}catch(e){}})}}),jQuery.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(elem,name,value){var ret,hooks,notxml,nType=elem.nodeType;if(elem&&3!==nType&&8!==nType&&2!==nType)return notxml=1!==nType||!jQuery.isXMLDoc(elem),notxml&&(name=jQuery.propFix[name]||name,hooks=jQuery.propHooks[name]),void 0!==value?hooks&&"set"in hooks&&void 0!==(ret=hooks.set(elem,value,name))?ret:elem[name]=value:hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:elem[name]},propHooks:{tabIndex:{get:function(elem){var tabindex=jQuery.find.attr(elem,"tabindex");return tabindex?parseInt(tabindex,10):rfocusable.test(elem.nodeName)||rclickable.test(elem.nodeName)&&elem.href?0:-1}}}}),support.hrefNormalized||jQuery.each(["href","src"],function(i,name){jQuery.propHooks[name]={get:function(elem){return elem.getAttribute(name,4)}}}),support.optSelected||(jQuery.propHooks.selected={get:function(elem){var parent=elem.parentNode;return parent&&(parent.selectedIndex,parent.parentNode&&parent.parentNode.selectedIndex),null}}),jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this}),support.enctype||(jQuery.propFix.enctype="encoding");var rclass=/[\t\r\n\f]/g;jQuery.fn.extend({addClass:function(value){var classes,elem,cur,clazz,j,finalValue,i=0,len=this.length,proceed="string"==typeof value&&value;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).addClass(value.call(this,j,this.className))});if(proceed)for(classes=(value||"").match(rnotwhite)||[];len>i;i++)if(elem=this[i],cur=1===elem.nodeType&&(elem.className?(" "+elem.className+" ").replace(rclass," "):" ")){for(j=0;clazz=classes[j++];)cur.indexOf(" "+clazz+" ")<0&&(cur+=clazz+" ");finalValue=jQuery.trim(cur),elem.className!==finalValue&&(elem.className=finalValue)}return this},removeClass:function(value){var classes,elem,cur,clazz,j,finalValue,i=0,len=this.length,proceed=0===arguments.length||"string"==typeof value&&value;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).removeClass(value.call(this,j,this.className))});if(proceed)for(classes=(value||"").match(rnotwhite)||[];len>i;i++)if(elem=this[i],cur=1===elem.nodeType&&(elem.className?(" "+elem.className+" ").replace(rclass," "):"")){for(j=0;clazz=classes[j++];)for(;cur.indexOf(" "+clazz+" ")>=0;)cur=cur.replace(" "+clazz+" "," ");finalValue=value?jQuery.trim(cur):"",elem.className!==finalValue&&(elem.className=finalValue)}return this},toggleClass:function(value,stateVal){var type=typeof value;return"boolean"==typeof stateVal&&"string"===type?stateVal?this.addClass(value):this.removeClass(value):jQuery.isFunction(value)?this.each(function(i){jQuery(this).toggleClass(value.call(this,i,this.className,stateVal),stateVal)}):this.each(function(){if("string"===type)for(var className,i=0,self=jQuery(this),classNames=value.match(rnotwhite)||[];className=classNames[i++];)self.hasClass(className)?self.removeClass(className):self.addClass(className);else(type===strundefined||"boolean"===type)&&(this.className&&jQuery._data(this,"__className__",this.className),this.className=this.className||value===!1?"":jQuery._data(this,"__className__")||"")})},hasClass:function(selector){for(var className=" "+selector+" ",i=0,l=this.length;l>i;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(rclass," ").indexOf(className)>=0)return!0;return!1}}),jQuery.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(i,name){jQuery.fn[name]=function(data,fn){return arguments.length>0?this.on(name,null,data,fn):this.trigger(name)}}),jQuery.fn.extend({hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver)},bind:function(types,data,fn){return this.on(types,null,data,fn)},unbind:function(types,fn){return this.off(types,null,fn)},delegate:function(selector,types,data,fn){return this.on(types,selector,data,fn)},undelegate:function(selector,types,fn){return 1===arguments.length?this.off(selector,"**"):this.off(types,selector||"**",fn)}});var nonce=jQuery.now(),rquery=/\?/,rvalidtokens=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;jQuery.parseJSON=function(data){if(window.JSON&&window.JSON.parse)return window.JSON.parse(data+"");var requireNonComma,depth=null,str=jQuery.trim(data+"");return str&&!jQuery.trim(str.replace(rvalidtokens,function(token,comma,open,close){return requireNonComma&&comma&&(depth=0),0===depth?token:(requireNonComma=open||comma,depth+=!close-!open,"")}))?Function("return "+str)():jQuery.error("Invalid JSON: "+data)},jQuery.parseXML=function(data){var xml,tmp;if(!data||"string"!=typeof data)return null;try{window.DOMParser?(tmp=new DOMParser,xml=tmp.parseFromString(data,"text/xml")):(xml=new ActiveXObject("Microsoft.XMLDOM"),xml.async="false",xml.loadXML(data))}catch(e){xml=void 0}return xml&&xml.documentElement&&!xml.getElementsByTagName("parsererror").length||jQuery.error("Invalid XML: "+data),xml};var ajaxLocParts,ajaxLocation,rhash=/#.*$/,rts=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,rurl=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,prefilters={},transports={},allTypes="*/".concat("*");try{ajaxLocation=location.href}catch(e){ajaxLocation=document.createElement("a"),ajaxLocation.href="",ajaxLocation=ajaxLocation.href}ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[],jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ajaxLocation,type:"GET",isLocal:rlocalProtocol.test(ajaxLocParts[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":jQuery.parseJSON,"text xml":jQuery.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(target,settings){return settings?ajaxExtend(ajaxExtend(target,jQuery.ajaxSettings),settings):ajaxExtend(jQuery.ajaxSettings,target)},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){function done(status,nativeStatusText,responses,headers){var isSuccess,success,error,response,modified,statusText=nativeStatusText;2!==state&&(state=2,timeoutTimer&&clearTimeout(timeoutTimer),transport=void 0,responseHeadersString=headers||"",jqXHR.readyState=status>0?4:0,isSuccess=status>=200&&300>status||304===status,responses&&(response=ajaxHandleResponses(s,jqXHR,responses)),response=ajaxConvert(s,response,jqXHR,isSuccess),isSuccess?(s.ifModified&&(modified=jqXHR.getResponseHeader("Last-Modified"),modified&&(jQuery.lastModified[cacheURL]=modified),modified=jqXHR.getResponseHeader("etag"),modified&&(jQuery.etag[cacheURL]=modified)),204===status||"HEAD"===s.type?statusText="nocontent":304===status?statusText="notmodified":(statusText=response.state,success=response.data,error=response.error,isSuccess=!error)):(error=statusText,(status||!statusText)&&(statusText="error",0>status&&(status=0))),jqXHR.status=status,jqXHR.statusText=(nativeStatusText||statusText)+"",isSuccess?deferred.resolveWith(callbackContext,[success,statusText,jqXHR]):deferred.rejectWith(callbackContext,[jqXHR,statusText,error]),jqXHR.statusCode(statusCode),statusCode=void 0,fireGlobals&&globalEventContext.trigger(isSuccess?"ajaxSuccess":"ajaxError",[jqXHR,s,isSuccess?success:error]),completeDeferred.fireWith(callbackContext,[jqXHR,statusText]),fireGlobals&&(globalEventContext.trigger("ajaxComplete",[jqXHR,s]),--jQuery.active||jQuery.event.trigger("ajaxStop")))}"object"==typeof url&&(options=url,url=void 0),options=options||{};var parts,i,cacheURL,responseHeadersString,timeoutTimer,fireGlobals,transport,responseHeaders,s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=s.context&&(callbackContext.nodeType||callbackContext.jquery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks("once memory"),statusCode=s.statusCode||{},requestHeaders={},requestHeadersNames={},state=0,strAbort="canceled",jqXHR={readyState:0,getResponseHeader:function(key){var match;if(2===state){if(!responseHeaders)for(responseHeaders={};match=rheaders.exec(responseHeadersString);)responseHeaders[match[1].toLowerCase()]=match[2];match=responseHeaders[key.toLowerCase()]}return null==match?null:match},getAllResponseHeaders:function(){return 2===state?responseHeadersString:null},setRequestHeader:function(name,value){var lname=name.toLowerCase();return state||(name=requestHeadersNames[lname]=requestHeadersNames[lname]||name,requestHeaders[name]=value),this},overrideMimeType:function(type){return state||(s.mimeType=type),this},statusCode:function(map){var code;if(map)if(2>state)for(code in map)statusCode[code]=[statusCode[code],map[code]];else jqXHR.always(map[jqXHR.status]);return this},abort:function(statusText){var finalText=statusText||strAbort;return transport&&transport.abort(finalText),done(0,finalText),this}};if(deferred.promise(jqXHR).complete=completeDeferred.add,jqXHR.success=jqXHR.done,jqXHR.error=jqXHR.fail,s.url=((url||s.url||ajaxLocation)+"").replace(rhash,"").replace(rprotocol,ajaxLocParts[1]+"//"),s.type=options.method||options.type||s.method||s.type,s.dataTypes=jQuery.trim(s.dataType||"*").toLowerCase().match(rnotwhite)||[""],null==s.crossDomain&&(parts=rurl.exec(s.url.toLowerCase()),s.crossDomain=!(!parts||parts[1]===ajaxLocParts[1]&&parts[2]===ajaxLocParts[2]&&(parts[3]||("http:"===parts[1]?"80":"443"))===(ajaxLocParts[3]||("http:"===ajaxLocParts[1]?"80":"443")))),s.data&&s.processData&&"string"!=typeof s.data&&(s.data=jQuery.param(s.data,s.traditional)),inspectPrefiltersOrTransports(prefilters,s,options,jqXHR),2===state)return jqXHR;fireGlobals=s.global,fireGlobals&&0===jQuery.active++&&jQuery.event.trigger("ajaxStart"),s.type=s.type.toUpperCase(),s.hasContent=!rnoContent.test(s.type),cacheURL=s.url,s.hasContent||(s.data&&(cacheURL=s.url+=(rquery.test(cacheURL)?"&":"?")+s.data,delete s.data),s.cache===!1&&(s.url=rts.test(cacheURL)?cacheURL.replace(rts,"$1_="+nonce++):cacheURL+(rquery.test(cacheURL)?"&":"?")+"_="+nonce++)),s.ifModified&&(jQuery.lastModified[cacheURL]&&jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[cacheURL]),jQuery.etag[cacheURL]&&jqXHR.setRequestHeader("If-None-Match",jQuery.etag[cacheURL])),(s.data&&s.hasContent&&s.contentType!==!1||options.contentType)&&jqXHR.setRequestHeader("Content-Type",s.contentType),jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+("*"!==s.dataTypes[0]?", "+allTypes+"; q=0.01":""):s.accepts["*"]);for(i in s.headers)jqXHR.setRequestHeader(i,s.headers[i]);if(s.beforeSend&&(s.beforeSend.call(callbackContext,jqXHR,s)===!1||2===state))return jqXHR.abort();strAbort="abort";for(i in{success:1,error:1,complete:1})jqXHR[i](s[i]);if(transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR)){jqXHR.readyState=1,fireGlobals&&globalEventContext.trigger("ajaxSend",[jqXHR,s]),s.async&&s.timeout>0&&(timeoutTimer=setTimeout(function(){jqXHR.abort("timeout")},s.timeout));try{state=1,transport.send(requestHeaders,done)}catch(e){if(!(2>state))throw e;done(-1,e)}}else done(-1,"No Transport");return jqXHR},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json")},getScript:function(url,callback){return jQuery.get(url,void 0,callback,"script")}}),jQuery.each(["get","post"],function(i,method){jQuery[method]=function(url,data,callback,type){return jQuery.isFunction(data)&&(type=type||callback,callback=data,data=void 0),jQuery.ajax({url:url,type:method,dataType:type,data:data,success:callback})}}),jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(i,type){jQuery.fn[type]=function(fn){return this.on(type,fn)}}),jQuery._evalUrl=function(url){return jQuery.ajax({url:url,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},jQuery.fn.extend({wrapAll:function(html){if(jQuery.isFunction(html))return this.each(function(i){jQuery(this).wrapAll(html.call(this,i))});if(this[0]){var wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&wrap.insertBefore(this[0]),wrap.map(function(){for(var elem=this;elem.firstChild&&1===elem.firstChild.nodeType;)elem=elem.firstChild;
return elem}).append(this)}return this},wrapInner:function(html){return jQuery.isFunction(html)?this.each(function(i){jQuery(this).wrapInner(html.call(this,i))}):this.each(function(){var self=jQuery(this),contents=self.contents();contents.length?contents.wrapAll(html):self.append(html)})},wrap:function(html){var isFunction=jQuery.isFunction(html);return this.each(function(i){jQuery(this).wrapAll(isFunction?html.call(this,i):html)})},unwrap:function(){return this.parent().each(function(){jQuery.nodeName(this,"body")||jQuery(this).replaceWith(this.childNodes)}).end()}}),jQuery.expr.filters.hidden=function(elem){return elem.offsetWidth<=0&&elem.offsetHeight<=0||!support.reliableHiddenOffsets()&&"none"===(elem.style&&elem.style.display||jQuery.css(elem,"display"))},jQuery.expr.filters.visible=function(elem){return!jQuery.expr.filters.hidden(elem)};var r20=/%20/g,rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;jQuery.param=function(a,traditional){var prefix,s=[],add=function(key,value){value=jQuery.isFunction(value)?value():null==value?"":value,s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(value)};if(void 0===traditional&&(traditional=jQuery.ajaxSettings&&jQuery.ajaxSettings.traditional),jQuery.isArray(a)||a.jquery&&!jQuery.isPlainObject(a))jQuery.each(a,function(){add(this.name,this.value)});else for(prefix in a)buildParams(prefix,a[prefix],traditional,add);return s.join("&").replace(r20,"+")},jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var elements=jQuery.prop(this,"elements");return elements?jQuery.makeArray(elements):this}).filter(function(){var type=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(type)&&(this.checked||!rcheckableType.test(type))}).map(function(i,elem){var val=jQuery(this).val();return null==val?null:jQuery.isArray(val)?jQuery.map(val,function(val){return{name:elem.name,value:val.replace(rCRLF,"\r\n")}}):{name:elem.name,value:val.replace(rCRLF,"\r\n")}}).get()}}),jQuery.ajaxSettings.xhr=void 0!==window.ActiveXObject?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&createStandardXHR()||createActiveXHR()}:createStandardXHR;var xhrId=0,xhrCallbacks={},xhrSupported=jQuery.ajaxSettings.xhr();window.ActiveXObject&&jQuery(window).on("unload",function(){for(var key in xhrCallbacks)xhrCallbacks[key](void 0,!0)}),support.cors=!!xhrSupported&&"withCredentials"in xhrSupported,xhrSupported=support.ajax=!!xhrSupported,xhrSupported&&jQuery.ajaxTransport(function(options){if(!options.crossDomain||support.cors){var callback;return{send:function(headers,complete){var i,xhr=options.xhr(),id=++xhrId;if(xhr.open(options.type,options.url,options.async,options.username,options.password),options.xhrFields)for(i in options.xhrFields)xhr[i]=options.xhrFields[i];options.mimeType&&xhr.overrideMimeType&&xhr.overrideMimeType(options.mimeType),options.crossDomain||headers["X-Requested-With"]||(headers["X-Requested-With"]="XMLHttpRequest");for(i in headers)void 0!==headers[i]&&xhr.setRequestHeader(i,headers[i]+"");xhr.send(options.hasContent&&options.data||null),callback=function(_,isAbort){var status,statusText,responses;if(callback&&(isAbort||4===xhr.readyState))if(delete xhrCallbacks[id],callback=void 0,xhr.onreadystatechange=jQuery.noop,isAbort)4!==xhr.readyState&&xhr.abort();else{responses={},status=xhr.status,"string"==typeof xhr.responseText&&(responses.text=xhr.responseText);try{statusText=xhr.statusText}catch(e){statusText=""}status||!options.isLocal||options.crossDomain?1223===status&&(status=204):status=responses.text?200:404}responses&&complete(status,statusText,responses,xhr.getAllResponseHeaders())},options.async?4===xhr.readyState?setTimeout(callback):xhr.onreadystatechange=xhrCallbacks[id]=callback:callback()},abort:function(){callback&&callback(void 0,!0)}}}}),jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(text){return jQuery.globalEval(text),text}}}),jQuery.ajaxPrefilter("script",function(s){void 0===s.cache&&(s.cache=!1),s.crossDomain&&(s.type="GET",s.global=!1)}),jQuery.ajaxTransport("script",function(s){if(s.crossDomain){var script,head=document.head||jQuery("head")[0]||document.documentElement;return{send:function(_,callback){script=document.createElement("script"),script.async=!0,s.scriptCharset&&(script.charset=s.scriptCharset),script.src=s.url,script.onload=script.onreadystatechange=function(_,isAbort){(isAbort||!script.readyState||/loaded|complete/.test(script.readyState))&&(script.onload=script.onreadystatechange=null,script.parentNode&&script.parentNode.removeChild(script),script=null,isAbort||callback(200,"success"))},head.insertBefore(script,head.firstChild)},abort:function(){script&&script.onload(void 0,!0)}}}});var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var callback=oldCallbacks.pop()||jQuery.expando+"_"+nonce++;return this[callback]=!0,callback}}),jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var callbackName,overwritten,responseContainer,jsonProp=s.jsonp!==!1&&(rjsonp.test(s.url)?"url":"string"==typeof s.data&&!(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(s.data)&&"data");return jsonProp||"jsonp"===s.dataTypes[0]?(callbackName=s.jsonpCallback=jQuery.isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback,jsonProp?s[jsonProp]=s[jsonProp].replace(rjsonp,"$1"+callbackName):s.jsonp!==!1&&(s.url+=(rquery.test(s.url)?"&":"?")+s.jsonp+"="+callbackName),s.converters["script json"]=function(){return responseContainer||jQuery.error(callbackName+" was not called"),responseContainer[0]},s.dataTypes[0]="json",overwritten=window[callbackName],window[callbackName]=function(){responseContainer=arguments},jqXHR.always(function(){window[callbackName]=overwritten,s[callbackName]&&(s.jsonpCallback=originalSettings.jsonpCallback,oldCallbacks.push(callbackName)),responseContainer&&jQuery.isFunction(overwritten)&&overwritten(responseContainer[0]),responseContainer=overwritten=void 0}),"script"):void 0}),jQuery.parseHTML=function(data,context,keepScripts){if(!data||"string"!=typeof data)return null;"boolean"==typeof context&&(keepScripts=context,context=!1),context=context||document;var parsed=rsingleTag.exec(data),scripts=!keepScripts&&[];return parsed?[context.createElement(parsed[1])]:(parsed=jQuery.buildFragment([data],context,scripts),scripts&&scripts.length&&jQuery(scripts).remove(),jQuery.merge([],parsed.childNodes))};var _load=jQuery.fn.load;jQuery.fn.load=function(url,params,callback){if("string"!=typeof url&&_load)return _load.apply(this,arguments);var selector,response,type,self=this,off=url.indexOf(" ");return off>=0&&(selector=url.slice(off,url.length),url=url.slice(0,off)),jQuery.isFunction(params)?(callback=params,params=void 0):params&&"object"==typeof params&&(type="POST"),self.length>0&&jQuery.ajax({url:url,type:type,dataType:"html",data:params}).done(function(responseText){response=arguments,self.html(selector?jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector):responseText)}).complete(callback&&function(jqXHR,status){self.each(callback,response||[jqXHR.responseText,status,jqXHR])}),this},jQuery.expr.filters.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem}).length};var docElem=window.document.documentElement;jQuery.offset={setOffset:function(elem,options,i){var curPosition,curLeft,curCSSTop,curTop,curOffset,curCSSLeft,calculatePosition,position=jQuery.css(elem,"position"),curElem=jQuery(elem),props={};"static"===position&&(elem.style.position="relative"),curOffset=curElem.offset(),curCSSTop=jQuery.css(elem,"top"),curCSSLeft=jQuery.css(elem,"left"),calculatePosition=("absolute"===position||"fixed"===position)&&jQuery.inArray("auto",[curCSSTop,curCSSLeft])>-1,calculatePosition?(curPosition=curElem.position(),curTop=curPosition.top,curLeft=curPosition.left):(curTop=parseFloat(curCSSTop)||0,curLeft=parseFloat(curCSSLeft)||0),jQuery.isFunction(options)&&(options=options.call(elem,i,curOffset)),null!=options.top&&(props.top=options.top-curOffset.top+curTop),null!=options.left&&(props.left=options.left-curOffset.left+curLeft),"using"in options?options.using.call(elem,props):curElem.css(props)}},jQuery.fn.extend({offset:function(options){if(arguments.length)return void 0===options?this:this.each(function(i){jQuery.offset.setOffset(this,options,i)});var docElem,win,box={top:0,left:0},elem=this[0],doc=elem&&elem.ownerDocument;if(doc)return docElem=doc.documentElement,jQuery.contains(docElem,elem)?(typeof elem.getBoundingClientRect!==strundefined&&(box=elem.getBoundingClientRect()),win=getWindow(doc),{top:box.top+(win.pageYOffset||docElem.scrollTop)-(docElem.clientTop||0),left:box.left+(win.pageXOffset||docElem.scrollLeft)-(docElem.clientLeft||0)}):box},position:function(){if(this[0]){var offsetParent,offset,parentOffset={top:0,left:0},elem=this[0];return"fixed"===jQuery.css(elem,"position")?offset=elem.getBoundingClientRect():(offsetParent=this.offsetParent(),offset=this.offset(),jQuery.nodeName(offsetParent[0],"html")||(parentOffset=offsetParent.offset()),parentOffset.top+=jQuery.css(offsetParent[0],"borderTopWidth",!0),parentOffset.left+=jQuery.css(offsetParent[0],"borderLeftWidth",!0)),{top:offset.top-parentOffset.top-jQuery.css(elem,"marginTop",!0),left:offset.left-parentOffset.left-jQuery.css(elem,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var offsetParent=this.offsetParent||docElem;offsetParent&&!jQuery.nodeName(offsetParent,"html")&&"static"===jQuery.css(offsetParent,"position");)offsetParent=offsetParent.offsetParent;return offsetParent||docElem})}}),jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){var top=/Y/.test(prop);jQuery.fn[method]=function(val){return access(this,function(elem,method,val){var win=getWindow(elem);return void 0===val?win?prop in win?win[prop]:win.document.documentElement[method]:elem[method]:(win?win.scrollTo(top?jQuery(win).scrollLeft():val,top?val:jQuery(win).scrollTop()):elem[method]=val,void 0)},method,val,arguments.length,null)}}),jQuery.each(["top","left"],function(i,prop){jQuery.cssHooks[prop]=addGetHookIf(support.pixelPosition,function(elem,computed){return computed?(computed=curCSS(elem,prop),rnumnonpx.test(computed)?jQuery(elem).position()[prop]+"px":computed):void 0})}),jQuery.each({Height:"height",Width:"width"},function(name,type){jQuery.each({padding:"inner"+name,content:type,"":"outer"+name},function(defaultExtra,funcName){jQuery.fn[funcName]=function(margin,value){var chainable=arguments.length&&(defaultExtra||"boolean"!=typeof margin),extra=defaultExtra||(margin===!0||value===!0?"margin":"border");return access(this,function(elem,type,value){var doc;return jQuery.isWindow(elem)?elem.document.documentElement["client"+name]:9===elem.nodeType?(doc=elem.documentElement,Math.max(elem.body["scroll"+name],doc["scroll"+name],elem.body["offset"+name],doc["offset"+name],doc["client"+name])):void 0===value?jQuery.css(elem,type,extra):jQuery.style(elem,type,value,extra)},type,chainable?margin:void 0,chainable,null)}})}),jQuery.fn.size=function(){return this.length},jQuery.fn.andSelf=jQuery.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return jQuery});var _jQuery=window.jQuery,_$=window.$;return jQuery.noConflict=function(deep){return window.$===jQuery&&(window.$=_$),deep&&window.jQuery===jQuery&&(window.jQuery=_jQuery),jQuery},typeof noGlobal===strundefined&&(window.jQuery=window.$=jQuery),jQuery}),function($,undefined){$.rails!==undefined&&$.error("jquery-ujs has already been loaded!");var rails,$document=$(document);$.rails=rails={linkClickSelector:"a[data-confirm], a[data-method], a[data-remote], a[data-disable-with]",buttonClickSelector:"button[data-remote]",inputChangeSelector:"select[data-remote], input[data-remote], textarea[data-remote]",formSubmitSelector:"form",formInputClickSelector:"form input[type=submit], form input[type=image], form button[type=submit], form button:not([type])",disableSelector:"input[data-disable-with], button[data-disable-with], textarea[data-disable-with]",enableSelector:"input[data-disable-with]:disabled, button[data-disable-with]:disabled, textarea[data-disable-with]:disabled",requiredInputSelector:"input[name][required]:not([disabled]),textarea[name][required]:not([disabled])",fileInputSelector:"input[type=file]",linkDisableSelector:"a[data-disable-with]",CSRFProtection:function(xhr){var token=$('meta[name="csrf-token"]').attr("content");token&&xhr.setRequestHeader("X-CSRF-Token",token)},refreshCSRFTokens:function(){var csrfToken=$("meta[name=csrf-token]").attr("content"),csrfParam=$("meta[name=csrf-param]").attr("content");$('form input[name="'+csrfParam+'"]').val(csrfToken)},fire:function(obj,name,data){var event=$.Event(name);return obj.trigger(event,data),event.result!==!1},confirm:function(message){return confirm(message)},ajax:function(options){return $.ajax(options)},href:function(element){return element.attr("href")},handleRemote:function(element){var method,url,data,elCrossDomain,crossDomain,withCredentials,dataType,options;if(rails.fire(element,"ajax:before")){if(elCrossDomain=element.data("cross-domain"),crossDomain=elCrossDomain===undefined?null:elCrossDomain,withCredentials=element.data("with-credentials")||null,dataType=element.data("type")||$.ajaxSettings&&$.ajaxSettings.dataType,element.is("form")){method=element.attr("method"),url=element.attr("action"),data=element.serializeArray();var button=element.data("ujs:submit-button");button&&(data.push(button),element.data("ujs:submit-button",null))}else element.is(rails.inputChangeSelector)?(method=element.data("method"),url=element.data("url"),data=element.serialize(),element.data("params")&&(data=data+"&"+element.data("params"))):element.is(rails.buttonClickSelector)?(method=element.data("method")||"get",url=element.data("url"),data=element.serialize(),element.data("params")&&(data=data+"&"+element.data("params"))):(method=element.data("method"),url=rails.href(element),data=element.data("params")||null);options={type:method||"GET",data:data,dataType:dataType,beforeSend:function(xhr,settings){return settings.dataType===undefined&&xhr.setRequestHeader("accept","*/*;q=0.5, "+settings.accepts.script),rails.fire(element,"ajax:beforeSend",[xhr,settings])},success:function(data,status,xhr){element.trigger("ajax:success",[data,status,xhr])},complete:function(xhr,status){element.trigger("ajax:complete",[xhr,status])},error:function(xhr,status,error){element.trigger("ajax:error",[xhr,status,error])},crossDomain:crossDomain},withCredentials&&(options.xhrFields={withCredentials:withCredentials}),url&&(options.url=url);var jqxhr=rails.ajax(options);return element.trigger("ajax:send",jqxhr),jqxhr}return!1},handleMethod:function(link){var href=rails.href(link),method=link.data("method"),target=link.attr("target"),csrfToken=$("meta[name=csrf-token]").attr("content"),csrfParam=$("meta[name=csrf-param]").attr("content"),form=$('<form method="post" action="'+href+'"></form>'),metadataInput='<input name="_method" value="'+method+'" type="hidden" />';csrfParam!==undefined&&csrfToken!==undefined&&(metadataInput+='<input name="'+csrfParam+'" value="'+csrfToken+'" type="hidden" />'),target&&form.attr("target",target),form.hide().append(metadataInput).appendTo("body"),form.submit()},disableFormElements:function(form){form.find(rails.disableSelector).each(function(){var element=$(this),method=element.is("button")?"html":"val";element.data("ujs:enable-with",element[method]()),element[method](element.data("disable-with")),element.prop("disabled",!0)})},enableFormElements:function(form){form.find(rails.enableSelector).each(function(){var element=$(this),method=element.is("button")?"html":"val";element.data("ujs:enable-with")&&element[method](element.data("ujs:enable-with")),element.prop("disabled",!1)})},allowAction:function(element){var callback,message=element.data("confirm"),answer=!1;return message?(rails.fire(element,"confirm")&&(answer=rails.confirm(message),callback=rails.fire(element,"confirm:complete",[answer])),answer&&callback):!0},blankInputs:function(form,specifiedSelector,nonBlank){var input,valueToCheck,inputs=$(),selector=specifiedSelector||"input,textarea",allInputs=form.find(selector);return allInputs.each(function(){if(input=$(this),valueToCheck=input.is("input[type=checkbox],input[type=radio]")?input.is(":checked"):input.val(),!valueToCheck==!nonBlank){if(input.is("input[type=radio]")&&allInputs.filter('input[type=radio]:checked[name="'+input.attr("name")+'"]').length)return!0;inputs=inputs.add(input)}}),inputs.length?inputs:!1},nonBlankInputs:function(form,specifiedSelector){return rails.blankInputs(form,specifiedSelector,!0)},stopEverything:function(e){return $(e.target).trigger("ujs:everythingStopped"),e.stopImmediatePropagation(),!1},disableElement:function(element){element.data("ujs:enable-with",element.html()),element.html(element.data("disable-with")),element.bind("click.railsDisable",function(e){return rails.stopEverything(e)})},enableElement:function(element){element.data("ujs:enable-with")!==undefined&&(element.html(element.data("ujs:enable-with")),element.removeData("ujs:enable-with")),element.unbind("click.railsDisable")}},rails.fire($document,"rails:attachBindings")&&($.ajaxPrefilter(function(options,originalOptions,xhr){options.crossDomain||rails.CSRFProtection(xhr)}),$document.delegate(rails.linkDisableSelector,"ajax:complete",function(){rails.enableElement($(this))}),$document.delegate(rails.linkClickSelector,"click.rails",function(e){var link=$(this),method=link.data("method"),data=link.data("params"),metaClick=e.metaKey||e.ctrlKey;if(!rails.allowAction(link))return rails.stopEverything(e);if(!metaClick&&link.is(rails.linkDisableSelector)&&rails.disableElement(link),link.data("remote")!==undefined){if(metaClick&&(!method||"GET"===method)&&!data)return!0;var handleRemote=rails.handleRemote(link);return handleRemote===!1?rails.enableElement(link):handleRemote.error(function(){rails.enableElement(link)}),!1}return link.data("method")?(rails.handleMethod(link),!1):void 0}),$document.delegate(rails.buttonClickSelector,"click.rails",function(e){var button=$(this);return rails.allowAction(button)?(rails.handleRemote(button),!1):rails.stopEverything(e)}),$document.delegate(rails.inputChangeSelector,"change.rails",function(e){var link=$(this);return rails.allowAction(link)?(rails.handleRemote(link),!1):rails.stopEverything(e)}),$document.delegate(rails.formSubmitSelector,"submit.rails",function(e){var form=$(this),remote=form.data("remote")!==undefined,blankRequiredInputs=rails.blankInputs(form,rails.requiredInputSelector),nonBlankFileInputs=rails.nonBlankInputs(form,rails.fileInputSelector);if(!rails.allowAction(form))return rails.stopEverything(e);if(blankRequiredInputs&&form.attr("novalidate")==undefined&&rails.fire(form,"ajax:aborted:required",[blankRequiredInputs]))return rails.stopEverything(e);if(remote){if(nonBlankFileInputs){setTimeout(function(){rails.disableFormElements(form)},13);var aborted=rails.fire(form,"ajax:aborted:file",[nonBlankFileInputs]);return aborted||setTimeout(function(){rails.enableFormElements(form)},13),aborted}return rails.handleRemote(form),!1}setTimeout(function(){rails.disableFormElements(form)},13)}),$document.delegate(rails.formInputClickSelector,"click.rails",function(event){var button=$(this);if(!rails.allowAction(button))return rails.stopEverything(event);var name=button.attr("name"),data=name?{name:name,value:button.val()}:null;button.closest("form").data("ujs:submit-button",data)}),$document.delegate(rails.formSubmitSelector,"ajax:beforeSend.rails",function(event){this==event.target&&rails.disableFormElements($(this))}),$document.delegate(rails.formSubmitSelector,"ajax:complete.rails",function(event){this==event.target&&rails.enableFormElements($(this))}),$(function(){rails.refreshCSRFTokens()}))}(jQuery),!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var f;"undefined"!=typeof window?f=window:"undefined"!=typeof global?f=global:"undefined"!=typeof self&&(f=self),f.Abecedary=e()}}(function(){return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(_dereq_,module){function Abecedary(iframeUrl,template,options){var generateElement=function(){var element=document.createElement("div");return element.style.cssText="display:none;",document.body.appendChild(element),element};this.options=options||{},this.iframeUrl=iframeUrl,this.template=template,this.options=extend({ui:"bdd",bail:!0,ignoreLeaks:!0},this.options),this.element=this.options.element||generateElement(),delete this.options.element,this.sandbox=new Promise(function(resolve,reject){stuff(this.iframeUrl,{el:this.element},function(context){context.on("finished",runComplete.bind(this)),context.on("loaded",loaded.bind(this,{resolve:resolve,reject:reject})),context.on("error",error.bind(this)),context.load(this.template),this.context=context}.bind(this))}.bind(this));var runComplete=function(report){this.emit("complete",report)},loaded=function(promise){this.context.evaljs("mocha.setup("+JSON.stringify(this.options)+");"),promise.resolve(this.context)},error=function(error){this.emit("error",error,this)}}var component=_dereq_("./lib/component"),runner=_dereq_("./lib/runner.js"),stuff=component("adamfortuna-stuff.js"),emitter=component("component-emitter"),Promise=component("then-promise"),extend=component("segmentio-extend");emitter(Abecedary.prototype),Abecedary.prototype.run=function(code,tests){var _this=this;this.sandbox.then(function(context){try{context.evaljs(runner(code,tests||_this.tests))}catch(e){_this.emit("error",e)}})},Abecedary.prototype.close=function(){this.element.parentElement.removeChild(this.element)},module.exports=Abecedary},{"./lib/component":2,"./lib/runner.js":3}],2:[function(_dereq_,module){(function(global){function _require(path,parent,orig){var resolved=_require.resolve(path);if(null==resolved){orig=orig||path,parent=parent||"root";var err=new Error('Failed to require "'+orig+'" from "'+parent+'"');throw err.path=orig,err.parent=parent,err._require=!0,err}var module=_require.modules[resolved];if(!module._resolving&&!module.exports){var mod={};mod.exports={},mod.client=mod.component=!0,module._resolving=!0,module.call(this,mod.exports,_require.relative(resolved),mod),delete module._resolving,module.exports=mod.exports}return module.exports}_require.modules={},_require.aliases={},_require.resolve=function(path){"/"===path.charAt(0)&&(path=path.slice(1));for(var paths=[path,path+".js",path+".json",path+"/index.js",path+"/index.json"],i=0;i<paths.length;i++){var path=paths[i];if(_require.modules.hasOwnProperty(path))return path;if(_require.aliases.hasOwnProperty(path))return _require.aliases[path]}},_require.normalize=function(curr,path){var segs=[];if("."!=path.charAt(0))return path;curr=curr.split("/"),path=path.split("/");for(var i=0;i<path.length;++i)".."==path[i]?curr.pop():"."!=path[i]&&""!=path[i]&&segs.push(path[i]);return curr.concat(segs).join("/")},_require.register=function(path,definition){_require.modules[path]=definition},_require.alias=function(from,to){if(!_require.modules.hasOwnProperty(from))throw new Error('Failed to alias "'+from+'", it does not exist');_require.aliases[to]=from},_require.relative=function(parent){function lastIndexOf(arr,obj){for(var i=arr.length;i--;)if(arr[i]===obj)return i;return-1}function localRequire(path){var resolved=localRequire.resolve(path);return _require(resolved,parent,path)}var p=_require.normalize(parent,"..");return localRequire.resolve=function(path){var c=path.charAt(0);if("/"==c)return path.slice(1);if("."==c)return _require.normalize(p,path);var segs=parent.split("/"),i=lastIndexOf(segs,"deps")+1;return i||(i=0),path=segs.slice(0,i+1).join("/")+"/deps/"+path},localRequire.exists=function(path){return _require.modules.hasOwnProperty(localRequire.resolve(path))},localRequire},_require.register("component-emitter/index.js",function(exports,_require,module){function Emitter(obj){return obj?mixin(obj):void 0}function mixin(obj){for(var key in Emitter.prototype)obj[key]=Emitter.prototype[key];return obj}module.exports=Emitter,Emitter.prototype.on=Emitter.prototype.addEventListener=function(event,fn){return this._callbacks=this._callbacks||{},(this._callbacks[event]=this._callbacks[event]||[]).push(fn),this},Emitter.prototype.once=function(event,fn){function on(){self.off(event,on),fn.apply(this,arguments)}var self=this;return this._callbacks=this._callbacks||{},on.fn=fn,this.on(event,on),this},Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=Emitter.prototype.removeEventListener=function(event,fn){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var callbacks=this._callbacks[event];if(!callbacks)return this;if(1==arguments.length)return delete this._callbacks[event],this;for(var cb,i=0;i<callbacks.length;i++)if(cb=callbacks[i],cb===fn||cb.fn===fn){callbacks.splice(i,1);break}return this},Emitter.prototype.emit=function(event){this._callbacks=this._callbacks||{};var args=[].slice.call(arguments,1),callbacks=this._callbacks[event];if(callbacks){callbacks=callbacks.slice(0);for(var i=0,len=callbacks.length;len>i;++i)callbacks[i].apply(this,args)}return this},Emitter.prototype.listeners=function(event){return this._callbacks=this._callbacks||{},this._callbacks[event]||[]},Emitter.prototype.hasListeners=function(event){return!!this.listeners(event).length}}),_require.register("johntron-asap/asap.js",function(exports,_require,module){"use strict";function flush(){for(;head.next;){head=head.next;var task=head.task;head.task=void 0;try{task()}catch(e){if(isNodeJS)throw requestFlush(),e;setTimeout(function(){throw e},0)}}flushing=!1}function asap(task){isNodeJS&&process.domain&&(task=process.domain.bind(task)),tail=tail.next={task:task,next:null},flushing||(requestFlush(),flushing=!0)}var domain,head={task:void 0,next:null},tail=head,flushing=!1,requestFlush=void 0,hasSetImmediate="function"==typeof setImmediate;if("undefined"!=typeof global)var process=global.process;var isNodeJS=!!process&&"[object process]"==={}.toString.call(process);if(isNodeJS)requestFlush=function(){var currentDomain=process.domain;currentDomain&&(domain=domain||_require("domain"),domain.active=process.domain=null),flushing&&hasSetImmediate?setImmediate(flush):process.nextTick(flush),currentDomain&&(domain.active=process.domain=currentDomain)};else if(hasSetImmediate)requestFlush=function(){setImmediate(flush)};else if("undefined"!=typeof MessageChannel){var channel=new MessageChannel;channel.port1.onmessage=function(){requestFlush=requestPortFlush,channel.port1.onmessage=flush,flush()};var requestPortFlush=function(){channel.port2.postMessage(0)};requestFlush=function(){setTimeout(flush,0),requestPortFlush()}}else requestFlush=function(){setTimeout(flush,0)};module.exports=asap}),_require.register("then-promise/index.js",function(exports,_require,module){"use strict";function ValuePromise(value){this.then=function(onFulfilled){return"function"!=typeof onFulfilled?this:new Promise(function(resolve,reject){asap(function(){try{resolve(onFulfilled(value))}catch(ex){reject(ex)}})})}}var Promise=_require("./core.js"),asap=_require("asap");module.exports=Promise,ValuePromise.prototype=Object.create(Promise.prototype);var TRUE=new ValuePromise(!0),FALSE=new ValuePromise(!1),NULL=new ValuePromise(null),UNDEFINED=new ValuePromise(void 0),ZERO=new ValuePromise(0),EMPTYSTRING=new ValuePromise("");Promise.from=Promise.cast=function(value){if(value instanceof Promise)return value;if(null===value)return NULL;if(void 0===value)return UNDEFINED;if(value===!0)return TRUE;if(value===!1)return FALSE;if(0===value)return ZERO;if(""===value)return EMPTYSTRING;if("object"==typeof value||"function"==typeof value)try{var then=value.then;if("function"==typeof then)return new Promise(then.bind(value))}catch(ex){return new Promise(function(resolve,reject){reject(ex)})}return new ValuePromise(value)},Promise.denodeify=function(fn,argumentCount){return argumentCount=argumentCount||1/0,function(){var self=this,args=Array.prototype.slice.call(arguments);return new Promise(function(resolve,reject){for(;args.length&&args.length>argumentCount;)args.pop();args.push(function(err,res){err?reject(err):resolve(res)}),fn.apply(self,args)})}},Promise.nodeify=function(fn){return function(){var args=Array.prototype.slice.call(arguments),callback="function"==typeof args[args.length-1]?args.pop():null;try{return fn.apply(this,arguments).nodeify(callback)}catch(ex){if(null===callback||"undefined"==typeof callback)return new Promise(function(resolve,reject){reject(ex)});asap(function(){callback(ex)})}}},Promise.all=function(){var args=Array.prototype.slice.call(1===arguments.length&&Array.isArray(arguments[0])?arguments[0]:arguments);return new Promise(function(resolve,reject){function res(i,val){try{if(val&&("object"==typeof val||"function"==typeof val)){var then=val.then;if("function"==typeof then)return then.call(val,function(val){res(i,val)},reject),void 0}args[i]=val,0===--remaining&&resolve(args)}catch(ex){reject(ex)}}if(0===args.length)return resolve([]);for(var remaining=args.length,i=0;i<args.length;i++)res(i,args[i])})},Promise.prototype.done=function(){var self=arguments.length?this.then.apply(this,arguments):this;self.then(null,function(err){asap(function(){throw err})})},Promise.prototype.nodeify=function(callback){return null===callback||"undefined"==typeof callback?this:(this.then(function(value){asap(function(){callback(null,value)})},function(err){asap(function(){callback(err)})}),void 0)},Promise.prototype.catch=function(onRejected){return this.then(null,onRejected)},Promise.resolve=function(value){return new Promise(function(resolve){resolve(value)})},Promise.reject=function(value){return new Promise(function(resolve,reject){reject(value)})},Promise.race=function(values){return new Promise(function(resolve,reject){values.map(function(value){Promise.cast(value).then(resolve,reject)})})}}),_require.register("then-promise/core.js",function(exports,_require,module){"use strict";function Promise(fn){function handle(deferred){return null===state?(deferreds.push(deferred),void 0):(asap(function(){var cb=state?deferred.onFulfilled:deferred.onRejected;if(null===cb)return(state?deferred.resolve:deferred.reject)(value),void 0;var ret;try{ret=cb(value)}catch(e){return deferred.reject(e),void 0}deferred.resolve(ret)}),void 0)}function resolve(newValue){try{if(newValue===self)throw new TypeError("A promise cannot be resolved with itself.");if(newValue&&("object"==typeof newValue||"function"==typeof newValue)){var then=newValue.then;if("function"==typeof then)return doResolve(then.bind(newValue),resolve,reject),void 0}state=!0,value=newValue,finale()}catch(e){reject(e)}}function reject(newValue){state=!1,value=newValue,finale()}function finale(){for(var i=0,len=deferreds.length;len>i;i++)handle(deferreds[i]);deferreds=null}if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof fn)throw new TypeError("not a function");var state=null,value=null,deferreds=[],self=this;this.then=function(onFulfilled,onRejected){return new Promise(function(resolve,reject){handle(new Handler(onFulfilled,onRejected,resolve,reject))})},doResolve(fn,resolve,reject)}function Handler(onFulfilled,onRejected,resolve,reject){this.onFulfilled="function"==typeof onFulfilled?onFulfilled:null,this.onRejected="function"==typeof onRejected?onRejected:null,this.resolve=resolve,this.reject=reject}function doResolve(fn,onFulfilled,onRejected){var done=!1;try{fn(function(value){done||(done=!0,onFulfilled(value))},function(reason){done||(done=!0,onRejected(reason))})}catch(ex){if(done)return;done=!0,onRejected(ex)}}var asap=_require("asap");module.exports=Promise}),_require.register("segmentio-extend/index.js",function(exports,_require,module){module.exports=function(object){for(var source,args=Array.prototype.slice.call(arguments,1),i=0;source=args[i];i++)if(source)for(var property in source)object[property]=source[property];
return object}}),_require.register("adamfortuna-stuff.js/lib/stuff.js",function(exports,_require,module){!function(global){"use strict";function stuff(url,options,cb){function init(){context.handshake(),once||(cb(context),once=!0)}"function"==typeof options&&(cb=options,options={}),cb||(cb=noop);var el=options&&1===options.nodeType?options:options.el||document.querySelector("body");options.el=null;var iframe=document.createElement("iframe"),context=new Context(iframe,options);global.addEventListener("message",context.messageHandler.bind(context),!1),iframes.push(iframe),iframe.setAttribute("scrolling","no"),iframe.setAttribute("src",url);var once=!1;iframe.addEventListener("load",init,!1),el.appendChild(iframe)}function Context(iframe,options){if(this.iframe=iframe,this.callbacks={},this.eventQ={load:[],evaljs:[],html:[]},options.sandbox===!0)this.sandbox="allow-scripts allow-same-origin";else if("string"==typeof options.sandbox){var sandbox=options.sandbox;-1===sandbox.indexOf("allow-scripts")&&(sandbox+=" allow-scripts"),-1===sandbox.indexOf("allow-same-origin")&&(sandbox+=" allow-same-origin"),this.sandbox=sandbox}else this.sandbox=null;this.secret=Math.ceil(999999999*Math.random())+1}var iframes=[],noop=function(){};stuff.clear=function(){iframes.forEach(function(iframe){var parent=iframe.parentElement;parent&&parent.removeChild(iframe)}),iframes=[]},Context.prototype.handle=function(type,data){var callbacks,that=this;if("custom"===type){var msg=data;callbacks=this.callbacks[msg.type]||[],callbacks.forEach(function(cb){"function"==typeof cb&&cb.call(cb.thisArg||that,msg.data)})}else{if(callbacks=this.eventQ[type],!callbacks)return;var cb=callbacks.shift();"function"==typeof cb&&cb.call(cb.thisArg||that,data)}},Context.prototype.messageHandler=function(e){var msg;try{msg=JSON.parse(e.data)}catch(err){return}if(msg.secret===this.secret){var data=msg.data,type=msg.type;this.handle(type,data)}},Context.prototype.post=function(type,data){this.iframe.contentWindow.postMessage(JSON.stringify({type:type,data:data,secret:this.secret}),"*")},Context.prototype.evaljs=function(js,cb,thisArg){var callback=function(d){var Type,e=d.error,error=e;e&&(Type=global[e.__errorType__])&&(error=new Type(e.message),error.stack=e.stack,error.type=e.type,error.arguments=e.arguments),(cb||noop).call(this,error,d.result)};callback.thisArg=thisArg,this.eventQ.evaljs.push(callback),this.post("evaljs",js)},Context.prototype.load=function(html,cb,thisArg){cb=cb||noop,cb.thisArg=thisArg,this.eventQ.load.push(cb),this.post("load",html)},Context.prototype.html=function(cb,thisArg){cb=cb||noop,cb.thisArg=thisArg,this.eventQ.html.push(cb),this.post("html",null)},Context.prototype.handshake=function(){this.post("handshake",this.sandbox)},Context.prototype.on=function(event,cb,thisArg){cb=cb||noop,cb.thisArg=thisArg,this.callbacks[event]?this.callbacks[event].push(cb):this.callbacks[event]=[cb]},Context.prototype.off=function(event,cb){var callbacks=this.callbacks[event];if(callbacks){var i=callbacks.indexOf(cb);-1!==i&&callbacks.splice(i,1)}else this.callbacks[event]=[]},stuff.Context=Context,global.stuff=stuff,module.exports=stuff}(this)}),_require.alias("component-emitter/index.js","abecedary/deps/emitter/index.js"),_require.alias("component-emitter/index.js","emitter/index.js"),_require.alias("then-promise/index.js","abecedary/deps/promise/index.js"),_require.alias("then-promise/core.js","abecedary/deps/promise/core.js"),_require.alias("then-promise/index.js","promise/index.js"),_require.alias("johntron-asap/asap.js","then-promise/deps/asap/asap.js"),_require.alias("johntron-asap/asap.js","then-promise/deps/asap/index.js"),_require.alias("johntron-asap/asap.js","johntron-asap/index.js"),_require.alias("segmentio-extend/index.js","abecedary/deps/extend/index.js"),_require.alias("segmentio-extend/index.js","extend/index.js"),_require.alias("adamfortuna-stuff.js/lib/stuff.js","abecedary/deps/stuff.js/lib/stuff.js"),_require.alias("adamfortuna-stuff.js/lib/stuff.js","abecedary/deps/stuff.js/index.js"),_require.alias("adamfortuna-stuff.js/lib/stuff.js","stuff.js/index.js"),_require.alias("adamfortuna-stuff.js/lib/stuff.js","adamfortuna-stuff.js/index.js"),module.exports=_require}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(_dereq_,module){module.exports=function(code,tests){return["try {","  window.code = JSON.parse("+JSON.stringify(JSON.stringify(code))+");","  mocha.suite.suites.shift()","","// Begin Tests",tests,"// End Tests","","  window.mocha.run();","} catch(e) {","  rethrow(e, JSON.parse("+JSON.stringify(JSON.stringify(tests))+"), 6);","}",!0].join("\n")}},{}]},{},[1])(1)}),window.Modernizr=function(window,document,undefined){function setCss(str){mStyle.cssText=str}function setCssAll(str1,str2){return setCss(prefixes.join(str1+";")+(str2||""))}function is(obj,type){return typeof obj===type}function contains(str,substr){return!!~(""+str).indexOf(substr)}function testProps(props,prefixed){for(var i in props){var prop=props[i];if(!contains(prop,"-")&&mStyle[prop]!==undefined)return"pfx"==prefixed?prop:!0}return!1}function testDOMProps(props,obj,elem){for(var i in props){var item=obj[props[i]];if(item!==undefined)return elem===!1?props[i]:is(item,"function")?item.bind(elem||obj):item}return!1}function testPropsAll(prop,prefixed,elem){var ucProp=prop.charAt(0).toUpperCase()+prop.slice(1),props=(prop+" "+cssomPrefixes.join(ucProp+" ")+ucProp).split(" ");return is(prefixed,"string")||is(prefixed,"undefined")?testProps(props,prefixed):(props=(prop+" "+domPrefixes.join(ucProp+" ")+ucProp).split(" "),testDOMProps(props,prefixed,elem))}function webforms(){Modernizr.input=function(props){for(var i=0,len=props.length;len>i;i++)attrs[props[i]]=!!(props[i]in inputElem);return attrs.list&&(attrs.list=!(!document.createElement("datalist")||!window.HTMLDataListElement)),attrs}("autocomplete autofocus list placeholder max min multiple pattern required step".split(" ")),Modernizr.inputtypes=function(props){for(var bool,inputElemType,defaultView,i=0,len=props.length;len>i;i++)inputElem.setAttribute("type",inputElemType=props[i]),bool="text"!==inputElem.type,bool&&(inputElem.value=smile,inputElem.style.cssText="position:absolute;visibility:hidden;",/^range$/.test(inputElemType)&&inputElem.style.WebkitAppearance!==undefined?(docElement.appendChild(inputElem),defaultView=document.defaultView,bool=defaultView.getComputedStyle&&"textfield"!==defaultView.getComputedStyle(inputElem,null).WebkitAppearance&&0!==inputElem.offsetHeight,docElement.removeChild(inputElem)):/^(search|tel)$/.test(inputElemType)||(bool=/^(url|email)$/.test(inputElemType)?inputElem.checkValidity&&inputElem.checkValidity()===!1:inputElem.value!=smile)),inputs[props[i]]=!!bool;return inputs}("search tel url email datetime date month week time datetime-local number range color".split(" "))}var featureName,hasOwnProp,version="2.7.1",Modernizr={},enableClasses=!0,docElement=document.documentElement,mod="modernizr",modElem=document.createElement(mod),mStyle=modElem.style,inputElem=document.createElement("input"),smile=":)",toString={}.toString,prefixes=" -webkit- -moz- -o- -ms- ".split(" "),omPrefixes="Webkit Moz O ms",cssomPrefixes=omPrefixes.split(" "),domPrefixes=omPrefixes.toLowerCase().split(" "),ns={svg:"http://www.w3.org/2000/svg"},tests={},inputs={},attrs={},classes=[],slice=classes.slice,injectElementWithStyles=function(rule,callback,nodes,testnames){var style,ret,node,docOverflow,div=document.createElement("div"),body=document.body,fakeBody=body||document.createElement("body");if(parseInt(nodes,10))for(;nodes--;)node=document.createElement("div"),node.id=testnames?testnames[nodes]:mod+(nodes+1),div.appendChild(node);return style=["&#173;",'<style id="s',mod,'">',rule,"</style>"].join(""),div.id=mod,(body?div:fakeBody).innerHTML+=style,fakeBody.appendChild(div),body||(fakeBody.style.background="",fakeBody.style.overflow="hidden",docOverflow=docElement.style.overflow,docElement.style.overflow="hidden",docElement.appendChild(fakeBody)),ret=callback(div,rule),body?div.parentNode.removeChild(div):(fakeBody.parentNode.removeChild(fakeBody),docElement.style.overflow=docOverflow),!!ret},testMediaQuery=function(mq){var matchMedia=window.matchMedia||window.msMatchMedia;if(matchMedia)return matchMedia(mq).matches;var bool;return injectElementWithStyles("@media "+mq+" { #"+mod+" { position: absolute; } }",function(node){bool="absolute"==(window.getComputedStyle?getComputedStyle(node,null):node.currentStyle).position}),bool},isEventSupported=function(){function isEventSupported(eventName,element){element=element||document.createElement(TAGNAMES[eventName]||"div"),eventName="on"+eventName;var isSupported=eventName in element;return isSupported||(element.setAttribute||(element=document.createElement("div")),element.setAttribute&&element.removeAttribute&&(element.setAttribute(eventName,""),isSupported=is(element[eventName],"function"),is(element[eventName],"undefined")||(element[eventName]=undefined),element.removeAttribute(eventName))),element=null,isSupported}var TAGNAMES={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return isEventSupported}(),_hasOwnProperty={}.hasOwnProperty;hasOwnProp=is(_hasOwnProperty,"undefined")||is(_hasOwnProperty.call,"undefined")?function(object,property){return property in object&&is(object.constructor.prototype[property],"undefined")}:function(object,property){return _hasOwnProperty.call(object,property)},Function.prototype.bind||(Function.prototype.bind=function(that){var target=this;if("function"!=typeof target)throw new TypeError;var args=slice.call(arguments,1),bound=function(){if(this instanceof bound){var F=function(){};F.prototype=target.prototype;var self=new F,result=target.apply(self,args.concat(slice.call(arguments)));return Object(result)===result?result:self}return target.apply(that,args.concat(slice.call(arguments)))};return bound}),tests.flexbox=function(){return testPropsAll("flexWrap")},tests.flexboxlegacy=function(){return testPropsAll("boxDirection")},tests.canvas=function(){var elem=document.createElement("canvas");return!(!elem.getContext||!elem.getContext("2d"))},tests.canvastext=function(){return!(!Modernizr.canvas||!is(document.createElement("canvas").getContext("2d").fillText,"function"))},tests.webgl=function(){return!!window.WebGLRenderingContext},tests.touch=function(){var bool;return"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch?bool=!0:injectElementWithStyles(["@media (",prefixes.join("touch-enabled),("),mod,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(node){bool=9===node.offsetTop}),bool},tests.geolocation=function(){return"geolocation"in navigator},tests.postmessage=function(){return!!window.postMessage},tests.websqldatabase=function(){return!!window.openDatabase},tests.indexedDB=function(){return!!testPropsAll("indexedDB",window)},tests.hashchange=function(){return isEventSupported("hashchange",window)&&(document.documentMode===undefined||document.documentMode>7)},tests.history=function(){return!(!window.history||!history.pushState)},tests.draganddrop=function(){var div=document.createElement("div");return"draggable"in div||"ondragstart"in div&&"ondrop"in div},tests.websockets=function(){return"WebSocket"in window||"MozWebSocket"in window},tests.rgba=function(){return setCss("background-color:rgba(150,255,150,.5)"),contains(mStyle.backgroundColor,"rgba")},tests.hsla=function(){return setCss("background-color:hsla(120,40%,100%,.5)"),contains(mStyle.backgroundColor,"rgba")||contains(mStyle.backgroundColor,"hsla")},tests.multiplebgs=function(){return setCss("background:url(https://),url(https://),red url(https://)"),/(url\s*\(.*?){3}/.test(mStyle.background)},tests.backgroundsize=function(){return testPropsAll("backgroundSize")},tests.borderimage=function(){return testPropsAll("borderImage")},tests.borderradius=function(){return testPropsAll("borderRadius")},tests.boxshadow=function(){return testPropsAll("boxShadow")},tests.textshadow=function(){return""===document.createElement("div").style.textShadow},tests.opacity=function(){return setCssAll("opacity:.55"),/^0.55$/.test(mStyle.opacity)},tests.cssanimations=function(){return testPropsAll("animationName")},tests.csscolumns=function(){return testPropsAll("columnCount")},tests.cssgradients=function(){var str1="background-image:",str2="gradient(linear,left top,right bottom,from(#9f9),to(white));",str3="linear-gradient(left top,#9f9, white);";return setCss((str1+"-webkit- ".split(" ").join(str2+str1)+prefixes.join(str3+str1)).slice(0,-str1.length)),contains(mStyle.backgroundImage,"gradient")},tests.cssreflections=function(){return testPropsAll("boxReflect")},tests.csstransforms=function(){return!!testPropsAll("transform")},tests.csstransforms3d=function(){var ret=!!testPropsAll("perspective");return ret&&"webkitPerspective"in docElement.style&&injectElementWithStyles("@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}",function(node){ret=9===node.offsetLeft&&3===node.offsetHeight}),ret},tests.csstransitions=function(){return testPropsAll("transition")},tests.fontface=function(){var bool;return injectElementWithStyles('@font-face {font-family:"font";src:url("https://")}',function(node,rule){var style=document.getElementById("smodernizr"),sheet=style.sheet||style.styleSheet,cssText=sheet?sheet.cssRules&&sheet.cssRules[0]?sheet.cssRules[0].cssText:sheet.cssText||"":"";bool=/src/i.test(cssText)&&0===cssText.indexOf(rule.split(" ")[0])}),bool},tests.generatedcontent=function(){var bool;return injectElementWithStyles(["#",mod,"{font:0/0 a}#",mod,':after{content:"',smile,'";visibility:hidden;font:3px/1 a}'].join(""),function(node){bool=node.offsetHeight>=3}),bool},tests.video=function(){var elem=document.createElement("video"),bool=!1;try{(bool=!!elem.canPlayType)&&(bool=new Boolean(bool),bool.ogg=elem.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,""),bool.h264=elem.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,""),bool.webm=elem.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,""))}catch(e){}return bool},tests.audio=function(){var elem=document.createElement("audio"),bool=!1;try{(bool=!!elem.canPlayType)&&(bool=new Boolean(bool),bool.ogg=elem.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),bool.mp3=elem.canPlayType("audio/mpeg;").replace(/^no$/,""),bool.wav=elem.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),bool.m4a=(elem.canPlayType("audio/x-m4a;")||elem.canPlayType("audio/aac;")).replace(/^no$/,""))}catch(e){}return bool},tests.localstorage=function(){try{return localStorage.setItem(mod,mod),localStorage.removeItem(mod),!0}catch(e){return!1}},tests.sessionstorage=function(){try{return sessionStorage.setItem(mod,mod),sessionStorage.removeItem(mod),!0}catch(e){return!1}},tests.webworkers=function(){return!!window.Worker},tests.applicationcache=function(){return!!window.applicationCache},tests.svg=function(){return!!document.createElementNS&&!!document.createElementNS(ns.svg,"svg").createSVGRect},tests.inlinesvg=function(){var div=document.createElement("div");return div.innerHTML="<svg/>",(div.firstChild&&div.firstChild.namespaceURI)==ns.svg},tests.smil=function(){return!!document.createElementNS&&/SVGAnimate/.test(toString.call(document.createElementNS(ns.svg,"animate")))},tests.svgclippaths=function(){return!!document.createElementNS&&/SVGClipPath/.test(toString.call(document.createElementNS(ns.svg,"clipPath")))};for(var feature in tests)hasOwnProp(tests,feature)&&(featureName=feature.toLowerCase(),Modernizr[featureName]=tests[feature](),classes.push((Modernizr[featureName]?"":"no-")+featureName));return Modernizr.input||webforms(),Modernizr.addTest=function(feature,test){if("object"==typeof feature)for(var key in feature)hasOwnProp(feature,key)&&Modernizr.addTest(key,feature[key]);else{if(feature=feature.toLowerCase(),Modernizr[feature]!==undefined)return Modernizr;test="function"==typeof test?test():test,"undefined"!=typeof enableClasses&&enableClasses&&(docElement.className+=" "+(test?"":"no-")+feature),Modernizr[feature]=test}return Modernizr},setCss(""),modElem=inputElem=null,function(window,document){function addStyleSheet(ownerDocument,cssText){var p=ownerDocument.createElement("p"),parent=ownerDocument.getElementsByTagName("head")[0]||ownerDocument.documentElement;return p.innerHTML="x<style>"+cssText+"</style>",parent.insertBefore(p.lastChild,parent.firstChild)}function getElements(){var elements=html5.elements;return"string"==typeof elements?elements.split(" "):elements}function getExpandoData(ownerDocument){var data=expandoData[ownerDocument[expando]];return data||(data={},expanID++,ownerDocument[expando]=expanID,expandoData[expanID]=data),data}function createElement(nodeName,ownerDocument,data){if(ownerDocument||(ownerDocument=document),supportsUnknownElements)return ownerDocument.createElement(nodeName);data||(data=getExpandoData(ownerDocument));var node;return node=data.cache[nodeName]?data.cache[nodeName].cloneNode():saveClones.test(nodeName)?(data.cache[nodeName]=data.createElem(nodeName)).cloneNode():data.createElem(nodeName),!node.canHaveChildren||reSkip.test(nodeName)||node.tagUrn?node:data.frag.appendChild(node)}function createDocumentFragment(ownerDocument,data){if(ownerDocument||(ownerDocument=document),supportsUnknownElements)return ownerDocument.createDocumentFragment();data=data||getExpandoData(ownerDocument);for(var clone=data.frag.cloneNode(),i=0,elems=getElements(),l=elems.length;l>i;i++)clone.createElement(elems[i]);return clone}function shivMethods(ownerDocument,data){data.cache||(data.cache={},data.createElem=ownerDocument.createElement,data.createFrag=ownerDocument.createDocumentFragment,data.frag=data.createFrag()),ownerDocument.createElement=function(nodeName){return html5.shivMethods?createElement(nodeName,ownerDocument,data):data.createElem(nodeName)},ownerDocument.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+getElements().join().replace(/[\w\-]+/g,function(nodeName){return data.createElem(nodeName),data.frag.createElement(nodeName),'c("'+nodeName+'")'})+");return n}")(html5,data.frag)}function shivDocument(ownerDocument){ownerDocument||(ownerDocument=document);var data=getExpandoData(ownerDocument);return!html5.shivCSS||supportsHtml5Styles||data.hasCSS||(data.hasCSS=!!addStyleSheet(ownerDocument,"article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}")),supportsUnknownElements||shivMethods(ownerDocument,data),ownerDocument}var supportsHtml5Styles,supportsUnknownElements,version="3.7.0",options=window.html5||{},reSkip=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,saveClones=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,expando="_html5shiv",expanID=0,expandoData={};!function(){try{var a=document.createElement("a");a.innerHTML="<xyz></xyz>",supportsHtml5Styles="hidden"in a,supportsUnknownElements=1==a.childNodes.length||function(){document.createElement("a");var frag=document.createDocumentFragment();return"undefined"==typeof frag.cloneNode||"undefined"==typeof frag.createDocumentFragment||"undefined"==typeof frag.createElement}()}catch(e){supportsHtml5Styles=!0,supportsUnknownElements=!0}}();var html5={elements:options.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video",version:version,shivCSS:options.shivCSS!==!1,supportsUnknownElements:supportsUnknownElements,shivMethods:options.shivMethods!==!1,type:"default",shivDocument:shivDocument,createElement:createElement,createDocumentFragment:createDocumentFragment};window.html5=html5,shivDocument(document)}(this,document),Modernizr._version=version,Modernizr._prefixes=prefixes,Modernizr._domPrefixes=domPrefixes,Modernizr._cssomPrefixes=cssomPrefixes,Modernizr.mq=testMediaQuery,Modernizr.hasEvent=isEventSupported,Modernizr.testProp=function(prop){return testProps([prop])},Modernizr.testAllProps=testPropsAll,Modernizr.testStyles=injectElementWithStyles,Modernizr.prefixed=function(prop,obj,elem){return obj?testPropsAll(prop,obj,elem):testPropsAll(prop,"pfx")},docElement.className=docElement.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(enableClasses?" js "+classes.join(" "):""),Modernizr}(this,this.document),function(window,document,undefined){"use strict";function minErr(module){return function(){var message,i,code=arguments[0],prefix="["+(module?module+":":"")+code+"] ",template=arguments[1],templateArgs=arguments,stringify=function(obj){return"function"==typeof obj?obj.toString().replace(/ \{[\s\S]*$/,""):"undefined"==typeof obj?"undefined":"string"!=typeof obj?JSON.stringify(obj):obj};for(message=prefix+template.replace(/\{\d+\}/g,function(match){var arg,index=+match.slice(1,-1);return index+2<templateArgs.length?(arg=templateArgs[index+2],"function"==typeof arg?arg.toString().replace(/ ?\{[\s\S]*$/,""):"undefined"==typeof arg?"undefined":"string"!=typeof arg?toJson(arg):arg):match}),message=message+"\nhttp://errors.angularjs.org/1.2.14/"+(module?module+"/":"")+code,i=2;i<arguments.length;i++)message=message+(2==i?"?":"&")+"p"+(i-2)+"="+encodeURIComponent(stringify(arguments[i]));return new Error(message)}}function isArrayLike(obj){if(null==obj||isWindow(obj))return!1;var length=obj.length;return 1===obj.nodeType&&length?!0:isString(obj)||isArray(obj)||0===length||"number"==typeof length&&length>0&&length-1 in obj}function forEach(obj,iterator,context){var key;if(obj)if(isFunction(obj))for(key in obj)"prototype"==key||"length"==key||"name"==key||obj.hasOwnProperty&&!obj.hasOwnProperty(key)||iterator.call(context,obj[key],key);else if(obj.forEach&&obj.forEach!==forEach)obj.forEach(iterator,context);else if(isArrayLike(obj))for(key=0;key<obj.length;key++)iterator.call(context,obj[key],key);else for(key in obj)obj.hasOwnProperty(key)&&iterator.call(context,obj[key],key);return obj}function sortedKeys(obj){var keys=[];for(var key in obj)obj.hasOwnProperty(key)&&keys.push(key);return keys.sort()}function forEachSorted(obj,iterator,context){for(var keys=sortedKeys(obj),i=0;i<keys.length;i++)iterator.call(context,obj[keys[i]],keys[i]);return keys}function reverseParams(iteratorFn){return function(value,key){iteratorFn(key,value)}}function nextUid(){for(var digit,index=uid.length;index;){if(index--,digit=uid[index].charCodeAt(0),57==digit)return uid[index]="A",uid.join("");if(90!=digit)return uid[index]=String.fromCharCode(digit+1),uid.join("");uid[index]="0"}return uid.unshift("0"),uid.join("")}function setHashKey(obj,h){h?obj.$$hashKey=h:delete obj.$$hashKey}function extend(dst){var h=dst.$$hashKey;return forEach(arguments,function(obj){obj!==dst&&forEach(obj,function(value,key){dst[key]=value})}),setHashKey(dst,h),dst}function int(str){return parseInt(str,10)}function inherit(parent,extra){return extend(new(extend(function(){},{prototype:parent})),extra)}function noop(){}function identity($){return $}function valueFn(value){return function(){return value}}function isUndefined(value){return"undefined"==typeof value}function isDefined(value){return"undefined"!=typeof value}function isObject(value){return null!=value&&"object"==typeof value}function isString(value){return"string"==typeof value}function isNumber(value){return"number"==typeof value}function isDate(value){return"[object Date]"===toString.call(value)}function isArray(value){return"[object Array]"===toString.call(value)}function isFunction(value){return"function"==typeof value}function isRegExp(value){return"[object RegExp]"===toString.call(value)}function isWindow(obj){return obj&&obj.document&&obj.location&&obj.alert&&obj.setInterval}function isScope(obj){return obj&&obj.$evalAsync&&obj.$watch}function isFile(obj){return"[object File]"===toString.call(obj)}function isElement(node){return!(!node||!(node.nodeName||node.prop&&node.attr&&node.find))}function map(obj,iterator,context){var results=[];return forEach(obj,function(value,index,list){results.push(iterator.call(context,value,index,list))}),results}function includes(array,obj){return-1!=indexOf(array,obj)}function indexOf(array,obj){if(array.indexOf)return array.indexOf(obj);for(var i=0;i<array.length;i++)if(obj===array[i])return i;return-1}function arrayRemove(array,value){var index=indexOf(array,value);return index>=0&&array.splice(index,1),value}function copy(source,destination){if(isWindow(source)||isScope(source))throw ngMinErr("cpws","Can't copy! Making copies of Window or Scope instances is not supported.");if(destination){if(source===destination)throw ngMinErr("cpi","Can't copy! Source and destination are identical.");if(isArray(source)){destination.length=0;for(var i=0;i<source.length;i++)destination.push(copy(source[i]))}else{var h=destination.$$hashKey;forEach(destination,function(value,key){delete destination[key]});for(var key in source)destination[key]=copy(source[key]);setHashKey(destination,h)}}else destination=source,source&&(isArray(source)?destination=copy(source,[]):isDate(source)?destination=new Date(source.getTime()):isRegExp(source)?destination=new RegExp(source.source):isObject(source)&&(destination=copy(source,{})));return destination}function shallowCopy(src,dst){dst=dst||{};for(var key in src)!src.hasOwnProperty(key)||"$"===key.charAt(0)&&"$"===key.charAt(1)||(dst[key]=src[key]);return dst}function equals(o1,o2){if(o1===o2)return!0;if(null===o1||null===o2)return!1;if(o1!==o1&&o2!==o2)return!0;var length,key,keySet,t1=typeof o1,t2=typeof o2;if(t1==t2&&"object"==t1){if(!isArray(o1)){if(isDate(o1))return isDate(o2)&&o1.getTime()==o2.getTime();if(isRegExp(o1)&&isRegExp(o2))return o1.toString()==o2.toString();if(isScope(o1)||isScope(o2)||isWindow(o1)||isWindow(o2)||isArray(o2))return!1;keySet={};for(key in o1)if("$"!==key.charAt(0)&&!isFunction(o1[key])){if(!equals(o1[key],o2[key]))return!1;keySet[key]=!0}for(key in o2)if(!keySet.hasOwnProperty(key)&&"$"!==key.charAt(0)&&o2[key]!==undefined&&!isFunction(o2[key]))return!1;return!0}if(!isArray(o2))return!1;if((length=o1.length)==o2.length){for(key=0;length>key;key++)if(!equals(o1[key],o2[key]))return!1;return!0}}return!1}function csp(){return document.securityPolicy&&document.securityPolicy.isActive||document.querySelector&&!(!document.querySelector("[ng-csp]")&&!document.querySelector("[data-ng-csp]"))}function concat(array1,array2,index){return array1.concat(slice.call(array2,index))}function sliceArgs(args,startIndex){return slice.call(args,startIndex||0)}function bind(self,fn){var curryArgs=arguments.length>2?sliceArgs(arguments,2):[];return!isFunction(fn)||fn instanceof RegExp?fn:curryArgs.length?function(){return arguments.length?fn.apply(self,curryArgs.concat(slice.call(arguments,0))):fn.apply(self,curryArgs)}:function(){return arguments.length?fn.apply(self,arguments):fn.call(self)}}function toJsonReplacer(key,value){var val=value;return"string"==typeof key&&"$"===key.charAt(0)?val=undefined:isWindow(value)?val="$WINDOW":value&&document===value?val="$DOCUMENT":isScope(value)&&(val="$SCOPE"),val}function toJson(obj,pretty){return"undefined"==typeof obj?undefined:JSON.stringify(obj,toJsonReplacer,pretty?"  ":null)}function fromJson(json){return isString(json)?JSON.parse(json):json}function toBoolean(value){if("function"==typeof value)value=!0;else if(value&&0!==value.length){var v=lowercase(""+value);value=!("f"==v||"0"==v||"false"==v||"no"==v||"n"==v||"[]"==v)}else value=!1;return value}function startingTag(element){element=jqLite(element).clone();try{element.empty()}catch(e){}var TEXT_NODE=3,elemHtml=jqLite("<div>").append(element).html();try{return element[0].nodeType===TEXT_NODE?lowercase(elemHtml):elemHtml.match(/^(<[^>]+>)/)[1].replace(/^<([\w\-]+)/,function(match,nodeName){return"<"+lowercase(nodeName)})}catch(e){return lowercase(elemHtml)}}function tryDecodeURIComponent(value){try{return decodeURIComponent(value)}catch(e){}}function parseKeyValue(keyValue){var key_value,key,obj={};return forEach((keyValue||"").split("&"),function(keyValue){if(keyValue&&(key_value=keyValue.split("="),key=tryDecodeURIComponent(key_value[0]),isDefined(key))){var val=isDefined(key_value[1])?tryDecodeURIComponent(key_value[1]):!0;obj[key]?isArray(obj[key])?obj[key].push(val):obj[key]=[obj[key],val]:obj[key]=val}}),obj}function toKeyValue(obj){var parts=[];return forEach(obj,function(value,key){isArray(value)?forEach(value,function(arrayValue){parts.push(encodeUriQuery(key,!0)+(arrayValue===!0?"":"="+encodeUriQuery(arrayValue,!0)))}):parts.push(encodeUriQuery(key,!0)+(value===!0?"":"="+encodeUriQuery(value,!0)))}),parts.length?parts.join("&"):""}function encodeUriSegment(val){return encodeUriQuery(val,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function encodeUriQuery(val,pctEncodeSpaces){return encodeURIComponent(val).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,pctEncodeSpaces?"%20":"+")}function angularInit(element,bootstrap){function append(element){element&&elements.push(element)}var appElement,module,elements=[element],names=["ng:app","ng-app","x-ng-app","data-ng-app"],NG_APP_CLASS_REGEXP=/\sng[:\-]app(:\s*([\w\d_]+);?)?\s/;forEach(names,function(name){names[name]=!0,append(document.getElementById(name)),name=name.replace(":","\\:"),element.querySelectorAll&&(forEach(element.querySelectorAll("."+name),append),forEach(element.querySelectorAll("."+name+"\\:"),append),forEach(element.querySelectorAll("["+name+"]"),append))}),forEach(elements,function(element){if(!appElement){var className=" "+element.className+" ",match=NG_APP_CLASS_REGEXP.exec(className);match?(appElement=element,module=(match[2]||"").replace(/\s+/g,",")):forEach(element.attributes,function(attr){!appElement&&names[attr.name]&&(appElement=element,module=attr.value)})}}),appElement&&bootstrap(appElement,module?[module]:[])}function bootstrap(element,modules){var doBootstrap=function(){if(element=jqLite(element),element.injector()){var tag=element[0]===document?"document":startingTag(element);throw ngMinErr("btstrpd","App Already Bootstrapped with this Element '{0}'",tag)}modules=modules||[],modules.unshift(["$provide",function($provide){$provide.value("$rootElement",element)}]),modules.unshift("ng");var injector=createInjector(modules);return injector.invoke(["$rootScope","$rootElement","$compile","$injector","$animate",function(scope,element,compile,injector){scope.$apply(function(){element.data("$injector",injector),compile(element)(scope)})}]),injector},NG_DEFER_BOOTSTRAP=/^NG_DEFER_BOOTSTRAP!/;return window&&!NG_DEFER_BOOTSTRAP.test(window.name)?doBootstrap():(window.name=window.name.replace(NG_DEFER_BOOTSTRAP,""),angular.resumeBootstrap=function(extraModules){forEach(extraModules,function(module){modules.push(module)}),doBootstrap()},void 0)}function snake_case(name,separator){return separator=separator||"_",name.replace(SNAKE_CASE_REGEXP,function(letter,pos){return(pos?separator:"")+letter.toLowerCase()})}function bindJQuery(){jQuery=window.jQuery,jQuery?(jqLite=jQuery,extend(jQuery.fn,{scope:JQLitePrototype.scope,isolateScope:JQLitePrototype.isolateScope,controller:JQLitePrototype.controller,injector:JQLitePrototype.injector,inheritedData:JQLitePrototype.inheritedData}),jqLitePatchJQueryRemove("remove",!0,!0,!1),jqLitePatchJQueryRemove("empty",!1,!1,!1),jqLitePatchJQueryRemove("html",!1,!1,!0)):jqLite=JQLite,angular.element=jqLite}function assertArg(arg,name,reason){if(!arg)throw ngMinErr("areq","Argument '{0}' is {1}",name||"?",reason||"required");return arg}function assertArgFn(arg,name,acceptArrayAnnotation){return acceptArrayAnnotation&&isArray(arg)&&(arg=arg[arg.length-1]),assertArg(isFunction(arg),name,"not a function, got "+(arg&&"object"==typeof arg?arg.constructor.name||"Object":typeof arg)),arg}function assertNotHasOwnProperty(name,context){if("hasOwnProperty"===name)throw ngMinErr("badname","hasOwnProperty is not a valid {0} name",context)}function getter(obj,path,bindFnToScope){if(!path)return obj;for(var key,keys=path.split("."),lastInstance=obj,len=keys.length,i=0;len>i;i++)key=keys[i],obj&&(obj=(lastInstance=obj)[key]);return!bindFnToScope&&isFunction(obj)?bind(lastInstance,obj):obj}function getBlockElements(nodes){var startNode=nodes[0],endNode=nodes[nodes.length-1];if(startNode===endNode)return jqLite(startNode);var element=startNode,elements=[element];do{if(element=element.nextSibling,!element)break;elements.push(element)}while(element!==endNode);return jqLite(elements)
}function setupModuleLoader(window){function ensure(obj,name,factory){return obj[name]||(obj[name]=factory())}var $injectorMinErr=minErr("$injector"),ngMinErr=minErr("ng"),angular=ensure(window,"angular",Object);return angular.$$minErr=angular.$$minErr||minErr,ensure(angular,"module",function(){var modules={};return function(name,requires,configFn){var assertNotHasOwnProperty=function(name,context){if("hasOwnProperty"===name)throw ngMinErr("badname","hasOwnProperty is not a valid {0} name",context)};return assertNotHasOwnProperty(name,"module"),requires&&modules.hasOwnProperty(name)&&(modules[name]=null),ensure(modules,name,function(){function invokeLater(provider,method,insertMethod){return function(){return invokeQueue[insertMethod||"push"]([provider,method,arguments]),moduleInstance}}if(!requires)throw $injectorMinErr("nomod","Module '{0}' is not available! You either misspelled the module name or forgot to load it. If registering a module ensure that you specify the dependencies as the second argument.",name);var invokeQueue=[],runBlocks=[],config=invokeLater("$injector","invoke"),moduleInstance={_invokeQueue:invokeQueue,_runBlocks:runBlocks,requires:requires,name:name,provider:invokeLater("$provide","provider"),factory:invokeLater("$provide","factory"),service:invokeLater("$provide","service"),value:invokeLater("$provide","value"),constant:invokeLater("$provide","constant","unshift"),animation:invokeLater("$animateProvider","register"),filter:invokeLater("$filterProvider","register"),controller:invokeLater("$controllerProvider","register"),directive:invokeLater("$compileProvider","directive"),config:config,run:function(block){return runBlocks.push(block),this}};return configFn&&config(configFn),moduleInstance})}})}function publishExternalAPI(angular){extend(angular,{bootstrap:bootstrap,copy:copy,extend:extend,equals:equals,element:jqLite,forEach:forEach,injector:createInjector,noop:noop,bind:bind,toJson:toJson,fromJson:fromJson,identity:identity,isUndefined:isUndefined,isDefined:isDefined,isString:isString,isFunction:isFunction,isObject:isObject,isNumber:isNumber,isElement:isElement,isArray:isArray,version:version,isDate:isDate,lowercase:lowercase,uppercase:uppercase,callbacks:{counter:0},$$minErr:minErr,$$csp:csp}),angularModule=setupModuleLoader(window);try{angularModule("ngLocale")}catch(e){angularModule("ngLocale",[]).provider("$locale",$LocaleProvider)}angularModule("ng",["ngLocale"],["$provide",function($provide){$provide.provider({$$sanitizeUri:$$SanitizeUriProvider}),$provide.provider("$compile",$CompileProvider).directive({a:htmlAnchorDirective,input:inputDirective,textarea:inputDirective,form:formDirective,script:scriptDirective,select:selectDirective,style:styleDirective,option:optionDirective,ngBind:ngBindDirective,ngBindHtml:ngBindHtmlDirective,ngBindTemplate:ngBindTemplateDirective,ngClass:ngClassDirective,ngClassEven:ngClassEvenDirective,ngClassOdd:ngClassOddDirective,ngCloak:ngCloakDirective,ngController:ngControllerDirective,ngForm:ngFormDirective,ngHide:ngHideDirective,ngIf:ngIfDirective,ngInclude:ngIncludeDirective,ngInit:ngInitDirective,ngNonBindable:ngNonBindableDirective,ngPluralize:ngPluralizeDirective,ngRepeat:ngRepeatDirective,ngShow:ngShowDirective,ngStyle:ngStyleDirective,ngSwitch:ngSwitchDirective,ngSwitchWhen:ngSwitchWhenDirective,ngSwitchDefault:ngSwitchDefaultDirective,ngOptions:ngOptionsDirective,ngTransclude:ngTranscludeDirective,ngModel:ngModelDirective,ngList:ngListDirective,ngChange:ngChangeDirective,required:requiredDirective,ngRequired:requiredDirective,ngValue:ngValueDirective}).directive({ngInclude:ngIncludeFillContentDirective}).directive(ngAttributeAliasDirectives).directive(ngEventDirectives),$provide.provider({$anchorScroll:$AnchorScrollProvider,$animate:$AnimateProvider,$browser:$BrowserProvider,$cacheFactory:$CacheFactoryProvider,$controller:$ControllerProvider,$document:$DocumentProvider,$exceptionHandler:$ExceptionHandlerProvider,$filter:$FilterProvider,$interpolate:$InterpolateProvider,$interval:$IntervalProvider,$http:$HttpProvider,$httpBackend:$HttpBackendProvider,$location:$LocationProvider,$log:$LogProvider,$parse:$ParseProvider,$rootScope:$RootScopeProvider,$q:$QProvider,$sce:$SceProvider,$sceDelegate:$SceDelegateProvider,$sniffer:$SnifferProvider,$templateCache:$TemplateCacheProvider,$timeout:$TimeoutProvider,$window:$WindowProvider,$$rAF:$$RAFProvider,$$asyncCallback:$$AsyncCallbackProvider})}])}function jqNextId(){return++jqId}function camelCase(name){return name.replace(SPECIAL_CHARS_REGEXP,function(_,separator,letter,offset){return offset?letter.toUpperCase():letter}).replace(MOZ_HACK_REGEXP,"Moz$1")}function jqLitePatchJQueryRemove(name,dispatchThis,filterElems,getterIfNoArguments){function removePatch(param){var set,setIndex,setLength,element,childIndex,childLength,children,list=filterElems&&param?[this.filter(param)]:[this],fireEvent=dispatchThis;if(!getterIfNoArguments||null!=param)for(;list.length;)for(set=list.shift(),setIndex=0,setLength=set.length;setLength>setIndex;setIndex++)for(element=jqLite(set[setIndex]),fireEvent?element.triggerHandler("$destroy"):fireEvent=!fireEvent,childIndex=0,childLength=(children=element.children()).length;childLength>childIndex;childIndex++)list.push(jQuery(children[childIndex]));return originalJqFn.apply(this,arguments)}var originalJqFn=jQuery.fn[name];originalJqFn=originalJqFn.$original||originalJqFn,removePatch.$original=originalJqFn,jQuery.fn[name]=removePatch}function JQLite(element){if(element instanceof JQLite)return element;if(isString(element)&&(element=trim(element)),!(this instanceof JQLite)){if(isString(element)&&"<"!=element.charAt(0))throw jqLiteMinErr("nosel","Looking up elements via selectors is not supported by jqLite! See: http://docs.angularjs.org/api/angular.element");return new JQLite(element)}if(isString(element)){var div=document.createElement("div");div.innerHTML="<div>&#160;</div>"+element,div.removeChild(div.firstChild),jqLiteAddNodes(this,div.childNodes);var fragment=jqLite(document.createDocumentFragment());fragment.append(this)}else jqLiteAddNodes(this,element)}function jqLiteClone(element){return element.cloneNode(!0)}function jqLiteDealoc(element){jqLiteRemoveData(element);for(var i=0,children=element.childNodes||[];i<children.length;i++)jqLiteDealoc(children[i])}function jqLiteOff(element,type,fn,unsupported){if(isDefined(unsupported))throw jqLiteMinErr("offargs","jqLite#off() does not support the `selector` argument");var events=jqLiteExpandoStore(element,"events"),handle=jqLiteExpandoStore(element,"handle");handle&&(isUndefined(type)?forEach(events,function(eventHandler,type){removeEventListenerFn(element,type,eventHandler),delete events[type]}):forEach(type.split(" "),function(type){isUndefined(fn)?(removeEventListenerFn(element,type,events[type]),delete events[type]):arrayRemove(events[type]||[],fn)}))}function jqLiteRemoveData(element,name){var expandoId=element[jqName],expandoStore=jqCache[expandoId];if(expandoStore){if(name)return delete jqCache[expandoId].data[name],void 0;expandoStore.handle&&(expandoStore.events.$destroy&&expandoStore.handle({},"$destroy"),jqLiteOff(element)),delete jqCache[expandoId],element[jqName]=undefined}}function jqLiteExpandoStore(element,key,value){var expandoId=element[jqName],expandoStore=jqCache[expandoId||-1];return isDefined(value)?(expandoStore||(element[jqName]=expandoId=jqNextId(),expandoStore=jqCache[expandoId]={}),expandoStore[key]=value,void 0):expandoStore&&expandoStore[key]}function jqLiteData(element,key,value){var data=jqLiteExpandoStore(element,"data"),isSetter=isDefined(value),keyDefined=!isSetter&&isDefined(key),isSimpleGetter=keyDefined&&!isObject(key);if(data||isSimpleGetter||jqLiteExpandoStore(element,"data",data={}),isSetter)data[key]=value;else{if(!keyDefined)return data;if(isSimpleGetter)return data&&data[key];extend(data,key)}}function jqLiteHasClass(element,selector){return element.getAttribute?(" "+(element.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").indexOf(" "+selector+" ")>-1:!1}function jqLiteRemoveClass(element,cssClasses){cssClasses&&element.setAttribute&&forEach(cssClasses.split(" "),function(cssClass){element.setAttribute("class",trim((" "+(element.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").replace(" "+trim(cssClass)+" "," ")))})}function jqLiteAddClass(element,cssClasses){if(cssClasses&&element.setAttribute){var existingClasses=(" "+(element.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ");forEach(cssClasses.split(" "),function(cssClass){cssClass=trim(cssClass),-1===existingClasses.indexOf(" "+cssClass+" ")&&(existingClasses+=cssClass+" ")}),element.setAttribute("class",trim(existingClasses))}}function jqLiteAddNodes(root,elements){if(elements){elements=elements.nodeName||!isDefined(elements.length)||isWindow(elements)?[elements]:elements;for(var i=0;i<elements.length;i++)root.push(elements[i])}}function jqLiteController(element,name){return jqLiteInheritedData(element,"$"+(name||"ngController")+"Controller")}function jqLiteInheritedData(element,name,value){element=jqLite(element),9==element[0].nodeType&&(element=element.find("html"));for(var names=isArray(name)?name:[name];element.length;){for(var i=0,ii=names.length;ii>i;i++)if((value=element.data(names[i]))!==undefined)return value;element=element.parent()}}function jqLiteEmpty(element){for(var i=0,childNodes=element.childNodes;i<childNodes.length;i++)jqLiteDealoc(childNodes[i]);for(;element.firstChild;)element.removeChild(element.firstChild)}function getBooleanAttrName(element,name){var booleanAttr=BOOLEAN_ATTR[name.toLowerCase()];return booleanAttr&&BOOLEAN_ELEMENTS[element.nodeName]&&booleanAttr}function createEventHandler(element,events){var eventHandler=function(event,type){if(event.preventDefault||(event.preventDefault=function(){event.returnValue=!1}),event.stopPropagation||(event.stopPropagation=function(){event.cancelBubble=!0}),event.target||(event.target=event.srcElement||document),isUndefined(event.defaultPrevented)){var prevent=event.preventDefault;event.preventDefault=function(){event.defaultPrevented=!0,prevent.call(event)},event.defaultPrevented=!1}event.isDefaultPrevented=function(){return event.defaultPrevented||event.returnValue===!1};var eventHandlersCopy=shallowCopy(events[type||event.type]||[]);forEach(eventHandlersCopy,function(fn){fn.call(element,event)}),8>=msie?(event.preventDefault=null,event.stopPropagation=null,event.isDefaultPrevented=null):(delete event.preventDefault,delete event.stopPropagation,delete event.isDefaultPrevented)};return eventHandler.elem=element,eventHandler}function hashKey(obj){var key,objType=typeof obj;return"object"==objType&&null!==obj?"function"==typeof(key=obj.$$hashKey)?key=obj.$$hashKey():key===undefined&&(key=obj.$$hashKey=nextUid()):key=obj,objType+":"+key}function HashMap(array){forEach(array,this.put,this)}function annotate(fn){var $inject,fnText,argDecl,last;return"function"==typeof fn?($inject=fn.$inject)||($inject=[],fn.length&&(fnText=fn.toString().replace(STRIP_COMMENTS,""),argDecl=fnText.match(FN_ARGS),forEach(argDecl[1].split(FN_ARG_SPLIT),function(arg){arg.replace(FN_ARG,function(all,underscore,name){$inject.push(name)})})),fn.$inject=$inject):isArray(fn)?(last=fn.length-1,assertArgFn(fn[last],"fn"),$inject=fn.slice(0,last)):assertArgFn(fn,"fn",!0),$inject}function createInjector(modulesToLoad){function supportObject(delegate){return function(key,value){return isObject(key)?(forEach(key,reverseParams(delegate)),void 0):delegate(key,value)}}function provider(name,provider_){if(assertNotHasOwnProperty(name,"service"),(isFunction(provider_)||isArray(provider_))&&(provider_=providerInjector.instantiate(provider_)),!provider_.$get)throw $injectorMinErr("pget","Provider '{0}' must define $get factory method.",name);return providerCache[name+providerSuffix]=provider_}function factory(name,factoryFn){return provider(name,{$get:factoryFn})}function service(name,constructor){return factory(name,["$injector",function($injector){return $injector.instantiate(constructor)}])}function value(name,val){return factory(name,valueFn(val))}function constant(name,value){assertNotHasOwnProperty(name,"constant"),providerCache[name]=value,instanceCache[name]=value}function decorator(serviceName,decorFn){var origProvider=providerInjector.get(serviceName+providerSuffix),orig$get=origProvider.$get;origProvider.$get=function(){var origInstance=instanceInjector.invoke(orig$get,origProvider);return instanceInjector.invoke(decorFn,null,{$delegate:origInstance})}}function loadModules(modulesToLoad){var moduleFn,invokeQueue,i,ii,runBlocks=[];return forEach(modulesToLoad,function(module){if(!loadedModules.get(module)){loadedModules.put(module,!0);try{if(isString(module))for(moduleFn=angularModule(module),runBlocks=runBlocks.concat(loadModules(moduleFn.requires)).concat(moduleFn._runBlocks),invokeQueue=moduleFn._invokeQueue,i=0,ii=invokeQueue.length;ii>i;i++){var invokeArgs=invokeQueue[i],provider=providerInjector.get(invokeArgs[0]);provider[invokeArgs[1]].apply(provider,invokeArgs[2])}else isFunction(module)?runBlocks.push(providerInjector.invoke(module)):isArray(module)?runBlocks.push(providerInjector.invoke(module)):assertArgFn(module,"module")}catch(e){throw isArray(module)&&(module=module[module.length-1]),e.message&&e.stack&&-1==e.stack.indexOf(e.message)&&(e=e.message+"\n"+e.stack),$injectorMinErr("modulerr","Failed to instantiate module {0} due to:\n{1}",module,e.stack||e.message||e)}}}),runBlocks}function createInternalInjector(cache,factory){function getService(serviceName){if(cache.hasOwnProperty(serviceName)){if(cache[serviceName]===INSTANTIATING)throw $injectorMinErr("cdep","Circular dependency found: {0}",path.join(" <- "));return cache[serviceName]}try{return path.unshift(serviceName),cache[serviceName]=INSTANTIATING,cache[serviceName]=factory(serviceName)}catch(err){throw cache[serviceName]===INSTANTIATING&&delete cache[serviceName],err}finally{path.shift()}}function invoke(fn,self,locals){var length,i,key,args=[],$inject=annotate(fn);for(i=0,length=$inject.length;length>i;i++){if(key=$inject[i],"string"!=typeof key)throw $injectorMinErr("itkn","Incorrect injection token! Expected service name as string, got {0}",key);args.push(locals&&locals.hasOwnProperty(key)?locals[key]:getService(key))}return fn.$inject||(fn=fn[length]),fn.apply(self,args)}function instantiate(Type,locals){var instance,returnedValue,Constructor=function(){};return Constructor.prototype=(isArray(Type)?Type[Type.length-1]:Type).prototype,instance=new Constructor,returnedValue=invoke(Type,instance,locals),isObject(returnedValue)||isFunction(returnedValue)?returnedValue:instance}return{invoke:invoke,instantiate:instantiate,get:getService,annotate:annotate,has:function(name){return providerCache.hasOwnProperty(name+providerSuffix)||cache.hasOwnProperty(name)}}}var INSTANTIATING={},providerSuffix="Provider",path=[],loadedModules=new HashMap,providerCache={$provide:{provider:supportObject(provider),factory:supportObject(factory),service:supportObject(service),value:supportObject(value),constant:supportObject(constant),decorator:decorator}},providerInjector=providerCache.$injector=createInternalInjector(providerCache,function(){throw $injectorMinErr("unpr","Unknown provider: {0}",path.join(" <- "))}),instanceCache={},instanceInjector=instanceCache.$injector=createInternalInjector(instanceCache,function(servicename){var provider=providerInjector.get(servicename+providerSuffix);return instanceInjector.invoke(provider.$get,provider)});return forEach(loadModules(modulesToLoad),function(fn){instanceInjector.invoke(fn||noop)}),instanceInjector}function $AnchorScrollProvider(){var autoScrollingEnabled=!0;this.disableAutoScrolling=function(){autoScrollingEnabled=!1},this.$get=["$window","$location","$rootScope",function($window,$location,$rootScope){function getFirstAnchor(list){var result=null;return forEach(list,function(element){result||"a"!==lowercase(element.nodeName)||(result=element)}),result}function scroll(){var elm,hash=$location.hash();hash?(elm=document.getElementById(hash))?elm.scrollIntoView():(elm=getFirstAnchor(document.getElementsByName(hash)))?elm.scrollIntoView():"top"===hash&&$window.scrollTo(0,0):$window.scrollTo(0,0)}var document=$window.document;return autoScrollingEnabled&&$rootScope.$watch(function(){return $location.hash()},function(){$rootScope.$evalAsync(scroll)}),scroll}]}function $$AsyncCallbackProvider(){this.$get=["$$rAF","$timeout",function($$rAF,$timeout){return $$rAF.supported?function(fn){return $$rAF(fn)}:function(fn){return $timeout(fn,0,!1)}}]}function Browser(window,document,$log,$sniffer){function completeOutstandingRequest(fn){try{fn.apply(null,sliceArgs(arguments,1))}finally{if(outstandingRequestCount--,0===outstandingRequestCount)for(;outstandingRequestCallbacks.length;)try{outstandingRequestCallbacks.pop()()}catch(e){$log.error(e)}}}function startPoller(interval,setTimeout){!function check(){forEach(pollFns,function(pollFn){pollFn()}),pollTimeout=setTimeout(check,interval)}()}function fireUrlChange(){newLocation=null,lastBrowserUrl!=self.url()&&(lastBrowserUrl=self.url(),forEach(urlChangeListeners,function(listener){listener(self.url())}))}var self=this,rawDocument=document[0],location=window.location,history=window.history,setTimeout=window.setTimeout,clearTimeout=window.clearTimeout,pendingDeferIds={};self.isMock=!1;var outstandingRequestCount=0,outstandingRequestCallbacks=[];self.$$completeOutstandingRequest=completeOutstandingRequest,self.$$incOutstandingRequestCount=function(){outstandingRequestCount++},self.notifyWhenNoOutstandingRequests=function(callback){forEach(pollFns,function(pollFn){pollFn()}),0===outstandingRequestCount?callback():outstandingRequestCallbacks.push(callback)};var pollTimeout,pollFns=[];self.addPollFn=function(fn){return isUndefined(pollTimeout)&&startPoller(100,setTimeout),pollFns.push(fn),fn};var lastBrowserUrl=location.href,baseElement=document.find("base"),newLocation=null;self.url=function(url,replace){if(location!==window.location&&(location=window.location),history!==window.history&&(history=window.history),url){if(lastBrowserUrl==url)return;return lastBrowserUrl=url,$sniffer.history?replace?history.replaceState(null,"",url):(history.pushState(null,"",url),baseElement.attr("href",baseElement.attr("href"))):(newLocation=url,replace?location.replace(url):location.href=url),self}return newLocation||location.href.replace(/%27/g,"'")};var urlChangeListeners=[],urlChangeInit=!1;self.onUrlChange=function(callback){return urlChangeInit||($sniffer.history&&jqLite(window).on("popstate",fireUrlChange),$sniffer.hashchange?jqLite(window).on("hashchange",fireUrlChange):self.addPollFn(fireUrlChange),urlChangeInit=!0),urlChangeListeners.push(callback),callback},self.baseHref=function(){var href=baseElement.attr("href");return href?href.replace(/^(https?\:)?\/\/[^\/]*/,""):""};var lastCookies={},lastCookieString="",cookiePath=self.baseHref();self.cookies=function(name,value){var cookieLength,cookieArray,cookie,i,index;if(!name){if(rawDocument.cookie!==lastCookieString)for(lastCookieString=rawDocument.cookie,cookieArray=lastCookieString.split("; "),lastCookies={},i=0;i<cookieArray.length;i++)cookie=cookieArray[i],index=cookie.indexOf("="),index>0&&(name=unescape(cookie.substring(0,index)),lastCookies[name]===undefined&&(lastCookies[name]=unescape(cookie.substring(index+1))));return lastCookies}value===undefined?rawDocument.cookie=escape(name)+"=;path="+cookiePath+";expires=Thu, 01 Jan 1970 00:00:00 GMT":isString(value)&&(cookieLength=(rawDocument.cookie=escape(name)+"="+escape(value)+";path="+cookiePath).length+1,cookieLength>4096&&$log.warn("Cookie '"+name+"' possibly not set or overflowed because it was too large ("+cookieLength+" > 4096 bytes)!"))},self.defer=function(fn,delay){var timeoutId;return outstandingRequestCount++,timeoutId=setTimeout(function(){delete pendingDeferIds[timeoutId],completeOutstandingRequest(fn)},delay||0),pendingDeferIds[timeoutId]=!0,timeoutId},self.defer.cancel=function(deferId){return pendingDeferIds[deferId]?(delete pendingDeferIds[deferId],clearTimeout(deferId),completeOutstandingRequest(noop),!0):!1}}function $BrowserProvider(){this.$get=["$window","$log","$sniffer","$document",function($window,$log,$sniffer,$document){return new Browser($window,$document,$log,$sniffer)}]}function $CacheFactoryProvider(){this.$get=function(){function cacheFactory(cacheId,options){function refresh(entry){entry!=freshEnd&&(staleEnd?staleEnd==entry&&(staleEnd=entry.n):staleEnd=entry,link(entry.n,entry.p),link(entry,freshEnd),freshEnd=entry,freshEnd.n=null)}function link(nextEntry,prevEntry){nextEntry!=prevEntry&&(nextEntry&&(nextEntry.p=prevEntry),prevEntry&&(prevEntry.n=nextEntry))}if(cacheId in caches)throw minErr("$cacheFactory")("iid","CacheId '{0}' is already taken!",cacheId);var size=0,stats=extend({},options,{id:cacheId}),data={},capacity=options&&options.capacity||Number.MAX_VALUE,lruHash={},freshEnd=null,staleEnd=null;return caches[cacheId]={put:function(key,value){if(capacity<Number.MAX_VALUE){var lruEntry=lruHash[key]||(lruHash[key]={key:key});refresh(lruEntry)}if(!isUndefined(value))return key in data||size++,data[key]=value,size>capacity&&this.remove(staleEnd.key),value},get:function(key){if(capacity<Number.MAX_VALUE){var lruEntry=lruHash[key];if(!lruEntry)return;refresh(lruEntry)}return data[key]},remove:function(key){if(capacity<Number.MAX_VALUE){var lruEntry=lruHash[key];if(!lruEntry)return;lruEntry==freshEnd&&(freshEnd=lruEntry.p),lruEntry==staleEnd&&(staleEnd=lruEntry.n),link(lruEntry.n,lruEntry.p),delete lruHash[key]}delete data[key],size--},removeAll:function(){data={},size=0,lruHash={},freshEnd=staleEnd=null},destroy:function(){data=null,stats=null,lruHash=null,delete caches[cacheId]},info:function(){return extend({},stats,{size:size})}}}var caches={};return cacheFactory.info=function(){var info={};return forEach(caches,function(cache,cacheId){info[cacheId]=cache.info()}),info},cacheFactory.get=function(cacheId){return caches[cacheId]},cacheFactory}}function $TemplateCacheProvider(){this.$get=["$cacheFactory",function($cacheFactory){return $cacheFactory("templates")}]}function $CompileProvider($provide,$$sanitizeUriProvider){var hasDirectives={},Suffix="Directive",COMMENT_DIRECTIVE_REGEXP=/^\s*directive\:\s*([\d\w\-_]+)\s+(.*)$/,CLASS_DIRECTIVE_REGEXP=/(([\d\w\-_]+)(?:\:([^;]+))?;?)/,TABLE_CONTENT_REGEXP=/^<\s*(tr|th|td|tbody)(\s+[^>]*)?>/i,EVENT_HANDLER_ATTR_REGEXP=/^(on[a-z]+|formaction)$/;this.directive=function registerDirective(name,directiveFactory){return assertNotHasOwnProperty(name,"directive"),isString(name)?(assertArg(directiveFactory,"directiveFactory"),hasDirectives.hasOwnProperty(name)||(hasDirectives[name]=[],$provide.factory(name+Suffix,["$injector","$exceptionHandler",function($injector,$exceptionHandler){var directives=[];return forEach(hasDirectives[name],function(directiveFactory,index){try{var directive=$injector.invoke(directiveFactory);isFunction(directive)?directive={compile:valueFn(directive)}:!directive.compile&&directive.link&&(directive.compile=valueFn(directive.link)),directive.priority=directive.priority||0,directive.index=index,directive.name=directive.name||name,directive.require=directive.require||directive.controller&&directive.name,directive.restrict=directive.restrict||"A",directives.push(directive)}catch(e){$exceptionHandler(e)}}),directives}])),hasDirectives[name].push(directiveFactory)):forEach(name,reverseParams(registerDirective)),this},this.aHrefSanitizationWhitelist=function(regexp){return isDefined(regexp)?($$sanitizeUriProvider.aHrefSanitizationWhitelist(regexp),this):$$sanitizeUriProvider.aHrefSanitizationWhitelist()},this.imgSrcSanitizationWhitelist=function(regexp){return isDefined(regexp)?($$sanitizeUriProvider.imgSrcSanitizationWhitelist(regexp),this):$$sanitizeUriProvider.imgSrcSanitizationWhitelist()},this.$get=["$injector","$interpolate","$exceptionHandler","$http","$templateCache","$parse","$controller","$rootScope","$document","$sce","$animate","$$sanitizeUri",function($injector,$interpolate,$exceptionHandler,$http,$templateCache,$parse,$controller,$rootScope,$document,$sce,$animate,$$sanitizeUri){function compile($compileNodes,transcludeFn,maxPriority,ignoreDirective,previousCompileContext){$compileNodes instanceof jqLite||($compileNodes=jqLite($compileNodes)),forEach($compileNodes,function(node,index){3==node.nodeType&&node.nodeValue.match(/\S+/)&&($compileNodes[index]=node=jqLite(node).wrap("<span></span>").parent()[0])});var compositeLinkFn=compileNodes($compileNodes,transcludeFn,$compileNodes,maxPriority,ignoreDirective,previousCompileContext);return safeAddClass($compileNodes,"ng-scope"),function(scope,cloneConnectFn,transcludeControllers){assertArg(scope,"scope");var $linkNode=cloneConnectFn?JQLitePrototype.clone.call($compileNodes):$compileNodes;forEach(transcludeControllers,function(instance,name){$linkNode.data("$"+name+"Controller",instance)});for(var i=0,ii=$linkNode.length;ii>i;i++){var node=$linkNode[i],nodeType=node.nodeType;(1===nodeType||9===nodeType)&&$linkNode.eq(i).data("$scope",scope)}return cloneConnectFn&&cloneConnectFn($linkNode,scope),compositeLinkFn&&compositeLinkFn(scope,$linkNode,$linkNode),$linkNode}}function safeAddClass($element,className){try{$element.addClass(className)}catch(e){}}function compileNodes(nodeList,transcludeFn,$rootElement,maxPriority,ignoreDirective,previousCompileContext){function compositeLinkFn(scope,nodeList,$rootElement,boundTranscludeFn){var nodeLinkFn,childLinkFn,node,$node,childScope,childTranscludeFn,i,ii,n,nodeListLength=nodeList.length,stableNodeList=new Array(nodeListLength);for(i=0;nodeListLength>i;i++)stableNodeList[i]=nodeList[i];for(i=0,n=0,ii=linkFns.length;ii>i;n++)node=stableNodeList[n],nodeLinkFn=linkFns[i++],childLinkFn=linkFns[i++],$node=jqLite(node),nodeLinkFn?(nodeLinkFn.scope?(childScope=scope.$new(),$node.data("$scope",childScope)):childScope=scope,childTranscludeFn=nodeLinkFn.transclude,childTranscludeFn||!boundTranscludeFn&&transcludeFn?nodeLinkFn(childLinkFn,childScope,node,$rootElement,createBoundTranscludeFn(scope,childTranscludeFn||transcludeFn)):nodeLinkFn(childLinkFn,childScope,node,$rootElement,boundTranscludeFn)):childLinkFn&&childLinkFn(scope,node.childNodes,undefined,boundTranscludeFn)}for(var attrs,directives,nodeLinkFn,childNodes,childLinkFn,linkFnFound,linkFns=[],i=0;i<nodeList.length;i++)attrs=new Attributes,directives=collectDirectives(nodeList[i],[],attrs,0===i?maxPriority:undefined,ignoreDirective),nodeLinkFn=directives.length?applyDirectivesToNode(directives,nodeList[i],attrs,transcludeFn,$rootElement,null,[],[],previousCompileContext):null,nodeLinkFn&&nodeLinkFn.scope&&safeAddClass(jqLite(nodeList[i]),"ng-scope"),childLinkFn=nodeLinkFn&&nodeLinkFn.terminal||!(childNodes=nodeList[i].childNodes)||!childNodes.length?null:compileNodes(childNodes,nodeLinkFn?nodeLinkFn.transclude:transcludeFn),linkFns.push(nodeLinkFn,childLinkFn),linkFnFound=linkFnFound||nodeLinkFn||childLinkFn,previousCompileContext=null;return linkFnFound?compositeLinkFn:null}function createBoundTranscludeFn(scope,transcludeFn){return function(transcludedScope,cloneFn,controllers){var scopeCreated=!1;transcludedScope||(transcludedScope=scope.$new(),transcludedScope.$$transcluded=!0,scopeCreated=!0);var clone=transcludeFn(transcludedScope,cloneFn,controllers);return scopeCreated&&clone.on("$destroy",bind(transcludedScope,transcludedScope.$destroy)),clone}}function collectDirectives(node,directives,attrs,maxPriority,ignoreDirective){var match,className,nodeType=node.nodeType,attrsMap=attrs.$attr;switch(nodeType){case 1:addDirective(directives,directiveNormalize(nodeName_(node).toLowerCase()),"E",maxPriority,ignoreDirective);for(var attr,name,nName,ngAttrName,value,nAttrs=node.attributes,j=0,jj=nAttrs&&nAttrs.length;jj>j;j++){var attrStartName=!1,attrEndName=!1;if(attr=nAttrs[j],!msie||msie>=8||attr.specified){name=attr.name,ngAttrName=directiveNormalize(name),NG_ATTR_BINDING.test(ngAttrName)&&(name=snake_case(ngAttrName.substr(6),"-"));var directiveNName=ngAttrName.replace(/(Start|End)$/,"");ngAttrName===directiveNName+"Start"&&(attrStartName=name,attrEndName=name.substr(0,name.length-5)+"end",name=name.substr(0,name.length-6)),nName=directiveNormalize(name.toLowerCase()),attrsMap[nName]=name,attrs[nName]=value=trim(attr.value),getBooleanAttrName(node,nName)&&(attrs[nName]=!0),addAttrInterpolateDirective(node,directives,value,nName),addDirective(directives,nName,"A",maxPriority,ignoreDirective,attrStartName,attrEndName)}}if(className=node.className,isString(className)&&""!==className)for(;match=CLASS_DIRECTIVE_REGEXP.exec(className);)nName=directiveNormalize(match[2]),addDirective(directives,nName,"C",maxPriority,ignoreDirective)&&(attrs[nName]=trim(match[3])),className=className.substr(match.index+match[0].length);break;case 3:addTextInterpolateDirective(directives,node.nodeValue);break;case 8:try{match=COMMENT_DIRECTIVE_REGEXP.exec(node.nodeValue),match&&(nName=directiveNormalize(match[1]),addDirective(directives,nName,"M",maxPriority,ignoreDirective)&&(attrs[nName]=trim(match[2])))}catch(e){}}return directives.sort(byPriority),directives}function groupScan(node,attrStart,attrEnd){var nodes=[],depth=0;if(attrStart&&node.hasAttribute&&node.hasAttribute(attrStart)){do{if(!node)throw $compileMinErr("uterdir","Unterminated attribute, found '{0}' but no matching '{1}' found.",attrStart,attrEnd);1==node.nodeType&&(node.hasAttribute(attrStart)&&depth++,node.hasAttribute(attrEnd)&&depth--),nodes.push(node),node=node.nextSibling}while(depth>0)}else nodes.push(node);return jqLite(nodes)}function groupElementsLinkFnWrapper(linkFn,attrStart,attrEnd){return function(scope,element,attrs,controllers,transcludeFn){return element=groupScan(element[0],attrStart,attrEnd),linkFn(scope,element,attrs,controllers,transcludeFn)}}function applyDirectivesToNode(directives,compileNode,templateAttrs,transcludeFn,jqCollection,originalReplaceDirective,preLinkFns,postLinkFns,previousCompileContext){function addLinkFns(pre,post,attrStart,attrEnd){pre&&(attrStart&&(pre=groupElementsLinkFnWrapper(pre,attrStart,attrEnd)),pre.require=directive.require,(newIsolateScopeDirective===directive||directive.$$isolateScope)&&(pre=cloneAndAnnotateFn(pre,{isolateScope:!0})),preLinkFns.push(pre)),post&&(attrStart&&(post=groupElementsLinkFnWrapper(post,attrStart,attrEnd)),post.require=directive.require,(newIsolateScopeDirective===directive||directive.$$isolateScope)&&(post=cloneAndAnnotateFn(post,{isolateScope:!0})),postLinkFns.push(post))}function getControllers(require,$element,elementControllers){var value,retrievalMethod="data",optional=!1;if(isString(require)){for(;"^"==(value=require.charAt(0))||"?"==value;)require=require.substr(1),"^"==value&&(retrievalMethod="inheritedData"),optional=optional||"?"==value;if(value=null,elementControllers&&"data"===retrievalMethod&&(value=elementControllers[require]),value=value||$element[retrievalMethod]("$"+require+"Controller"),!value&&!optional)throw $compileMinErr("ctreq","Controller '{0}', required by directive '{1}', can't be found!",require,directiveName);return value}return isArray(require)&&(value=[],forEach(require,function(require){value.push(getControllers(require,$element,elementControllers))})),value}function nodeLinkFn(childLinkFn,scope,linkNode,$rootElement,boundTranscludeFn){function controllersBoundTransclude(scope,cloneAttachFn){var transcludeControllers;return arguments.length<2&&(cloneAttachFn=scope,scope=undefined),hasElementTranscludeDirective&&(transcludeControllers=elementControllers),boundTranscludeFn(scope,cloneAttachFn,transcludeControllers)}var attrs,$element,i,ii,linkFn,controller,isolateScope,transcludeFn,elementControllers={};if(attrs=compileNode===linkNode?templateAttrs:shallowCopy(templateAttrs,new Attributes(jqLite(linkNode),templateAttrs.$attr)),$element=attrs.$$element,newIsolateScopeDirective){var LOCAL_REGEXP=/^\s*([@=&])(\??)\s*(\w*)\s*$/,$linkNode=jqLite(linkNode);isolateScope=scope.$new(!0),templateDirective&&templateDirective===newIsolateScopeDirective.$$originalDirective?$linkNode.data("$isolateScope",isolateScope):$linkNode.data("$isolateScopeNoTemplate",isolateScope),safeAddClass($linkNode,"ng-isolate-scope"),forEach(newIsolateScopeDirective.scope,function(definition,scopeName){var lastValue,parentGet,parentSet,compare,match=definition.match(LOCAL_REGEXP)||[],attrName=match[3]||scopeName,optional="?"==match[2],mode=match[1];switch(isolateScope.$$isolateBindings[scopeName]=mode+attrName,mode){case"@":attrs.$observe(attrName,function(value){isolateScope[scopeName]=value}),attrs.$$observers[attrName].$$scope=scope,attrs[attrName]&&(isolateScope[scopeName]=$interpolate(attrs[attrName])(scope));break;case"=":if(optional&&!attrs[attrName])return;
parentGet=$parse(attrs[attrName]),compare=parentGet.literal?equals:function(a,b){return a===b},parentSet=parentGet.assign||function(){throw lastValue=isolateScope[scopeName]=parentGet(scope),$compileMinErr("nonassign","Expression '{0}' used with directive '{1}' is non-assignable!",attrs[attrName],newIsolateScopeDirective.name)},lastValue=isolateScope[scopeName]=parentGet(scope),isolateScope.$watch(function(){var parentValue=parentGet(scope);return compare(parentValue,isolateScope[scopeName])||(compare(parentValue,lastValue)?parentSet(scope,parentValue=isolateScope[scopeName]):isolateScope[scopeName]=parentValue),lastValue=parentValue},null,parentGet.literal);break;case"&":parentGet=$parse(attrs[attrName]),isolateScope[scopeName]=function(locals){return parentGet(scope,locals)};break;default:throw $compileMinErr("iscp","Invalid isolate scope definition for directive '{0}'. Definition: {... {1}: '{2}' ...}",newIsolateScopeDirective.name,scopeName,definition)}})}for(transcludeFn=boundTranscludeFn&&controllersBoundTransclude,controllerDirectives&&forEach(controllerDirectives,function(directive){var controllerInstance,locals={$scope:directive===newIsolateScopeDirective||directive.$$isolateScope?isolateScope:scope,$element:$element,$attrs:attrs,$transclude:transcludeFn};controller=directive.controller,"@"==controller&&(controller=attrs[directive.name]),controllerInstance=$controller(controller,locals),elementControllers[directive.name]=controllerInstance,hasElementTranscludeDirective||$element.data("$"+directive.name+"Controller",controllerInstance),directive.controllerAs&&(locals.$scope[directive.controllerAs]=controllerInstance)}),i=0,ii=preLinkFns.length;ii>i;i++)try{linkFn=preLinkFns[i],linkFn(linkFn.isolateScope?isolateScope:scope,$element,attrs,linkFn.require&&getControllers(linkFn.require,$element,elementControllers),transcludeFn)}catch(e){$exceptionHandler(e,startingTag($element))}var scopeToChild=scope;for(newIsolateScopeDirective&&(newIsolateScopeDirective.template||null===newIsolateScopeDirective.templateUrl)&&(scopeToChild=isolateScope),childLinkFn&&childLinkFn(scopeToChild,linkNode.childNodes,undefined,boundTranscludeFn),i=postLinkFns.length-1;i>=0;i--)try{linkFn=postLinkFns[i],linkFn(linkFn.isolateScope?isolateScope:scope,$element,attrs,linkFn.require&&getControllers(linkFn.require,$element,elementControllers),transcludeFn)}catch(e){$exceptionHandler(e,startingTag($element))}}previousCompileContext=previousCompileContext||{};for(var newScopeDirective,directive,directiveName,$template,linkFn,directiveValue,terminalPriority=-Number.MAX_VALUE,controllerDirectives=previousCompileContext.controllerDirectives,newIsolateScopeDirective=previousCompileContext.newIsolateScopeDirective,templateDirective=previousCompileContext.templateDirective,nonTlbTranscludeDirective=previousCompileContext.nonTlbTranscludeDirective,hasTranscludeDirective=!1,hasElementTranscludeDirective=previousCompileContext.hasElementTranscludeDirective,$compileNode=templateAttrs.$$element=jqLite(compileNode),replaceDirective=originalReplaceDirective,childTranscludeFn=transcludeFn,i=0,ii=directives.length;ii>i;i++){directive=directives[i];var attrStart=directive.$$start,attrEnd=directive.$$end;if(attrStart&&($compileNode=groupScan(compileNode,attrStart,attrEnd)),$template=undefined,terminalPriority>directive.priority)break;if((directiveValue=directive.scope)&&(newScopeDirective=newScopeDirective||directive,directive.templateUrl||(assertNoDuplicate("new/isolated scope",newIsolateScopeDirective,directive,$compileNode),isObject(directiveValue)&&(newIsolateScopeDirective=directive))),directiveName=directive.name,!directive.templateUrl&&directive.controller&&(directiveValue=directive.controller,controllerDirectives=controllerDirectives||{},assertNoDuplicate("'"+directiveName+"' controller",controllerDirectives[directiveName],directive,$compileNode),controllerDirectives[directiveName]=directive),(directiveValue=directive.transclude)&&(hasTranscludeDirective=!0,directive.$$tlb||(assertNoDuplicate("transclusion",nonTlbTranscludeDirective,directive,$compileNode),nonTlbTranscludeDirective=directive),"element"==directiveValue?(hasElementTranscludeDirective=!0,terminalPriority=directive.priority,$template=groupScan(compileNode,attrStart,attrEnd),$compileNode=templateAttrs.$$element=jqLite(document.createComment(" "+directiveName+": "+templateAttrs[directiveName]+" ")),compileNode=$compileNode[0],replaceWith(jqCollection,jqLite(sliceArgs($template)),compileNode),childTranscludeFn=compile($template,transcludeFn,terminalPriority,replaceDirective&&replaceDirective.name,{nonTlbTranscludeDirective:nonTlbTranscludeDirective})):($template=jqLite(jqLiteClone(compileNode)).contents(),$compileNode.empty(),childTranscludeFn=compile($template,transcludeFn))),directive.template)if(assertNoDuplicate("template",templateDirective,directive,$compileNode),templateDirective=directive,directiveValue=isFunction(directive.template)?directive.template($compileNode,templateAttrs):directive.template,directiveValue=denormalizeTemplate(directiveValue),directive.replace){if(replaceDirective=directive,$template=directiveTemplateContents(directiveValue),compileNode=$template[0],1!=$template.length||1!==compileNode.nodeType)throw $compileMinErr("tplrt","Template for directive '{0}' must have exactly one root element. {1}",directiveName,"");replaceWith(jqCollection,$compileNode,compileNode);var newTemplateAttrs={$attr:{}},templateDirectives=collectDirectives(compileNode,[],newTemplateAttrs),unprocessedDirectives=directives.splice(i+1,directives.length-(i+1));newIsolateScopeDirective&&markDirectivesAsIsolate(templateDirectives),directives=directives.concat(templateDirectives).concat(unprocessedDirectives),mergeTemplateAttributes(templateAttrs,newTemplateAttrs),ii=directives.length}else $compileNode.html(directiveValue);if(directive.templateUrl)assertNoDuplicate("template",templateDirective,directive,$compileNode),templateDirective=directive,directive.replace&&(replaceDirective=directive),nodeLinkFn=compileTemplateUrl(directives.splice(i,directives.length-i),$compileNode,templateAttrs,jqCollection,childTranscludeFn,preLinkFns,postLinkFns,{controllerDirectives:controllerDirectives,newIsolateScopeDirective:newIsolateScopeDirective,templateDirective:templateDirective,nonTlbTranscludeDirective:nonTlbTranscludeDirective}),ii=directives.length;else if(directive.compile)try{linkFn=directive.compile($compileNode,templateAttrs,childTranscludeFn),isFunction(linkFn)?addLinkFns(null,linkFn,attrStart,attrEnd):linkFn&&addLinkFns(linkFn.pre,linkFn.post,attrStart,attrEnd)}catch(e){$exceptionHandler(e,startingTag($compileNode))}directive.terminal&&(nodeLinkFn.terminal=!0,terminalPriority=Math.max(terminalPriority,directive.priority))}return nodeLinkFn.scope=newScopeDirective&&newScopeDirective.scope===!0,nodeLinkFn.transclude=hasTranscludeDirective&&childTranscludeFn,previousCompileContext.hasElementTranscludeDirective=hasElementTranscludeDirective,nodeLinkFn}function markDirectivesAsIsolate(directives){for(var j=0,jj=directives.length;jj>j;j++)directives[j]=inherit(directives[j],{$$isolateScope:!0})}function addDirective(tDirectives,name,location,maxPriority,ignoreDirective,startAttrName,endAttrName){if(name===ignoreDirective)return null;var match=null;if(hasDirectives.hasOwnProperty(name))for(var directive,directives=$injector.get(name+Suffix),i=0,ii=directives.length;ii>i;i++)try{directive=directives[i],(maxPriority===undefined||maxPriority>directive.priority)&&-1!=directive.restrict.indexOf(location)&&(startAttrName&&(directive=inherit(directive,{$$start:startAttrName,$$end:endAttrName})),tDirectives.push(directive),match=directive)}catch(e){$exceptionHandler(e)}return match}function mergeTemplateAttributes(dst,src){var srcAttr=src.$attr,dstAttr=dst.$attr,$element=dst.$$element;forEach(dst,function(value,key){"$"!=key.charAt(0)&&(src[key]&&(value+=("style"===key?";":" ")+src[key]),dst.$set(key,value,!0,srcAttr[key]))}),forEach(src,function(value,key){"class"==key?(safeAddClass($element,value),dst["class"]=(dst["class"]?dst["class"]+" ":"")+value):"style"==key?($element.attr("style",$element.attr("style")+";"+value),dst.style=(dst.style?dst.style+";":"")+value):"$"==key.charAt(0)||dst.hasOwnProperty(key)||(dst[key]=value,dstAttr[key]=srcAttr[key])})}function directiveTemplateContents(template){var type;if(template=trim(template),type=TABLE_CONTENT_REGEXP.exec(template)){type=type[1].toLowerCase();var table=jqLite("<table>"+template+"</table>"),tbody=table.children("tbody"),leaf=/(td|th)/.test(type)&&table.find("tr");return tbody.length&&"tbody"!==type&&(table=tbody),leaf&&leaf.length&&(table=leaf),table.contents()}return jqLite("<div>"+template+"</div>").contents()}function compileTemplateUrl(directives,$compileNode,tAttrs,$rootElement,childTranscludeFn,preLinkFns,postLinkFns,previousCompileContext){var afterTemplateNodeLinkFn,afterTemplateChildLinkFn,linkQueue=[],beforeTemplateCompileNode=$compileNode[0],origAsyncDirective=directives.shift(),derivedSyncDirective=extend({},origAsyncDirective,{templateUrl:null,transclude:null,replace:null,$$originalDirective:origAsyncDirective}),templateUrl=isFunction(origAsyncDirective.templateUrl)?origAsyncDirective.templateUrl($compileNode,tAttrs):origAsyncDirective.templateUrl;return $compileNode.empty(),$http.get($sce.getTrustedResourceUrl(templateUrl),{cache:$templateCache}).success(function(content){var compileNode,tempTemplateAttrs,$template,childBoundTranscludeFn;if(content=denormalizeTemplate(content),origAsyncDirective.replace){if($template=directiveTemplateContents(content),compileNode=$template[0],1!=$template.length||1!==compileNode.nodeType)throw $compileMinErr("tplrt","Template for directive '{0}' must have exactly one root element. {1}",origAsyncDirective.name,templateUrl);tempTemplateAttrs={$attr:{}},replaceWith($rootElement,$compileNode,compileNode);var templateDirectives=collectDirectives(compileNode,[],tempTemplateAttrs);isObject(origAsyncDirective.scope)&&markDirectivesAsIsolate(templateDirectives),directives=templateDirectives.concat(directives),mergeTemplateAttributes(tAttrs,tempTemplateAttrs)}else compileNode=beforeTemplateCompileNode,$compileNode.html(content);for(directives.unshift(derivedSyncDirective),afterTemplateNodeLinkFn=applyDirectivesToNode(directives,compileNode,tAttrs,childTranscludeFn,$compileNode,origAsyncDirective,preLinkFns,postLinkFns,previousCompileContext),forEach($rootElement,function(node,i){node==compileNode&&($rootElement[i]=$compileNode[0])}),afterTemplateChildLinkFn=compileNodes($compileNode[0].childNodes,childTranscludeFn);linkQueue.length;){var scope=linkQueue.shift(),beforeTemplateLinkNode=linkQueue.shift(),linkRootElement=linkQueue.shift(),boundTranscludeFn=linkQueue.shift(),linkNode=$compileNode[0];if(beforeTemplateLinkNode!==beforeTemplateCompileNode){var oldClasses=beforeTemplateLinkNode.className;previousCompileContext.hasElementTranscludeDirective&&origAsyncDirective.replace||(linkNode=jqLiteClone(compileNode)),replaceWith(linkRootElement,jqLite(beforeTemplateLinkNode),linkNode),safeAddClass(jqLite(linkNode),oldClasses)}childBoundTranscludeFn=afterTemplateNodeLinkFn.transclude?createBoundTranscludeFn(scope,afterTemplateNodeLinkFn.transclude):boundTranscludeFn,afterTemplateNodeLinkFn(afterTemplateChildLinkFn,scope,linkNode,$rootElement,childBoundTranscludeFn)}linkQueue=null}).error(function(response,code,headers,config){throw $compileMinErr("tpload","Failed to load template: {0}",config.url)}),function(ignoreChildLinkFn,scope,node,rootElement,boundTranscludeFn){linkQueue?(linkQueue.push(scope),linkQueue.push(node),linkQueue.push(rootElement),linkQueue.push(boundTranscludeFn)):afterTemplateNodeLinkFn(afterTemplateChildLinkFn,scope,node,rootElement,boundTranscludeFn)}}function byPriority(a,b){var diff=b.priority-a.priority;return 0!==diff?diff:a.name!==b.name?a.name<b.name?-1:1:a.index-b.index}function assertNoDuplicate(what,previousDirective,directive,element){if(previousDirective)throw $compileMinErr("multidir","Multiple directives [{0}, {1}] asking for {2} on: {3}",previousDirective.name,directive.name,what,startingTag(element))}function addTextInterpolateDirective(directives,text){var interpolateFn=$interpolate(text,!0);interpolateFn&&directives.push({priority:0,compile:valueFn(function(scope,node){var parent=node.parent(),bindings=parent.data("$binding")||[];bindings.push(interpolateFn),safeAddClass(parent.data("$binding",bindings),"ng-binding"),scope.$watch(interpolateFn,function(value){node[0].nodeValue=value})})})}function getTrustedContext(node,attrNormalizedName){if("srcdoc"==attrNormalizedName)return $sce.HTML;var tag=nodeName_(node);return"xlinkHref"==attrNormalizedName||"FORM"==tag&&"action"==attrNormalizedName||"IMG"!=tag&&("src"==attrNormalizedName||"ngSrc"==attrNormalizedName)?$sce.RESOURCE_URL:void 0}function addAttrInterpolateDirective(node,directives,value,name){var interpolateFn=$interpolate(value,!0);if(interpolateFn){if("multiple"===name&&"SELECT"===nodeName_(node))throw $compileMinErr("selmulti","Binding to the 'multiple' attribute is not supported. Element: {0}",startingTag(node));directives.push({priority:100,compile:function(){return{pre:function(scope,element,attr){var $$observers=attr.$$observers||(attr.$$observers={});if(EVENT_HANDLER_ATTR_REGEXP.test(name))throw $compileMinErr("nodomevents","Interpolations for HTML DOM event attributes are disallowed.  Please use the ng- versions (such as ng-click instead of onclick) instead.");interpolateFn=$interpolate(attr[name],!0,getTrustedContext(node,name)),interpolateFn&&(attr[name]=interpolateFn(scope),($$observers[name]||($$observers[name]=[])).$$inter=!0,(attr.$$observers&&attr.$$observers[name].$$scope||scope).$watch(interpolateFn,function(newValue,oldValue){"class"===name&&newValue!=oldValue?attr.$updateClass(newValue,oldValue):attr.$set(name,newValue)}))}}}})}}function replaceWith($rootElement,elementsToRemove,newNode){var i,ii,firstElementToRemove=elementsToRemove[0],removeCount=elementsToRemove.length,parent=firstElementToRemove.parentNode;if($rootElement)for(i=0,ii=$rootElement.length;ii>i;i++)if($rootElement[i]==firstElementToRemove){$rootElement[i++]=newNode;for(var j=i,j2=j+removeCount-1,jj=$rootElement.length;jj>j;j++,j2++)jj>j2?$rootElement[j]=$rootElement[j2]:delete $rootElement[j];$rootElement.length-=removeCount-1;break}parent&&parent.replaceChild(newNode,firstElementToRemove);var fragment=document.createDocumentFragment();fragment.appendChild(firstElementToRemove),newNode[jqLite.expando]=firstElementToRemove[jqLite.expando];for(var k=1,kk=elementsToRemove.length;kk>k;k++){var element=elementsToRemove[k];jqLite(element).remove(),fragment.appendChild(element),delete elementsToRemove[k]}elementsToRemove[0]=newNode,elementsToRemove.length=1}function cloneAndAnnotateFn(fn,annotation){return extend(function(){return fn.apply(null,arguments)},fn,annotation)}var Attributes=function(element,attr){this.$$element=element,this.$attr=attr||{}};Attributes.prototype={$normalize:directiveNormalize,$addClass:function(classVal){classVal&&classVal.length>0&&$animate.addClass(this.$$element,classVal)},$removeClass:function(classVal){classVal&&classVal.length>0&&$animate.removeClass(this.$$element,classVal)},$updateClass:function(newClasses,oldClasses){var toAdd=tokenDifference(newClasses,oldClasses),toRemove=tokenDifference(oldClasses,newClasses);0===toAdd.length?$animate.removeClass(this.$$element,toRemove):0===toRemove.length?$animate.addClass(this.$$element,toAdd):$animate.setClass(this.$$element,toAdd,toRemove)},$set:function(key,value,writeAttr,attrName){var nodeName,booleanKey=getBooleanAttrName(this.$$element[0],key);booleanKey&&(this.$$element.prop(key,value),attrName=booleanKey),this[key]=value,attrName?this.$attr[key]=attrName:(attrName=this.$attr[key],attrName||(this.$attr[key]=attrName=snake_case(key,"-"))),nodeName=nodeName_(this.$$element),("A"===nodeName&&"href"===key||"IMG"===nodeName&&"src"===key)&&(this[key]=value=$$sanitizeUri(value,"src"===key)),writeAttr!==!1&&(null===value||value===undefined?this.$$element.removeAttr(attrName):this.$$element.attr(attrName,value));var $$observers=this.$$observers;$$observers&&forEach($$observers[key],function(fn){try{fn(value)}catch(e){$exceptionHandler(e)}})},$observe:function(key,fn){var attrs=this,$$observers=attrs.$$observers||(attrs.$$observers={}),listeners=$$observers[key]||($$observers[key]=[]);return listeners.push(fn),$rootScope.$evalAsync(function(){listeners.$$inter||fn(attrs[key])}),fn}};var startSymbol=$interpolate.startSymbol(),endSymbol=$interpolate.endSymbol(),denormalizeTemplate="{{"==startSymbol||"}}"==endSymbol?identity:function(template){return template.replace(/\{\{/g,startSymbol).replace(/}}/g,endSymbol)},NG_ATTR_BINDING=/^ngAttr[A-Z]/;return compile}]}function directiveNormalize(name){return camelCase(name.replace(PREFIX_REGEXP,""))}function tokenDifference(str1,str2){var values="",tokens1=str1.split(/\s+/),tokens2=str2.split(/\s+/);outer:for(var i=0;i<tokens1.length;i++){for(var token=tokens1[i],j=0;j<tokens2.length;j++)if(token==tokens2[j])continue outer;values+=(values.length>0?" ":"")+token}return values}function $ControllerProvider(){var controllers={},CNTRL_REG=/^(\S+)(\s+as\s+(\w+))?$/;this.register=function(name,constructor){assertNotHasOwnProperty(name,"controller"),isObject(name)?extend(controllers,name):controllers[name]=constructor},this.$get=["$injector","$window",function($injector,$window){return function(expression,locals){var instance,match,constructor,identifier;if(isString(expression)&&(match=expression.match(CNTRL_REG),constructor=match[1],identifier=match[3],expression=controllers.hasOwnProperty(constructor)?controllers[constructor]:getter(locals.$scope,constructor,!0)||getter($window,constructor,!0),assertArgFn(expression,constructor,!0)),instance=$injector.instantiate(expression,locals),identifier){if(!locals||"object"!=typeof locals.$scope)throw minErr("$controller")("noscp","Cannot export controller '{0}' as '{1}'! No $scope object provided via `locals`.",constructor||expression.name,identifier);locals.$scope[identifier]=instance}return instance}}]}function $DocumentProvider(){this.$get=["$window",function(window){return jqLite(window.document)}]}function $ExceptionHandlerProvider(){this.$get=["$log",function($log){return function(){$log.error.apply($log,arguments)}}]}function parseHeaders(headers){var key,val,i,parsed={};return headers?(forEach(headers.split("\n"),function(line){i=line.indexOf(":"),key=lowercase(trim(line.substr(0,i))),val=trim(line.substr(i+1)),key&&(parsed[key]?parsed[key]+=", "+val:parsed[key]=val)}),parsed):parsed}function headersGetter(headers){var headersObj=isObject(headers)?headers:undefined;return function(name){return headersObj||(headersObj=parseHeaders(headers)),name?headersObj[lowercase(name)]||null:headersObj}}function transformData(data,headers,fns){return isFunction(fns)?fns(data,headers):(forEach(fns,function(fn){data=fn(data,headers)}),data)}function isSuccess(status){return status>=200&&300>status}function $HttpProvider(){var JSON_START=/^\s*(\[|\{[^\{])/,JSON_END=/[\}\]]\s*$/,PROTECTION_PREFIX=/^\)\]\}',?\n/,CONTENT_TYPE_APPLICATION_JSON={"Content-Type":"application/json;charset=utf-8"},defaults=this.defaults={transformResponse:[function(data){return isString(data)&&(data=data.replace(PROTECTION_PREFIX,""),JSON_START.test(data)&&JSON_END.test(data)&&(data=fromJson(data))),data}],transformRequest:[function(d){return isObject(d)&&!isFile(d)?toJson(d):d}],headers:{common:{Accept:"application/json, text/plain, */*"},post:copy(CONTENT_TYPE_APPLICATION_JSON),put:copy(CONTENT_TYPE_APPLICATION_JSON),patch:copy(CONTENT_TYPE_APPLICATION_JSON)},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN"},interceptorFactories=this.interceptors=[],responseInterceptorFactories=this.responseInterceptors=[];this.$get=["$httpBackend","$browser","$cacheFactory","$rootScope","$q","$injector",function($httpBackend,$browser,$cacheFactory,$rootScope,$q,$injector){function $http(requestConfig){function transformResponse(response){var resp=extend({},response,{data:transformData(response.data,response.headers,config.transformResponse)});return isSuccess(response.status)?resp:$q.reject(resp)}function mergeHeaders(config){function execHeaders(headers){var headerContent;forEach(headers,function(headerFn,header){isFunction(headerFn)&&(headerContent=headerFn(),null!=headerContent?headers[header]=headerContent:delete headers[header])})}var defHeaderName,lowercaseDefHeaderName,reqHeaderName,defHeaders=defaults.headers,reqHeaders=extend({},config.headers);defHeaders=extend({},defHeaders.common,defHeaders[lowercase(config.method)]),execHeaders(defHeaders),execHeaders(reqHeaders);defaultHeadersIteration:for(defHeaderName in defHeaders){lowercaseDefHeaderName=lowercase(defHeaderName);for(reqHeaderName in reqHeaders)if(lowercase(reqHeaderName)===lowercaseDefHeaderName)continue defaultHeadersIteration;reqHeaders[defHeaderName]=defHeaders[defHeaderName]}return reqHeaders}var config={method:"get",transformRequest:defaults.transformRequest,transformResponse:defaults.transformResponse},headers=mergeHeaders(requestConfig);extend(config,requestConfig),config.headers=headers,config.method=uppercase(config.method);var xsrfValue=urlIsSameOrigin(config.url)?$browser.cookies()[config.xsrfCookieName||defaults.xsrfCookieName]:undefined;xsrfValue&&(headers[config.xsrfHeaderName||defaults.xsrfHeaderName]=xsrfValue);var serverRequest=function(config){headers=config.headers;var reqData=transformData(config.data,headersGetter(headers),config.transformRequest);return isUndefined(config.data)&&forEach(headers,function(value,header){"content-type"===lowercase(header)&&delete headers[header]}),isUndefined(config.withCredentials)&&!isUndefined(defaults.withCredentials)&&(config.withCredentials=defaults.withCredentials),sendReq(config,reqData,headers).then(transformResponse,transformResponse)},chain=[serverRequest,undefined],promise=$q.when(config);for(forEach(reversedInterceptors,function(interceptor){(interceptor.request||interceptor.requestError)&&chain.unshift(interceptor.request,interceptor.requestError),(interceptor.response||interceptor.responseError)&&chain.push(interceptor.response,interceptor.responseError)});chain.length;){var thenFn=chain.shift(),rejectFn=chain.shift();promise=promise.then(thenFn,rejectFn)}return promise.success=function(fn){return promise.then(function(response){fn(response.data,response.status,response.headers,config)}),promise},promise.error=function(fn){return promise.then(null,function(response){fn(response.data,response.status,response.headers,config)}),promise},promise}function createShortMethods(){forEach(arguments,function(name){$http[name]=function(url,config){return $http(extend(config||{},{method:name,url:url}))}})}function createShortMethodsWithData(){forEach(arguments,function(name){$http[name]=function(url,data,config){return $http(extend(config||{},{method:name,url:url,data:data}))}})}function sendReq(config,reqData,reqHeaders){function done(status,response,headersString){cache&&(isSuccess(status)?cache.put(url,[status,response,parseHeaders(headersString)]):cache.remove(url)),resolvePromise(response,status,headersString),$rootScope.$$phase||$rootScope.$apply()}function resolvePromise(response,status,headers){status=Math.max(status,0),(isSuccess(status)?deferred.resolve:deferred.reject)({data:response,status:status,headers:headersGetter(headers),config:config})}function removePendingReq(){var idx=indexOf($http.pendingRequests,config);-1!==idx&&$http.pendingRequests.splice(idx,1)}var cache,cachedResp,deferred=$q.defer(),promise=deferred.promise,url=buildUrl(config.url,config.params);if($http.pendingRequests.push(config),promise.then(removePendingReq,removePendingReq),(config.cache||defaults.cache)&&config.cache!==!1&&"GET"==config.method&&(cache=isObject(config.cache)?config.cache:isObject(defaults.cache)?defaults.cache:defaultCache),cache)if(cachedResp=cache.get(url),isDefined(cachedResp)){if(cachedResp.then)return cachedResp.then(removePendingReq,removePendingReq),cachedResp;isArray(cachedResp)?resolvePromise(cachedResp[1],cachedResp[0],copy(cachedResp[2])):resolvePromise(cachedResp,200,{})}else cache.put(url,promise);return isUndefined(cachedResp)&&$httpBackend(config.method,url,reqData,done,reqHeaders,config.timeout,config.withCredentials,config.responseType),promise}function buildUrl(url,params){if(!params)return url;var parts=[];return forEachSorted(params,function(value,key){null===value||isUndefined(value)||(isArray(value)||(value=[value]),forEach(value,function(v){isObject(v)&&(v=toJson(v)),parts.push(encodeUriQuery(key)+"="+encodeUriQuery(v))}))}),parts.length>0&&(url+=(-1==url.indexOf("?")?"?":"&")+parts.join("&")),url}var defaultCache=$cacheFactory("$http"),reversedInterceptors=[];return forEach(interceptorFactories,function(interceptorFactory){reversedInterceptors.unshift(isString(interceptorFactory)?$injector.get(interceptorFactory):$injector.invoke(interceptorFactory))}),forEach(responseInterceptorFactories,function(interceptorFactory,index){var responseFn=isString(interceptorFactory)?$injector.get(interceptorFactory):$injector.invoke(interceptorFactory);reversedInterceptors.splice(index,0,{response:function(response){return responseFn($q.when(response))},responseError:function(response){return responseFn($q.reject(response))}})}),$http.pendingRequests=[],createShortMethods("get","delete","head","jsonp"),createShortMethodsWithData("post","put"),$http.defaults=defaults,$http}]}function createXhr(method){if(8>=msie&&(!method.match(/^(get|post|head|put|delete|options)$/i)||!window.XMLHttpRequest))return new window.ActiveXObject("Microsoft.XMLHTTP");if(window.XMLHttpRequest)return new window.XMLHttpRequest;throw minErr("$httpBackend")("noxhr","This browser does not support XMLHttpRequest.")}function $HttpBackendProvider(){this.$get=["$browser","$window","$document",function($browser,$window,$document){return createHttpBackend($browser,createXhr,$browser.defer,$window.angular.callbacks,$document[0])}]}function createHttpBackend($browser,createXhr,$browserDefer,callbacks,rawDocument){function jsonpReq(url,done){var script=rawDocument.createElement("script"),doneWrapper=function(){script.onreadystatechange=script.onload=script.onerror=null,rawDocument.body.removeChild(script),done&&done()};return script.type="text/javascript",script.src=url,msie&&8>=msie?script.onreadystatechange=function(){/loaded|complete/.test(script.readyState)&&doneWrapper()}:script.onload=script.onerror=function(){doneWrapper()},rawDocument.body.appendChild(script),doneWrapper}var ABORTED=-1;return function(method,url,post,callback,headers,timeout,withCredentials,responseType){function timeoutRequest(){status=ABORTED,jsonpDone&&jsonpDone(),xhr&&xhr.abort()}function completeRequest(callback,status,response,headersString){timeoutId&&$browserDefer.cancel(timeoutId),jsonpDone=xhr=null,status=0===status?response?200:404:status,status=1223==status?204:status,callback(status,response,headersString),$browser.$$completeOutstandingRequest(noop)}var status;if($browser.$$incOutstandingRequestCount(),url=url||$browser.url(),"jsonp"==lowercase(method)){var callbackId="_"+(callbacks.counter++).toString(36);callbacks[callbackId]=function(data){callbacks[callbackId].data=data};var jsonpDone=jsonpReq(url.replace("JSON_CALLBACK","angular.callbacks."+callbackId),function(){callbacks[callbackId].data?completeRequest(callback,200,callbacks[callbackId].data):completeRequest(callback,status||-2),callbacks[callbackId]=angular.noop})}else{var xhr=createXhr(method);if(xhr.open(method,url,!0),forEach(headers,function(value,key){isDefined(value)&&xhr.setRequestHeader(key,value)}),xhr.onreadystatechange=function(){if(xhr&&4==xhr.readyState){var responseHeaders=null,response=null;status!==ABORTED&&(responseHeaders=xhr.getAllResponseHeaders(),response="response"in xhr?xhr.response:xhr.responseText),completeRequest(callback,status||xhr.status,response,responseHeaders)}},withCredentials&&(xhr.withCredentials=!0),responseType)try{xhr.responseType=responseType}catch(e){if("json"!==responseType)throw e}xhr.send(post||null)}if(timeout>0)var timeoutId=$browserDefer(timeoutRequest,timeout);else timeout&&timeout.then&&timeout.then(timeoutRequest)}}function $InterpolateProvider(){var startSymbol="{{",endSymbol="}}";this.startSymbol=function(value){return value?(startSymbol=value,this):startSymbol},this.endSymbol=function(value){return value?(endSymbol=value,this):endSymbol},this.$get=["$parse","$exceptionHandler","$sce",function($parse,$exceptionHandler,$sce){function $interpolate(text,mustHaveExpression,trustedContext){for(var startIndex,endIndex,fn,exp,index=0,parts=[],length=text.length,hasInterpolation=!1,concat=[];length>index;)-1!=(startIndex=text.indexOf(startSymbol,index))&&-1!=(endIndex=text.indexOf(endSymbol,startIndex+startSymbolLength))?(index!=startIndex&&parts.push(text.substring(index,startIndex)),parts.push(fn=$parse(exp=text.substring(startIndex+startSymbolLength,endIndex))),fn.exp=exp,index=endIndex+endSymbolLength,hasInterpolation=!0):(index!=length&&parts.push(text.substring(index)),index=length);if((length=parts.length)||(parts.push(""),length=1),trustedContext&&parts.length>1)throw $interpolateMinErr("noconcat","Error while interpolating: {0}\nStrict Contextual Escaping disallows interpolations that concatenate multiple expressions when a trusted value is required.  See http://docs.angularjs.org/api/ng.$sce",text);return!mustHaveExpression||hasInterpolation?(concat.length=length,fn=function(context){try{for(var part,i=0,ii=length;ii>i;i++)"function"==typeof(part=parts[i])&&(part=part(context),part=trustedContext?$sce.getTrusted(trustedContext,part):$sce.valueOf(part),null===part||isUndefined(part)?part="":"string"!=typeof part&&(part=toJson(part))),concat[i]=part;return concat.join("")}catch(err){var newErr=$interpolateMinErr("interr","Can't interpolate: {0}\n{1}",text,err.toString());$exceptionHandler(newErr)}},fn.exp=text,fn.parts=parts,fn):void 0}var startSymbolLength=startSymbol.length,endSymbolLength=endSymbol.length;return $interpolate.startSymbol=function(){return startSymbol},$interpolate.endSymbol=function(){return endSymbol},$interpolate}]}function $IntervalProvider(){this.$get=["$rootScope","$window","$q",function($rootScope,$window,$q){function interval(fn,delay,count,invokeApply){var setInterval=$window.setInterval,clearInterval=$window.clearInterval,deferred=$q.defer(),promise=deferred.promise,iteration=0,skipApply=isDefined(invokeApply)&&!invokeApply;return count=isDefined(count)?count:0,promise.then(null,null,fn),promise.$$intervalId=setInterval(function(){deferred.notify(iteration++),count>0&&iteration>=count&&(deferred.resolve(iteration),clearInterval(promise.$$intervalId),delete intervals[promise.$$intervalId]),skipApply||$rootScope.$apply()},delay),intervals[promise.$$intervalId]=deferred,promise}var intervals={};return interval.cancel=function(promise){return promise&&promise.$$intervalId in intervals?(intervals[promise.$$intervalId].reject("canceled"),clearInterval(promise.$$intervalId),delete intervals[promise.$$intervalId],!0):!1},interval}]}function $LocaleProvider(){this.$get=function(){return{id:"en-us",NUMBER_FORMATS:{DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{minInt:1,minFrac:0,maxFrac:3,posPre:"",posSuf:"",negPre:"-",negSuf:"",gSize:3,lgSize:3},{minInt:1,minFrac:2,maxFrac:2,posPre:"¤",posSuf:"",negPre:"(¤",negSuf:")",gSize:3,lgSize:3}],CURRENCY_SYM:"$"},DATETIME_FORMATS:{MONTH:"January,February,March,April,May,June,July,August,September,October,November,December".split(","),SHORTMONTH:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","),DAY:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),SHORTDAY:"Sun,Mon,Tue,Wed,Thu,Fri,Sat".split(","),AMPMS:["AM","PM"],medium:"MMM d, y h:mm:ss a","short":"M/d/yy h:mm a",fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",mediumDate:"MMM d, y",shortDate:"M/d/yy",mediumTime:"h:mm:ss a",shortTime:"h:mm a"},pluralCat:function(num){return 1===num?"one":"other"}}}}function encodePath(path){for(var segments=path.split("/"),i=segments.length;i--;)segments[i]=encodeUriSegment(segments[i]);return segments.join("/")}function parseAbsoluteUrl(absoluteUrl,locationObj,appBase){var parsedUrl=urlResolve(absoluteUrl,appBase);locationObj.$$protocol=parsedUrl.protocol,locationObj.$$host=parsedUrl.hostname,locationObj.$$port=int(parsedUrl.port)||DEFAULT_PORTS[parsedUrl.protocol]||null}function parseAppUrl(relativeUrl,locationObj,appBase){var prefixed="/"!==relativeUrl.charAt(0);prefixed&&(relativeUrl="/"+relativeUrl);var match=urlResolve(relativeUrl,appBase);locationObj.$$path=decodeURIComponent(prefixed&&"/"===match.pathname.charAt(0)?match.pathname.substring(1):match.pathname),locationObj.$$search=parseKeyValue(match.search),locationObj.$$hash=decodeURIComponent(match.hash),locationObj.$$path&&"/"!=locationObj.$$path.charAt(0)&&(locationObj.$$path="/"+locationObj.$$path)
}function beginsWith(begin,whole){return 0===whole.indexOf(begin)?whole.substr(begin.length):void 0}function stripHash(url){var index=url.indexOf("#");return-1==index?url:url.substr(0,index)}function stripFile(url){return url.substr(0,stripHash(url).lastIndexOf("/")+1)}function serverBase(url){return url.substring(0,url.indexOf("/",url.indexOf("//")+2))}function LocationHtml5Url(appBase,basePrefix){this.$$html5=!0,basePrefix=basePrefix||"";var appBaseNoFile=stripFile(appBase);parseAbsoluteUrl(appBase,this,appBase),this.$$parse=function(url){var pathUrl=beginsWith(appBaseNoFile,url);if(!isString(pathUrl))throw $locationMinErr("ipthprfx",'Invalid url "{0}", missing path prefix "{1}".',url,appBaseNoFile);parseAppUrl(pathUrl,this,appBase),this.$$path||(this.$$path="/"),this.$$compose()},this.$$compose=function(){var search=toKeyValue(this.$$search),hash=this.$$hash?"#"+encodeUriSegment(this.$$hash):"";this.$$url=encodePath(this.$$path)+(search?"?"+search:"")+hash,this.$$absUrl=appBaseNoFile+this.$$url.substr(1)},this.$$rewrite=function(url){var appUrl,prevAppUrl;return(appUrl=beginsWith(appBase,url))!==undefined?(prevAppUrl=appUrl,(appUrl=beginsWith(basePrefix,appUrl))!==undefined?appBaseNoFile+(beginsWith("/",appUrl)||appUrl):appBase+prevAppUrl):(appUrl=beginsWith(appBaseNoFile,url))!==undefined?appBaseNoFile+appUrl:appBaseNoFile==url+"/"?appBaseNoFile:void 0}}function LocationHashbangUrl(appBase,hashPrefix){var appBaseNoFile=stripFile(appBase);parseAbsoluteUrl(appBase,this,appBase),this.$$parse=function(url){function removeWindowsDriveName(path,url,base){var firstPathSegmentMatch,windowsFilePathExp=/^\/?.*?:(\/.*)/;return 0===url.indexOf(base)&&(url=url.replace(base,"")),windowsFilePathExp.exec(url)?path:(firstPathSegmentMatch=windowsFilePathExp.exec(path),firstPathSegmentMatch?firstPathSegmentMatch[1]:path)}var withoutBaseUrl=beginsWith(appBase,url)||beginsWith(appBaseNoFile,url),withoutHashUrl="#"==withoutBaseUrl.charAt(0)?beginsWith(hashPrefix,withoutBaseUrl):this.$$html5?withoutBaseUrl:"";if(!isString(withoutHashUrl))throw $locationMinErr("ihshprfx",'Invalid url "{0}", missing hash prefix "{1}".',url,hashPrefix);parseAppUrl(withoutHashUrl,this,appBase),this.$$path=removeWindowsDriveName(this.$$path,withoutHashUrl,appBase),this.$$compose()},this.$$compose=function(){var search=toKeyValue(this.$$search),hash=this.$$hash?"#"+encodeUriSegment(this.$$hash):"";this.$$url=encodePath(this.$$path)+(search?"?"+search:"")+hash,this.$$absUrl=appBase+(this.$$url?hashPrefix+this.$$url:"")},this.$$rewrite=function(url){return stripHash(appBase)==stripHash(url)?url:void 0}}function LocationHashbangInHtml5Url(appBase,hashPrefix){this.$$html5=!0,LocationHashbangUrl.apply(this,arguments);var appBaseNoFile=stripFile(appBase);this.$$rewrite=function(url){var appUrl;return appBase==stripHash(url)?url:(appUrl=beginsWith(appBaseNoFile,url))?appBase+hashPrefix+appUrl:appBaseNoFile===url+"/"?appBaseNoFile:void 0}}function locationGetter(property){return function(){return this[property]}}function locationGetterSetter(property,preprocess){return function(value){return isUndefined(value)?this[property]:(this[property]=preprocess(value),this.$$compose(),this)}}function $LocationProvider(){var hashPrefix="",html5Mode=!1;this.hashPrefix=function(prefix){return isDefined(prefix)?(hashPrefix=prefix,this):hashPrefix},this.html5Mode=function(mode){return isDefined(mode)?(html5Mode=mode,this):html5Mode},this.$get=["$rootScope","$browser","$sniffer","$rootElement",function($rootScope,$browser,$sniffer,$rootElement){function afterLocationChange(oldUrl){$rootScope.$broadcast("$locationChangeSuccess",$location.absUrl(),oldUrl)}var $location,LocationMode,appBase,baseHref=$browser.baseHref(),initialUrl=$browser.url();html5Mode?(appBase=serverBase(initialUrl)+(baseHref||"/"),LocationMode=$sniffer.history?LocationHtml5Url:LocationHashbangInHtml5Url):(appBase=stripHash(initialUrl),LocationMode=LocationHashbangUrl),$location=new LocationMode(appBase,"#"+hashPrefix),$location.$$parse($location.$$rewrite(initialUrl)),$rootElement.on("click",function(event){if(!event.ctrlKey&&!event.metaKey&&2!=event.which){for(var elm=jqLite(event.target);"a"!==lowercase(elm[0].nodeName);)if(elm[0]===$rootElement[0]||!(elm=elm.parent())[0])return;var absHref=elm.prop("href");isObject(absHref)&&"[object SVGAnimatedString]"===absHref.toString()&&(absHref=urlResolve(absHref.animVal).href);var rewrittenUrl=$location.$$rewrite(absHref);absHref&&!elm.attr("target")&&rewrittenUrl&&!event.isDefaultPrevented()&&(event.preventDefault(),rewrittenUrl!=$browser.url()&&($location.$$parse(rewrittenUrl),$rootScope.$apply(),window.angular["ff-684208-preventDefault"]=!0))}}),$location.absUrl()!=initialUrl&&$browser.url($location.absUrl(),!0),$browser.onUrlChange(function(newUrl){$location.absUrl()!=newUrl&&($rootScope.$evalAsync(function(){var oldUrl=$location.absUrl();$location.$$parse(newUrl),$rootScope.$broadcast("$locationChangeStart",newUrl,oldUrl).defaultPrevented?($location.$$parse(oldUrl),$browser.url(oldUrl)):afterLocationChange(oldUrl)}),$rootScope.$$phase||$rootScope.$digest())});var changeCounter=0;return $rootScope.$watch(function(){var oldUrl=$browser.url(),currentReplace=$location.$$replace;return changeCounter&&oldUrl==$location.absUrl()||(changeCounter++,$rootScope.$evalAsync(function(){$rootScope.$broadcast("$locationChangeStart",$location.absUrl(),oldUrl).defaultPrevented?$location.$$parse(oldUrl):($browser.url($location.absUrl(),currentReplace),afterLocationChange(oldUrl))})),$location.$$replace=!1,changeCounter}),$location}]}function $LogProvider(){var debug=!0,self=this;this.debugEnabled=function(flag){return isDefined(flag)?(debug=flag,this):debug},this.$get=["$window",function($window){function formatError(arg){return arg instanceof Error&&(arg.stack?arg=arg.message&&-1===arg.stack.indexOf(arg.message)?"Error: "+arg.message+"\n"+arg.stack:arg.stack:arg.sourceURL&&(arg=arg.message+"\n"+arg.sourceURL+":"+arg.line)),arg}function consoleLog(type){var console=$window.console||{},logFn=console[type]||console.log||noop,hasApply=!1;try{hasApply=!!logFn.apply}catch(e){}return hasApply?function(){var args=[];return forEach(arguments,function(arg){args.push(formatError(arg))}),logFn.apply(console,args)}:function(arg1,arg2){logFn(arg1,null==arg2?"":arg2)}}return{log:consoleLog("log"),info:consoleLog("info"),warn:consoleLog("warn"),error:consoleLog("error"),debug:function(){var fn=consoleLog("debug");return function(){debug&&fn.apply(self,arguments)}}()}}]}function ensureSafeMemberName(name,fullExpression){if("constructor"===name)throw $parseMinErr("isecfld",'Referencing "constructor" field in Angular expressions is disallowed! Expression: {0}',fullExpression);return name}function ensureSafeObject(obj,fullExpression){if(obj){if(obj.constructor===obj)throw $parseMinErr("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj.document&&obj.location&&obj.alert&&obj.setInterval)throw $parseMinErr("isecwindow","Referencing the Window in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj.children&&(obj.nodeName||obj.prop&&obj.attr&&obj.find))throw $parseMinErr("isecdom","Referencing DOM nodes in Angular expressions is disallowed! Expression: {0}",fullExpression)}return obj}function setter(obj,path,setValue,fullExp,options){options=options||{};for(var key,element=path.split("."),i=0;element.length>1;i++){key=ensureSafeMemberName(element.shift(),fullExp);var propertyObj=obj[key];propertyObj||(propertyObj={},obj[key]=propertyObj),obj=propertyObj,obj.then&&options.unwrapPromises&&(promiseWarning(fullExp),"$$v"in obj||!function(promise){promise.then(function(val){promise.$$v=val})}(obj),obj.$$v===undefined&&(obj.$$v={}),obj=obj.$$v)}return key=ensureSafeMemberName(element.shift(),fullExp),obj[key]=setValue,setValue}function cspSafeGetterFn(key0,key1,key2,key3,key4,fullExp,options){return ensureSafeMemberName(key0,fullExp),ensureSafeMemberName(key1,fullExp),ensureSafeMemberName(key2,fullExp),ensureSafeMemberName(key3,fullExp),ensureSafeMemberName(key4,fullExp),options.unwrapPromises?function(scope,locals){var promise,pathVal=locals&&locals.hasOwnProperty(key0)?locals:scope;return null==pathVal?pathVal:(pathVal=pathVal[key0],pathVal&&pathVal.then&&(promiseWarning(fullExp),"$$v"in pathVal||(promise=pathVal,promise.$$v=undefined,promise.then(function(val){promise.$$v=val})),pathVal=pathVal.$$v),key1?null==pathVal?undefined:(pathVal=pathVal[key1],pathVal&&pathVal.then&&(promiseWarning(fullExp),"$$v"in pathVal||(promise=pathVal,promise.$$v=undefined,promise.then(function(val){promise.$$v=val})),pathVal=pathVal.$$v),key2?null==pathVal?undefined:(pathVal=pathVal[key2],pathVal&&pathVal.then&&(promiseWarning(fullExp),"$$v"in pathVal||(promise=pathVal,promise.$$v=undefined,promise.then(function(val){promise.$$v=val})),pathVal=pathVal.$$v),key3?null==pathVal?undefined:(pathVal=pathVal[key3],pathVal&&pathVal.then&&(promiseWarning(fullExp),"$$v"in pathVal||(promise=pathVal,promise.$$v=undefined,promise.then(function(val){promise.$$v=val})),pathVal=pathVal.$$v),key4?null==pathVal?undefined:(pathVal=pathVal[key4],pathVal&&pathVal.then&&(promiseWarning(fullExp),"$$v"in pathVal||(promise=pathVal,promise.$$v=undefined,promise.then(function(val){promise.$$v=val})),pathVal=pathVal.$$v),pathVal):pathVal):pathVal):pathVal):pathVal)}:function(scope,locals){var pathVal=locals&&locals.hasOwnProperty(key0)?locals:scope;return null==pathVal?pathVal:(pathVal=pathVal[key0],key1?null==pathVal?undefined:(pathVal=pathVal[key1],key2?null==pathVal?undefined:(pathVal=pathVal[key2],key3?null==pathVal?undefined:(pathVal=pathVal[key3],key4?null==pathVal?undefined:pathVal=pathVal[key4]:pathVal):pathVal):pathVal):pathVal)}}function simpleGetterFn1(key0,fullExp){return ensureSafeMemberName(key0,fullExp),function(scope,locals){return null==scope?undefined:(locals&&locals.hasOwnProperty(key0)?locals:scope)[key0]}}function simpleGetterFn2(key0,key1,fullExp){return ensureSafeMemberName(key0,fullExp),ensureSafeMemberName(key1,fullExp),function(scope,locals){return null==scope?undefined:(scope=(locals&&locals.hasOwnProperty(key0)?locals:scope)[key0],null==scope?undefined:scope[key1])}}function getterFn(path,options,fullExp){if(getterFnCache.hasOwnProperty(path))return getterFnCache[path];var fn,pathKeys=path.split("."),pathKeysLength=pathKeys.length;if(options.unwrapPromises||1!==pathKeysLength)if(options.unwrapPromises||2!==pathKeysLength)if(options.csp)fn=6>pathKeysLength?cspSafeGetterFn(pathKeys[0],pathKeys[1],pathKeys[2],pathKeys[3],pathKeys[4],fullExp,options):function(scope,locals){var val,i=0;do val=cspSafeGetterFn(pathKeys[i++],pathKeys[i++],pathKeys[i++],pathKeys[i++],pathKeys[i++],fullExp,options)(scope,locals),locals=undefined,scope=val;while(pathKeysLength>i);return val};else{var code="var p;\n";forEach(pathKeys,function(key,index){ensureSafeMemberName(key,fullExp),code+="if(s == null) return undefined;\ns="+(index?"s":'((k&&k.hasOwnProperty("'+key+'"))?k:s)')+'["'+key+'"];\n'+(options.unwrapPromises?'if (s && s.then) {\n pw("'+fullExp.replace(/(["\r\n])/g,"\\$1")+'");\n if (!("$$v" in s)) {\n p=s;\n p.$$v = undefined;\n p.then(function(v) {p.$$v=v;});\n}\n s=s.$$v\n}\n':"")}),code+="return s;";var evaledFnGetter=new Function("s","k","pw",code);evaledFnGetter.toString=valueFn(code),fn=options.unwrapPromises?function(scope,locals){return evaledFnGetter(scope,locals,promiseWarning)}:evaledFnGetter}else fn=simpleGetterFn2(pathKeys[0],pathKeys[1],fullExp);else fn=simpleGetterFn1(pathKeys[0],fullExp);return"hasOwnProperty"!==path&&(getterFnCache[path]=fn),fn}function $ParseProvider(){var cache={},$parseOptions={csp:!1,unwrapPromises:!1,logPromiseWarnings:!0};this.unwrapPromises=function(value){return isDefined(value)?($parseOptions.unwrapPromises=!!value,this):$parseOptions.unwrapPromises},this.logPromiseWarnings=function(value){return isDefined(value)?($parseOptions.logPromiseWarnings=value,this):$parseOptions.logPromiseWarnings},this.$get=["$filter","$sniffer","$log",function($filter,$sniffer,$log){return $parseOptions.csp=$sniffer.csp,promiseWarning=function(fullExp){$parseOptions.logPromiseWarnings&&!promiseWarningCache.hasOwnProperty(fullExp)&&(promiseWarningCache[fullExp]=!0,$log.warn("[$parse] Promise found in the expression `"+fullExp+"`. Automatic unwrapping of promises in Angular expressions is deprecated."))},function(exp){var parsedExpression;switch(typeof exp){case"string":if(cache.hasOwnProperty(exp))return cache[exp];var lexer=new Lexer($parseOptions),parser=new Parser(lexer,$filter,$parseOptions);return parsedExpression=parser.parse(exp,!1),"hasOwnProperty"!==exp&&(cache[exp]=parsedExpression),parsedExpression;case"function":return exp;default:return noop}}}]}function $QProvider(){this.$get=["$rootScope","$exceptionHandler",function($rootScope,$exceptionHandler){return qFactory(function(callback){$rootScope.$evalAsync(callback)},$exceptionHandler)}]}function qFactory(nextTick,exceptionHandler){function defaultCallback(value){return value}function defaultErrback(reason){return reject(reason)}function all(promises){var deferred=defer(),counter=0,results=isArray(promises)?[]:{};return forEach(promises,function(promise,key){counter++,ref(promise).then(function(value){results.hasOwnProperty(key)||(results[key]=value,--counter||deferred.resolve(results))},function(reason){results.hasOwnProperty(key)||deferred.reject(reason)})}),0===counter&&deferred.resolve(results),deferred.promise}var defer=function(){var value,deferred,pending=[];return deferred={resolve:function(val){if(pending){var callbacks=pending;pending=undefined,value=ref(val),callbacks.length&&nextTick(function(){for(var callback,i=0,ii=callbacks.length;ii>i;i++)callback=callbacks[i],value.then(callback[0],callback[1],callback[2])})}},reject:function(reason){deferred.resolve(createInternalRejectedPromise(reason))},notify:function(progress){if(pending){var callbacks=pending;pending.length&&nextTick(function(){for(var callback,i=0,ii=callbacks.length;ii>i;i++)callback=callbacks[i],callback[2](progress)})}},promise:{then:function(callback,errback,progressback){var result=defer(),wrappedCallback=function(value){try{result.resolve((isFunction(callback)?callback:defaultCallback)(value))}catch(e){result.reject(e),exceptionHandler(e)}},wrappedErrback=function(reason){try{result.resolve((isFunction(errback)?errback:defaultErrback)(reason))}catch(e){result.reject(e),exceptionHandler(e)}},wrappedProgressback=function(progress){try{result.notify((isFunction(progressback)?progressback:defaultCallback)(progress))}catch(e){exceptionHandler(e)}};return pending?pending.push([wrappedCallback,wrappedErrback,wrappedProgressback]):value.then(wrappedCallback,wrappedErrback,wrappedProgressback),result.promise},"catch":function(callback){return this.then(null,callback)},"finally":function(callback){function makePromise(value,resolved){var result=defer();return resolved?result.resolve(value):result.reject(value),result.promise}function handleCallback(value,isResolved){var callbackOutput=null;try{callbackOutput=(callback||defaultCallback)()}catch(e){return makePromise(e,!1)}return callbackOutput&&isFunction(callbackOutput.then)?callbackOutput.then(function(){return makePromise(value,isResolved)},function(error){return makePromise(error,!1)}):makePromise(value,isResolved)}return this.then(function(value){return handleCallback(value,!0)},function(error){return handleCallback(error,!1)})}}}},ref=function(value){return value&&isFunction(value.then)?value:{then:function(callback){var result=defer();return nextTick(function(){result.resolve(callback(value))}),result.promise}}},reject=function(reason){var result=defer();return result.reject(reason),result.promise},createInternalRejectedPromise=function(reason){return{then:function(callback,errback){var result=defer();return nextTick(function(){try{result.resolve((isFunction(errback)?errback:defaultErrback)(reason))}catch(e){result.reject(e),exceptionHandler(e)}}),result.promise}}},when=function(value,callback,errback,progressback){var done,result=defer(),wrappedCallback=function(value){try{return(isFunction(callback)?callback:defaultCallback)(value)}catch(e){return exceptionHandler(e),reject(e)}},wrappedErrback=function(reason){try{return(isFunction(errback)?errback:defaultErrback)(reason)}catch(e){return exceptionHandler(e),reject(e)}},wrappedProgressback=function(progress){try{return(isFunction(progressback)?progressback:defaultCallback)(progress)}catch(e){exceptionHandler(e)}};return nextTick(function(){ref(value).then(function(value){done||(done=!0,result.resolve(ref(value).then(wrappedCallback,wrappedErrback,wrappedProgressback)))},function(reason){done||(done=!0,result.resolve(wrappedErrback(reason)))},function(progress){done||result.notify(wrappedProgressback(progress))})}),result.promise};return{defer:defer,reject:reject,when:when,all:all}}function $$RAFProvider(){this.$get=["$window",function($window){var requestAnimationFrame=$window.requestAnimationFrame||$window.webkitRequestAnimationFrame,cancelAnimationFrame=$window.cancelAnimationFrame||$window.webkitCancelAnimationFrame,raf=function(fn){var id=requestAnimationFrame(fn);return function(){cancelAnimationFrame(id)}};return raf.supported=!!requestAnimationFrame,raf}]}function $RootScopeProvider(){var TTL=10,$rootScopeMinErr=minErr("$rootScope"),lastDirtyWatch=null;this.digestTtl=function(value){return arguments.length&&(TTL=value),TTL},this.$get=["$injector","$exceptionHandler","$parse","$browser",function($injector,$exceptionHandler,$parse,$browser){function Scope(){this.$id=nextUid(),this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null,this["this"]=this.$root=this,this.$$destroyed=!1,this.$$asyncQueue=[],this.$$postDigestQueue=[],this.$$listeners={},this.$$listenerCount={},this.$$isolateBindings={}}function beginPhase(phase){if($rootScope.$$phase)throw $rootScopeMinErr("inprog","{0} already in progress",$rootScope.$$phase);$rootScope.$$phase=phase}function clearPhase(){$rootScope.$$phase=null}function compileToFn(exp,name){var fn=$parse(exp);return assertArgFn(fn,name),fn}function decrementListenerCount(current,count,name){do current.$$listenerCount[name]-=count,0===current.$$listenerCount[name]&&delete current.$$listenerCount[name];while(current=current.$parent)}function initWatchVal(){}Scope.prototype={constructor:Scope,$new:function(isolate){var ChildScope,child;return isolate?(child=new Scope,child.$root=this.$root,child.$$asyncQueue=this.$$asyncQueue,child.$$postDigestQueue=this.$$postDigestQueue):(ChildScope=function(){},ChildScope.prototype=this,child=new ChildScope,child.$id=nextUid()),child["this"]=child,child.$$listeners={},child.$$listenerCount={},child.$parent=this,child.$$watchers=child.$$nextSibling=child.$$childHead=child.$$childTail=null,child.$$prevSibling=this.$$childTail,this.$$childHead?(this.$$childTail.$$nextSibling=child,this.$$childTail=child):this.$$childHead=this.$$childTail=child,child},$watch:function(watchExp,listener,objectEquality){var scope=this,get=compileToFn(watchExp,"watch"),array=scope.$$watchers,watcher={fn:listener,last:initWatchVal,get:get,exp:watchExp,eq:!!objectEquality};if(lastDirtyWatch=null,!isFunction(listener)){var listenFn=compileToFn(listener||noop,"listener");watcher.fn=function(newVal,oldVal,scope){listenFn(scope)}}if("string"==typeof watchExp&&get.constant){var originalFn=watcher.fn;watcher.fn=function(newVal,oldVal,scope){originalFn.call(this,newVal,oldVal,scope),arrayRemove(array,watcher)}}return array||(array=scope.$$watchers=[]),array.unshift(watcher),function(){arrayRemove(array,watcher),lastDirtyWatch=null}},$watchCollection:function(obj,listener){function $watchCollectionWatch(){newValue=objGetter(self);var newLength,key;if(isObject(newValue))if(isArrayLike(newValue)){oldValue!==internalArray&&(oldValue=internalArray,oldLength=oldValue.length=0,changeDetected++),newLength=newValue.length,oldLength!==newLength&&(changeDetected++,oldValue.length=oldLength=newLength);for(var i=0;newLength>i;i++)oldValue[i]!==newValue[i]&&(changeDetected++,oldValue[i]=newValue[i])}else{oldValue!==internalObject&&(oldValue=internalObject={},oldLength=0,changeDetected++),newLength=0;for(key in newValue)newValue.hasOwnProperty(key)&&(newLength++,oldValue.hasOwnProperty(key)?oldValue[key]!==newValue[key]&&(changeDetected++,oldValue[key]=newValue[key]):(oldLength++,oldValue[key]=newValue[key],changeDetected++));if(oldLength>newLength){changeDetected++;for(key in oldValue)oldValue.hasOwnProperty(key)&&!newValue.hasOwnProperty(key)&&(oldLength--,delete oldValue[key])}}else oldValue!==newValue&&(oldValue=newValue,changeDetected++);return changeDetected}function $watchCollectionAction(){listener(newValue,oldValue,self)}var oldValue,newValue,self=this,changeDetected=0,objGetter=$parse(obj),internalArray=[],internalObject={},oldLength=0;return this.$watch($watchCollectionWatch,$watchCollectionAction)},$digest:function(){var watch,value,last,watchers,length,dirty,next,current,logIdx,logMsg,asyncTask,asyncQueue=this.$$asyncQueue,postDigestQueue=this.$$postDigestQueue,ttl=TTL,target=this,watchLog=[];beginPhase("$digest"),lastDirtyWatch=null;do{for(dirty=!1,current=target;asyncQueue.length;){try{asyncTask=asyncQueue.shift(),asyncTask.scope.$eval(asyncTask.expression)}catch(e){clearPhase(),$exceptionHandler(e)}lastDirtyWatch=null}traverseScopesLoop:do{if(watchers=current.$$watchers)for(length=watchers.length;length--;)try{if(watch=watchers[length])if((value=watch.get(current))===(last=watch.last)||(watch.eq?equals(value,last):"number"==typeof value&&"number"==typeof last&&isNaN(value)&&isNaN(last))){if(watch===lastDirtyWatch){dirty=!1;break traverseScopesLoop}}else dirty=!0,lastDirtyWatch=watch,watch.last=watch.eq?copy(value):value,watch.fn(value,last===initWatchVal?value:last,current),5>ttl&&(logIdx=4-ttl,watchLog[logIdx]||(watchLog[logIdx]=[]),logMsg=isFunction(watch.exp)?"fn: "+(watch.exp.name||watch.exp.toString()):watch.exp,logMsg+="; newVal: "+toJson(value)+"; oldVal: "+toJson(last),watchLog[logIdx].push(logMsg))}catch(e){clearPhase(),$exceptionHandler(e)}if(!(next=current.$$childHead||current!==target&&current.$$nextSibling))for(;current!==target&&!(next=current.$$nextSibling);)current=current.$parent}while(current=next);if((dirty||asyncQueue.length)&&!ttl--)throw clearPhase(),$rootScopeMinErr("infdig","{0} $digest() iterations reached. Aborting!\nWatchers fired in the last 5 iterations: {1}",TTL,toJson(watchLog))}while(dirty||asyncQueue.length);for(clearPhase();postDigestQueue.length;)try{postDigestQueue.shift()()}catch(e){$exceptionHandler(e)}},$destroy:function(){if(!this.$$destroyed){var parent=this.$parent;this.$broadcast("$destroy"),this.$$destroyed=!0,this!==$rootScope&&(forEach(this.$$listenerCount,bind(null,decrementListenerCount,this)),parent.$$childHead==this&&(parent.$$childHead=this.$$nextSibling),parent.$$childTail==this&&(parent.$$childTail=this.$$prevSibling),this.$$prevSibling&&(this.$$prevSibling.$$nextSibling=this.$$nextSibling),this.$$nextSibling&&(this.$$nextSibling.$$prevSibling=this.$$prevSibling),this.$parent=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null)}},$eval:function(expr,locals){return $parse(expr)(this,locals)},$evalAsync:function(expr){$rootScope.$$phase||$rootScope.$$asyncQueue.length||$browser.defer(function(){$rootScope.$$asyncQueue.length&&$rootScope.$digest()}),this.$$asyncQueue.push({scope:this,expression:expr})},$$postDigest:function(fn){this.$$postDigestQueue.push(fn)},$apply:function(expr){try{return beginPhase("$apply"),this.$eval(expr)}catch(e){$exceptionHandler(e)}finally{clearPhase();try{$rootScope.$digest()}catch(e){throw $exceptionHandler(e),e}}},$on:function(name,listener){var namedListeners=this.$$listeners[name];namedListeners||(this.$$listeners[name]=namedListeners=[]),namedListeners.push(listener);var current=this;do current.$$listenerCount[name]||(current.$$listenerCount[name]=0),current.$$listenerCount[name]++;while(current=current.$parent);var self=this;return function(){namedListeners[indexOf(namedListeners,listener)]=null,decrementListenerCount(self,1,name)}},$emit:function(name){var namedListeners,i,length,empty=[],scope=this,stopPropagation=!1,event={name:name,targetScope:scope,stopPropagation:function(){stopPropagation=!0},preventDefault:function(){event.defaultPrevented=!0},defaultPrevented:!1},listenerArgs=concat([event],arguments,1);do{for(namedListeners=scope.$$listeners[name]||empty,event.currentScope=scope,i=0,length=namedListeners.length;length>i;i++)if(namedListeners[i])try{namedListeners[i].apply(null,listenerArgs)}catch(e){$exceptionHandler(e)}else namedListeners.splice(i,1),i--,length--;if(stopPropagation)return event;scope=scope.$parent}while(scope);return event},$broadcast:function(name){for(var listeners,i,length,target=this,current=target,next=target,event={name:name,targetScope:target,preventDefault:function(){event.defaultPrevented=!0},defaultPrevented:!1},listenerArgs=concat([event],arguments,1);current=next;){for(event.currentScope=current,listeners=current.$$listeners[name]||[],i=0,length=listeners.length;length>i;i++)if(listeners[i])try{listeners[i].apply(null,listenerArgs)}catch(e){$exceptionHandler(e)}else listeners.splice(i,1),i--,length--;if(!(next=current.$$listenerCount[name]&&current.$$childHead||current!==target&&current.$$nextSibling))for(;current!==target&&!(next=current.$$nextSibling);)current=current.$parent}return event}};var $rootScope=new Scope;return $rootScope}]}function $$SanitizeUriProvider(){var aHrefSanitizationWhitelist=/^\s*(https?|ftp|mailto|tel|file):/,imgSrcSanitizationWhitelist=/^\s*(https?|ftp|file):|data:image\//;this.aHrefSanitizationWhitelist=function(regexp){return isDefined(regexp)?(aHrefSanitizationWhitelist=regexp,this):aHrefSanitizationWhitelist},this.imgSrcSanitizationWhitelist=function(regexp){return isDefined(regexp)?(imgSrcSanitizationWhitelist=regexp,this):imgSrcSanitizationWhitelist},this.$get=function(){return function(uri,isImage){var normalizedVal,regex=isImage?imgSrcSanitizationWhitelist:aHrefSanitizationWhitelist;return msie&&!(msie>=8)||(normalizedVal=urlResolve(uri).href,""===normalizedVal||normalizedVal.match(regex))?uri:"unsafe:"+normalizedVal}}}function escapeForRegexp(s){return s.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")}function adjustMatcher(matcher){if("self"===matcher)return matcher;if(isString(matcher)){if(matcher.indexOf("***")>-1)throw $sceMinErr("iwcard","Illegal sequence *** in string matcher.  String: {0}",matcher);return matcher=escapeForRegexp(matcher).replace("\\*\\*",".*").replace("\\*","[^:/.?&;]*"),new RegExp("^"+matcher+"$")}if(isRegExp(matcher))return new RegExp("^"+matcher.source+"$");throw $sceMinErr("imatcher",'Matchers may only be "self", string patterns or RegExp objects')}function adjustMatchers(matchers){var adjustedMatchers=[];return isDefined(matchers)&&forEach(matchers,function(matcher){adjustedMatchers.push(adjustMatcher(matcher))}),adjustedMatchers}function $SceDelegateProvider(){this.SCE_CONTEXTS=SCE_CONTEXTS;var resourceUrlWhitelist=["self"],resourceUrlBlacklist=[];this.resourceUrlWhitelist=function(value){return arguments.length&&(resourceUrlWhitelist=adjustMatchers(value)),resourceUrlWhitelist},this.resourceUrlBlacklist=function(value){return arguments.length&&(resourceUrlBlacklist=adjustMatchers(value)),resourceUrlBlacklist},this.$get=["$injector",function($injector){function matchUrl(matcher,parsedUrl){return"self"===matcher?urlIsSameOrigin(parsedUrl):!!matcher.exec(parsedUrl.href)}function isResourceUrlAllowedByPolicy(url){var i,n,parsedUrl=urlResolve(url.toString()),allowed=!1;for(i=0,n=resourceUrlWhitelist.length;n>i;i++)if(matchUrl(resourceUrlWhitelist[i],parsedUrl)){allowed=!0;break}if(allowed)for(i=0,n=resourceUrlBlacklist.length;n>i;i++)if(matchUrl(resourceUrlBlacklist[i],parsedUrl)){allowed=!1;break}return allowed}function generateHolderType(Base){var holderType=function(trustedValue){this.$$unwrapTrustedValue=function(){return trustedValue}};return Base&&(holderType.prototype=new Base),holderType.prototype.valueOf=function(){return this.$$unwrapTrustedValue()},holderType.prototype.toString=function(){return this.$$unwrapTrustedValue().toString()},holderType}function trustAs(type,trustedValue){var Constructor=byType.hasOwnProperty(type)?byType[type]:null;if(!Constructor)throw $sceMinErr("icontext","Attempted to trust a value in invalid context. Context: {0}; Value: {1}",type,trustedValue);if(null===trustedValue||trustedValue===undefined||""===trustedValue)return trustedValue;if("string"!=typeof trustedValue)throw $sceMinErr("itype","Attempted to trust a non-string value in a content requiring a string: Context: {0}",type);return new Constructor(trustedValue)}function valueOf(maybeTrusted){return maybeTrusted instanceof trustedValueHolderBase?maybeTrusted.$$unwrapTrustedValue():maybeTrusted}function getTrusted(type,maybeTrusted){if(null===maybeTrusted||maybeTrusted===undefined||""===maybeTrusted)return maybeTrusted;var constructor=byType.hasOwnProperty(type)?byType[type]:null;if(constructor&&maybeTrusted instanceof constructor)return maybeTrusted.$$unwrapTrustedValue();if(type===SCE_CONTEXTS.RESOURCE_URL){if(isResourceUrlAllowedByPolicy(maybeTrusted))return maybeTrusted;throw $sceMinErr("insecurl","Blocked loading resource from url not allowed by $sceDelegate policy.  URL: {0}",maybeTrusted.toString())}if(type===SCE_CONTEXTS.HTML)return htmlSanitizer(maybeTrusted);throw $sceMinErr("unsafe","Attempting to use an unsafe value in a safe context.")}var htmlSanitizer=function(){throw $sceMinErr("unsafe","Attempting to use an unsafe value in a safe context.")};$injector.has("$sanitize")&&(htmlSanitizer=$injector.get("$sanitize"));var trustedValueHolderBase=generateHolderType(),byType={};return byType[SCE_CONTEXTS.HTML]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.CSS]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.URL]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.JS]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.RESOURCE_URL]=generateHolderType(byType[SCE_CONTEXTS.URL]),{trustAs:trustAs,getTrusted:getTrusted,valueOf:valueOf}}]}function $SceProvider(){var enabled=!0;this.enabled=function(value){return arguments.length&&(enabled=!!value),enabled},this.$get=["$parse","$sniffer","$sceDelegate",function($parse,$sniffer,$sceDelegate){if(enabled&&$sniffer.msie&&$sniffer.msieDocumentMode<8)throw $sceMinErr("iequirks","Strict Contextual Escaping does not support Internet Explorer version < 9 in quirks mode.  You can fix this by adding the text <!doctype html> to the top of your HTML document.  See http://docs.angularjs.org/api/ng.$sce for more information.");var sce=copy(SCE_CONTEXTS);sce.isEnabled=function(){return enabled},sce.trustAs=$sceDelegate.trustAs,sce.getTrusted=$sceDelegate.getTrusted,sce.valueOf=$sceDelegate.valueOf,enabled||(sce.trustAs=sce.getTrusted=function(type,value){return value},sce.valueOf=identity),sce.parseAs=function(type,expr){var parsed=$parse(expr);return parsed.literal&&parsed.constant?parsed:function(self,locals){return sce.getTrusted(type,parsed(self,locals))}};var parse=sce.parseAs,getTrusted=sce.getTrusted,trustAs=sce.trustAs;return forEach(SCE_CONTEXTS,function(enumValue,name){var lName=lowercase(name);sce[camelCase("parse_as_"+lName)]=function(expr){return parse(enumValue,expr)},sce[camelCase("get_trusted_"+lName)]=function(value){return getTrusted(enumValue,value)},sce[camelCase("trust_as_"+lName)]=function(value){return trustAs(enumValue,value)}}),sce}]}function $SnifferProvider(){this.$get=["$window","$document",function($window,$document){var vendorPrefix,match,eventSupport={},android=int((/android (\d+)/.exec(lowercase(($window.navigator||{}).userAgent))||[])[1]),boxee=/Boxee/i.test(($window.navigator||{}).userAgent),document=$document[0]||{},documentMode=document.documentMode,vendorRegex=/^(Moz|webkit|O|ms)(?=[A-Z])/,bodyStyle=document.body&&document.body.style,transitions=!1,animations=!1;if(bodyStyle){for(var prop in bodyStyle)if(match=vendorRegex.exec(prop)){vendorPrefix=match[0],vendorPrefix=vendorPrefix.substr(0,1).toUpperCase()+vendorPrefix.substr(1);break}vendorPrefix||(vendorPrefix="WebkitOpacity"in bodyStyle&&"webkit"),transitions=!!("transition"in bodyStyle||vendorPrefix+"Transition"in bodyStyle),animations=!!("animation"in bodyStyle||vendorPrefix+"Animation"in bodyStyle),!android||transitions&&animations||(transitions=isString(document.body.style.webkitTransition),animations=isString(document.body.style.webkitAnimation))}return{history:!(!$window.history||!$window.history.pushState||4>android||boxee),hashchange:"onhashchange"in $window&&(!documentMode||documentMode>7),hasEvent:function(event){if("input"==event&&9==msie)return!1;
if(isUndefined(eventSupport[event])){var divElm=document.createElement("div");eventSupport[event]="on"+event in divElm}return eventSupport[event]},csp:csp(),vendorPrefix:vendorPrefix,transitions:transitions,animations:animations,android:android,msie:msie,msieDocumentMode:documentMode}}]}function $TimeoutProvider(){this.$get=["$rootScope","$browser","$q","$exceptionHandler",function($rootScope,$browser,$q,$exceptionHandler){function timeout(fn,delay,invokeApply){var timeoutId,deferred=$q.defer(),promise=deferred.promise,skipApply=isDefined(invokeApply)&&!invokeApply;return timeoutId=$browser.defer(function(){try{deferred.resolve(fn())}catch(e){deferred.reject(e),$exceptionHandler(e)}finally{delete deferreds[promise.$$timeoutId]}skipApply||$rootScope.$apply()},delay),promise.$$timeoutId=timeoutId,deferreds[timeoutId]=deferred,promise}var deferreds={};return timeout.cancel=function(promise){return promise&&promise.$$timeoutId in deferreds?(deferreds[promise.$$timeoutId].reject("canceled"),delete deferreds[promise.$$timeoutId],$browser.defer.cancel(promise.$$timeoutId)):!1},timeout}]}function urlResolve(url){var href=url;return msie&&(urlParsingNode.setAttribute("href",href),href=urlParsingNode.href),urlParsingNode.setAttribute("href",href),{href:urlParsingNode.href,protocol:urlParsingNode.protocol?urlParsingNode.protocol.replace(/:$/,""):"",host:urlParsingNode.host,search:urlParsingNode.search?urlParsingNode.search.replace(/^\?/,""):"",hash:urlParsingNode.hash?urlParsingNode.hash.replace(/^#/,""):"",hostname:urlParsingNode.hostname,port:urlParsingNode.port,pathname:"/"===urlParsingNode.pathname.charAt(0)?urlParsingNode.pathname:"/"+urlParsingNode.pathname}}function urlIsSameOrigin(requestUrl){var parsed=isString(requestUrl)?urlResolve(requestUrl):requestUrl;return parsed.protocol===originUrl.protocol&&parsed.host===originUrl.host}function $WindowProvider(){this.$get=valueFn(window)}function $FilterProvider($provide){function register(name,factory){if(isObject(name)){var filters={};return forEach(name,function(filter,key){filters[key]=register(key,filter)}),filters}return $provide.factory(name+suffix,factory)}var suffix="Filter";this.register=register,this.$get=["$injector",function($injector){return function(name){return $injector.get(name+suffix)}}],register("currency",currencyFilter),register("date",dateFilter),register("filter",filterFilter),register("json",jsonFilter),register("limitTo",limitToFilter),register("lowercase",lowercaseFilter),register("number",numberFilter),register("orderBy",orderByFilter),register("uppercase",uppercaseFilter)}function filterFilter(){return function(array,expression,comparator){if(!isArray(array))return array;var comparatorType=typeof comparator,predicates=[];predicates.check=function(value){for(var j=0;j<predicates.length;j++)if(!predicates[j](value))return!1;return!0},"function"!==comparatorType&&(comparator="boolean"===comparatorType&&comparator?function(obj,text){return angular.equals(obj,text)}:function(obj,text){if(obj&&text&&"object"==typeof obj&&"object"==typeof text){for(var objKey in obj)if("$"!==objKey.charAt(0)&&hasOwnProperty.call(obj,objKey)&&comparator(obj[objKey],text[objKey]))return!0;return!1}return text=(""+text).toLowerCase(),(""+obj).toLowerCase().indexOf(text)>-1});var search=function(obj,text){if("string"==typeof text&&"!"===text.charAt(0))return!search(obj,text.substr(1));switch(typeof obj){case"boolean":case"number":case"string":return comparator(obj,text);case"object":switch(typeof text){case"object":return comparator(obj,text);default:for(var objKey in obj)if("$"!==objKey.charAt(0)&&search(obj[objKey],text))return!0}return!1;case"array":for(var i=0;i<obj.length;i++)if(search(obj[i],text))return!0;return!1;default:return!1}};switch(typeof expression){case"boolean":case"number":case"string":expression={$:expression};case"object":for(var key in expression)!function(path){"undefined"!=typeof expression[path]&&predicates.push(function(value){return search("$"==path?value:value&&value[path],expression[path])})}(key);break;case"function":predicates.push(expression);break;default:return array}for(var filtered=[],j=0;j<array.length;j++){var value=array[j];predicates.check(value)&&filtered.push(value)}return filtered}}function currencyFilter($locale){var formats=$locale.NUMBER_FORMATS;return function(amount,currencySymbol){return isUndefined(currencySymbol)&&(currencySymbol=formats.CURRENCY_SYM),formatNumber(amount,formats.PATTERNS[1],formats.GROUP_SEP,formats.DECIMAL_SEP,2).replace(/\u00A4/g,currencySymbol)}}function numberFilter($locale){var formats=$locale.NUMBER_FORMATS;return function(number,fractionSize){return formatNumber(number,formats.PATTERNS[0],formats.GROUP_SEP,formats.DECIMAL_SEP,fractionSize)}}function formatNumber(number,pattern,groupSep,decimalSep,fractionSize){if(null==number||!isFinite(number)||isObject(number))return"";var isNegative=0>number;number=Math.abs(number);var numStr=number+"",formatedText="",parts=[],hasExponent=!1;if(-1!==numStr.indexOf("e")){var match=numStr.match(/([\d\.]+)e(-?)(\d+)/);match&&"-"==match[2]&&match[3]>fractionSize+1?numStr="0":(formatedText=numStr,hasExponent=!0)}if(hasExponent)fractionSize>0&&number>-1&&1>number&&(formatedText=number.toFixed(fractionSize));else{var fractionLen=(numStr.split(DECIMAL_SEP)[1]||"").length;isUndefined(fractionSize)&&(fractionSize=Math.min(Math.max(pattern.minFrac,fractionLen),pattern.maxFrac));var pow=Math.pow(10,fractionSize);number=Math.round(number*pow)/pow;var fraction=(""+number).split(DECIMAL_SEP),whole=fraction[0];fraction=fraction[1]||"";var i,pos=0,lgroup=pattern.lgSize,group=pattern.gSize;if(whole.length>=lgroup+group)for(pos=whole.length-lgroup,i=0;pos>i;i++)(pos-i)%group===0&&0!==i&&(formatedText+=groupSep),formatedText+=whole.charAt(i);for(i=pos;i<whole.length;i++)(whole.length-i)%lgroup===0&&0!==i&&(formatedText+=groupSep),formatedText+=whole.charAt(i);for(;fraction.length<fractionSize;)fraction+="0";fractionSize&&"0"!==fractionSize&&(formatedText+=decimalSep+fraction.substr(0,fractionSize))}return parts.push(isNegative?pattern.negPre:pattern.posPre),parts.push(formatedText),parts.push(isNegative?pattern.negSuf:pattern.posSuf),parts.join("")}function padNumber(num,digits,trim){var neg="";for(0>num&&(neg="-",num=-num),num=""+num;num.length<digits;)num="0"+num;return trim&&(num=num.substr(num.length-digits)),neg+num}function dateGetter(name,size,offset,trim){return offset=offset||0,function(date){var value=date["get"+name]();return(offset>0||value>-offset)&&(value+=offset),0===value&&-12==offset&&(value=12),padNumber(value,size,trim)}}function dateStrGetter(name,shortForm){return function(date,formats){var value=date["get"+name](),get=uppercase(shortForm?"SHORT"+name:name);return formats[get][value]}}function timeZoneGetter(date){var zone=-1*date.getTimezoneOffset(),paddedZone=zone>=0?"+":"";return paddedZone+=padNumber(Math[zone>0?"floor":"ceil"](zone/60),2)+padNumber(Math.abs(zone%60),2)}function ampmGetter(date,formats){return date.getHours()<12?formats.AMPMS[0]:formats.AMPMS[1]}function dateFilter($locale){function jsonStringToDate(string){var match;if(match=string.match(R_ISO8601_STR)){var date=new Date(0),tzHour=0,tzMin=0,dateSetter=match[8]?date.setUTCFullYear:date.setFullYear,timeSetter=match[8]?date.setUTCHours:date.setHours;match[9]&&(tzHour=int(match[9]+match[10]),tzMin=int(match[9]+match[11])),dateSetter.call(date,int(match[1]),int(match[2])-1,int(match[3]));var h=int(match[4]||0)-tzHour,m=int(match[5]||0)-tzMin,s=int(match[6]||0),ms=Math.round(1e3*parseFloat("0."+(match[7]||0)));return timeSetter.call(date,h,m,s,ms),date}return string}var R_ISO8601_STR=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;return function(date,format){var fn,match,text="",parts=[];if(format=format||"mediumDate",format=$locale.DATETIME_FORMATS[format]||format,isString(date)&&(date=NUMBER_STRING.test(date)?int(date):jsonStringToDate(date)),isNumber(date)&&(date=new Date(date)),!isDate(date))return date;for(;format;)match=DATE_FORMATS_SPLIT.exec(format),match?(parts=concat(parts,match,1),format=parts.pop()):(parts.push(format),format=null);return forEach(parts,function(value){fn=DATE_FORMATS[value],text+=fn?fn(date,$locale.DATETIME_FORMATS):value.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),text}}function jsonFilter(){return function(object){return toJson(object,!0)}}function limitToFilter(){return function(input,limit){if(!isArray(input)&&!isString(input))return input;if(limit=int(limit),isString(input))return limit?limit>=0?input.slice(0,limit):input.slice(limit,input.length):"";var i,n,out=[];for(limit>input.length?limit=input.length:limit<-input.length&&(limit=-input.length),limit>0?(i=0,n=limit):(i=input.length+limit,n=input.length);n>i;i++)out.push(input[i]);return out}}function orderByFilter($parse){return function(array,sortPredicate,reverseOrder){function comparator(o1,o2){for(var i=0;i<sortPredicate.length;i++){var comp=sortPredicate[i](o1,o2);if(0!==comp)return comp}return 0}function reverseComparator(comp,descending){return toBoolean(descending)?function(a,b){return comp(b,a)}:comp}function compare(v1,v2){var t1=typeof v1,t2=typeof v2;return t1==t2?("string"==t1&&(v1=v1.toLowerCase(),v2=v2.toLowerCase()),v1===v2?0:v2>v1?-1:1):t2>t1?-1:1}if(!isArray(array))return array;if(!sortPredicate)return array;sortPredicate=isArray(sortPredicate)?sortPredicate:[sortPredicate],sortPredicate=map(sortPredicate,function(predicate){var descending=!1,get=predicate||identity;return isString(predicate)&&(("+"==predicate.charAt(0)||"-"==predicate.charAt(0))&&(descending="-"==predicate.charAt(0),predicate=predicate.substring(1)),get=$parse(predicate)),reverseComparator(function(a,b){return compare(get(a),get(b))},descending)});for(var arrayCopy=[],i=0;i<array.length;i++)arrayCopy.push(array[i]);return arrayCopy.sort(reverseComparator(comparator,reverseOrder))}}function ngDirective(directive){return isFunction(directive)&&(directive={link:directive}),directive.restrict=directive.restrict||"AC",valueFn(directive)}function FormController(element,attrs,$scope,$animate){function toggleValidCss(isValid,validationErrorKey){validationErrorKey=validationErrorKey?"-"+snake_case(validationErrorKey,"-"):"",$animate.removeClass(element,(isValid?INVALID_CLASS:VALID_CLASS)+validationErrorKey),$animate.addClass(element,(isValid?VALID_CLASS:INVALID_CLASS)+validationErrorKey)}var form=this,parentForm=element.parent().controller("form")||nullFormCtrl,invalidCount=0,errors=form.$error={},controls=[];form.$name=attrs.name||attrs.ngForm,form.$dirty=!1,form.$pristine=!0,form.$valid=!0,form.$invalid=!1,parentForm.$addControl(form),element.addClass(PRISTINE_CLASS),toggleValidCss(!0),form.$addControl=function(control){assertNotHasOwnProperty(control.$name,"input"),controls.push(control),control.$name&&(form[control.$name]=control)},form.$removeControl=function(control){control.$name&&form[control.$name]===control&&delete form[control.$name],forEach(errors,function(queue,validationToken){form.$setValidity(validationToken,!0,control)}),arrayRemove(controls,control)},form.$setValidity=function(validationToken,isValid,control){var queue=errors[validationToken];if(isValid)queue&&(arrayRemove(queue,control),queue.length||(invalidCount--,invalidCount||(toggleValidCss(isValid),form.$valid=!0,form.$invalid=!1),errors[validationToken]=!1,toggleValidCss(!0,validationToken),parentForm.$setValidity(validationToken,!0,form)));else{if(invalidCount||toggleValidCss(isValid),queue){if(includes(queue,control))return}else errors[validationToken]=queue=[],invalidCount++,toggleValidCss(!1,validationToken),parentForm.$setValidity(validationToken,!1,form);queue.push(control),form.$valid=!1,form.$invalid=!0}},form.$setDirty=function(){$animate.removeClass(element,PRISTINE_CLASS),$animate.addClass(element,DIRTY_CLASS),form.$dirty=!0,form.$pristine=!1,parentForm.$setDirty()},form.$setPristine=function(){$animate.removeClass(element,DIRTY_CLASS),$animate.addClass(element,PRISTINE_CLASS),form.$dirty=!1,form.$pristine=!0,forEach(controls,function(control){control.$setPristine()})}}function validate(ctrl,validatorName,validity,value){return ctrl.$setValidity(validatorName,validity),validity?value:undefined}function addNativeHtml5Validators(ctrl,validatorName,element){var validity=element.prop("validity");if(isObject(validity)){var validator=function(value){return ctrl.$error[validatorName]||!(validity.badInput||validity.customError||validity.typeMismatch)||validity.valueMissing?value:(ctrl.$setValidity(validatorName,!1),void 0)};ctrl.$parsers.push(validator),ctrl.$formatters.push(validator)}}function textInputType(scope,element,attr,ctrl,$sniffer,$browser){var validity=element.prop("validity");if(!$sniffer.android){var composing=!1;element.on("compositionstart",function(){composing=!0}),element.on("compositionend",function(){composing=!1,listener()})}var listener=function(){if(!composing){var value=element.val();toBoolean(attr.ngTrim||"T")&&(value=trim(value)),(ctrl.$viewValue!==value||validity&&""===value&&!validity.valueMissing)&&(scope.$$phase?ctrl.$setViewValue(value):scope.$apply(function(){ctrl.$setViewValue(value)}))}};if($sniffer.hasEvent("input"))element.on("input",listener);else{var timeout,deferListener=function(){timeout||(timeout=$browser.defer(function(){listener(),timeout=null}))};element.on("keydown",function(event){var key=event.keyCode;91===key||key>15&&19>key||key>=37&&40>=key||deferListener()}),$sniffer.hasEvent("paste")&&element.on("paste cut",deferListener)}element.on("change",listener),ctrl.$render=function(){element.val(ctrl.$isEmpty(ctrl.$viewValue)?"":ctrl.$viewValue)};var patternValidator,match,pattern=attr.ngPattern;if(pattern){var validateRegex=function(regexp,value){return validate(ctrl,"pattern",ctrl.$isEmpty(value)||regexp.test(value),value)};match=pattern.match(/^\/(.*)\/([gim]*)$/),match?(pattern=new RegExp(match[1],match[2]),patternValidator=function(value){return validateRegex(pattern,value)}):patternValidator=function(value){var patternObj=scope.$eval(pattern);if(!patternObj||!patternObj.test)throw minErr("ngPattern")("noregexp","Expected {0} to be a RegExp but was {1}. Element: {2}",pattern,patternObj,startingTag(element));return validateRegex(patternObj,value)},ctrl.$formatters.push(patternValidator),ctrl.$parsers.push(patternValidator)}if(attr.ngMinlength){var minlength=int(attr.ngMinlength),minLengthValidator=function(value){return validate(ctrl,"minlength",ctrl.$isEmpty(value)||value.length>=minlength,value)};ctrl.$parsers.push(minLengthValidator),ctrl.$formatters.push(minLengthValidator)}if(attr.ngMaxlength){var maxlength=int(attr.ngMaxlength),maxLengthValidator=function(value){return validate(ctrl,"maxlength",ctrl.$isEmpty(value)||value.length<=maxlength,value)};ctrl.$parsers.push(maxLengthValidator),ctrl.$formatters.push(maxLengthValidator)}}function numberInputType(scope,element,attr,ctrl,$sniffer,$browser){if(textInputType(scope,element,attr,ctrl,$sniffer,$browser),ctrl.$parsers.push(function(value){var empty=ctrl.$isEmpty(value);return empty||NUMBER_REGEXP.test(value)?(ctrl.$setValidity("number",!0),""===value?null:empty?value:parseFloat(value)):(ctrl.$setValidity("number",!1),undefined)}),addNativeHtml5Validators(ctrl,"number",element),ctrl.$formatters.push(function(value){return ctrl.$isEmpty(value)?"":""+value}),attr.min){var minValidator=function(value){var min=parseFloat(attr.min);return validate(ctrl,"min",ctrl.$isEmpty(value)||value>=min,value)};ctrl.$parsers.push(minValidator),ctrl.$formatters.push(minValidator)}if(attr.max){var maxValidator=function(value){var max=parseFloat(attr.max);return validate(ctrl,"max",ctrl.$isEmpty(value)||max>=value,value)};ctrl.$parsers.push(maxValidator),ctrl.$formatters.push(maxValidator)}ctrl.$formatters.push(function(value){return validate(ctrl,"number",ctrl.$isEmpty(value)||isNumber(value),value)})}function urlInputType(scope,element,attr,ctrl,$sniffer,$browser){textInputType(scope,element,attr,ctrl,$sniffer,$browser);var urlValidator=function(value){return validate(ctrl,"url",ctrl.$isEmpty(value)||URL_REGEXP.test(value),value)};ctrl.$formatters.push(urlValidator),ctrl.$parsers.push(urlValidator)}function emailInputType(scope,element,attr,ctrl,$sniffer,$browser){textInputType(scope,element,attr,ctrl,$sniffer,$browser);var emailValidator=function(value){return validate(ctrl,"email",ctrl.$isEmpty(value)||EMAIL_REGEXP.test(value),value)};ctrl.$formatters.push(emailValidator),ctrl.$parsers.push(emailValidator)}function radioInputType(scope,element,attr,ctrl){isUndefined(attr.name)&&element.attr("name",nextUid()),element.on("click",function(){element[0].checked&&scope.$apply(function(){ctrl.$setViewValue(attr.value)})}),ctrl.$render=function(){var value=attr.value;element[0].checked=value==ctrl.$viewValue},attr.$observe("value",ctrl.$render)}function checkboxInputType(scope,element,attr,ctrl){var trueValue=attr.ngTrueValue,falseValue=attr.ngFalseValue;isString(trueValue)||(trueValue=!0),isString(falseValue)||(falseValue=!1),element.on("click",function(){scope.$apply(function(){ctrl.$setViewValue(element[0].checked)})}),ctrl.$render=function(){element[0].checked=ctrl.$viewValue},ctrl.$isEmpty=function(value){return value!==trueValue},ctrl.$formatters.push(function(value){return value===trueValue}),ctrl.$parsers.push(function(value){return value?trueValue:falseValue})}function classDirective(name,selector){return name="ngClass"+name,function(){return{restrict:"AC",link:function(scope,element,attr){function ngClassWatchAction(newVal){if(selector===!0||scope.$index%2===selector){var newClasses=flattenClasses(newVal||"");oldVal?equals(newVal,oldVal)||attr.$updateClass(newClasses,flattenClasses(oldVal)):attr.$addClass(newClasses)}oldVal=copy(newVal)}function flattenClasses(classVal){if(isArray(classVal))return classVal.join(" ");if(isObject(classVal)){var classes=[];return forEach(classVal,function(v,k){v&&classes.push(k)}),classes.join(" ")}return classVal}var oldVal;scope.$watch(attr[name],ngClassWatchAction,!0),attr.$observe("class",function(){ngClassWatchAction(scope.$eval(attr[name]))}),"ngClass"!==name&&scope.$watch("$index",function($index,old$index){var mod=1&$index;if(mod!==old$index&1){var classes=flattenClasses(scope.$eval(attr[name]));mod===selector?attr.$addClass(classes):attr.$removeClass(classes)}})}}}}var lowercase=function(string){return isString(string)?string.toLowerCase():string},hasOwnProperty=Object.prototype.hasOwnProperty,uppercase=function(string){return isString(string)?string.toUpperCase():string},manualLowercase=function(s){return isString(s)?s.replace(/[A-Z]/g,function(ch){return String.fromCharCode(32|ch.charCodeAt(0))}):s},manualUppercase=function(s){return isString(s)?s.replace(/[a-z]/g,function(ch){return String.fromCharCode(-33&ch.charCodeAt(0))}):s};"i"!=="I".toLowerCase()&&(lowercase=manualLowercase,uppercase=manualUppercase);var msie,jqLite,jQuery,angularModule,nodeName_,slice=[].slice,push=[].push,toString=Object.prototype.toString,ngMinErr=minErr("ng"),angular=(window.angular,window.angular||(window.angular={})),uid=["0","0","0"];msie=int((/msie (\d+)/.exec(lowercase(navigator.userAgent))||[])[1]),isNaN(msie)&&(msie=int((/trident\/.*; rv:(\d+)/.exec(lowercase(navigator.userAgent))||[])[1])),noop.$inject=[],identity.$inject=[];var trim=function(){return String.prototype.trim?function(value){return isString(value)?value.trim():value}:function(value){return isString(value)?value.replace(/^\s\s*/,"").replace(/\s\s*$/,""):value}}();nodeName_=9>msie?function(element){return element=element.nodeName?element:element[0],element.scopeName&&"HTML"!=element.scopeName?uppercase(element.scopeName+":"+element.nodeName):element.nodeName}:function(element){return element.nodeName?element.nodeName:element[0].nodeName};var SNAKE_CASE_REGEXP=/[A-Z]/g,version={full:"1.2.14",major:1,minor:2,dot:14,codeName:"feisty-cryokinesis"},jqCache=JQLite.cache={},jqName=JQLite.expando="ng-"+(new Date).getTime(),jqId=1,addEventListenerFn=window.document.addEventListener?function(element,type,fn){element.addEventListener(type,fn,!1)}:function(element,type,fn){element.attachEvent("on"+type,fn)},removeEventListenerFn=window.document.removeEventListener?function(element,type,fn){element.removeEventListener(type,fn,!1)}:function(element,type,fn){element.detachEvent("on"+type,fn)},SPECIAL_CHARS_REGEXP=(JQLite._data=function(node){return this.cache[node[this.expando]]||{}},/([\:\-\_]+(.))/g),MOZ_HACK_REGEXP=/^moz([A-Z])/,jqLiteMinErr=minErr("jqLite"),JQLitePrototype=JQLite.prototype={ready:function(fn){function trigger(){fired||(fired=!0,fn())}var fired=!1;"complete"===document.readyState?setTimeout(trigger):(this.on("DOMContentLoaded",trigger),JQLite(window).on("load",trigger))},toString:function(){var value=[];return forEach(this,function(e){value.push(""+e)}),"["+value.join(", ")+"]"},eq:function(index){return index>=0?jqLite(this[index]):jqLite(this[this.length+index])},length:0,push:push,sort:[].sort,splice:[].splice},BOOLEAN_ATTR={};forEach("multiple,selected,checked,disabled,readOnly,required,open".split(","),function(value){BOOLEAN_ATTR[lowercase(value)]=value});var BOOLEAN_ELEMENTS={};forEach("input,select,option,textarea,button,form,details".split(","),function(value){BOOLEAN_ELEMENTS[uppercase(value)]=!0}),forEach({data:jqLiteData,inheritedData:jqLiteInheritedData,scope:function(element){return jqLite(element).data("$scope")||jqLiteInheritedData(element.parentNode||element,["$isolateScope","$scope"])},isolateScope:function(element){return jqLite(element).data("$isolateScope")||jqLite(element).data("$isolateScopeNoTemplate")},controller:jqLiteController,injector:function(element){return jqLiteInheritedData(element,"$injector")},removeAttr:function(element,name){element.removeAttribute(name)},hasClass:jqLiteHasClass,css:function(element,name,value){if(name=camelCase(name),!isDefined(value)){var val;return 8>=msie&&(val=element.currentStyle&&element.currentStyle[name],""===val&&(val="auto")),val=val||element.style[name],8>=msie&&(val=""===val?undefined:val),val}element.style[name]=value},attr:function(element,name,value){var lowercasedName=lowercase(name);if(BOOLEAN_ATTR[lowercasedName]){if(!isDefined(value))return element[name]||(element.attributes.getNamedItem(name)||noop).specified?lowercasedName:undefined;value?(element[name]=!0,element.setAttribute(name,lowercasedName)):(element[name]=!1,element.removeAttribute(lowercasedName))}else if(isDefined(value))element.setAttribute(name,value);else if(element.getAttribute){var ret=element.getAttribute(name,2);return null===ret?undefined:ret}},prop:function(element,name,value){return isDefined(value)?(element[name]=value,void 0):element[name]},text:function(){function getText(element,value){var textProp=NODE_TYPE_TEXT_PROPERTY[element.nodeType];return isUndefined(value)?textProp?element[textProp]:"":(element[textProp]=value,void 0)}var NODE_TYPE_TEXT_PROPERTY=[];return 9>msie?(NODE_TYPE_TEXT_PROPERTY[1]="innerText",NODE_TYPE_TEXT_PROPERTY[3]="nodeValue"):NODE_TYPE_TEXT_PROPERTY[1]=NODE_TYPE_TEXT_PROPERTY[3]="textContent",getText.$dv="",getText}(),val:function(element,value){if(isUndefined(value)){if("SELECT"===nodeName_(element)&&element.multiple){var result=[];return forEach(element.options,function(option){option.selected&&result.push(option.value||option.text)}),0===result.length?null:result}return element.value}element.value=value},html:function(element,value){if(isUndefined(value))return element.innerHTML;for(var i=0,childNodes=element.childNodes;i<childNodes.length;i++)jqLiteDealoc(childNodes[i]);element.innerHTML=value},empty:jqLiteEmpty},function(fn,name){JQLite.prototype[name]=function(arg1,arg2){var i,key;if(fn!==jqLiteEmpty&&(2==fn.length&&fn!==jqLiteHasClass&&fn!==jqLiteController?arg1:arg2)===undefined){if(isObject(arg1)){for(i=0;i<this.length;i++)if(fn===jqLiteData)fn(this[i],arg1);else for(key in arg1)fn(this[i],key,arg1[key]);return this}for(var value=fn.$dv,jj=value===undefined?Math.min(this.length,1):this.length,j=0;jj>j;j++){var nodeValue=fn(this[j],arg1,arg2);value=value?value+nodeValue:nodeValue}return value}for(i=0;i<this.length;i++)fn(this[i],arg1,arg2);return this}}),forEach({removeData:jqLiteRemoveData,dealoc:jqLiteDealoc,on:function onFn(element,type,fn,unsupported){if(isDefined(unsupported))throw jqLiteMinErr("onargs","jqLite#on() does not support the `selector` or `eventData` parameters");var events=jqLiteExpandoStore(element,"events"),handle=jqLiteExpandoStore(element,"handle");events||jqLiteExpandoStore(element,"events",events={}),handle||jqLiteExpandoStore(element,"handle",handle=createEventHandler(element,events)),forEach(type.split(" "),function(type){var eventFns=events[type];if(!eventFns){if("mouseenter"==type||"mouseleave"==type){var contains=document.body.contains||document.body.compareDocumentPosition?function(a,b){var adown=9===a.nodeType?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!(!bup||1!==bup.nodeType||!(adown.contains?adown.contains(bup):a.compareDocumentPosition&&16&a.compareDocumentPosition(bup)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1};events[type]=[];var eventmap={mouseleave:"mouseout",mouseenter:"mouseover"};onFn(element,eventmap[type],function(event){var target=this,related=event.relatedTarget;(!related||related!==target&&!contains(target,related))&&handle(event,type)})}else addEventListenerFn(element,type,handle),events[type]=[];eventFns=events[type]}eventFns.push(fn)})},off:jqLiteOff,one:function(element,type,fn){element=jqLite(element),element.on(type,function onFn(){element.off(type,fn),element.off(type,onFn)}),element.on(type,fn)},replaceWith:function(element,replaceNode){var index,parent=element.parentNode;jqLiteDealoc(element),forEach(new JQLite(replaceNode),function(node){index?parent.insertBefore(node,index.nextSibling):parent.replaceChild(node,element),index=node})},children:function(element){var children=[];return forEach(element.childNodes,function(element){1===element.nodeType&&children.push(element)}),children},contents:function(element){return element.contentDocument||element.childNodes||[]},append:function(element,node){forEach(new JQLite(node),function(child){(1===element.nodeType||11===element.nodeType)&&element.appendChild(child)})},prepend:function(element,node){if(1===element.nodeType){var index=element.firstChild;forEach(new JQLite(node),function(child){element.insertBefore(child,index)})}},wrap:function(element,wrapNode){wrapNode=jqLite(wrapNode)[0];var parent=element.parentNode;parent&&parent.replaceChild(wrapNode,element),wrapNode.appendChild(element)},remove:function(element){jqLiteDealoc(element);var parent=element.parentNode;parent&&parent.removeChild(element)},after:function(element,newElement){var index=element,parent=element.parentNode;forEach(new JQLite(newElement),function(node){parent.insertBefore(node,index.nextSibling),index=node})},addClass:jqLiteAddClass,removeClass:jqLiteRemoveClass,toggleClass:function(element,selector,condition){selector&&forEach(selector.split(" "),function(className){var classCondition=condition;isUndefined(classCondition)&&(classCondition=!jqLiteHasClass(element,className)),(classCondition?jqLiteAddClass:jqLiteRemoveClass)(element,className)})},parent:function(element){var parent=element.parentNode;return parent&&11!==parent.nodeType?parent:null},next:function(element){if(element.nextElementSibling)return element.nextElementSibling;for(var elm=element.nextSibling;null!=elm&&1!==elm.nodeType;)elm=elm.nextSibling;return elm},find:function(element,selector){return element.getElementsByTagName?element.getElementsByTagName(selector):[]},clone:jqLiteClone,triggerHandler:function(element,eventName,eventData){var eventFns=(jqLiteExpandoStore(element,"events")||{})[eventName];eventData=eventData||[];var event=[{preventDefault:noop,stopPropagation:noop}];forEach(eventFns,function(fn){fn.apply(element,event.concat(eventData))})}},function(fn,name){JQLite.prototype[name]=function(arg1,arg2,arg3){for(var value,i=0;i<this.length;i++)isUndefined(value)?(value=fn(this[i],arg1,arg2,arg3),isDefined(value)&&(value=jqLite(value))):jqLiteAddNodes(value,fn(this[i],arg1,arg2,arg3));return isDefined(value)?value:this},JQLite.prototype.bind=JQLite.prototype.on,JQLite.prototype.unbind=JQLite.prototype.off}),HashMap.prototype={put:function(key,value){this[hashKey(key)]=value},get:function(key){return this[hashKey(key)]},remove:function(key){var value=this[key=hashKey(key)];return delete this[key],value}};var FN_ARGS=/^function\s*[^\(]*\(\s*([^\)]*)\)/m,FN_ARG_SPLIT=/,/,FN_ARG=/^\s*(_?)(\S+?)\1\s*$/,STRIP_COMMENTS=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,$injectorMinErr=minErr("$injector"),$animateMinErr=minErr("$animate"),$AnimateProvider=["$provide",function($provide){this.$$selectors={},this.register=function(name,factory){var key=name+"-animation";if(name&&"."!=name.charAt(0))throw $animateMinErr("notcsel","Expecting class selector starting with '.' got '{0}'.",name);this.$$selectors[name.substr(1)]=key,$provide.factory(key,factory)},this.classNameFilter=function(expression){return 1===arguments.length&&(this.$$classNameFilter=expression instanceof RegExp?expression:null),this.$$classNameFilter},this.$get=["$timeout","$$asyncCallback",function($timeout,$$asyncCallback){function async(fn){fn&&$$asyncCallback(fn)}return{enter:function(element,parent,after,done){after?after.after(element):(parent&&parent[0]||(parent=after.parent()),parent.append(element)),async(done)},leave:function(element,done){element.remove(),async(done)},move:function(element,parent,after,done){this.enter(element,parent,after,done)},addClass:function(element,className,done){className=isString(className)?className:isArray(className)?className.join(" "):"",forEach(element,function(element){jqLiteAddClass(element,className)}),async(done)},removeClass:function(element,className,done){className=isString(className)?className:isArray(className)?className.join(" "):"",forEach(element,function(element){jqLiteRemoveClass(element,className)}),async(done)},setClass:function(element,add,remove,done){forEach(element,function(element){jqLiteAddClass(element,add),jqLiteRemoveClass(element,remove)}),async(done)},enabled:noop}}]}],$compileMinErr=minErr("$compile");$CompileProvider.$inject=["$provide","$$sanitizeUriProvider"];var PREFIX_REGEXP=/^(x[\:\-_]|data[\:\-_])/i,$interpolateMinErr=minErr("$interpolate"),PATH_MATCH=/^([^\?#]*)(\?([^#]*))?(#(.*))?$/,DEFAULT_PORTS={http:80,https:443,ftp:21},$locationMinErr=minErr("$location");LocationHashbangInHtml5Url.prototype=LocationHashbangUrl.prototype=LocationHtml5Url.prototype={$$html5:!1,$$replace:!1,absUrl:locationGetter("$$absUrl"),url:function(url,replace){if(isUndefined(url))return this.$$url;var match=PATH_MATCH.exec(url);return match[1]&&this.path(decodeURIComponent(match[1])),(match[2]||match[1])&&this.search(match[3]||""),this.hash(match[5]||"",replace),this},protocol:locationGetter("$$protocol"),host:locationGetter("$$host"),port:locationGetter("$$port"),path:locationGetterSetter("$$path",function(path){return"/"==path.charAt(0)?path:"/"+path}),search:function(search,paramValue){switch(arguments.length){case 0:return this.$$search;case 1:if(isString(search))this.$$search=parseKeyValue(search);else{if(!isObject(search))throw $locationMinErr("isrcharg","The first argument of the `$location#search()` call must be a string or an object.");this.$$search=search}break;default:isUndefined(paramValue)||null===paramValue?delete this.$$search[search]:this.$$search[search]=paramValue}return this.$$compose(),this},hash:locationGetterSetter("$$hash",identity),replace:function(){return this.$$replace=!0,this}};var promiseWarning,$parseMinErr=minErr("$parse"),promiseWarningCache={},OPERATORS={"null":function(){return null},"true":function(){return!0},"false":function(){return!1},undefined:noop,"+":function(self,locals,a,b){return a=a(self,locals),b=b(self,locals),isDefined(a)?isDefined(b)?a+b:a:isDefined(b)?b:undefined},"-":function(self,locals,a,b){return a=a(self,locals),b=b(self,locals),(isDefined(a)?a:0)-(isDefined(b)?b:0)},"*":function(self,locals,a,b){return a(self,locals)*b(self,locals)},"/":function(self,locals,a,b){return a(self,locals)/b(self,locals)},"%":function(self,locals,a,b){return a(self,locals)%b(self,locals)},"^":function(self,locals,a,b){return a(self,locals)^b(self,locals)},"=":noop,"===":function(self,locals,a,b){return a(self,locals)===b(self,locals)},"!==":function(self,locals,a,b){return a(self,locals)!==b(self,locals)},"==":function(self,locals,a,b){return a(self,locals)==b(self,locals)},"!=":function(self,locals,a,b){return a(self,locals)!=b(self,locals)},"<":function(self,locals,a,b){return a(self,locals)<b(self,locals)},">":function(self,locals,a,b){return a(self,locals)>b(self,locals)
},"<=":function(self,locals,a,b){return a(self,locals)<=b(self,locals)},">=":function(self,locals,a,b){return a(self,locals)>=b(self,locals)},"&&":function(self,locals,a,b){return a(self,locals)&&b(self,locals)},"||":function(self,locals,a,b){return a(self,locals)||b(self,locals)},"&":function(self,locals,a,b){return a(self,locals)&b(self,locals)},"|":function(self,locals,a,b){return b(self,locals)(self,locals,a(self,locals))},"!":function(self,locals,a){return!a(self,locals)}},ESCAPE={n:"\n",f:"\f",r:"\r",t:"	",v:"","'":"'",'"':'"'},Lexer=function(options){this.options=options};Lexer.prototype={constructor:Lexer,lex:function(text){this.text=text,this.index=0,this.ch=undefined,this.lastCh=":",this.tokens=[];for(var token,json=[];this.index<this.text.length;){if(this.ch=this.text.charAt(this.index),this.is("\"'"))this.readString(this.ch);else if(this.isNumber(this.ch)||this.is(".")&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdent(this.ch))this.readIdent(),this.was("{,")&&"{"===json[0]&&(token=this.tokens[this.tokens.length-1])&&(token.json=-1===token.text.indexOf("."));else if(this.is("(){}[].,;:?"))this.tokens.push({index:this.index,text:this.ch,json:this.was(":[,")&&this.is("{[")||this.is("}]:,")}),this.is("{[")&&json.unshift(this.ch),this.is("}]")&&json.shift(),this.index++;else{if(this.isWhitespace(this.ch)){this.index++;continue}var ch2=this.ch+this.peek(),ch3=ch2+this.peek(2),fn=OPERATORS[this.ch],fn2=OPERATORS[ch2],fn3=OPERATORS[ch3];fn3?(this.tokens.push({index:this.index,text:ch3,fn:fn3}),this.index+=3):fn2?(this.tokens.push({index:this.index,text:ch2,fn:fn2}),this.index+=2):fn?(this.tokens.push({index:this.index,text:this.ch,fn:fn,json:this.was("[,:")&&this.is("+-")}),this.index+=1):this.throwError("Unexpected next character ",this.index,this.index+1)}this.lastCh=this.ch}return this.tokens},is:function(chars){return-1!==chars.indexOf(this.ch)},was:function(chars){return-1!==chars.indexOf(this.lastCh)},peek:function(i){var num=i||1;return this.index+num<this.text.length?this.text.charAt(this.index+num):!1},isNumber:function(ch){return ch>="0"&&"9">=ch},isWhitespace:function(ch){return" "===ch||"\r"===ch||"	"===ch||"\n"===ch||""===ch||" "===ch},isIdent:function(ch){return ch>="a"&&"z">=ch||ch>="A"&&"Z">=ch||"_"===ch||"$"===ch},isExpOperator:function(ch){return"-"===ch||"+"===ch||this.isNumber(ch)},throwError:function(error,start,end){end=end||this.index;var colStr=isDefined(start)?"s "+start+"-"+this.index+" ["+this.text.substring(start,end)+"]":" "+end;throw $parseMinErr("lexerr","Lexer Error: {0} at column{1} in expression [{2}].",error,colStr,this.text)},readNumber:function(){for(var number="",start=this.index;this.index<this.text.length;){var ch=lowercase(this.text.charAt(this.index));if("."==ch||this.isNumber(ch))number+=ch;else{var peekCh=this.peek();if("e"==ch&&this.isExpOperator(peekCh))number+=ch;else if(this.isExpOperator(ch)&&peekCh&&this.isNumber(peekCh)&&"e"==number.charAt(number.length-1))number+=ch;else{if(!this.isExpOperator(ch)||peekCh&&this.isNumber(peekCh)||"e"!=number.charAt(number.length-1))break;this.throwError("Invalid exponent")}}this.index++}number=1*number,this.tokens.push({index:start,text:number,json:!0,fn:function(){return number}})},readIdent:function(){for(var lastDot,peekIndex,methodName,ch,parser=this,ident="",start=this.index;this.index<this.text.length&&(ch=this.text.charAt(this.index),"."===ch||this.isIdent(ch)||this.isNumber(ch));)"."===ch&&(lastDot=this.index),ident+=ch,this.index++;if(lastDot)for(peekIndex=this.index;peekIndex<this.text.length;){if(ch=this.text.charAt(peekIndex),"("===ch){methodName=ident.substr(lastDot-start+1),ident=ident.substr(0,lastDot-start),this.index=peekIndex;break}if(!this.isWhitespace(ch))break;peekIndex++}var token={index:start,text:ident};if(OPERATORS.hasOwnProperty(ident))token.fn=OPERATORS[ident],token.json=OPERATORS[ident];else{var getter=getterFn(ident,this.options,this.text);token.fn=extend(function(self,locals){return getter(self,locals)},{assign:function(self,value){return setter(self,ident,value,parser.text,parser.options)}})}this.tokens.push(token),methodName&&(this.tokens.push({index:lastDot,text:".",json:!1}),this.tokens.push({index:lastDot+1,text:methodName,json:!1}))},readString:function(quote){var start=this.index;this.index++;for(var string="",rawString=quote,escape=!1;this.index<this.text.length;){var ch=this.text.charAt(this.index);if(rawString+=ch,escape){if("u"===ch){var hex=this.text.substring(this.index+1,this.index+5);hex.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+hex+"]"),this.index+=4,string+=String.fromCharCode(parseInt(hex,16))}else{var rep=ESCAPE[ch];string+=rep?rep:ch}escape=!1}else if("\\"===ch)escape=!0;else{if(ch===quote)return this.index++,this.tokens.push({index:start,text:rawString,string:string,json:!0,fn:function(){return string}}),void 0;string+=ch}this.index++}this.throwError("Unterminated quote",start)}};var Parser=function(lexer,$filter,options){this.lexer=lexer,this.$filter=$filter,this.options=options};Parser.ZERO=function(){return 0},Parser.prototype={constructor:Parser,parse:function(text,json){this.text=text,this.json=json,this.tokens=this.lexer.lex(text),json&&(this.assignment=this.logicalOR,this.functionCall=this.fieldAccess=this.objectIndex=this.filterChain=function(){this.throwError("is not valid json",{text:text,index:0})});var value=json?this.primary():this.statements();return 0!==this.tokens.length&&this.throwError("is an unexpected token",this.tokens[0]),value.literal=!!value.literal,value.constant=!!value.constant,value},primary:function(){var primary;if(this.expect("("))primary=this.filterChain(),this.consume(")");else if(this.expect("["))primary=this.arrayDeclaration();else if(this.expect("{"))primary=this.object();else{var token=this.expect();primary=token.fn,primary||this.throwError("not a primary expression",token),token.json&&(primary.constant=!0,primary.literal=!0)}for(var next,context;next=this.expect("(","[",".");)"("===next.text?(primary=this.functionCall(primary,context),context=null):"["===next.text?(context=primary,primary=this.objectIndex(primary)):"."===next.text?(context=primary,primary=this.fieldAccess(primary)):this.throwError("IMPOSSIBLE");return primary},throwError:function(msg,token){throw $parseMinErr("syntax","Syntax Error: Token '{0}' {1} at column {2} of the expression [{3}] starting at [{4}].",token.text,msg,token.index+1,this.text,this.text.substring(token.index))},peekToken:function(){if(0===this.tokens.length)throw $parseMinErr("ueoe","Unexpected end of expression: {0}",this.text);return this.tokens[0]},peek:function(e1,e2,e3,e4){if(this.tokens.length>0){var token=this.tokens[0],t=token.text;if(t===e1||t===e2||t===e3||t===e4||!e1&&!e2&&!e3&&!e4)return token}return!1},expect:function(e1,e2,e3,e4){var token=this.peek(e1,e2,e3,e4);return token?(this.json&&!token.json&&this.throwError("is not valid json",token),this.tokens.shift(),token):!1},consume:function(e1){this.expect(e1)||this.throwError("is unexpected, expecting ["+e1+"]",this.peek())},unaryFn:function(fn,right){return extend(function(self,locals){return fn(self,locals,right)},{constant:right.constant})},ternaryFn:function(left,middle,right){return extend(function(self,locals){return left(self,locals)?middle(self,locals):right(self,locals)},{constant:left.constant&&middle.constant&&right.constant})},binaryFn:function(left,fn,right){return extend(function(self,locals){return fn(self,locals,left,right)},{constant:left.constant&&right.constant})},statements:function(){for(var statements=[];;)if(this.tokens.length>0&&!this.peek("}",")",";","]")&&statements.push(this.filterChain()),!this.expect(";"))return 1===statements.length?statements[0]:function(self,locals){for(var value,i=0;i<statements.length;i++){var statement=statements[i];statement&&(value=statement(self,locals))}return value}},filterChain:function(){for(var token,left=this.expression();;){if(!(token=this.expect("|")))return left;left=this.binaryFn(left,token.fn,this.filter())}},filter:function(){for(var token=this.expect(),fn=this.$filter(token.text),argsFn=[];;){if(!(token=this.expect(":"))){var fnInvoke=function(self,locals,input){for(var args=[input],i=0;i<argsFn.length;i++)args.push(argsFn[i](self,locals));return fn.apply(self,args)};return function(){return fnInvoke}}argsFn.push(this.expression())}},expression:function(){return this.assignment()},assignment:function(){var right,token,left=this.ternary();return(token=this.expect("="))?(left.assign||this.throwError("implies assignment but ["+this.text.substring(0,token.index)+"] can not be assigned to",token),right=this.ternary(),function(scope,locals){return left.assign(scope,right(scope,locals),locals)}):left},ternary:function(){var middle,token,left=this.logicalOR();return(token=this.expect("?"))?(middle=this.ternary(),(token=this.expect(":"))?this.ternaryFn(left,middle,this.ternary()):(this.throwError("expected :",token),void 0)):left},logicalOR:function(){for(var token,left=this.logicalAND();;){if(!(token=this.expect("||")))return left;left=this.binaryFn(left,token.fn,this.logicalAND())}},logicalAND:function(){var token,left=this.equality();return(token=this.expect("&&"))&&(left=this.binaryFn(left,token.fn,this.logicalAND())),left},equality:function(){var token,left=this.relational();return(token=this.expect("==","!=","===","!=="))&&(left=this.binaryFn(left,token.fn,this.equality())),left},relational:function(){var token,left=this.additive();return(token=this.expect("<",">","<=",">="))&&(left=this.binaryFn(left,token.fn,this.relational())),left},additive:function(){for(var token,left=this.multiplicative();token=this.expect("+","-");)left=this.binaryFn(left,token.fn,this.multiplicative());return left},multiplicative:function(){for(var token,left=this.unary();token=this.expect("*","/","%");)left=this.binaryFn(left,token.fn,this.unary());return left},unary:function(){var token;return this.expect("+")?this.primary():(token=this.expect("-"))?this.binaryFn(Parser.ZERO,token.fn,this.unary()):(token=this.expect("!"))?this.unaryFn(token.fn,this.unary()):this.primary()},fieldAccess:function(object){var parser=this,field=this.expect().text,getter=getterFn(field,this.options,this.text);return extend(function(scope,locals,self){return getter(self||object(scope,locals))},{assign:function(scope,value,locals){return setter(object(scope,locals),field,value,parser.text,parser.options)}})},objectIndex:function(obj){var parser=this,indexFn=this.expression();return this.consume("]"),extend(function(self,locals){var v,p,o=obj(self,locals),i=indexFn(self,locals);return o?(v=ensureSafeObject(o[i],parser.text),v&&v.then&&parser.options.unwrapPromises&&(p=v,"$$v"in v||(p.$$v=undefined,p.then(function(val){p.$$v=val})),v=v.$$v),v):undefined},{assign:function(self,value,locals){var key=indexFn(self,locals),safe=ensureSafeObject(obj(self,locals),parser.text);return safe[key]=value}})},functionCall:function(fn,contextGetter){var argsFn=[];if(")"!==this.peekToken().text)do argsFn.push(this.expression());while(this.expect(","));this.consume(")");var parser=this;return function(scope,locals){for(var args=[],context=contextGetter?contextGetter(scope,locals):scope,i=0;i<argsFn.length;i++)args.push(argsFn[i](scope,locals));var fnPtr=fn(scope,locals,context)||noop;ensureSafeObject(context,parser.text),ensureSafeObject(fnPtr,parser.text);var v=fnPtr.apply?fnPtr.apply(context,args):fnPtr(args[0],args[1],args[2],args[3],args[4]);return ensureSafeObject(v,parser.text)}},arrayDeclaration:function(){var elementFns=[],allConstant=!0;if("]"!==this.peekToken().text)do{if(this.peek("]"))break;var elementFn=this.expression();elementFns.push(elementFn),elementFn.constant||(allConstant=!1)}while(this.expect(","));return this.consume("]"),extend(function(self,locals){for(var array=[],i=0;i<elementFns.length;i++)array.push(elementFns[i](self,locals));return array},{literal:!0,constant:allConstant})},object:function(){var keyValues=[],allConstant=!0;if("}"!==this.peekToken().text)do{if(this.peek("}"))break;var token=this.expect(),key=token.string||token.text;this.consume(":");var value=this.expression();keyValues.push({key:key,value:value}),value.constant||(allConstant=!1)}while(this.expect(","));return this.consume("}"),extend(function(self,locals){for(var object={},i=0;i<keyValues.length;i++){var keyValue=keyValues[i];object[keyValue.key]=keyValue.value(self,locals)}return object},{literal:!0,constant:allConstant})}};var getterFnCache={},$sceMinErr=minErr("$sce"),SCE_CONTEXTS={HTML:"html",CSS:"css",URL:"url",RESOURCE_URL:"resourceUrl",JS:"js"},urlParsingNode=document.createElement("a"),originUrl=urlResolve(window.location.href,!0);$FilterProvider.$inject=["$provide"],currencyFilter.$inject=["$locale"],numberFilter.$inject=["$locale"];var DECIMAL_SEP=".",DATE_FORMATS={yyyy:dateGetter("FullYear",4),yy:dateGetter("FullYear",2,0,!0),y:dateGetter("FullYear",1),MMMM:dateStrGetter("Month"),MMM:dateStrGetter("Month",!0),MM:dateGetter("Month",2,1),M:dateGetter("Month",1,1),dd:dateGetter("Date",2),d:dateGetter("Date",1),HH:dateGetter("Hours",2),H:dateGetter("Hours",1),hh:dateGetter("Hours",2,-12),h:dateGetter("Hours",1,-12),mm:dateGetter("Minutes",2),m:dateGetter("Minutes",1),ss:dateGetter("Seconds",2),s:dateGetter("Seconds",1),sss:dateGetter("Milliseconds",3),EEEE:dateStrGetter("Day"),EEE:dateStrGetter("Day",!0),a:ampmGetter,Z:timeZoneGetter},DATE_FORMATS_SPLIT=/((?:[^yMdHhmsaZE']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z))(.*)/,NUMBER_STRING=/^\-?\d+$/;dateFilter.$inject=["$locale"];var lowercaseFilter=valueFn(lowercase),uppercaseFilter=valueFn(uppercase);orderByFilter.$inject=["$parse"];var htmlAnchorDirective=valueFn({restrict:"E",compile:function(element,attr){return 8>=msie&&(attr.href||attr.name||attr.$set("href",""),element.append(document.createComment("IE fix"))),attr.href||attr.xlinkHref||attr.name?void 0:function(scope,element){var href="[object SVGAnimatedString]"===toString.call(element.prop("href"))?"xlink:href":"href";element.on("click",function(event){element.attr(href)||event.preventDefault()})}}}),ngAttributeAliasDirectives={};forEach(BOOLEAN_ATTR,function(propName,attrName){if("multiple"!=propName){var normalized=directiveNormalize("ng-"+attrName);ngAttributeAliasDirectives[normalized]=function(){return{priority:100,link:function(scope,element,attr){scope.$watch(attr[normalized],function(value){attr.$set(attrName,!!value)})}}}}}),forEach(["src","srcset","href"],function(attrName){var normalized=directiveNormalize("ng-"+attrName);ngAttributeAliasDirectives[normalized]=function(){return{priority:99,link:function(scope,element,attr){var propName=attrName,name=attrName;"href"===attrName&&"[object SVGAnimatedString]"===toString.call(element.prop("href"))&&(name="xlinkHref",attr.$attr[name]="xlink:href",propName=null),attr.$observe(normalized,function(value){value&&(attr.$set(name,value),msie&&propName&&element.prop(propName,attr[name]))})}}}});var nullFormCtrl={$addControl:noop,$removeControl:noop,$setValidity:noop,$setDirty:noop,$setPristine:noop};FormController.$inject=["$element","$attrs","$scope","$animate"];var formDirectiveFactory=function(isNgForm){return["$timeout",function($timeout){var formDirective={name:"form",restrict:isNgForm?"EAC":"E",controller:FormController,compile:function(){return{pre:function(scope,formElement,attr,controller){if(!attr.action){var preventDefaultListener=function(event){event.preventDefault?event.preventDefault():event.returnValue=!1};addEventListenerFn(formElement[0],"submit",preventDefaultListener),formElement.on("$destroy",function(){$timeout(function(){removeEventListenerFn(formElement[0],"submit",preventDefaultListener)},0,!1)})}var parentFormCtrl=formElement.parent().controller("form"),alias=attr.name||attr.ngForm;alias&&setter(scope,alias,controller,alias),parentFormCtrl&&formElement.on("$destroy",function(){parentFormCtrl.$removeControl(controller),alias&&setter(scope,alias,undefined,alias),extend(controller,nullFormCtrl)})}}}};return formDirective}]},formDirective=formDirectiveFactory(),ngFormDirective=formDirectiveFactory(!0),URL_REGEXP=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,EMAIL_REGEXP=/^[a-z0-9!#$%&'*+/=?^_`{|}~.-]+@[a-z0-9-]+(\.[a-z0-9-]+)*$/i,NUMBER_REGEXP=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))\s*$/,inputType={text:textInputType,number:numberInputType,url:urlInputType,email:emailInputType,radio:radioInputType,checkbox:checkboxInputType,hidden:noop,button:noop,submit:noop,reset:noop,file:noop},inputDirective=["$browser","$sniffer",function($browser,$sniffer){return{restrict:"E",require:"?ngModel",link:function(scope,element,attr,ctrl){ctrl&&(inputType[lowercase(attr.type)]||inputType.text)(scope,element,attr,ctrl,$sniffer,$browser)}}}],VALID_CLASS="ng-valid",INVALID_CLASS="ng-invalid",PRISTINE_CLASS="ng-pristine",DIRTY_CLASS="ng-dirty",NgModelController=["$scope","$exceptionHandler","$attrs","$element","$parse","$animate",function($scope,$exceptionHandler,$attr,$element,$parse,$animate){function toggleValidCss(isValid,validationErrorKey){validationErrorKey=validationErrorKey?"-"+snake_case(validationErrorKey,"-"):"",$animate.removeClass($element,(isValid?INVALID_CLASS:VALID_CLASS)+validationErrorKey),$animate.addClass($element,(isValid?VALID_CLASS:INVALID_CLASS)+validationErrorKey)}this.$viewValue=Number.NaN,this.$modelValue=Number.NaN,this.$parsers=[],this.$formatters=[],this.$viewChangeListeners=[],this.$pristine=!0,this.$dirty=!1,this.$valid=!0,this.$invalid=!1,this.$name=$attr.name;var ngModelGet=$parse($attr.ngModel),ngModelSet=ngModelGet.assign;if(!ngModelSet)throw minErr("ngModel")("nonassign","Expression '{0}' is non-assignable. Element: {1}",$attr.ngModel,startingTag($element));this.$render=noop,this.$isEmpty=function(value){return isUndefined(value)||""===value||null===value||value!==value};var parentForm=$element.inheritedData("$formController")||nullFormCtrl,invalidCount=0,$error=this.$error={};$element.addClass(PRISTINE_CLASS),toggleValidCss(!0),this.$setValidity=function(validationErrorKey,isValid){$error[validationErrorKey]!==!isValid&&(isValid?($error[validationErrorKey]&&invalidCount--,invalidCount||(toggleValidCss(!0),this.$valid=!0,this.$invalid=!1)):(toggleValidCss(!1),this.$invalid=!0,this.$valid=!1,invalidCount++),$error[validationErrorKey]=!isValid,toggleValidCss(isValid,validationErrorKey),parentForm.$setValidity(validationErrorKey,isValid,this))},this.$setPristine=function(){this.$dirty=!1,this.$pristine=!0,$animate.removeClass($element,DIRTY_CLASS),$animate.addClass($element,PRISTINE_CLASS)},this.$setViewValue=function(value){this.$viewValue=value,this.$pristine&&(this.$dirty=!0,this.$pristine=!1,$animate.removeClass($element,PRISTINE_CLASS),$animate.addClass($element,DIRTY_CLASS),parentForm.$setDirty()),forEach(this.$parsers,function(fn){value=fn(value)}),this.$modelValue!==value&&(this.$modelValue=value,ngModelSet($scope,value),forEach(this.$viewChangeListeners,function(listener){try{listener()}catch(e){$exceptionHandler(e)}}))};var ctrl=this;$scope.$watch(function(){var value=ngModelGet($scope);if(ctrl.$modelValue!==value){var formatters=ctrl.$formatters,idx=formatters.length;for(ctrl.$modelValue=value;idx--;)value=formatters[idx](value);ctrl.$viewValue!==value&&(ctrl.$viewValue=value,ctrl.$render())}return value})}],ngModelDirective=function(){return{require:["ngModel","^?form"],controller:NgModelController,link:function(scope,element,attr,ctrls){var modelCtrl=ctrls[0],formCtrl=ctrls[1]||nullFormCtrl;formCtrl.$addControl(modelCtrl),scope.$on("$destroy",function(){formCtrl.$removeControl(modelCtrl)})}}},ngChangeDirective=valueFn({require:"ngModel",link:function(scope,element,attr,ctrl){ctrl.$viewChangeListeners.push(function(){scope.$eval(attr.ngChange)})}}),requiredDirective=function(){return{require:"?ngModel",link:function(scope,elm,attr,ctrl){if(ctrl){attr.required=!0;var validator=function(value){return attr.required&&ctrl.$isEmpty(value)?(ctrl.$setValidity("required",!1),void 0):(ctrl.$setValidity("required",!0),value)};ctrl.$formatters.push(validator),ctrl.$parsers.unshift(validator),attr.$observe("required",function(){validator(ctrl.$viewValue)})}}}},ngListDirective=function(){return{require:"ngModel",link:function(scope,element,attr,ctrl){var match=/\/(.*)\//.exec(attr.ngList),separator=match&&new RegExp(match[1])||attr.ngList||",",parse=function(viewValue){if(!isUndefined(viewValue)){var list=[];return viewValue&&forEach(viewValue.split(separator),function(value){value&&list.push(trim(value))}),list}};ctrl.$parsers.push(parse),ctrl.$formatters.push(function(value){return isArray(value)?value.join(", "):undefined}),ctrl.$isEmpty=function(value){return!value||!value.length}}}},CONSTANT_VALUE_REGEXP=/^(true|false|\d+)$/,ngValueDirective=function(){return{priority:100,compile:function(tpl,tplAttr){return CONSTANT_VALUE_REGEXP.test(tplAttr.ngValue)?function(scope,elm,attr){attr.$set("value",scope.$eval(attr.ngValue))}:function(scope,elm,attr){scope.$watch(attr.ngValue,function(value){attr.$set("value",value)})}}}},ngBindDirective=ngDirective(function(scope,element,attr){element.addClass("ng-binding").data("$binding",attr.ngBind),scope.$watch(attr.ngBind,function(value){element.text(value==undefined?"":value)})}),ngBindTemplateDirective=["$interpolate",function($interpolate){return function(scope,element,attr){var interpolateFn=$interpolate(element.attr(attr.$attr.ngBindTemplate));element.addClass("ng-binding").data("$binding",interpolateFn),attr.$observe("ngBindTemplate",function(value){element.text(value)})}}],ngBindHtmlDirective=["$sce","$parse",function($sce,$parse){return function(scope,element,attr){function getStringValue(){return(parsed(scope)||"").toString()}element.addClass("ng-binding").data("$binding",attr.ngBindHtml);var parsed=$parse(attr.ngBindHtml);scope.$watch(getStringValue,function(){element.html($sce.getTrustedHtml(parsed(scope))||"")})}}],ngClassDirective=classDirective("",!0),ngClassOddDirective=classDirective("Odd",0),ngClassEvenDirective=classDirective("Even",1),ngCloakDirective=ngDirective({compile:function(element,attr){attr.$set("ngCloak",undefined),element.removeClass("ng-cloak")}}),ngControllerDirective=[function(){return{scope:!0,controller:"@",priority:500}}],ngEventDirectives={};forEach("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "),function(name){var directiveName=directiveNormalize("ng-"+name);ngEventDirectives[directiveName]=["$parse",function($parse){return{compile:function($element,attr){var fn=$parse(attr[directiveName]);return function(scope,element){element.on(lowercase(name),function(event){scope.$apply(function(){fn(scope,{$event:event})})})}}}}]});var ngIfDirective=["$animate",function($animate){return{transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function($scope,$element,$attr,ctrl,$transclude){var block,childScope,previousElements;$scope.$watch($attr.ngIf,function(value){toBoolean(value)?childScope||(childScope=$scope.$new(),$transclude(childScope,function(clone){clone[clone.length++]=document.createComment(" end ngIf: "+$attr.ngIf+" "),block={clone:clone},$animate.enter(clone,$element.parent(),$element)})):(previousElements&&(previousElements.remove(),previousElements=null),childScope&&(childScope.$destroy(),childScope=null),block&&(previousElements=getBlockElements(block.clone),$animate.leave(previousElements,function(){previousElements=null}),block=null))})}}}],ngIncludeDirective=["$http","$templateCache","$anchorScroll","$animate","$sce",function($http,$templateCache,$anchorScroll,$animate,$sce){return{restrict:"ECA",priority:400,terminal:!0,transclude:"element",controller:angular.noop,compile:function(element,attr){var srcExp=attr.ngInclude||attr.src,onloadExp=attr.onload||"",autoScrollExp=attr.autoscroll;return function(scope,$element,$attr,ctrl,$transclude){var currentScope,previousElement,currentElement,changeCounter=0,cleanupLastIncludeContent=function(){previousElement&&(previousElement.remove(),previousElement=null),currentScope&&(currentScope.$destroy(),currentScope=null),currentElement&&($animate.leave(currentElement,function(){previousElement=null}),previousElement=currentElement,currentElement=null)};scope.$watch($sce.parseAsResourceUrl(srcExp),function(src){var afterAnimation=function(){!isDefined(autoScrollExp)||autoScrollExp&&!scope.$eval(autoScrollExp)||$anchorScroll()},thisChangeId=++changeCounter;src?($http.get(src,{cache:$templateCache}).success(function(response){if(thisChangeId===changeCounter){var newScope=scope.$new();ctrl.template=response;var clone=$transclude(newScope,function(clone){cleanupLastIncludeContent(),$animate.enter(clone,null,$element,afterAnimation)});currentScope=newScope,currentElement=clone,currentScope.$emit("$includeContentLoaded"),scope.$eval(onloadExp)}}).error(function(){thisChangeId===changeCounter&&cleanupLastIncludeContent()}),scope.$emit("$includeContentRequested")):(cleanupLastIncludeContent(),ctrl.template=null)})}}}}],ngIncludeFillContentDirective=["$compile",function($compile){return{restrict:"ECA",priority:-400,require:"ngInclude",link:function(scope,$element,$attr,ctrl){$element.html(ctrl.template),$compile($element.contents())(scope)}}}],ngInitDirective=ngDirective({priority:450,compile:function(){return{pre:function(scope,element,attrs){scope.$eval(attrs.ngInit)}}}}),ngNonBindableDirective=ngDirective({terminal:!0,priority:1e3}),ngPluralizeDirective=["$locale","$interpolate",function($locale,$interpolate){var BRACE=/{}/g;return{restrict:"EA",link:function(scope,element,attr){var numberExp=attr.count,whenExp=attr.$attr.when&&element.attr(attr.$attr.when),offset=attr.offset||0,whens=scope.$eval(whenExp)||{},whensExpFns={},startSymbol=$interpolate.startSymbol(),endSymbol=$interpolate.endSymbol(),isWhen=/^when(Minus)?(.+)$/;forEach(attr,function(expression,attributeName){isWhen.test(attributeName)&&(whens[lowercase(attributeName.replace("when","").replace("Minus","-"))]=element.attr(attr.$attr[attributeName]))}),forEach(whens,function(expression,key){whensExpFns[key]=$interpolate(expression.replace(BRACE,startSymbol+numberExp+"-"+offset+endSymbol))}),scope.$watch(function(){var value=parseFloat(scope.$eval(numberExp));return isNaN(value)?"":(value in whens||(value=$locale.pluralCat(value-offset)),whensExpFns[value](scope,element,!0))},function(newVal){element.text(newVal)})}}}],ngRepeatDirective=["$parse","$animate",function($parse,$animate){function getBlockStart(block){return block.clone[0]}function getBlockEnd(block){return block.clone[block.clone.length-1]}var NG_REMOVED="$$NG_REMOVED",ngRepeatMinErr=minErr("ngRepeat");return{transclude:"element",priority:1e3,terminal:!0,$$tlb:!0,link:function($scope,$element,$attr,ctrl,$transclude){var trackByExp,trackByExpGetter,trackByIdExpFn,trackByIdArrayFn,trackByIdObjFn,lhs,rhs,valueIdentifier,keyIdentifier,expression=$attr.ngRepeat,match=expression.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?\s*$/),hashFnLocals={$id:hashKey};if(!match)throw ngRepeatMinErr("iexp","Expected expression in form of '_item_ in _collection_[ track by _id_]' but got '{0}'.",expression);if(lhs=match[1],rhs=match[2],trackByExp=match[3],trackByExp?(trackByExpGetter=$parse(trackByExp),trackByIdExpFn=function(key,value,index){return keyIdentifier&&(hashFnLocals[keyIdentifier]=key),hashFnLocals[valueIdentifier]=value,hashFnLocals.$index=index,trackByExpGetter($scope,hashFnLocals)}):(trackByIdArrayFn=function(key,value){return hashKey(value)},trackByIdObjFn=function(key){return key}),match=lhs.match(/^(?:([\$\w]+)|\(([\$\w]+)\s*,\s*([\$\w]+)\))$/),!match)throw ngRepeatMinErr("iidexp","'_item_' in '_item_ in _collection_' should be an identifier or '(_key_, _value_)' expression, but got '{0}'.",lhs);valueIdentifier=match[3]||match[1],keyIdentifier=match[2];var lastBlockMap={};$scope.$watchCollection(rhs,function(collection){var index,length,nextNode,arrayLength,childScope,key,value,trackById,trackByIdFn,collectionKeys,block,elementsToRemove,previousNode=$element[0],nextBlockMap={},nextBlockOrder=[];if(isArrayLike(collection))collectionKeys=collection,trackByIdFn=trackByIdExpFn||trackByIdArrayFn;else{trackByIdFn=trackByIdExpFn||trackByIdObjFn,collectionKeys=[];for(key in collection)collection.hasOwnProperty(key)&&"$"!=key.charAt(0)&&collectionKeys.push(key);collectionKeys.sort()}for(arrayLength=collectionKeys.length,length=nextBlockOrder.length=collectionKeys.length,index=0;length>index;index++)if(key=collection===collectionKeys?index:collectionKeys[index],value=collection[key],trackById=trackByIdFn(key,value,index),assertNotHasOwnProperty(trackById,"`track by` id"),lastBlockMap.hasOwnProperty(trackById))block=lastBlockMap[trackById],delete lastBlockMap[trackById],nextBlockMap[trackById]=block,nextBlockOrder[index]=block;else{if(nextBlockMap.hasOwnProperty(trackById))throw forEach(nextBlockOrder,function(block){block&&block.scope&&(lastBlockMap[block.id]=block)}),ngRepeatMinErr("dupes","Duplicates in a repeater are not allowed. Use 'track by' expression to specify unique keys. Repeater: {0}, Duplicate key: {1}",expression,trackById);nextBlockOrder[index]={id:trackById},nextBlockMap[trackById]=!1}for(key in lastBlockMap)lastBlockMap.hasOwnProperty(key)&&(block=lastBlockMap[key],elementsToRemove=getBlockElements(block.clone),$animate.leave(elementsToRemove),forEach(elementsToRemove,function(element){element[NG_REMOVED]=!0}),block.scope.$destroy());for(index=0,length=collectionKeys.length;length>index;index++){if(key=collection===collectionKeys?index:collectionKeys[index],value=collection[key],block=nextBlockOrder[index],nextBlockOrder[index-1]&&(previousNode=getBlockEnd(nextBlockOrder[index-1])),block.scope){childScope=block.scope,nextNode=previousNode;do nextNode=nextNode.nextSibling;while(nextNode&&nextNode[NG_REMOVED]);getBlockStart(block)!=nextNode&&$animate.move(getBlockElements(block.clone),null,jqLite(previousNode)),previousNode=getBlockEnd(block)}else childScope=$scope.$new();childScope[valueIdentifier]=value,keyIdentifier&&(childScope[keyIdentifier]=key),childScope.$index=index,childScope.$first=0===index,childScope.$last=index===arrayLength-1,childScope.$middle=!(childScope.$first||childScope.$last),childScope.$odd=!(childScope.$even=0===(1&index)),block.scope||$transclude(childScope,function(clone){clone[clone.length++]=document.createComment(" end ngRepeat: "+expression+" "),$animate.enter(clone,null,jqLite(previousNode)),previousNode=clone,block.scope=childScope,block.clone=clone,nextBlockMap[block.id]=block})}lastBlockMap=nextBlockMap})}}}],ngShowDirective=["$animate",function($animate){return function(scope,element,attr){scope.$watch(attr.ngShow,function(value){$animate[toBoolean(value)?"removeClass":"addClass"](element,"ng-hide")})}}],ngHideDirective=["$animate",function($animate){return function(scope,element,attr){scope.$watch(attr.ngHide,function(value){$animate[toBoolean(value)?"addClass":"removeClass"](element,"ng-hide")})}}],ngStyleDirective=ngDirective(function(scope,element,attr){scope.$watch(attr.ngStyle,function(newStyles,oldStyles){oldStyles&&newStyles!==oldStyles&&forEach(oldStyles,function(val,style){element.css(style,"")}),newStyles&&element.css(newStyles)},!0)}),ngSwitchDirective=["$animate",function($animate){return{restrict:"EA",require:"ngSwitch",controller:["$scope",function(){this.cases={}}],link:function(scope,element,attr,ngSwitchController){var selectedTranscludes,selectedElements,previousElements,watchExpr=attr.ngSwitch||attr.on,selectedScopes=[];scope.$watch(watchExpr,function(value){var i,ii=selectedScopes.length;if(ii>0){if(previousElements){for(i=0;ii>i;i++)previousElements[i].remove();previousElements=null}for(previousElements=[],i=0;ii>i;i++){var selected=selectedElements[i];selectedScopes[i].$destroy(),previousElements[i]=selected,$animate.leave(selected,function(){previousElements.splice(i,1),0===previousElements.length&&(previousElements=null)})}}selectedElements=[],selectedScopes=[],(selectedTranscludes=ngSwitchController.cases["!"+value]||ngSwitchController.cases["?"])&&(scope.$eval(attr.change),forEach(selectedTranscludes,function(selectedTransclude){var selectedScope=scope.$new();selectedScopes.push(selectedScope),selectedTransclude.transclude(selectedScope,function(caseElement){var anchor=selectedTransclude.element;selectedElements.push(caseElement),$animate.enter(caseElement,anchor.parent(),anchor)})}))})}}}],ngSwitchWhenDirective=ngDirective({transclude:"element",priority:800,require:"^ngSwitch",link:function(scope,element,attrs,ctrl,$transclude){ctrl.cases["!"+attrs.ngSwitchWhen]=ctrl.cases["!"+attrs.ngSwitchWhen]||[],ctrl.cases["!"+attrs.ngSwitchWhen].push({transclude:$transclude,element:element})
}}),ngSwitchDefaultDirective=ngDirective({transclude:"element",priority:800,require:"^ngSwitch",link:function(scope,element,attr,ctrl,$transclude){ctrl.cases["?"]=ctrl.cases["?"]||[],ctrl.cases["?"].push({transclude:$transclude,element:element})}}),ngTranscludeDirective=ngDirective({link:function($scope,$element,$attrs,controller,$transclude){if(!$transclude)throw minErr("ngTransclude")("orphan","Illegal use of ngTransclude directive in the template! No parent directive that requires a transclusion found. Element: {0}",startingTag($element));$transclude(function(clone){$element.empty(),$element.append(clone)})}}),scriptDirective=["$templateCache",function($templateCache){return{restrict:"E",terminal:!0,compile:function(element,attr){if("text/ng-template"==attr.type){var templateUrl=attr.id,text=element[0].text;$templateCache.put(templateUrl,text)}}}}],ngOptionsMinErr=minErr("ngOptions"),ngOptionsDirective=valueFn({terminal:!0}),selectDirective=["$compile","$parse",function($compile,$parse){var NG_OPTIONS_REGEXP=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,nullModelCtrl={$setViewValue:noop};return{restrict:"E",require:["select","?ngModel"],controller:["$element","$scope","$attrs",function($element,$scope,$attrs){var nullOption,unknownOption,self=this,optionsMap={},ngModelCtrl=nullModelCtrl;self.databound=$attrs.ngModel,self.init=function(ngModelCtrl_,nullOption_,unknownOption_){ngModelCtrl=ngModelCtrl_,nullOption=nullOption_,unknownOption=unknownOption_},self.addOption=function(value){assertNotHasOwnProperty(value,'"option value"'),optionsMap[value]=!0,ngModelCtrl.$viewValue==value&&($element.val(value),unknownOption.parent()&&unknownOption.remove())},self.removeOption=function(value){this.hasOption(value)&&(delete optionsMap[value],ngModelCtrl.$viewValue==value&&this.renderUnknownOption(value))},self.renderUnknownOption=function(val){var unknownVal="? "+hashKey(val)+" ?";unknownOption.val(unknownVal),$element.prepend(unknownOption),$element.val(unknownVal),unknownOption.prop("selected",!0)},self.hasOption=function(value){return optionsMap.hasOwnProperty(value)},$scope.$on("$destroy",function(){self.renderUnknownOption=noop})}],link:function(scope,element,attr,ctrls){function setupAsSingle(scope,selectElement,ngModelCtrl,selectCtrl){ngModelCtrl.$render=function(){var viewValue=ngModelCtrl.$viewValue;selectCtrl.hasOption(viewValue)?(unknownOption.parent()&&unknownOption.remove(),selectElement.val(viewValue),""===viewValue&&emptyOption.prop("selected",!0)):isUndefined(viewValue)&&emptyOption?selectElement.val(""):selectCtrl.renderUnknownOption(viewValue)},selectElement.on("change",function(){scope.$apply(function(){unknownOption.parent()&&unknownOption.remove(),ngModelCtrl.$setViewValue(selectElement.val())})})}function setupAsMultiple(scope,selectElement,ctrl){var lastView;ctrl.$render=function(){var items=new HashMap(ctrl.$viewValue);forEach(selectElement.find("option"),function(option){option.selected=isDefined(items.get(option.value))})},scope.$watch(function(){equals(lastView,ctrl.$viewValue)||(lastView=copy(ctrl.$viewValue),ctrl.$render())}),selectElement.on("change",function(){scope.$apply(function(){var array=[];forEach(selectElement.find("option"),function(option){option.selected&&array.push(option.value)}),ctrl.$setViewValue(array)})})}function setupAsOptions(scope,selectElement,ctrl){function render(){var optionGroupName,optionGroup,option,existingParent,existingOptions,existingOption,key,groupLength,length,groupIndex,index,selected,lastElement,element,label,optionGroups={"":[]},optionGroupNames=[""],modelValue=ctrl.$modelValue,values=valuesFn(scope)||[],keys=keyName?sortedKeys(values):values,locals={},selectedSet=!1;if(multiple)if(trackFn&&isArray(modelValue)){selectedSet=new HashMap([]);for(var trackIndex=0;trackIndex<modelValue.length;trackIndex++)locals[valueName]=modelValue[trackIndex],selectedSet.put(trackFn(scope,locals),modelValue[trackIndex])}else selectedSet=new HashMap(modelValue);for(index=0;length=keys.length,length>index;index++){if(key=index,keyName){if(key=keys[index],"$"===key.charAt(0))continue;locals[keyName]=key}if(locals[valueName]=values[key],optionGroupName=groupByFn(scope,locals)||"",(optionGroup=optionGroups[optionGroupName])||(optionGroup=optionGroups[optionGroupName]=[],optionGroupNames.push(optionGroupName)),multiple)selected=isDefined(selectedSet.remove(trackFn?trackFn(scope,locals):valueFn(scope,locals)));else{if(trackFn){var modelCast={};modelCast[valueName]=modelValue,selected=trackFn(scope,modelCast)===trackFn(scope,locals)}else selected=modelValue===valueFn(scope,locals);selectedSet=selectedSet||selected}label=displayFn(scope,locals),label=isDefined(label)?label:"",optionGroup.push({id:trackFn?trackFn(scope,locals):keyName?keys[index]:index,label:label,selected:selected})}for(multiple||(nullOption||null===modelValue?optionGroups[""].unshift({id:"",label:"",selected:!selectedSet}):selectedSet||optionGroups[""].unshift({id:"?",label:"",selected:!0})),groupIndex=0,groupLength=optionGroupNames.length;groupLength>groupIndex;groupIndex++){for(optionGroupName=optionGroupNames[groupIndex],optionGroup=optionGroups[optionGroupName],optionGroupsCache.length<=groupIndex?(existingParent={element:optGroupTemplate.clone().attr("label",optionGroupName),label:optionGroup.label},existingOptions=[existingParent],optionGroupsCache.push(existingOptions),selectElement.append(existingParent.element)):(existingOptions=optionGroupsCache[groupIndex],existingParent=existingOptions[0],existingParent.label!=optionGroupName&&existingParent.element.attr("label",existingParent.label=optionGroupName)),lastElement=null,index=0,length=optionGroup.length;length>index;index++)option=optionGroup[index],(existingOption=existingOptions[index+1])?(lastElement=existingOption.element,existingOption.label!==option.label&&lastElement.text(existingOption.label=option.label),existingOption.id!==option.id&&lastElement.val(existingOption.id=option.id),lastElement[0].selected!==option.selected&&lastElement.prop("selected",existingOption.selected=option.selected)):(""===option.id&&nullOption?element=nullOption:(element=optionTemplate.clone()).val(option.id).attr("selected",option.selected).text(option.label),existingOptions.push(existingOption={element:element,label:option.label,id:option.id,selected:option.selected}),lastElement?lastElement.after(element):existingParent.element.append(element),lastElement=element);for(index++;existingOptions.length>index;)existingOptions.pop().element.remove()}for(;optionGroupsCache.length>groupIndex;)optionGroupsCache.pop()[0].element.remove()}var match;if(!(match=optionsExp.match(NG_OPTIONS_REGEXP)))throw ngOptionsMinErr("iexp","Expected expression in form of '_select_ (as _label_)? for (_key_,)?_value_ in _collection_' but got '{0}'. Element: {1}",optionsExp,startingTag(selectElement));var displayFn=$parse(match[2]||match[1]),valueName=match[4]||match[6],keyName=match[5],groupByFn=$parse(match[3]||""),valueFn=$parse(match[2]?match[1]:valueName),valuesFn=$parse(match[7]),track=match[8],trackFn=track?$parse(match[8]):null,optionGroupsCache=[[{element:selectElement,label:""}]];nullOption&&($compile(nullOption)(scope),nullOption.removeClass("ng-scope"),nullOption.remove()),selectElement.empty(),selectElement.on("change",function(){scope.$apply(function(){var optionGroup,key,value,optionElement,index,groupIndex,length,groupLength,trackIndex,collection=valuesFn(scope)||[],locals={};if(multiple){for(value=[],groupIndex=0,groupLength=optionGroupsCache.length;groupLength>groupIndex;groupIndex++)for(optionGroup=optionGroupsCache[groupIndex],index=1,length=optionGroup.length;length>index;index++)if((optionElement=optionGroup[index].element)[0].selected){if(key=optionElement.val(),keyName&&(locals[keyName]=key),trackFn)for(trackIndex=0;trackIndex<collection.length&&(locals[valueName]=collection[trackIndex],trackFn(scope,locals)!=key);trackIndex++);else locals[valueName]=collection[key];value.push(valueFn(scope,locals))}}else if(key=selectElement.val(),"?"==key)value=undefined;else if(""===key)value=null;else if(trackFn){for(trackIndex=0;trackIndex<collection.length;trackIndex++)if(locals[valueName]=collection[trackIndex],trackFn(scope,locals)==key){value=valueFn(scope,locals);break}}else locals[valueName]=collection[key],keyName&&(locals[keyName]=key),value=valueFn(scope,locals);ctrl.$setViewValue(value)})}),ctrl.$render=render,scope.$watch(render)}if(ctrls[1]){for(var emptyOption,selectCtrl=ctrls[0],ngModelCtrl=ctrls[1],multiple=attr.multiple,optionsExp=attr.ngOptions,nullOption=!1,optionTemplate=jqLite(document.createElement("option")),optGroupTemplate=jqLite(document.createElement("optgroup")),unknownOption=optionTemplate.clone(),i=0,children=element.children(),ii=children.length;ii>i;i++)if(""===children[i].value){emptyOption=nullOption=children.eq(i);break}selectCtrl.init(ngModelCtrl,nullOption,unknownOption),multiple&&(ngModelCtrl.$isEmpty=function(value){return!value||0===value.length}),optionsExp?setupAsOptions(scope,element,ngModelCtrl):multiple?setupAsMultiple(scope,element,ngModelCtrl):setupAsSingle(scope,element,ngModelCtrl,selectCtrl)}}}}],optionDirective=["$interpolate",function($interpolate){var nullSelectCtrl={addOption:noop,removeOption:noop};return{restrict:"E",priority:100,compile:function(element,attr){if(isUndefined(attr.value)){var interpolateFn=$interpolate(element.text(),!0);interpolateFn||attr.$set("value",element.text())}return function(scope,element,attr){var selectCtrlName="$selectController",parent=element.parent(),selectCtrl=parent.data(selectCtrlName)||parent.parent().data(selectCtrlName);selectCtrl&&selectCtrl.databound?element.prop("selected",!1):selectCtrl=nullSelectCtrl,interpolateFn?scope.$watch(interpolateFn,function(newVal,oldVal){attr.$set("value",newVal),newVal!==oldVal&&selectCtrl.removeOption(oldVal),selectCtrl.addOption(newVal)}):selectCtrl.addOption(attr.value),element.on("$destroy",function(){selectCtrl.removeOption(attr.value)})}}}}],styleDirective=valueFn({restrict:"E",terminal:!0});bindJQuery(),publishExternalAPI(angular),jqLite(document).ready(function(){angularInit(document,bootstrap)})}(window,document),!angular.$$csp()&&angular.element(document).find("head").prepend('<style type="text/css">@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide{display:none !important;}ng\\:form{display:block;}.ng-animate-block-transitions{transition:0s all!important;-webkit-transition:0s all!important;}</style>'),function(window,angular){"use strict";function $SanitizeProvider(){this.$get=["$$sanitizeUri",function($$sanitizeUri){return function(html){var buf=[];return htmlParser(html,htmlSanitizeWriter(buf,function(uri,isImage){return!/^unsafe/.test($$sanitizeUri(uri,isImage))})),buf.join("")}}]}function sanitizeText(chars){var buf=[],writer=htmlSanitizeWriter(buf,angular.noop);return writer.chars(chars),buf.join("")}function makeMap(str){var i,obj={},items=str.split(",");for(i=0;i<items.length;i++)obj[items[i]]=!0;return obj}function htmlParser(html,handler){function parseStartTag(tag,tagName,rest,unary){if(tagName=angular.lowercase(tagName),blockElements[tagName])for(;stack.last()&&inlineElements[stack.last()];)parseEndTag("",stack.last());optionalEndTagElements[tagName]&&stack.last()==tagName&&parseEndTag("",tagName),unary=voidElements[tagName]||!!unary,unary||stack.push(tagName);var attrs={};rest.replace(ATTR_REGEXP,function(match,name,doubleQuotedValue,singleQuotedValue,unquotedValue){var value=doubleQuotedValue||singleQuotedValue||unquotedValue||"";attrs[name]=decodeEntities(value)}),handler.start&&handler.start(tagName,attrs,unary)}function parseEndTag(tag,tagName){var i,pos=0;if(tagName=angular.lowercase(tagName))for(pos=stack.length-1;pos>=0&&stack[pos]!=tagName;pos--);if(pos>=0){for(i=stack.length-1;i>=pos;i--)handler.end&&handler.end(stack[i]);stack.length=pos}}var index,chars,match,stack=[],last=html;for(stack.last=function(){return stack[stack.length-1]};html;){if(chars=!0,stack.last()&&specialElements[stack.last()])html=html.replace(new RegExp("(.*)<\\s*\\/\\s*"+stack.last()+"[^>]*>","i"),function(all,text){return text=text.replace(COMMENT_REGEXP,"$1").replace(CDATA_REGEXP,"$1"),handler.chars&&handler.chars(decodeEntities(text)),""}),parseEndTag("",stack.last());else if(0===html.indexOf("<!--")?(index=html.indexOf("--",4),index>=0&&html.lastIndexOf("-->",index)===index&&(handler.comment&&handler.comment(html.substring(4,index)),html=html.substring(index+3),chars=!1)):DOCTYPE_REGEXP.test(html)?(match=html.match(DOCTYPE_REGEXP),match&&(html=html.replace(match[0],""),chars=!1)):BEGING_END_TAGE_REGEXP.test(html)?(match=html.match(END_TAG_REGEXP),match&&(html=html.substring(match[0].length),match[0].replace(END_TAG_REGEXP,parseEndTag),chars=!1)):BEGIN_TAG_REGEXP.test(html)&&(match=html.match(START_TAG_REGEXP),match&&(html=html.substring(match[0].length),match[0].replace(START_TAG_REGEXP,parseStartTag),chars=!1)),chars){index=html.indexOf("<");var text=0>index?html:html.substring(0,index);html=0>index?"":html.substring(index),handler.chars&&handler.chars(decodeEntities(text))}if(html==last)throw $sanitizeMinErr("badparse","The sanitizer was unable to parse the following block of html: {0}",html);last=html}parseEndTag()}function decodeEntities(value){if(!value)return"";var parts=spaceRe.exec(value),spaceBefore=parts[1],spaceAfter=parts[3],content=parts[2];return content&&(hiddenPre.innerHTML=content.replace(/</g,"&lt;"),content="textContent"in hiddenPre?hiddenPre.textContent:hiddenPre.innerText),spaceBefore+content+spaceAfter}function encodeEntities(value){return value.replace(/&/g,"&amp;").replace(NON_ALPHANUMERIC_REGEXP,function(value){return"&#"+value.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function htmlSanitizeWriter(buf,uriValidator){var ignore=!1,out=angular.bind(buf,buf.push);return{start:function(tag,attrs,unary){tag=angular.lowercase(tag),!ignore&&specialElements[tag]&&(ignore=tag),ignore||validElements[tag]!==!0||(out("<"),out(tag),angular.forEach(attrs,function(value,key){var lkey=angular.lowercase(key),isImage="img"===tag&&"src"===lkey||"background"===lkey;validAttrs[lkey]!==!0||uriAttrs[lkey]===!0&&!uriValidator(value,isImage)||(out(" "),out(key),out('="'),out(encodeEntities(value)),out('"'))}),out(unary?"/>":">"))},end:function(tag){tag=angular.lowercase(tag),ignore||validElements[tag]!==!0||(out("</"),out(tag),out(">")),tag==ignore&&(ignore=!1)},chars:function(chars){ignore||out(encodeEntities(chars))}}}var $sanitizeMinErr=angular.$$minErr("$sanitize"),START_TAG_REGEXP=/^<\s*([\w:-]+)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*>/,END_TAG_REGEXP=/^<\s*\/\s*([\w:-]+)[^>]*>/,ATTR_REGEXP=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,BEGIN_TAG_REGEXP=/^</,BEGING_END_TAGE_REGEXP=/^<\s*\//,COMMENT_REGEXP=/<!--(.*?)-->/g,DOCTYPE_REGEXP=/<!DOCTYPE([^>]*?)>/i,CDATA_REGEXP=/<!\[CDATA\[(.*?)]]>/g,NON_ALPHANUMERIC_REGEXP=/([^\#-~| |!])/g,voidElements=makeMap("area,br,col,hr,img,wbr"),optionalEndTagBlockElements=makeMap("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),optionalEndTagInlineElements=makeMap("rp,rt"),optionalEndTagElements=angular.extend({},optionalEndTagInlineElements,optionalEndTagBlockElements),blockElements=angular.extend({},optionalEndTagBlockElements,makeMap("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),inlineElements=angular.extend({},optionalEndTagInlineElements,makeMap("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),specialElements=makeMap("script,style"),validElements=angular.extend({},voidElements,blockElements,inlineElements,optionalEndTagElements),uriAttrs=makeMap("background,cite,href,longdesc,src,usemap"),validAttrs=angular.extend({},uriAttrs,makeMap("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width")),hiddenPre=document.createElement("pre"),spaceRe=/^(\s*)([\s\S]*?)(\s*)$/;angular.module("ngSanitize",[]).provider("$sanitize",$SanitizeProvider),angular.module("ngSanitize").filter("linky",["$sanitize",function($sanitize){var LINKY_URL_REGEXP=/((ftp|https?):\/\/|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>]/,MAILTO_REGEXP=/^mailto:/;return function(text,target){function addText(text){text&&html.push(sanitizeText(text))}function addLink(url,text){html.push("<a "),angular.isDefined(target)&&(html.push('target="'),html.push(target),html.push('" ')),html.push('href="'),html.push(url),html.push('">'),addText(text),html.push("</a>")}if(!text)return text;for(var match,url,i,raw=text,html=[];match=raw.match(LINKY_URL_REGEXP);)url=match[0],match[2]==match[3]&&(url="mailto:"+url),i=match.index,addText(raw.substr(0,i)),addLink(url,match[0].replace(MAILTO_REGEXP,"")),raw=raw.substring(i+match[0].length);return addText(raw),$sanitize(html.join(""))}}])}(window,window.angular),function(window,angular,undefined){"use strict";angular.module("ngCookies",["ng"]).factory("$cookies",["$rootScope","$browser",function($rootScope,$browser){function push(){var name,value,browserCookies,updated;for(name in lastCookies)isUndefined(cookies[name])&&$browser.cookies(name,undefined);for(name in cookies)value=cookies[name],angular.isString(value)?value!==lastCookies[name]&&($browser.cookies(name,value),updated=!0):angular.isDefined(lastCookies[name])?cookies[name]=lastCookies[name]:delete cookies[name];if(updated){updated=!1,browserCookies=$browser.cookies();for(name in cookies)cookies[name]!==browserCookies[name]&&(isUndefined(browserCookies[name])?delete cookies[name]:cookies[name]=browserCookies[name],updated=!0)}}var lastBrowserCookies,cookies={},lastCookies={},runEval=!1,copy=angular.copy,isUndefined=angular.isUndefined;return $browser.addPollFn(function(){var currentCookies=$browser.cookies();lastBrowserCookies!=currentCookies&&(lastBrowserCookies=currentCookies,copy(currentCookies,lastCookies),copy(currentCookies,cookies),runEval&&$rootScope.$apply())})(),runEval=!0,$rootScope.$watch(push),cookies}]).factory("$cookieStore",["$cookies",function($cookies){return{get:function(key){var value=$cookies[key];return value?angular.fromJson(value):value},put:function(key,value){$cookies[key]=angular.toJson(value)},remove:function(key){delete $cookies[key]}}}])}(window,window.angular),"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports="ui.router"),function(window,angular,undefined){"use strict";function inherit(parent,extra){return extend(new(extend(function(){},{prototype:parent})),extra)}function merge(dst){return forEach(arguments,function(obj){obj!==dst&&forEach(obj,function(value,key){dst.hasOwnProperty(key)||(dst[key]=value)})}),dst}function ancestors(first,second){var path=[];for(var n in first.path){if(first.path[n]!==second.path[n])break;path.push(first.path[n])}return path}function arraySearch(array,value){if(Array.prototype.indexOf)return array.indexOf(value,Number(arguments[2])||0);var len=array.length>>>0,from=Number(arguments[2])||0;for(from=0>from?Math.ceil(from):Math.floor(from),0>from&&(from+=len);len>from;from++)if(from in array&&array[from]===value)return from;return-1}function inheritParams(currentParams,newParams,$current,$to){var parentParams,parents=ancestors($current,$to),inherited={},inheritList=[];for(var i in parents)if(parents[i].params&&parents[i].params.length){parentParams=parents[i].params;for(var j in parentParams)arraySearch(inheritList,parentParams[j])>=0||(inheritList.push(parentParams[j]),inherited[parentParams[j]]=currentParams[parentParams[j]])}return extend({},inherited,newParams)}function normalize(keys,values){var normalized={};return forEach(keys,function(name){var value=values[name];normalized[name]=null!=value?String(value):null}),normalized}function equalForKeys(a,b,keys){if(!keys){keys=[];for(var n in a)keys.push(n)}for(var i=0;i<keys.length;i++){var k=keys[i];if(a[k]!=b[k])return!1}return!0}function filterByKeys(keys,values){var filtered={};return forEach(keys,function(name){filtered[name]=values[name]}),filtered}function $Resolve($q,$injector){var VISIT_IN_PROGRESS=1,VISIT_DONE=2,NOTHING={},NO_DEPENDENCIES=[],NO_LOCALS=NOTHING,NO_PARENT=extend($q.when(NOTHING),{$$promises:NOTHING,$$values:NOTHING});this.study=function(invocables){function visit(value,key){if(visited[key]!==VISIT_DONE){if(cycle.push(key),visited[key]===VISIT_IN_PROGRESS)throw cycle.splice(0,cycle.indexOf(key)),new Error("Cyclic dependency: "+cycle.join(" -> "));if(visited[key]=VISIT_IN_PROGRESS,isString(value))plan.push(key,[function(){return $injector.get(value)}],NO_DEPENDENCIES);else{var params=$injector.annotate(value);forEach(params,function(param){param!==key&&invocables.hasOwnProperty(param)&&visit(invocables[param],param)}),plan.push(key,value,params)}cycle.pop(),visited[key]=VISIT_DONE}}function isResolve(value){return isObject(value)&&value.then&&value.$$promises}if(!isObject(invocables))throw new Error("'invocables' must be an object");var plan=[],cycle=[],visited={};return forEach(invocables,visit),invocables=cycle=visited=null,function(locals,parent,self){function done(){--wait||(merged||merge(values,parent.$$values),result.$$values=values,result.$$promises=!0,resolution.resolve(values))}function fail(reason){result.$$failure=reason,resolution.reject(reason)}function invoke(key,invocable,params){function onfailure(reason){invocation.reject(reason),fail(reason)}function proceed(){if(!isDefined(result.$$failure))try{invocation.resolve($injector.invoke(invocable,self,values)),invocation.promise.then(function(result){values[key]=result,done()},onfailure)}catch(e){onfailure(e)}}var invocation=$q.defer(),waitParams=0;forEach(params,function(dep){promises.hasOwnProperty(dep)&&!locals.hasOwnProperty(dep)&&(waitParams++,promises[dep].then(function(result){values[dep]=result,--waitParams||proceed()},onfailure))}),waitParams||proceed(),promises[key]=invocation.promise}if(isResolve(locals)&&self===undefined&&(self=parent,parent=locals,locals=null),locals){if(!isObject(locals))throw new Error("'locals' must be an object")}else locals=NO_LOCALS;if(parent){if(!isResolve(parent))throw new Error("'parent' must be a promise returned by $resolve.resolve()")}else parent=NO_PARENT;var resolution=$q.defer(),result=resolution.promise,promises=result.$$promises={},values=extend({},locals),wait=1+plan.length/3,merged=!1;if(isDefined(parent.$$failure))return fail(parent.$$failure),result;parent.$$values?(merged=merge(values,parent.$$values),done()):(extend(promises,parent.$$promises),parent.then(done,fail));for(var i=0,ii=plan.length;ii>i;i+=3)locals.hasOwnProperty(plan[i])?done():invoke(plan[i],plan[i+1],plan[i+2]);return result}},this.resolve=function(invocables,locals,parent,self){return this.study(invocables)(locals,parent,self)}}function $TemplateFactory($http,$templateCache,$injector){this.fromConfig=function(config,params,locals){return isDefined(config.template)?this.fromString(config.template,params):isDefined(config.templateUrl)?this.fromUrl(config.templateUrl,params):isDefined(config.templateProvider)?this.fromProvider(config.templateProvider,params,locals):null},this.fromString=function(template,params){return isFunction(template)?template(params):template},this.fromUrl=function(url,params){return isFunction(url)&&(url=url(params)),null==url?null:$http.get(url,{cache:$templateCache}).then(function(response){return response.data})},this.fromProvider=function(provider,params,locals){return $injector.invoke(provider,null,locals||{params:params})}}function UrlMatcher(pattern){function addParameter(id){if(!/^\w+(-+\w+)*$/.test(id))throw new Error("Invalid parameter name '"+id+"' in pattern '"+pattern+"'");if(names[id])throw new Error("Duplicate parameter name '"+id+"' in pattern '"+pattern+"'");names[id]=!0,params.push(id)}function quoteRegExp(string){return string.replace(/[\\\[\]\^$*+?.()|{}]/g,"\\$&")}var m,placeholder=/([:*])(\w+)|\{(\w+)(?:\:((?:[^{}\\]+|\\.|\{(?:[^{}\\]+|\\.)*\})+))?\}/g,names={},compiled="^",last=0,segments=this.segments=[],params=this.params=[];this.source=pattern;for(var id,regexp,segment;(m=placeholder.exec(pattern))&&(id=m[2]||m[3],regexp=m[4]||("*"==m[1]?".*":"[^/]*"),segment=pattern.substring(last,m.index),!(segment.indexOf("?")>=0));)compiled+=quoteRegExp(segment)+"("+regexp+")",addParameter(id),segments.push(segment),last=placeholder.lastIndex;segment=pattern.substring(last);var i=segment.indexOf("?");if(i>=0){var search=this.sourceSearch=segment.substring(i);segment=segment.substring(0,i),this.sourcePath=pattern.substring(0,last+i),forEach(search.substring(1).split(/[&?]/),addParameter)}else this.sourcePath=pattern,this.sourceSearch="";compiled+=quoteRegExp(segment)+"$",segments.push(segment),this.regexp=new RegExp(compiled),this.prefix=segments[0]}function $UrlMatcherFactory(){this.compile=function(pattern){return new UrlMatcher(pattern)},this.isMatcher=function(o){return isObject(o)&&isFunction(o.exec)&&isFunction(o.format)&&isFunction(o.concat)},this.$get=function(){return this}}function $UrlRouterProvider($urlMatcherFactory){function regExpPrefix(re){var prefix=/^\^((?:\\[^a-zA-Z0-9]|[^\\\[\]\^$*+?.()|{}]+)*)/.exec(re.source);return null!=prefix?prefix[1].replace(/\\(.)/g,"$1"):""}function interpolate(pattern,match){return pattern.replace(/\$(\$|\d{1,2})/,function(m,what){return match["$"===what?0:Number(what)]})}function handleIfMatch($injector,handler,match){if(!match)return!1;var result=$injector.invoke(handler,handler,{$match:match});return isDefined(result)?result:!0}var rules=[],otherwise=null;this.rule=function(rule){if(!isFunction(rule))throw new Error("'rule' must be a function");return rules.push(rule),this},this.otherwise=function(rule){if(isString(rule)){var redirect=rule;rule=function(){return redirect}}else if(!isFunction(rule))throw new Error("'rule' must be a function");return otherwise=rule,this},this.when=function(what,handler){var redirect,handlerIsString=isString(handler);if(isString(what)&&(what=$urlMatcherFactory.compile(what)),!handlerIsString&&!isFunction(handler)&&!isArray(handler))throw new Error("invalid 'handler' in when()");var strategies={matcher:function(what,handler){return handlerIsString&&(redirect=$urlMatcherFactory.compile(handler),handler=["$match",function($match){return redirect.format($match)}]),extend(function($injector,$location){return handleIfMatch($injector,handler,what.exec($location.path(),$location.search()))},{prefix:isString(what.prefix)?what.prefix:""})},regex:function(what,handler){if(what.global||what.sticky)throw new Error("when() RegExp must not be global or sticky");return handlerIsString&&(redirect=handler,handler=["$match",function($match){return interpolate(redirect,$match)}]),extend(function($injector,$location){return handleIfMatch($injector,handler,what.exec($location.path()))},{prefix:regExpPrefix(what)})}},check={matcher:$urlMatcherFactory.isMatcher(what),regex:what instanceof RegExp};for(var n in check)if(check[n])return this.rule(strategies[n](what,handler));throw new Error("invalid 'what' in when()")},this.$get=["$location","$rootScope","$injector",function($location,$rootScope,$injector){function update(evt){function check(rule){var handled=rule($injector,$location);return handled?(isString(handled)&&$location.replace().url(handled),!0):!1}if(!evt||!evt.defaultPrevented){var i,n=rules.length;for(i=0;n>i;i++)if(check(rules[i]))return;otherwise&&check(otherwise)}}return $rootScope.$on("$locationChangeSuccess",update),{sync:function(){update()}}}]}function $StateProvider($urlRouterProvider,$urlMatcherFactory,$locationProvider){function isRelative(stateName){return 0===stateName.indexOf(".")||0===stateName.indexOf("^")}function findState(stateOrName,base){var isStr=isString(stateOrName),name=isStr?stateOrName:stateOrName.name,path=isRelative(name);if(path){if(!base)throw new Error("No reference point given for path '"+name+"'");for(var rel=name.split("."),i=0,pathLength=rel.length,current=base;pathLength>i;i++)if(""!==rel[i]||0!==i){if("^"!==rel[i])break;if(!current.parent)throw new Error("Path '"+name+"' not valid for state '"+base.name+"'");current=current.parent}else current=base;rel=rel.slice(i).join("."),name=current.name+(current.name&&rel?".":"")+rel}var state=states[name];return!state||!isStr&&(isStr||state!==stateOrName&&state.self!==stateOrName)?undefined:state}function queueState(parentName,state){queue[parentName]||(queue[parentName]=[]),queue[parentName].push(state)}function registerState(state){state=inherit(state,{self:state,resolve:state.resolve||{},toString:function(){return this.name}});var name=state.name;if(!isString(name)||name.indexOf("@")>=0)throw new Error("State must have a valid name");if(states.hasOwnProperty(name))throw new Error("State '"+name+"'' is already defined");var parentName=-1!==name.indexOf(".")?name.substring(0,name.lastIndexOf(".")):isString(state.parent)?state.parent:"";if(parentName&&!states[parentName])return queueState(parentName,state.self);for(var key in stateBuilder)isFunction(stateBuilder[key])&&(state[key]=stateBuilder[key](state,stateBuilder.$delegates[key]));if(states[name]=state,!state[abstractKey]&&state.url&&$urlRouterProvider.when(state.url,["$match","$stateParams",function($match,$stateParams){$state.$current.navigable==state&&equalForKeys($match,$stateParams)||$state.transitionTo(state,$match,{location:!1})}]),queue[name])for(var i=0;i<queue[name].length;i++)registerState(queue[name][i]);return state}function decorator(name,func){return isString(name)&&!isDefined(func)?stateBuilder[name]:isFunction(func)&&isString(name)?(stateBuilder[name]&&!stateBuilder.$delegates[name]&&(stateBuilder.$delegates[name]=stateBuilder[name]),stateBuilder[name]=func,this):this}function state(name,definition){return isObject(name)?definition=name:definition.name=name,registerState(definition),this}function $get($rootScope,$q,$view,$injector,$resolve,$stateParams,$location){function syncUrl(){$location.url()!==currentLocation&&($location.url(currentLocation),$location.replace())}function resolveState(state,params,paramsAreFiltered,inherited,dst){var $stateParams=paramsAreFiltered?params:filterByKeys(state.params,params),locals={$stateParams:$stateParams};dst.resolve=$resolve.resolve(state.resolve,locals,dst.resolve,state);var promises=[dst.resolve.then(function(globals){dst.globals=globals})];return inherited&&promises.push(inherited),forEach(state.views,function(view,name){var injectables=view.resolve&&view.resolve!==state.resolve?view.resolve:{};injectables.$template=[function(){return $view.load(name,{view:view,locals:locals,params:$stateParams,notify:!1})||""}],promises.push($resolve.resolve(injectables,locals,dst.resolve,state).then(function(result){if(isFunction(view.controllerProvider)||isArray(view.controllerProvider)){var injectLocals=angular.extend({},injectables,locals);result.$$controller=$injector.invoke(view.controllerProvider,null,injectLocals)}else result.$$controller=view.controller;result.$$state=state,dst[name]=result}))}),$q.all(promises).then(function(){return dst})}var TransitionSuperseded=$q.reject(new Error("transition superseded")),TransitionPrevented=$q.reject(new Error("transition prevented")),TransitionAborted=$q.reject(new Error("transition aborted")),TransitionFailed=$q.reject(new Error("transition failed")),currentLocation=$location.url();return root.locals={resolve:null,globals:{$stateParams:{}}},$state={params:{},current:root.self,$current:root,transition:null},$state.reload=function(){$state.transitionTo($state.current,$stateParams,{reload:!0,inherit:!1,notify:!1})},$state.go=function(to,params,options){return this.transitionTo(to,params,extend({inherit:!0,relative:$state.$current},options))},$state.transitionTo=function(to,toParams,options){toParams=toParams||{},options=extend({location:!0,inherit:!1,relative:null,notify:!0,reload:!1,$retry:!1},options||{});var evt,from=$state.$current,fromParams=$state.params,fromPath=from.path,toState=findState(to,options.relative);if(!isDefined(toState)){var redirect={to:to,toParams:toParams,options:options};if(evt=$rootScope.$broadcast("$stateNotFound",redirect,from.self,fromParams),evt.defaultPrevented)return syncUrl(),TransitionAborted;if(evt.retry){if(options.$retry)return syncUrl(),TransitionFailed;
var retryTransition=$state.transition=$q.when(evt.retry);return retryTransition.then(function(){return retryTransition!==$state.transition?TransitionSuperseded:(redirect.options.$retry=!0,$state.transitionTo(redirect.to,redirect.toParams,redirect.options))},function(){return TransitionAborted}),syncUrl(),retryTransition}if(to=redirect.to,toParams=redirect.toParams,options=redirect.options,toState=findState(to,options.relative),!isDefined(toState)){if(options.relative)throw new Error("Could not resolve '"+to+"' from state '"+options.relative+"'");throw new Error("No such state '"+to+"'")}}if(toState[abstractKey])throw new Error("Cannot transition to abstract state '"+to+"'");options.inherit&&(toParams=inheritParams($stateParams,toParams||{},$state.$current,toState)),to=toState;var keep,state,toPath=to.path,locals=root.locals,toLocals=[];for(keep=0,state=toPath[keep];state&&state===fromPath[keep]&&equalForKeys(toParams,fromParams,state.ownParams)&&!options.reload;keep++,state=toPath[keep])locals=toLocals[keep]=state.locals;if(shouldTriggerReload(to,from,locals,options))return to.self.reloadOnSearch!==!1&&syncUrl(),$state.transition=null,$q.when($state.current);if(toParams=normalize(to.params,toParams||{}),options.notify&&(evt=$rootScope.$broadcast("$stateChangeStart",to.self,toParams,from.self,fromParams),evt.defaultPrevented))return syncUrl(),TransitionPrevented;for(var resolved=$q.when(locals),l=keep;l<toPath.length;l++,state=toPath[l])locals=toLocals[l]=inherit(locals),resolved=resolveState(state,toParams,state===to,resolved,locals);var transition=$state.transition=resolved.then(function(){var l,entering,exiting;if($state.transition!==transition)return TransitionSuperseded;for(l=fromPath.length-1;l>=keep;l--)exiting=fromPath[l],exiting.self.onExit&&$injector.invoke(exiting.self.onExit,exiting.self,exiting.locals.globals),exiting.locals=null;for(l=keep;l<toPath.length;l++)entering=toPath[l],entering.locals=toLocals[l],entering.self.onEnter&&$injector.invoke(entering.self.onEnter,entering.self,entering.locals.globals);if($state.transition!==transition)return TransitionSuperseded;$state.$current=to,$state.current=to.self,$state.params=toParams,copy($state.params,$stateParams),$state.transition=null;var toNav=to.navigable;return options.location&&toNav&&($location.url(toNav.url.format(toNav.locals.globals.$stateParams)),"replace"===options.location&&$location.replace()),options.notify&&$rootScope.$broadcast("$stateChangeSuccess",to.self,toParams,from.self,fromParams),currentLocation=$location.url(),$state.current},function(error){return $state.transition!==transition?TransitionSuperseded:($state.transition=null,$rootScope.$broadcast("$stateChangeError",to.self,toParams,from.self,fromParams,error),syncUrl(),$q.reject(error))});return transition},$state.is=function(stateOrName,params){var state=findState(stateOrName);return isDefined(state)?$state.$current!==state?!1:isDefined(params)&&null!==params?angular.equals($stateParams,params):!0:undefined},$state.includes=function(stateOrName,params){var state=findState(stateOrName);if(!isDefined(state))return undefined;if(!isDefined($state.$current.includes[state.name]))return!1;var validParams=!0;return angular.forEach(params,function(value,key){isDefined($stateParams[key])&&$stateParams[key]===value||(validParams=!1)}),validParams},$state.href=function(stateOrName,params,options){options=extend({lossy:!0,inherit:!1,absolute:!1,relative:$state.$current},options||{});var state=findState(stateOrName,options.relative);if(!isDefined(state))return null;params=inheritParams($stateParams,params||{},$state.$current,state);var nav=state&&options.lossy?state.navigable:state,url=nav&&nav.url?nav.url.format(normalize(state.params,params||{})):null;return!$locationProvider.html5Mode()&&url&&(url="#"+$locationProvider.hashPrefix()+url),options.absolute&&url&&(url=$location.protocol()+"://"+$location.host()+(80==$location.port()||443==$location.port()?"":":"+$location.port())+(!$locationProvider.html5Mode()&&url?"/":"")+url),url},$state.get=function(stateOrName,context){if(!isDefined(stateOrName)){var list=[];return forEach(states,function(state){list.push(state.self)}),list}var state=findState(stateOrName,context);return state&&state.self?state.self:null},$state}function shouldTriggerReload(to,from,locals,options){return to!==from||(locals!==from.locals||options.reload)&&to.self.reloadOnSearch!==!1?void 0:!0}var root,$state,states={},queue={},abstractKey="abstract",stateBuilder={parent:function(state){if(isDefined(state.parent)&&state.parent)return findState(state.parent);var compositeName=/^(.+)\.[^.]+$/.exec(state.name);return compositeName?findState(compositeName[1]):root},data:function(state){return state.parent&&state.parent.data&&(state.data=state.self.data=extend({},state.parent.data,state.data)),state.data},url:function(state){var url=state.url;if(isString(url))return"^"==url.charAt(0)?$urlMatcherFactory.compile(url.substring(1)):(state.parent.navigable||root).url.concat(url);if($urlMatcherFactory.isMatcher(url)||null==url)return url;throw new Error("Invalid url '"+url+"' in state '"+state+"'")},navigable:function(state){return state.url?state:state.parent?state.parent.navigable:null},params:function(state){if(!state.params)return state.url?state.url.parameters():state.parent.params;if(!isArray(state.params))throw new Error("Invalid params in state '"+state+"'");if(state.url)throw new Error("Both params and url specicified in state '"+state+"'");return state.params},views:function(state){var views={};return forEach(isDefined(state.views)?state.views:{"":state},function(view,name){name.indexOf("@")<0&&(name+="@"+state.parent.name),views[name]=view}),views},ownParams:function(state){if(!state.parent)return state.params;var paramNames={};forEach(state.params,function(p){paramNames[p]=!0}),forEach(state.parent.params,function(p){if(!paramNames[p])throw new Error("Missing required parameter '"+p+"' in state '"+state.name+"'");paramNames[p]=!1});var ownParams=[];return forEach(paramNames,function(own,p){own&&ownParams.push(p)}),ownParams},path:function(state){return state.parent?state.parent.path.concat(state):[]},includes:function(state){var includes=state.parent?extend({},state.parent.includes):{};return includes[state.name]=!0,includes},$delegates:{}};root=registerState({name:"",url:"^",views:null,"abstract":!0}),root.navigable=null,this.decorator=decorator,this.state=state,this.$get=$get,$get.$inject=["$rootScope","$q","$view","$injector","$resolve","$stateParams","$location","$urlRouter"]}function $ViewProvider(){function $get($rootScope,$templateFactory){return{load:function(name,options){var result,defaults={template:null,controller:null,view:null,locals:null,notify:!0,async:!0,params:{}};return options=extend(defaults,options),options.view&&(result=$templateFactory.fromConfig(options.view,options.params,options.locals)),result&&options.notify&&$rootScope.$broadcast("$viewContentLoading",options),result}}}this.$get=$get,$get.$inject=["$rootScope","$templateFactory"]}function $ViewScrollProvider(){var useAnchorScroll=!1;this.useAnchorScroll=function(){useAnchorScroll=!0},this.$get=["$anchorScroll","$timeout",function($anchorScroll,$timeout){return useAnchorScroll?$anchorScroll:function($element){$timeout(function(){$element[0].scrollIntoView()},0,!1)}}]}function $ViewDirective($state,$compile,$controller,$injector,$uiViewScroll,$document){function getService(){return $injector.has?function(service){return $injector.has(service)?$injector.get(service):null}:function(service){try{return $injector.get(service)}catch(e){return null}}}function getRenderer(element,attrs,scope){var statics=function(){return{leave:function(element){element.remove()},enter:function(element,parent,anchor){anchor.after(element)}}};if($animate)return function(shouldAnimate){return shouldAnimate?{enter:function(element,parent,anchor){$animate.enter(element,null,anchor)},leave:function(element){$animate.leave(element,function(){element.remove()})}}:statics()};if($animator){var animate=$animator&&$animator(scope,attrs);return function(shouldAnimate){return shouldAnimate?{enter:function(element,parent){animate.enter(element,parent)},leave:function(element){animate.leave(element.contents(),element)}}:statics()}}return statics}var viewIsUpdating=!1,service=getService(),$animator=service("$animator"),$animate=service("$animate"),directive={restrict:"ECA",compile:function(element,attrs){var initial=element.html(),isDefault=!0,anchor=angular.element($document[0].createComment(" ui-view-anchor ")),parentEl=element.parent();return element.prepend(anchor),function($scope){function cleanupLastView(){currentEl&&(renderer(!0).leave(currentEl),currentEl=null),currentScope&&(currentScope.$destroy(),currentScope=null)}function updateView(shouldAnimate){var locals=$state.$current&&$state.$current.locals[name];if(isDefault&&(isDefault=!1,element.replaceWith(anchor)),!locals)return cleanupLastView(),currentEl=element.clone(),currentEl.html(initial),renderer(shouldAnimate).enter(currentEl,parentEl,anchor),currentScope=$scope.$new(),$compile(currentEl.contents())(currentScope),void 0;if(locals!==viewLocals){cleanupLastView(),currentEl=element.clone(),currentEl.html(locals.$template?locals.$template:initial),renderer(!0).enter(currentEl,parentEl,anchor),currentEl.data("$uiView",view),viewLocals=locals,view.state=locals.$$state;var link=$compile(currentEl.contents());if(currentScope=$scope.$new(),locals.$$controller){locals.$scope=currentScope;var controller=$controller(locals.$$controller,locals);currentEl.children().data("$ngControllerController",controller)}link(currentScope),currentScope.$emit("$viewContentLoaded"),onloadExp&&currentScope.$eval(onloadExp),angular.isDefined(autoscrollExp)&&autoscrollExp&&!$scope.$eval(autoscrollExp)||$uiViewScroll(currentEl)}}var currentScope,currentEl,viewLocals,inherited=parentEl.inheritedData("$uiView"),name=attrs[directive.name]||attrs.name||"",onloadExp=attrs.onload||"",autoscrollExp=attrs.autoscroll,renderer=getRenderer(element,attrs,$scope);name.indexOf("@")<0&&(name=name+"@"+(inherited?inherited.state.name:""));var view={name:name,state:null},eventHook=function(){if(!viewIsUpdating){viewIsUpdating=!0;try{updateView(!0)}catch(e){throw viewIsUpdating=!1,e}viewIsUpdating=!1}};$scope.$on("$stateChangeSuccess",eventHook),$scope.$on("$viewContentLoading",eventHook),updateView(!1)}}};return directive}function parseStateRef(ref){var parsed=ref.replace(/\n/g," ").match(/^([^(]+?)\s*(\((.*)\))?$/);if(!parsed||4!==parsed.length)throw new Error("Invalid state ref '"+ref+"'");return{state:parsed[1],paramExpr:parsed[3]||null}}function stateContext(el){var stateData=el.parent().inheritedData("$uiView");return stateData&&stateData.state&&stateData.state.name?stateData.state:void 0}function $StateRefDirective($state,$timeout){return{restrict:"A",require:"?^uiSrefActive",link:function(scope,element,attrs,uiSrefActive){var ref=parseStateRef(attrs.uiSref),params=null,base=stateContext(element)||$state.$current,isForm="FORM"===element[0].nodeName,attr=isForm?"action":"href",nav=!0,update=function(newVal){if(newVal&&(params=newVal),nav){var newHref=$state.href(ref.state,params,{relative:base});return uiSrefActive&&uiSrefActive.$$setStateInfo(ref.state,params),newHref?(element[0][attr]=newHref,void 0):(nav=!1,!1)}};ref.paramExpr&&(scope.$watch(ref.paramExpr,function(newVal){newVal!==params&&update(newVal)},!0),params=scope.$eval(ref.paramExpr)),update(),isForm||element.bind("click",function(e){var button=e.which||e.button;0!==button&&1!=button||e.ctrlKey||e.metaKey||e.shiftKey||element.attr("target")||($timeout(function(){$state.go(ref.state,params,{relative:base})}),e.preventDefault())})}}}function $StateActiveDirective($state,$stateParams,$interpolate){return{restrict:"A",controller:["$scope","$element","$attrs",function($scope,$element,$attrs){function update(){$state.$current.self===state&&matchesParams()?$element.addClass(activeClass):$element.removeClass(activeClass)}function matchesParams(){return!params||equalForKeys(params,$stateParams)}var state,params,activeClass;activeClass=$interpolate($attrs.uiSrefActive||"",!1)($scope),this.$$setStateInfo=function(newState,newParams){state=$state.get(newState,stateContext($element)),params=newParams,update()},$scope.$on("$stateChangeSuccess",update)}]}}function $IsStateFilter($state){return function(state){return $state.is(state)}}function $IncludedByStateFilter($state){return function(state){return $state.includes(state)}}function $RouteProvider($stateProvider,$urlRouterProvider){function onEnterRoute($$state){this.locals=$$state.locals.globals,this.params=this.locals.$stateParams}function onExitRoute(){this.locals=null,this.params=null}function when(url,route){if(null!=route.redirectTo){var handler,redirect=route.redirectTo;if(isString(redirect))handler=redirect;else{if(!isFunction(redirect))throw new Error("Invalid 'redirectTo' in when()");handler=function(params,$location){return redirect(params,$location.path(),$location.search())}}$urlRouterProvider.when(url,handler)}else $stateProvider.state(inherit(route,{parent:null,name:"route:"+encodeURIComponent(url),url:url,onEnter:onEnterRoute,onExit:onExitRoute}));return routes.push(route),this}function $get($state,$rootScope,$routeParams){function stateAsRoute(state){return""!==state.name?state:undefined}var $route={routes:routes,params:$routeParams,current:undefined};return $rootScope.$on("$stateChangeStart",function(ev,to,toParams,from){$rootScope.$broadcast("$routeChangeStart",stateAsRoute(to),stateAsRoute(from))}),$rootScope.$on("$stateChangeSuccess",function(ev,to,toParams,from){$route.current=stateAsRoute(to),$rootScope.$broadcast("$routeChangeSuccess",stateAsRoute(to),stateAsRoute(from)),copy(toParams,$route.params)}),$rootScope.$on("$stateChangeError",function(ev,to,toParams,from,fromParams,error){$rootScope.$broadcast("$routeChangeError",stateAsRoute(to),stateAsRoute(from),error)}),$route}var routes=[];onEnterRoute.$inject=["$$state"],this.when=when,this.$get=$get,$get.$inject=["$state","$rootScope","$routeParams"]}var isDefined=angular.isDefined,isFunction=angular.isFunction,isString=angular.isString,isObject=angular.isObject,isArray=angular.isArray,forEach=angular.forEach,extend=angular.extend,copy=angular.copy;angular.module("ui.router.util",["ng"]),angular.module("ui.router.router",["ui.router.util"]),angular.module("ui.router.state",["ui.router.router","ui.router.util"]),angular.module("ui.router",["ui.router.state"]),angular.module("ui.router.compat",["ui.router"]),$Resolve.$inject=["$q","$injector"],angular.module("ui.router.util").service("$resolve",$Resolve),$TemplateFactory.$inject=["$http","$templateCache","$injector"],angular.module("ui.router.util").service("$templateFactory",$TemplateFactory),UrlMatcher.prototype.concat=function(pattern){return new UrlMatcher(this.sourcePath+pattern+this.sourceSearch)},UrlMatcher.prototype.toString=function(){return this.source},UrlMatcher.prototype.exec=function(path,searchParams){var m=this.regexp.exec(path);if(!m)return null;var i,params=this.params,nTotal=params.length,nPath=this.segments.length-1,values={};if(nPath!==m.length-1)throw new Error("Unbalanced capture group in route '"+this.source+"'");for(i=0;nPath>i;i++)values[params[i]]=m[i+1];for(;nTotal>i;i++)values[params[i]]=searchParams[params[i]];return values},UrlMatcher.prototype.parameters=function(){return this.params},UrlMatcher.prototype.format=function(values){var segments=this.segments,params=this.params;if(!values)return segments.join("");var i,search,value,nPath=segments.length-1,nTotal=params.length,result=segments[0];for(i=0;nPath>i;i++)value=values[params[i]],null!=value&&(result+=encodeURIComponent(value)),result+=segments[i+1];for(;nTotal>i;i++)value=values[params[i]],null!=value&&(result+=(search?"&":"?")+params[i]+"="+encodeURIComponent(value),search=!0);return result},angular.module("ui.router.util").provider("$urlMatcherFactory",$UrlMatcherFactory),$UrlRouterProvider.$inject=["$urlMatcherFactoryProvider"],angular.module("ui.router.router").provider("$urlRouter",$UrlRouterProvider),$StateProvider.$inject=["$urlRouterProvider","$urlMatcherFactoryProvider","$locationProvider"],angular.module("ui.router.state").value("$stateParams",{}).provider("$state",$StateProvider),$ViewProvider.$inject=[],angular.module("ui.router.state").provider("$view",$ViewProvider),angular.module("ui.router.state").provider("$uiViewScroll",$ViewScrollProvider),$ViewDirective.$inject=["$state","$compile","$controller","$injector","$uiViewScroll","$document"],angular.module("ui.router.state").directive("uiView",$ViewDirective),$StateRefDirective.$inject=["$state","$timeout"],$StateActiveDirective.$inject=["$state","$stateParams","$interpolate"],angular.module("ui.router.state").directive("uiSref",$StateRefDirective).directive("uiSrefActive",$StateActiveDirective),$IsStateFilter.$inject=["$state"],$IncludedByStateFilter.$inject=["$state"],angular.module("ui.router.state").filter("isState",$IsStateFilter).filter("includedByState",$IncludedByStateFilter),$RouteProvider.$inject=["$stateProvider","$urlRouterProvider"],angular.module("ui.router.compat").provider("$route",$RouteProvider).directive("ngView",$ViewDirective)}(window,window.angular),!function($){"use strict";function targetIsSelf(callback){return function(e){return this===e.target?callback.apply(this,arguments):void 0}}var ModalManager=function(element,options){this.init(element,options)};ModalManager.prototype={constructor:ModalManager,init:function(element,options){if(this.$element=$(element),this.options=$.extend({},$.fn.modalmanager.defaults,this.$element.data(),"object"==typeof options&&options),this.stack=[],this.backdropCount=0,this.options.resize){var resizeTimeout,that=this;$(window).on("resize.modal",function(){resizeTimeout&&clearTimeout(resizeTimeout),resizeTimeout=setTimeout(function(){for(var i=0;i<that.stack.length;i++)that.stack[i].isShown&&that.stack[i].layout()},10)})}},createModal:function(element,options){$(element).modal($.extend({manager:this},options))},appendModal:function(modal){this.stack.push(modal);var that=this;modal.$element.on("show.modalmanager",targetIsSelf(function(){var showModal=function(){modal.isShown=!0;var transition=$.support.transition&&modal.$element.hasClass("fade");that.$element.toggleClass("modal-open",that.hasOpenModal()).toggleClass("page-overflow",$(window).height()<that.$element.height()),modal.$parent=modal.$element.parent(),modal.$container=that.createContainer(modal),modal.$element.appendTo(modal.$container),that.backdrop(modal,function(){modal.$element.show(),transition&&modal.$element[0].offsetWidth,modal.layout(),modal.$element.addClass("in").attr("aria-hidden",!1);var complete=function(){that.setFocus(),modal.$element.triggerHandler("shown")};transition?modal.$element.one($.support.transition.end,complete):complete()})};modal.options.replace?that.replace(showModal):showModal()})),modal.$element.on("hidden.modalmanager",targetIsSelf(function(){that.backdrop(modal),modal.$backdrop?$.support.transition&&modal.$element.hasClass("fade")?modal.$backdrop.one($.support.transition.end,function(){that.destroyModal(modal)}):that.destroyModal(modal):that.destroyModal(modal)})),modal.$element.on("destroy.modalmanager",targetIsSelf(function(){that.removeModal(modal)}))},destroyModal:function(modal){modal.destroy();var hasOpenModal=this.hasOpenModal();this.$element.toggleClass("modal-open",hasOpenModal),hasOpenModal||this.$element.removeClass("page-overflow"),this.removeContainer(modal),this.setFocus()},hasOpenModal:function(){for(var i=0;i<this.stack.length;i++)if(this.stack[i].isShown)return!0;return!1},setFocus:function(){for(var topModal,i=0;i<this.stack.length;i++)this.stack[i].isShown&&(topModal=this.stack[i]);topModal&&topModal.focus()},removeModal:function(modal){modal.$element.off(".modalmanager"),modal.$backdrop&&this.removeBackdrop.call(modal),this.stack.splice(this.getIndexOfModal(modal),1)},getModalAt:function(index){return this.stack[index]},getIndexOfModal:function(modal){for(var i=0;i<this.stack.length;i++)if(modal===this.stack[i])return i},replace:function(callback){for(var topModal,i=0;i<this.stack.length;i++)this.stack[i].isShown&&(topModal=this.stack[i]);topModal?(this.$backdropHandle=topModal.$backdrop,topModal.$backdrop=null,callback&&topModal.$element.one("hidden",targetIsSelf($.proxy(callback,this))),topModal.hide()):callback&&callback()},removeBackdrop:function(modal){modal.$backdrop.remove(),modal.$backdrop=null},createBackdrop:function(animate){var $backdrop;return this.$backdropHandle?($backdrop=this.$backdropHandle,$backdrop.off(".modalmanager"),this.$backdropHandle=null,this.isLoading&&this.removeSpinner()):$backdrop=$('<div class="modal-backdrop '+animate+'" />').appendTo(this.$element),$backdrop},removeContainer:function(modal){modal.$container.remove(),modal.$container=null},createContainer:function(modal){var $container;return $container=$('<div class="modal-scrollable">').css("z-index",getzIndex("modal",modal?this.getIndexOfModal(modal):this.stack.length)).appendTo(this.$element),modal&&"static"!=modal.options.backdrop?$container.on("click.modal",targetIsSelf(function(){modal.hide()})):modal&&$container.on("click.modal",targetIsSelf(function(){modal.attention()})),$container},backdrop:function(modal,callback){var animate=modal.$element.hasClass("fade")?"fade":"",showBackdrop=modal.options.backdrop&&this.backdropCount<this.options.backdropLimit;if(modal.isShown&&showBackdrop){var doAnimate=$.support.transition&&animate&&!this.$backdropHandle;modal.$backdrop=this.createBackdrop(animate),modal.$backdrop.css("z-index",getzIndex("backdrop",this.getIndexOfModal(modal))),doAnimate&&modal.$backdrop[0].offsetWidth,modal.$backdrop.addClass("in"),this.backdropCount+=1,doAnimate?modal.$backdrop.one($.support.transition.end,callback):callback()}else if(!modal.isShown&&modal.$backdrop){modal.$backdrop.removeClass("in"),this.backdropCount-=1;var that=this;$.support.transition&&modal.$element.hasClass("fade")?modal.$backdrop.one($.support.transition.end,function(){that.removeBackdrop(modal)}):that.removeBackdrop(modal)}else callback&&callback()},removeSpinner:function(){this.$spinner&&this.$spinner.remove(),this.$spinner=null,this.isLoading=!1},removeLoading:function(){this.$backdropHandle&&this.$backdropHandle.remove(),this.$backdropHandle=null,this.removeSpinner()},loading:function(callback){if(callback=callback||function(){},this.$element.toggleClass("modal-open",!this.isLoading||this.hasOpenModal()).toggleClass("page-overflow",$(window).height()<this.$element.height()),this.isLoading)if(this.isLoading&&this.$backdropHandle){this.$backdropHandle.removeClass("in");var that=this;$.support.transition?this.$backdropHandle.one($.support.transition.end,function(){that.removeLoading()}):that.removeLoading()}else callback&&callback(this.isLoading);else{this.$backdropHandle=this.createBackdrop("fade"),this.$backdropHandle[0].offsetWidth,this.$backdropHandle.css("z-index",getzIndex("backdrop",this.stack.length)).addClass("in");var $spinner=$(this.options.spinner).css("z-index",getzIndex("modal",this.stack.length)).appendTo(this.$element).addClass("in");this.$spinner=$(this.createContainer()).append($spinner).on("click.modalmanager",$.proxy(this.loading,this)),this.isLoading=!0,$.support.transition?this.$backdropHandle.one($.support.transition.end,callback):callback()}}};var getzIndex=function(){var zIndexFactor,baseIndex={};return function(type,pos){if("undefined"==typeof zIndexFactor){var $baseModal=$('<div class="modal hide" />').appendTo("body"),$baseBackdrop=$('<div class="modal-backdrop hide" />').appendTo("body");baseIndex.modal=+$baseModal.css("z-index"),baseIndex.backdrop=+$baseBackdrop.css("z-index"),zIndexFactor=baseIndex.modal-baseIndex.backdrop,$baseModal.remove(),$baseBackdrop.remove(),$baseBackdrop=$baseModal=null}return baseIndex[type]+zIndexFactor*pos}}();$.fn.modalmanager=function(option,args){return this.each(function(){var $this=$(this),data=$this.data("modalmanager");data||$this.data("modalmanager",data=new ModalManager(this,option)),"string"==typeof option&&data[option].apply(data,[].concat(args))})},$.fn.modalmanager.defaults={backdropLimit:999,resize:!0,spinner:'<div class="loading-spinner fade" style="width: 200px; margin-left: -100px;"><div class="progress progress-striped active"><div class="bar" style="width: 100%;"></div></div></div>'},$.fn.modalmanager.Constructor=ModalManager}(jQuery),!function($){"use strict";var Modal=function(element,options){this.init(element,options)};Modal.prototype={constructor:Modal,init:function(element,options){this.options=options,this.$element=$(element).delegate('[data-dismiss="modal"]',"click.dismiss.modal",$.proxy(this.hide,this)),this.options.remote&&this.$element.find(".modal-body").load(this.options.remote);var manager="function"==typeof this.options.manager?this.options.manager.call(this):this.options.manager;manager=manager.appendModal?manager:$(manager).modalmanager().data("modalmanager"),manager.appendModal(this)},toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var e=$.Event("show");this.isShown||(this.$element.triggerHandler(e),e.isDefaultPrevented()||(this.escape(),this.tab(),this.options.loading&&this.loading()))},hide:function(e){return e&&e.preventDefault(),e=$.Event("hide"),this.$element.triggerHandler(e),!this.isShown||e.isDefaultPrevented()?this.isShown=!1:(this.isShown=!1,this.escape(),this.tab(),this.isLoading&&this.loading(),$(document).off("focusin.modal"),this.$element.removeClass("in").removeClass("animated").removeClass(this.options.attentionAnimation).removeClass("modal-overflow").attr("aria-hidden",!0),$.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal(),void 0)},layout:function(){var prop=this.options.height?"height":"max-height",value=this.options.height||this.options.maxHeight;if(this.options.width){this.$element.css("width",this.options.width);var that=this;this.$element.css("margin-left",function(){return/%/gi.test(that.options.width)?-(parseInt(that.options.width)/2)+"%":-($(this).width()/2)+"px"})}else this.$element.css("width",""),this.$element.css("margin-left","");this.$element.find(".modal-body").css("overflow","").css(prop,"");var modalOverflow=$(window).height()-10<this.$element.height();value&&this.$element.find(".modal-body").css("overflow","auto").css(prop,value),modalOverflow||this.options.modalOverflow?this.$element.css("margin-top",0).addClass("modal-overflow"):this.$element.css("margin-top",0-this.$element.height()/2).removeClass("modal-overflow")},tab:function(){var that=this;this.isShown&&this.options.consumeTab?this.$element.on("keydown.tabindex.modal","[data-tabindex]",function(e){if(e.keyCode&&9==e.keyCode){var $next=$(this),$rollover=$(this);that.$element.find("[data-tabindex]:enabled:not([readonly])").each(function(e){$next=e.shiftKey?$next.data("tabindex")>$(this).data("tabindex")?$next=$(this):$rollover=$(this):$next.data("tabindex")<$(this).data("tabindex")?$next=$(this):$rollover=$(this)}),$next[0]!==$(this)[0]?$next.focus():$rollover.focus(),e.preventDefault()}}):this.isShown||this.$element.off("keydown.tabindex.modal")},escape:function(){var that=this;this.isShown&&this.options.keyboard?(this.$element.attr("tabindex")||this.$element.attr("tabindex",-1),this.$element.on("keyup.dismiss.modal",function(e){27==e.which&&that.hide()})):this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var that=this,timeout=setTimeout(function(){that.$element.off($.support.transition.end),that.hideModal()},500);this.$element.one($.support.transition.end,function(){clearTimeout(timeout),that.hideModal()})},hideModal:function(){this.$element.hide().triggerHandler("hidden");var prop=this.options.height?"height":"max-height",value=this.options.height||this.options.maxHeight;value&&this.$element.find(".modal-body").css("overflow","").css(prop,"")},removeLoading:function(){this.$loading.remove(),this.$loading=null,this.isLoading=!1},loading:function(callback){callback=callback||function(){};var animate=this.$element.hasClass("fade")?"fade":"";if(this.isLoading)if(this.isLoading&&this.$loading){this.$loading.removeClass("in");var that=this;$.support.transition&&this.$element.hasClass("fade")?this.$loading.one($.support.transition.end,function(){that.removeLoading()}):that.removeLoading()}else callback&&callback(this.isLoading);else{var doAnimate=$.support.transition&&animate;this.$loading=$('<div class="loading-mask '+animate+'">').append(this.options.spinner).appendTo(this.$element),doAnimate&&this.$loading[0].offsetWidth,this.$loading.addClass("in"),this.isLoading=!0,doAnimate?this.$loading.one($.support.transition.end,callback):callback()}},focus:function(){var $focusElem=this.$element.find(this.options.focusOn);$focusElem=$focusElem.length?$focusElem:this.$element,$focusElem.focus()},attention:function(){if(this.options.attentionAnimation){this.$element.removeClass("animated").removeClass(this.options.attentionAnimation);var that=this;setTimeout(function(){that.$element.addClass("animated").addClass(that.options.attentionAnimation)},0)}this.focus()},destroy:function(){var e=$.Event("destroy");this.$element.triggerHandler(e),e.isDefaultPrevented()||this.teardown()},teardown:function(){return this.$parent.length?(this.$parent!==this.$element.parent()&&this.$element.appendTo(this.$parent),this.$element.off(".modal"),this.$element.removeData("modal"),this.$element.removeClass("in").attr("aria-hidden",!0),void 0):(this.$element.remove(),this.$element=null,void 0)}},$.fn.modal=function(option,args){return this.each(function(){var $this=$(this),data=$this.data("modal"),options=$.extend({},$.fn.modal.defaults,$this.data(),"object"==typeof option&&option);data||$this.data("modal",data=new Modal(this,options)),"string"==typeof option?data[option].apply(data,[].concat(args)):options.show&&data.show()})},$.fn.modal.defaults={keyboard:!0,backdrop:!0,loading:!1,show:!0,width:null,height:null,maxHeight:null,modalOverflow:!1,consumeTab:!0,focusOn:null,replace:!1,resize:!1,attentionAnimation:"shake",manager:"body",spinner:'<div class="loading-spinner" style="width: 200px; margin-left: -100px;"><div class="progress progress-striped active"><div class="bar" style="width: 100%;"></div></div></div>'},$.fn.modal.Constructor=Modal,$(function(){$(document).off(".modal").on("click.modal.data-api",'[data-toggle="modal"]',function(e){var $this=$(this),href=$this.attr("href"),$target=$($this.attr("data-target")||href&&href.replace(/.*(?=#[^\s]+$)/,"")),option=$target.data("modal")?"toggle":$.extend({remote:!/#/.test(href)&&href},$target.data(),$this.data());e.preventDefault(),$target.modal(option).one("hide",function(){$this.focus()})})})}(window.jQuery),+function($){"use strict";var Tooltip=function(element,options){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",element,options)};Tooltip.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},Tooltip.prototype.init=function(type,element,options){this.enabled=!0,this.type=type,this.$element=$(element),this.options=this.getOptions(options);for(var triggers=this.options.trigger.split(" "),i=triggers.length;i--;){var trigger=triggers[i];if("click"==trigger)this.$element.on("click."+this.type,this.options.selector,$.proxy(this.toggle,this));else if("manual"!=trigger){var eventIn="hover"==trigger?"mouseenter":"focusin",eventOut="hover"==trigger?"mouseleave":"focusout";this.$element.on(eventIn+"."+this.type,this.options.selector,$.proxy(this.enter,this)),this.$element.on(eventOut+"."+this.type,this.options.selector,$.proxy(this.leave,this))}}this.options.selector?this._options=$.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},Tooltip.prototype.getDefaults=function(){return Tooltip.DEFAULTS},Tooltip.prototype.getOptions=function(options){return options=$.extend({},this.getDefaults(),this.$element.data(),options),options.delay&&"number"==typeof options.delay&&(options.delay={show:options.delay,hide:options.delay}),options},Tooltip.prototype.getDelegateOptions=function(){var options={},defaults=this.getDefaults();return this._options&&$.each(this._options,function(key,value){defaults[key]!=value&&(options[key]=value)}),options},Tooltip.prototype.enter=function(obj){var self=obj instanceof this.constructor?obj:$(obj.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);return clearTimeout(self.timeout),self.hoverState="in",self.options.delay&&self.options.delay.show?(self.timeout=setTimeout(function(){"in"==self.hoverState&&self.show()
},self.options.delay.show),void 0):self.show()},Tooltip.prototype.leave=function(obj){var self=obj instanceof this.constructor?obj:$(obj.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);return clearTimeout(self.timeout),self.hoverState="out",self.options.delay&&self.options.delay.hide?(self.timeout=setTimeout(function(){"out"==self.hoverState&&self.hide()},self.options.delay.hide),void 0):self.hide()},Tooltip.prototype.show=function(){var e=$.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){if(this.$element.trigger(e),e.isDefaultPrevented())return;var that=this,$tip=this.tip();this.setContent(),this.options.animation&&$tip.addClass("fade");var placement="function"==typeof this.options.placement?this.options.placement.call(this,$tip[0],this.$element[0]):this.options.placement,autoToken=/\s?auto?\s?/i,autoPlace=autoToken.test(placement);autoPlace&&(placement=placement.replace(autoToken,"")||"top"),$tip.detach().css({top:0,left:0,display:"block"}).addClass(placement),this.options.container?$tip.appendTo(this.options.container):$tip.insertAfter(this.$element);var pos=this.getPosition(),actualWidth=$tip[0].offsetWidth,actualHeight=$tip[0].offsetHeight;if(autoPlace){var $parent=this.$element.parent(),orgPlacement=placement,docScroll=document.documentElement.scrollTop||document.body.scrollTop,parentWidth="body"==this.options.container?window.innerWidth:$parent.outerWidth(),parentHeight="body"==this.options.container?window.innerHeight:$parent.outerHeight(),parentLeft="body"==this.options.container?0:$parent.offset().left;placement="bottom"==placement&&pos.top+pos.height+actualHeight-docScroll>parentHeight?"top":"top"==placement&&pos.top-docScroll-actualHeight<0?"bottom":"right"==placement&&pos.right+actualWidth>parentWidth?"left":"left"==placement&&pos.left-actualWidth<parentLeft?"right":placement,$tip.removeClass(orgPlacement).addClass(placement)}var calculatedOffset=this.getCalculatedOffset(placement,pos,actualWidth,actualHeight);this.applyPlacement(calculatedOffset,placement),this.hoverState=null;var complete=function(){that.$element.trigger("shown.bs."+that.type)};$.support.transition&&this.$tip.hasClass("fade")?$tip.one($.support.transition.end,complete).emulateTransitionEnd(150):complete()}},Tooltip.prototype.applyPlacement=function(offset,placement){var replace,$tip=this.tip(),width=$tip[0].offsetWidth,height=$tip[0].offsetHeight,marginTop=parseInt($tip.css("margin-top"),10),marginLeft=parseInt($tip.css("margin-left"),10);isNaN(marginTop)&&(marginTop=0),isNaN(marginLeft)&&(marginLeft=0),offset.top=offset.top+marginTop,offset.left=offset.left+marginLeft,$.offset.setOffset($tip[0],$.extend({using:function(props){$tip.css({top:Math.round(props.top),left:Math.round(props.left)})}},offset),0),$tip.addClass("in");var actualWidth=$tip[0].offsetWidth,actualHeight=$tip[0].offsetHeight;if("top"==placement&&actualHeight!=height&&(replace=!0,offset.top=offset.top+height-actualHeight),/bottom|top/.test(placement)){var delta=0;offset.left<0&&(delta=-2*offset.left,offset.left=0,$tip.offset(offset),actualWidth=$tip[0].offsetWidth,actualHeight=$tip[0].offsetHeight),this.replaceArrow(delta-width+actualWidth,actualWidth,"left")}else this.replaceArrow(actualHeight-height,actualHeight,"top");replace&&$tip.offset(offset)},Tooltip.prototype.replaceArrow=function(delta,dimension,position){this.arrow().css(position,delta?50*(1-delta/dimension)+"%":"")},Tooltip.prototype.setContent=function(){var $tip=this.tip(),title=this.getTitle();$tip.find(".tooltip-inner")[this.options.html?"html":"text"](title),$tip.removeClass("fade in top bottom left right")},Tooltip.prototype.hide=function(){function complete(){"in"!=that.hoverState&&$tip.detach(),that.$element.trigger("hidden.bs."+that.type)}var that=this,$tip=this.tip(),e=$.Event("hide.bs."+this.type);return this.$element.trigger(e),e.isDefaultPrevented()?void 0:($tip.removeClass("in"),$.support.transition&&this.$tip.hasClass("fade")?$tip.one($.support.transition.end,complete).emulateTransitionEnd(150):complete(),this.hoverState=null,this)},Tooltip.prototype.fixTitle=function(){var $e=this.$element;($e.attr("title")||"string"!=typeof $e.attr("data-original-title"))&&$e.attr("data-original-title",$e.attr("title")||"").attr("title","")},Tooltip.prototype.hasContent=function(){return this.getTitle()},Tooltip.prototype.getPosition=function(){var el=this.$element[0];return $.extend({},"function"==typeof el.getBoundingClientRect?el.getBoundingClientRect():{width:el.offsetWidth,height:el.offsetHeight},this.$element.offset())},Tooltip.prototype.getCalculatedOffset=function(placement,pos,actualWidth,actualHeight){return"bottom"==placement?{top:pos.top+pos.height,left:pos.left+pos.width/2-actualWidth/2}:"top"==placement?{top:pos.top-actualHeight,left:pos.left+pos.width/2-actualWidth/2}:"left"==placement?{top:pos.top+pos.height/2-actualHeight/2,left:pos.left-actualWidth}:{top:pos.top+pos.height/2-actualHeight/2,left:pos.left+pos.width}},Tooltip.prototype.getTitle=function(){var title,$e=this.$element,o=this.options;return title=$e.attr("data-original-title")||("function"==typeof o.title?o.title.call($e[0]):o.title)},Tooltip.prototype.tip=function(){return this.$tip=this.$tip||$(this.options.template)},Tooltip.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},Tooltip.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},Tooltip.prototype.enable=function(){this.enabled=!0},Tooltip.prototype.disable=function(){this.enabled=!1},Tooltip.prototype.toggleEnabled=function(){this.enabled=!this.enabled},Tooltip.prototype.toggle=function(e){var self=e?$(e.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type):this;self.tip().hasClass("in")?self.leave(self):self.enter(self)},Tooltip.prototype.destroy=function(){clearTimeout(this.timeout),this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var old=$.fn.tooltip;$.fn.tooltip=function(option){return this.each(function(){var $this=$(this),data=$this.data("bs.tooltip"),options="object"==typeof option&&option;(data||"destroy"!=option)&&(data||$this.data("bs.tooltip",data=new Tooltip(this,options)),"string"==typeof option&&data[option]())})},$.fn.tooltip.Constructor=Tooltip,$.fn.tooltip.noConflict=function(){return $.fn.tooltip=old,this}}(jQuery),+function($){"use strict";function transitionEnd(){var el=document.createElement("bootstrap"),transEndEventNames={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var name in transEndEventNames)if(void 0!==el.style[name])return{end:transEndEventNames[name]};return!1}$.fn.emulateTransitionEnd=function(duration){var called=!1,$el=this;$(this).one($.support.transition.end,function(){called=!0});var callback=function(){called||$($el).trigger($.support.transition.end)};return setTimeout(callback,duration),this},$(function(){$.support.transition=transitionEnd()})}(jQuery),+function($){"use strict";var Popover=function(element,options){this.init("popover",element,options)};if(!$.fn.tooltip)throw new Error("Popover requires tooltip.js");Popover.DEFAULTS=$.extend({},$.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),Popover.prototype=$.extend({},$.fn.tooltip.Constructor.prototype),Popover.prototype.constructor=Popover,Popover.prototype.getDefaults=function(){return Popover.DEFAULTS},Popover.prototype.setContent=function(){var $tip=this.tip(),title=this.getTitle(),content=this.getContent();$tip.find(".popover-title")[this.options.html?"html":"text"](title),$tip.find(".popover-content")[this.options.html?"string"==typeof content?"html":"append":"text"](content),$tip.removeClass("fade top bottom left right in"),$tip.find(".popover-title").html()||$tip.find(".popover-title").hide()},Popover.prototype.hasContent=function(){return this.getTitle()||this.getContent()},Popover.prototype.getContent=function(){var $e=this.$element,o=this.options;return $e.attr("data-content")||("function"==typeof o.content?o.content.call($e[0]):o.content)},Popover.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},Popover.prototype.tip=function(){return this.$tip||(this.$tip=$(this.options.template)),this.$tip};var old=$.fn.popover;$.fn.popover=function(option){return this.each(function(){var $this=$(this),data=$this.data("bs.popover"),options="object"==typeof option&&option;(data||"destroy"!=option)&&(data||$this.data("bs.popover",data=new Popover(this,options)),"string"==typeof option&&data[option]())})},$.fn.popover.Constructor=Popover,$.fn.popover.noConflict=function(){return $.fn.popover=old,this}}(jQuery),function(global){function index(array,item){for(var i=array.length;i--;)if(array[i]===item)return i;return-1}function compareArray(a1,a2){if(a1.length!=a2.length)return!1;for(var i=0;i<a1.length;i++)if(a1[i]!==a2[i])return!1;return!0}function updateModifierKey(event){for(k in _mods)_mods[k]=event[modifierMap[k]]}function dispatch(event){var key,handler,k,i,modifiersMatch,scope;if(key=event.keyCode,-1==index(_downKeys,key)&&_downKeys.push(key),(93==key||224==key)&&(key=91),key in _mods){_mods[key]=!0;for(k in _MODIFIERS)_MODIFIERS[k]==key&&(assignKey[k]=!0)}else if(updateModifierKey(event),assignKey.filter.call(this,event)&&key in _handlers)for(scope=getScope(),i=0;i<_handlers[key].length;i++)if(handler=_handlers[key][i],handler.scope==scope||"all"==handler.scope){modifiersMatch=handler.mods.length>0;for(k in _mods)(!_mods[k]&&index(handler.mods,+k)>-1||_mods[k]&&-1==index(handler.mods,+k))&&(modifiersMatch=!1);(0!=handler.mods.length||_mods[16]||_mods[18]||_mods[17]||_mods[91])&&!modifiersMatch||handler.method(event,handler)===!1&&(event.preventDefault?event.preventDefault():event.returnValue=!1,event.stopPropagation&&event.stopPropagation(),event.cancelBubble&&(event.cancelBubble=!0))}}function clearModifier(event){var k,key=event.keyCode,i=index(_downKeys,key);if(i>=0&&_downKeys.splice(i,1),(93==key||224==key)&&(key=91),key in _mods){_mods[key]=!1;for(k in _MODIFIERS)_MODIFIERS[k]==key&&(assignKey[k]=!1)}}function resetModifiers(){for(k in _mods)_mods[k]=!1;for(k in _MODIFIERS)assignKey[k]=!1}function assignKey(key,scope,method){var keys,mods;keys=getKeys(key),void 0===method&&(method=scope,scope="all");for(var i=0;i<keys.length;i++)mods=[],key=keys[i].split("+"),key.length>1&&(mods=getMods(key),key=[key[key.length-1]]),key=key[0],key=code(key),key in _handlers||(_handlers[key]=[]),_handlers[key].push({shortcut:keys[i],scope:scope,method:method,key:keys[i],mods:mods})}function unbindKey(key,scope){var multipleKeys,keys,i,j,obj,mods=[];for(multipleKeys=getKeys(key),j=0;j<multipleKeys.length;j++){if(keys=multipleKeys[j].split("+"),keys.length>1&&(mods=getMods(keys),key=keys[keys.length-1]),key=code(key),void 0===scope&&(scope=getScope()),!_handlers[key])return;for(i in _handlers[key])obj=_handlers[key][i],obj.scope===scope&&compareArray(obj.mods,mods)&&(_handlers[key][i]={})}}function isPressed(keyCode){return"string"==typeof keyCode&&(keyCode=code(keyCode)),-1!=index(_downKeys,keyCode)}function getPressedKeyCodes(){return _downKeys.slice(0)}function filter(event){var tagName=(event.target||event.srcElement).tagName;return!("INPUT"==tagName||"SELECT"==tagName||"TEXTAREA"==tagName)}function setScope(scope){_scope=scope||"all"}function getScope(){return _scope||"all"}function deleteScope(scope){var key,handlers,i;for(key in _handlers)for(handlers=_handlers[key],i=0;i<handlers.length;)handlers[i].scope===scope?handlers.splice(i,1):i++}function getKeys(key){var keys;return key=key.replace(/\s/g,""),keys=key.split(","),""==keys[keys.length-1]&&(keys[keys.length-2]+=","),keys}function getMods(key){for(var mods=key.slice(0,key.length-1),mi=0;mi<mods.length;mi++)mods[mi]=_MODIFIERS[mods[mi]];return mods}function addEvent(object,event,method){object.addEventListener?object.addEventListener(event,method,!1):object.attachEvent&&object.attachEvent("on"+event,function(){method(window.event)})}function noConflict(){var k=global.key;return global.key=previousKey,k}var k,_handlers={},_mods={16:!1,18:!1,17:!1,91:!1},_scope="all",_MODIFIERS={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,command:91},_MAP={backspace:8,tab:9,clear:12,enter:13,"return":13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,"delete":46,home:36,end:35,pageup:33,pagedown:34,",":188,".":190,"/":191,"`":192,"-":189,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220},code=function(x){return _MAP[x]||x.toUpperCase().charCodeAt(0)},_downKeys=[];for(k=1;20>k;k++)_MAP["f"+k]=111+k;var modifierMap={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"};for(k in _MODIFIERS)assignKey[k]=!1;addEvent(document,"keydown",function(event){dispatch(event)}),addEvent(document,"keyup",clearModifier),addEvent(window,"focus",resetModifiers);var previousKey=global.key;global.key=assignKey,global.key.setScope=setScope,global.key.getScope=getScope,global.key.deleteScope=deleteScope,global.key.filter=filter,global.key.isPressed=isPressed,global.key.getPressedKeyCodes=getPressedKeyCodes,global.key.noConflict=noConflict,global.key.unbind=unbindKey,"undefined"!=typeof module&&(module.exports=key)}(this),function(expose){function mk_block_toSource(){return"Markdown.mk_block( "+uneval(this.toString())+", "+uneval(this.trailing)+", "+uneval(this.lineNumber)+" )"}function mk_block_inspect(){var util=require("util");return"Markdown.mk_block( "+util.inspect(this.toString())+", "+util.inspect(this.trailing)+", "+util.inspect(this.lineNumber)+" )"}function count_lines(str){for(var n=0,i=-1;-1!==(i=str.indexOf("\n",i+1));)n++;return n}function strong_em(tag,md){function CloseTag(len){this.len_after=len,this.name="close_"+md}var state_slot=tag+"_state",other_slot="strong"==tag?"em_state":"strong_state";return function(text){if(this[state_slot][0]==md)return this[state_slot].shift(),[text.length,new CloseTag(text.length-md.length)];var other=this[other_slot].slice(),state=this[state_slot].slice();this[state_slot].unshift(md);{var res=this.processInline(text.substr(md.length)),last=res[res.length-1];this[state_slot].shift()}if(last instanceof CloseTag){res.pop();var consumed=text.length-last.len_after;return[consumed,[tag].concat(res)]}return this[other_slot]=other,this[state_slot]=state,[md.length,md]}}function split_meta_hash(meta_string){for(var meta=meta_string.split(""),parts=[""],in_quotes=!1;meta.length;){var letter=meta.shift();switch(letter){case" ":in_quotes?parts[parts.length-1]+=letter:parts.push("");break;case"'":case'"':in_quotes=!in_quotes;break;case"\\":letter=meta.shift();default:parts[parts.length-1]+=letter}}return parts}function extract_attr(jsonml){return isArray(jsonml)&&jsonml.length>1&&"object"==typeof jsonml[1]&&!isArray(jsonml[1])?jsonml[1]:void 0}function escapeHTML(text){return text.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function render_tree(jsonml){if("string"==typeof jsonml)return escapeHTML(jsonml);var tag=jsonml.shift(),attributes={},content=[];for(!jsonml.length||"object"!=typeof jsonml[0]||jsonml[0]instanceof Array||(attributes=jsonml.shift());jsonml.length;)content.push(render_tree(jsonml.shift()));var tag_attrs="";for(var a in attributes)tag_attrs+=" "+a+'="'+escapeHTML(attributes[a])+'"';return"img"==tag||"br"==tag||"hr"==tag?"<"+tag+tag_attrs+"/>":"<"+tag+tag_attrs+">"+content.join("")+"</"+tag+">"}function convert_tree_to_html(tree,references,options){var i;options=options||{};var jsonml=tree.slice(0);"function"==typeof options.preprocessTreeNode&&(jsonml=options.preprocessTreeNode(jsonml,references));var attrs=extract_attr(jsonml);if(attrs){jsonml[1]={};for(i in attrs)jsonml[1][i]=attrs[i];attrs=jsonml[1]}if("string"==typeof jsonml)return jsonml;switch(jsonml[0]){case"header":jsonml[0]="h"+jsonml[1].level,delete jsonml[1].level;break;case"bulletlist":jsonml[0]="ul";break;case"numberlist":jsonml[0]="ol";break;case"listitem":jsonml[0]="li";break;case"para":jsonml[0]="p";break;case"markdown":jsonml[0]="html",attrs&&delete attrs.references;break;case"code_block":jsonml[0]="pre",i=attrs?2:1;var code=["code"];code.push.apply(code,jsonml.splice(i,jsonml.length-i)),jsonml[i]=code;break;case"inlinecode":jsonml[0]="code";break;case"img":jsonml[1].src=jsonml[1].href,delete jsonml[1].href;break;case"linebreak":jsonml[0]="br";break;case"link":jsonml[0]="a";break;case"link_ref":jsonml[0]="a";var ref=references[attrs.ref];if(!ref)return attrs.original;delete attrs.ref,attrs.href=ref.href,ref.title&&(attrs.title=ref.title),delete attrs.original;break;case"img_ref":jsonml[0]="img";var ref=references[attrs.ref];if(!ref)return attrs.original;delete attrs.ref,attrs.src=ref.href,ref.title&&(attrs.title=ref.title),delete attrs.original}if(i=1,attrs){for(var key in jsonml[1]){i=2;break}1===i&&jsonml.splice(i,1)}for(;i<jsonml.length;++i)jsonml[i]=convert_tree_to_html(jsonml[i],references,options);return jsonml}function merge_text_nodes(jsonml){for(var i=extract_attr(jsonml)?2:1;i<jsonml.length;)"string"==typeof jsonml[i]?i+1<jsonml.length&&"string"==typeof jsonml[i+1]?jsonml[i]+=jsonml.splice(i+1,1)[0]:++i:(merge_text_nodes(jsonml[i]),++i)}var Markdown=expose.Markdown=function(dialect){switch(typeof dialect){case"undefined":this.dialect=Markdown.dialects.Gruber;break;case"object":this.dialect=dialect;break;default:if(!(dialect in Markdown.dialects))throw new Error("Unknown Markdown dialect '"+String(dialect)+"'");this.dialect=Markdown.dialects[dialect]}this.em_state=[],this.strong_state=[],this.debug_indent=""};expose.parse=function(source,dialect){var md=new Markdown(dialect);return md.toTree(source)},expose.toHTML=function(source,dialect,options){var input=expose.toHTMLTree(source,dialect,options);return expose.renderJsonML(input)},expose.toHTMLTree=function(input,dialect,options){"string"==typeof input&&(input=this.parse(input,dialect));var attrs=extract_attr(input),refs={};attrs&&attrs.references&&(refs=attrs.references);var html=convert_tree_to_html(input,refs,options);return merge_text_nodes(html),html};var mk_block=Markdown.mk_block=function(block,trail,line){1==arguments.length&&(trail="\n\n");var s=new String(block);return s.trailing=trail,s.inspect=mk_block_inspect,s.toSource=mk_block_toSource,void 0!=line&&(s.lineNumber=line),s};Markdown.prototype.split_blocks=function(input){input=input.replace(/(\r\n|\n|\r)/g,"\n");var m,re=/([\s\S]+?)($|\n#|\n(?:\s*\n|$)+)/g,blocks=[],line_no=1;for(null!=(m=/^(\s*\n)/.exec(input))&&(line_no+=count_lines(m[0]),re.lastIndex=m[0].length);null!==(m=re.exec(input));)"\n#"==m[2]&&(m[2]="\n",re.lastIndex--),blocks.push(mk_block(m[1],m[2],line_no)),line_no+=count_lines(m[0]);return blocks},Markdown.prototype.processBlock=function(block,next){var cbs=this.dialect.block,ord=cbs.__order__;if("__call__"in cbs)return cbs.__call__.call(this,block,next);for(var i=0;i<ord.length;i++){var res=cbs[ord[i]].call(this,block,next);if(res)return(!isArray(res)||res.length>0&&!isArray(res[0]))&&this.debug(ord[i],"didn't return a proper array"),res}return[]},Markdown.prototype.processInline=function(block){return this.dialect.inline.__call__.call(this,String(block))},Markdown.prototype.toTree=function(source,custom_root){var blocks=source instanceof Array?source:this.split_blocks(source),old_tree=this.tree;try{for(this.tree=custom_root||this.tree||["markdown"];blocks.length;){var b=this.processBlock(blocks.shift(),blocks);b.length&&this.tree.push.apply(this.tree,b)}return this.tree}finally{custom_root&&(this.tree=old_tree)}},Markdown.prototype.debug=function(){var args=Array.prototype.slice.call(arguments);args.unshift(this.debug_indent),"undefined"!=typeof print&&print.apply(print,args),"undefined"!=typeof console&&"undefined"!=typeof console.log&&console.log.apply(null,args)},Markdown.prototype.loop_re_over_block=function(re,block,cb){for(var m,b=block.valueOf();b.length&&null!=(m=re.exec(b));)b=b.substr(m[0].length),cb.call(this,m);return b},Markdown.dialects={},Markdown.dialects.Gruber={block:{atxHeader:function(block,next){var m=block.match(/^(#{1,6})\s*(.*?)\s*#*\s*(?:\n|$)/);if(!m)return void 0;var header=["header",{level:m[1].length}];return Array.prototype.push.apply(header,this.processInline(m[2])),m[0].length<block.length&&next.unshift(mk_block(block.substr(m[0].length),block.trailing,block.lineNumber+2)),[header]},setextHeader:function(block,next){var m=block.match(/^(.*)\n([-=])\2\2+(?:\n|$)/);if(!m)return void 0;var level="="===m[2]?1:2,header=["header",{level:level},m[1]];return m[0].length<block.length&&next.unshift(mk_block(block.substr(m[0].length),block.trailing,block.lineNumber+2)),[header]},code:function(block,next){var ret=[],re=/^(?: {0,3}\t| {4})(.*)\n?/;if(!block.match(re))return void 0;block_search:for(;;){var b=this.loop_re_over_block(re,block.valueOf(),function(m){ret.push(m[1])});if(b.length){next.unshift(mk_block(b,block.trailing));break block_search}if(!next.length)break block_search;if(!next[0].match(re))break block_search;ret.push(block.trailing.replace(/[^\n]/g,"").substring(2)),block=next.shift()}return[["code_block",ret.join("\n")]]},horizRule:function(block,next){var m=block.match(/^(?:([\s\S]*?)\n)?[ \t]*([-_*])(?:[ \t]*\2){2,}[ \t]*(?:\n([\s\S]*))?$/);if(!m)return void 0;var jsonml=[["hr"]];return m[1]&&jsonml.unshift.apply(jsonml,this.processBlock(m[1],[])),m[3]&&next.unshift(mk_block(m[3])),jsonml},lists:function(){function regex_for_depth(depth){return new RegExp("(?:^("+indent_re+"{0,"+depth+"} {0,3})("+any_list+")\\s+)|(^"+indent_re+"{0,"+(depth-1)+"}[ ]{0,4})")}function expand_tab(input){return input.replace(/ {0,3}\t/g,"    ")}function add(li,loose,inline,nl){if(loose)return li.push(["para"].concat(inline)),void 0;var add_to=li[li.length-1]instanceof Array&&"para"==li[li.length-1][0]?li[li.length-1]:li;nl&&li.length>1&&inline.unshift(nl);for(var i=0;i<inline.length;i++){var what=inline[i],is_str="string"==typeof what;is_str&&add_to.length>1&&"string"==typeof add_to[add_to.length-1]?add_to[add_to.length-1]+=what:add_to.push(what)}}function get_contained_blocks(depth,blocks){for(var re=new RegExp("^("+indent_re+"{"+depth+"}.*?\\n?)*$"),replace=new RegExp("^"+indent_re+"{"+depth+"}","gm"),ret=[];blocks.length>0&&re.exec(blocks[0]);){var b=blocks.shift(),x=b.replace(replace,"");ret.push(mk_block(x,b.trailing,b.lineNumber))}return ret}function paragraphify(s,i,stack){var list=s.list,last_li=list[list.length-1];if(!(last_li[1]instanceof Array&&"para"==last_li[1][0]))if(i+1==stack.length)last_li.push(["para"].concat(last_li.splice(1,last_li.length-1)));else{var sublist=last_li.pop();last_li.push(["para"].concat(last_li.splice(1,last_li.length-1)),sublist)}}var any_list="[*+-]|\\d+\\.",bullet_list=/[*+-]/,is_list_re=new RegExp("^( {0,3})("+any_list+")[ 	]+"),indent_re="(?: {0,3}\\t| {4})";return function(block,next){function make_list(m){var list=bullet_list.exec(m[2])?["bulletlist"]:["numberlist"];return stack.push({list:list,indent:m[1]}),list}var m=block.match(is_list_re);if(!m)return void 0;for(var last_li,i,stack=[],list=make_list(m),loose=!1,ret=[stack[0].list];;){for(var lines=block.split(/(?=\n)/),li_accumulate="",line_no=0;line_no<lines.length;line_no++){var nl="",l=lines[line_no].replace(/^\n/,function(n){return nl=n,""}),line_re=regex_for_depth(stack.length);if(m=l.match(line_re),void 0!==m[1]){li_accumulate.length&&(add(last_li,loose,this.processInline(li_accumulate),nl),loose=!1,li_accumulate=""),m[1]=expand_tab(m[1]);var wanted_depth=Math.floor(m[1].length/4)+1;if(wanted_depth>stack.length)list=make_list(m),last_li.push(list),last_li=list[1]=["listitem"];else{var found=!1;for(i=0;i<stack.length;i++)if(stack[i].indent==m[1]){list=stack[i].list,stack.splice(i+1,stack.length-(i+1)),found=!0;break}found||(wanted_depth++,wanted_depth<=stack.length?(stack.splice(wanted_depth,stack.length-wanted_depth),list=stack[wanted_depth-1].list):(list=make_list(m),last_li.push(list))),last_li=["listitem"],list.push(last_li)}nl=""}l.length>m[0].length&&(li_accumulate+=nl+l.substr(m[0].length))}li_accumulate.length&&(add(last_li,loose,this.processInline(li_accumulate),nl),loose=!1,li_accumulate="");var contained=get_contained_blocks(stack.length,next);contained.length>0&&(forEach(stack,paragraphify,this),last_li.push.apply(last_li,this.toTree(contained,[])));var next_block=next[0]&&next[0].valueOf()||"";if(!next_block.match(is_list_re)&&!next_block.match(/^ /))break;block=next.shift();var hr=this.dialect.block.horizRule(block,next);if(hr){ret.push.apply(ret,hr);break}forEach(stack,paragraphify,this),loose=!0}return ret}}(),blockquote:function(block,next){if(!block.match(/^>/m))return void 0;var jsonml=[];if(">"!=block[0]){for(var lines=block.split(/\n/),prev=[],line_no=block.lineNumber;lines.length&&">"!=lines[0][0];)prev.push(lines.shift()),line_no++;var abutting=mk_block(prev.join("\n"),"\n",block.lineNumber);jsonml.push.apply(jsonml,this.processBlock(abutting,[])),block=mk_block(lines.join("\n"),block.trailing,line_no)}for(;next.length&&">"==next[0][0];){var b=next.shift();block=mk_block(block+block.trailing+b,b.trailing,block.lineNumber)}var input=block.replace(/^> ?/gm,""),processedBlock=(this.tree,this.toTree(input,["blockquote"])),attr=extract_attr(processedBlock);return attr&&attr.references&&(delete attr.references,isEmpty(attr)&&processedBlock.splice(1,1)),jsonml.push(processedBlock),jsonml},referenceDefn:function(block,next){var re=/^\s*\[(.*?)\]:\s*(\S+)(?:\s+(?:(['"])(.*?)\3|\((.*?)\)))?\n?/;if(!block.match(re))return void 0;extract_attr(this.tree)||this.tree.splice(1,0,{});var attrs=extract_attr(this.tree);void 0===attrs.references&&(attrs.references={});var b=this.loop_re_over_block(re,block,function(m){m[2]&&"<"==m[2][0]&&">"==m[2][m[2].length-1]&&(m[2]=m[2].substring(1,m[2].length-1));var ref=attrs.references[m[1].toLowerCase()]={href:m[2]};void 0!==m[4]?ref.title=m[4]:void 0!==m[5]&&(ref.title=m[5])});return b.length&&next.unshift(mk_block(b,block.trailing)),[]},para:function(block){return[["para"].concat(this.processInline(block))]}}},Markdown.dialects.Gruber.inline={__oneElement__:function(text,patterns_or_re,previous_nodes){var m,res;patterns_or_re=patterns_or_re||this.dialect.inline.__patterns__;var re=new RegExp("([\\s\\S]*?)("+(patterns_or_re.source||patterns_or_re)+")");if(m=re.exec(text),!m)return[text.length,text];if(m[1])return[m[1].length,m[1]];var res;return m[2]in this.dialect.inline&&(res=this.dialect.inline[m[2]].call(this,text.substr(m.index),m,previous_nodes||[])),res=res||[m[2].length,m[2]]},__call__:function(text,patterns){function add(x){"string"==typeof x&&"string"==typeof out[out.length-1]?out[out.length-1]+=x:out.push(x)}for(var res,out=[];text.length>0;)res=this.dialect.inline.__oneElement__.call(this,text,patterns,out),text=text.substr(res.shift()),forEach(res,add);return out},"]":function(){},"}":function(){},__escape__:/^\\[\\`\*_{}\[\]()#\+.!\-]/,"\\":function(text){return this.dialect.inline.__escape__.exec(text)?[2,text.charAt(1)]:[1,"\\"]},"![":function(text){var m=text.match(/^!\[(.*?)\][ \t]*\([ \t]*([^")]*?)(?:[ \t]+(["'])(.*?)\3)?[ \t]*\)/);if(m){m[2]&&"<"==m[2][0]&&">"==m[2][m[2].length-1]&&(m[2]=m[2].substring(1,m[2].length-1)),m[2]=this.dialect.inline.__call__.call(this,m[2],/\\/)[0];var attrs={alt:m[1],href:m[2]||""};return void 0!==m[4]&&(attrs.title=m[4]),[m[0].length,["img",attrs]]}return m=text.match(/^!\[(.*?)\][ \t]*\[(.*?)\]/),m?[m[0].length,["img_ref",{alt:m[1],ref:m[2].toLowerCase(),original:m[0]}]]:[2,"!["]},"[":function link(text){var orig=String(text),res=Markdown.DialectHelpers.inline_until_char.call(this,text.substr(1),"]");if(!res)return[1,"["];var link,attrs,consumed=1+res[0],children=res[1];text=text.substr(consumed);var m=text.match(/^\s*\([ \t]*([^"']*)(?:[ \t]+(["'])(.*?)\2)?[ \t]*\)/);if(m){var url=m[1];if(consumed+=m[0].length,url&&"<"==url[0]&&">"==url[url.length-1]&&(url=url.substring(1,url.length-1)),!m[3])for(var open_parens=1,len=0;len<url.length;len++)switch(url[len]){case"(":open_parens++;break;case")":0==--open_parens&&(consumed-=url.length-len,url=url.substring(0,len))}return url=this.dialect.inline.__call__.call(this,url,/\\/)[0],attrs={href:url||""},void 0!==m[3]&&(attrs.title=m[3]),link=["link",attrs].concat(children),[consumed,link]}return m=text.match(/^\s*\[(.*?)\]/),m?(consumed+=m[0].length,attrs={ref:(m[1]||String(children)).toLowerCase(),original:orig.substr(0,consumed)},link=["link_ref",attrs].concat(children),[consumed,link]):1==children.length&&"string"==typeof children[0]?(attrs={ref:children[0].toLowerCase(),original:orig.substr(0,consumed)},link=["link_ref",attrs,children[0]],[consumed,link]):[1,"["]},"<":function(text){var m;return null!=(m=text.match(/^<(?:((https?|ftp|mailto):[^>]+)|(.*?@.*?\.[a-zA-Z]+))>/))?m[3]?[m[0].length,["link",{href:"mailto:"+m[3]},m[3]]]:"mailto"==m[2]?[m[0].length,["link",{href:m[1]},m[1].substr("mailto:".length)]]:[m[0].length,["link",{href:m[1]},m[1]]]:[1,"<"]},"`":function(text){var m=text.match(/(`+)(([\s\S]*?)\1)/);return m&&m[2]?[m[1].length+m[2].length,["inlinecode",m[3]]]:[1,"`"]},"  \n":function(){return[3,["linebreak"]]}},Markdown.dialects.Gruber.inline["**"]=strong_em("strong","**"),Markdown.dialects.Gruber.inline.__=strong_em("strong","__"),Markdown.dialects.Gruber.inline["*"]=strong_em("em","*"),Markdown.dialects.Gruber.inline._=strong_em("em","_"),Markdown.buildBlockOrder=function(d){var ord=[];for(var i in d)"__order__"!=i&&"__call__"!=i&&ord.push(i);d.__order__=ord},Markdown.buildInlinePatterns=function(d){var patterns=[];for(var i in d)if(!i.match(/^__.*__$/)){var l=i.replace(/([\\.*+?|()\[\]{}])/g,"\\$1").replace(/\n/,"\\n");patterns.push(1==i.length?l:"(?:"+l+")")}patterns=patterns.join("|"),d.__patterns__=patterns;var fn=d.__call__;d.__call__=function(text,pattern){return void 0!=pattern?fn.call(this,text,pattern):fn.call(this,text,patterns)}},Markdown.DialectHelpers={},Markdown.DialectHelpers.inline_until_char=function(text,want){for(var consumed=0,nodes=[];;){if(text.charAt(consumed)==want)return consumed++,[consumed,nodes];if(consumed>=text.length)return null;var res=this.dialect.inline.__oneElement__.call(this,text.substr(consumed));consumed+=res[0],nodes.push.apply(nodes,res.slice(1))}},Markdown.subclassDialect=function(d){function Block(){}function Inline(){}return Block.prototype=d.block,Inline.prototype=d.inline,{block:new Block,inline:new Inline}},Markdown.buildBlockOrder(Markdown.dialects.Gruber.block),Markdown.buildInlinePatterns(Markdown.dialects.Gruber.inline),Markdown.dialects.Maruku=Markdown.subclassDialect(Markdown.dialects.Gruber),Markdown.dialects.Maruku.processMetaHash=function(meta_string){for(var meta=split_meta_hash(meta_string),attr={},i=0;i<meta.length;++i)if(/^#/.test(meta[i]))attr.id=meta[i].substring(1);else if(/^\./.test(meta[i]))attr["class"]=attr["class"]?attr["class"]+meta[i].replace(/./," "):meta[i].substring(1);else if(/\=/.test(meta[i])){var s=meta[i].split(/\=/);attr[s[0]]=s[1]}return attr},Markdown.dialects.Maruku.block.document_meta=function(block){if(block.lineNumber>1)return void 0;if(!block.match(/^(?:\w+:.*\n)*\w+:.*$/))return void 0;extract_attr(this.tree)||this.tree.splice(1,0,{});var pairs=block.split(/\n/);for(p in pairs){var m=pairs[p].match(/(\w+):\s*(.*)$/),key=m[1].toLowerCase(),value=m[2];this.tree[1][key]=value}return[]},Markdown.dialects.Maruku.block.block_meta=function(block){var m=block.match(/(^|\n) {0,3}\{:\s*((?:\\\}|[^\}])*)\s*\}$/);if(!m)return void 0;var hash,attr=this.dialect.processMetaHash(m[2]);if(""===m[1]){var node=this.tree[this.tree.length-1];if(hash=extract_attr(node),"string"==typeof node)return void 0;hash||(hash={},node.splice(1,0,hash));for(a in attr)hash[a]=attr[a];return[]}var b=block.replace(/\n.*$/,""),result=this.processBlock(b,[]);hash=extract_attr(result[0]),hash||(hash={},result[0].splice(1,0,hash));for(a in attr)hash[a]=attr[a];return result},Markdown.dialects.Maruku.block.definition_list=function(block,next){var i,m,tight=/^((?:[^\s:].*\n)+):\s+([\s\S]+)$/,list=["dl"];if(!(m=block.match(tight)))return void 0;for(var blocks=[block];next.length&&tight.exec(next[0]);)blocks.push(next.shift());for(var b=0;b<blocks.length;++b){var m=blocks[b].match(tight),terms=m[1].replace(/\n$/,"").split(/\n/),defns=m[2].split(/\n:\s+/);for(i=0;i<terms.length;++i)list.push(["dt",terms[i]]);for(i=0;i<defns.length;++i)list.push(["dd"].concat(this.processInline(defns[i].replace(/(\n)\s+/,"$1"))))}return[list]},Markdown.dialects.Maruku.block.table=function table(block){var i,m,_split_on_unescaped=function(s,ch){ch=ch||"\\s",ch.match(/^[\\|\[\]{}?*.+^$]$/)&&(ch="\\"+ch);
for(var m,res=[],r=new RegExp("^((?:\\\\.|[^\\\\"+ch+"])*)"+ch+"(.*)");m=s.match(r);)res.push(m[1]),s=m[2];return res.push(s),res},leading_pipe=/^ {0,3}\|(.+)\n {0,3}\|\s*([\-:]+[\-| :]*)\n((?:\s*\|.*(?:\n|$))*)(?=\n|$)/,no_leading_pipe=/^ {0,3}(\S(?:\\.|[^\\|])*\|.*)\n {0,3}([\-:]+\s*\|[\-| :]*)\n((?:(?:\\.|[^\\|])*\|.*(?:\n|$))*)(?=\n|$)/;if(m=block.match(leading_pipe))m[3]=m[3].replace(/^\s*\|/gm,"");else if(!(m=block.match(no_leading_pipe)))return void 0;var table=["table",["thead",["tr"]],["tbody"]];m[2]=m[2].replace(/\|\s*$/,"").split("|");var html_attrs=[];for(forEach(m[2],function(s){s.match(/^\s*-+:\s*$/)?html_attrs.push({align:"right"}):s.match(/^\s*:-+\s*$/)?html_attrs.push({align:"left"}):s.match(/^\s*:-+:\s*$/)?html_attrs.push({align:"center"}):html_attrs.push({})}),m[1]=_split_on_unescaped(m[1].replace(/\|\s*$/,""),"|"),i=0;i<m[1].length;i++)table[1][1].push(["th",html_attrs[i]||{}].concat(this.processInline(m[1][i].trim())));return forEach(m[3].replace(/\|\s*$/gm,"").split("\n"),function(row){var html_row=["tr"];for(row=_split_on_unescaped(row,"|"),i=0;i<row.length;i++)html_row.push(["td",html_attrs[i]||{}].concat(this.processInline(row[i].trim())));table[2].push(html_row)},this),[table]},Markdown.dialects.Maruku.inline["{:"]=function(text,matches,out){if(!out.length)return[2,"{:"];var before=out[out.length-1];if("string"==typeof before)return[2,"{:"];var m=text.match(/^\{:\s*((?:\\\}|[^\}])*)\s*\}/);if(!m)return[2,"{:"];var meta=this.dialect.processMetaHash(m[1]),attr=extract_attr(before);attr||(attr={},before.splice(1,0,attr));for(var k in meta)attr[k]=meta[k];return[m[0].length,""]},Markdown.dialects.Maruku.inline.__escape__=/^\\[\\`\*_{}\[\]()#\+.!\-|:]/,Markdown.buildBlockOrder(Markdown.dialects.Maruku.block),Markdown.buildInlinePatterns(Markdown.dialects.Maruku.inline);var forEach,isArray=Array.isArray||function(obj){return"[object Array]"==Object.prototype.toString.call(obj)};forEach=Array.prototype.forEach?function(arr,cb,thisp){return arr.forEach(cb,thisp)}:function(arr,cb,thisp){for(var i=0;i<arr.length;i++)cb.call(thisp||arr,arr[i],i,arr)};var isEmpty=function(obj){for(var key in obj)if(hasOwnProperty.call(obj,key))return!1;return!0};expose.renderJsonML=function(jsonml,options){options=options||{},options.root=options.root||!1;var content=[];if(options.root)content.push(render_tree(jsonml));else for(jsonml.shift(),!jsonml.length||"object"!=typeof jsonml[0]||jsonml[0]instanceof Array||jsonml.shift();jsonml.length;)content.push(render_tree(jsonml.shift()));return content.join("\n\n")}}(function(){return"undefined"==typeof exports?(window.markdown={},window.markdown):exports}()),window.CodeMirror=function(){"use strict";function CodeMirror(place,options){if(!(this instanceof CodeMirror))return new CodeMirror(place,options);this.options=options=options||{};for(var opt in defaults)!options.hasOwnProperty(opt)&&defaults.hasOwnProperty(opt)&&(options[opt]=defaults[opt]);setGuttersForLineNumbers(options);var docStart="string"==typeof options.value?0:options.value.first,display=this.display=makeDisplay(place,docStart);display.wrapper.CodeMirror=this,updateGutters(this),options.autofocus&&!mobile&&focusInput(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,focused:!1,suppressEdits:!1,pasteIncoming:!1,cutIncoming:!1,draggingText:!1,highlight:new Delayed},themeChanged(this),options.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap");var doc=options.value;"string"==typeof doc&&(doc=new Doc(options.value,options.mode)),operation(this,attachDoc)(this,doc),old_ie&&setTimeout(bind(resetInput,this,!0),20),registerEventHandlers(this);var hasFocus;try{hasFocus=document.activeElement==display.input}catch(e){}hasFocus||options.autofocus&&!mobile?setTimeout(bind(onFocus,this),20):onBlur(this),operation(this,function(){for(var opt in optionHandlers)optionHandlers.propertyIsEnumerable(opt)&&optionHandlers[opt](this,options[opt],Init);for(var i=0;i<initHooks.length;++i)initHooks[i](this)})()}function makeDisplay(place,docStart){var d={},input=d.input=elt("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none");return webkit?input.style.width="1000px":input.setAttribute("wrap","off"),ios&&(input.style.border="1px solid black"),input.setAttribute("autocorrect","off"),input.setAttribute("autocapitalize","off"),input.setAttribute("spellcheck","false"),d.inputDiv=elt("div",[input],null,"overflow: hidden; position: relative; width: 3px; height: 0px;"),d.scrollbarH=elt("div",[elt("div",null,null,"height: 1px")],"CodeMirror-hscrollbar"),d.scrollbarV=elt("div",[elt("div",null,null,"width: 1px")],"CodeMirror-vscrollbar"),d.scrollbarFiller=elt("div",null,"CodeMirror-scrollbar-filler"),d.gutterFiller=elt("div",null,"CodeMirror-gutter-filler"),d.lineDiv=elt("div",null,"CodeMirror-code"),d.selectionDiv=elt("div",null,null,"position: relative; z-index: 1"),d.cursor=elt("div"," ","CodeMirror-cursor"),d.otherCursor=elt("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"),d.measure=elt("div",null,"CodeMirror-measure"),d.lineSpace=elt("div",[d.measure,d.selectionDiv,d.lineDiv,d.cursor,d.otherCursor],null,"position: relative; outline: none"),d.mover=elt("div",[elt("div",[d.lineSpace],"CodeMirror-lines")],null,"position: relative"),d.sizer=elt("div",[d.mover],"CodeMirror-sizer"),d.heightForcer=elt("div",null,null,"position: absolute; height: "+scrollerCutOff+"px; width: 1px;"),d.gutters=elt("div",null,"CodeMirror-gutters"),d.lineGutter=null,d.scroller=elt("div",[d.sizer,d.heightForcer,d.gutters],"CodeMirror-scroll"),d.scroller.setAttribute("tabIndex","-1"),d.wrapper=elt("div",[d.inputDiv,d.scrollbarH,d.scrollbarV,d.scrollbarFiller,d.gutterFiller,d.scroller],"CodeMirror"),ie_lt8&&(d.gutters.style.zIndex=-1,d.scroller.style.paddingRight=0),place.appendChild?place.appendChild(d.wrapper):place(d.wrapper),ios&&(input.style.width="0px"),webkit||(d.scroller.draggable=!0),khtml?(d.inputDiv.style.height="1px",d.inputDiv.style.position="absolute"):ie_lt8&&(d.scrollbarH.style.minWidth=d.scrollbarV.style.minWidth="18px"),d.viewOffset=d.lastSizeC=0,d.showingFrom=d.showingTo=docStart,d.lineNumWidth=d.lineNumInnerWidth=d.lineNumChars=null,d.prevInput="",d.alignWidgets=!1,d.pollingFast=!1,d.poll=new Delayed,d.cachedCharWidth=d.cachedTextHeight=d.cachedPaddingH=null,d.measureLineCache=[],d.measureLineCachePos=0,d.inaccurateSelection=!1,d.maxLine=null,d.maxLineLength=0,d.maxLineChanged=!1,d.wheelDX=d.wheelDY=d.wheelStartX=d.wheelStartY=null,d}function loadMode(cm){cm.doc.mode=CodeMirror.getMode(cm.options,cm.doc.modeOption),resetModeState(cm)}function resetModeState(cm){cm.doc.iter(function(line){line.stateAfter&&(line.stateAfter=null),line.styles&&(line.styles=null)}),cm.doc.frontier=cm.doc.first,startWorker(cm,100),cm.state.modeGen++,cm.curOp&&regChange(cm)}function wrappingChanged(cm){cm.options.lineWrapping?(cm.display.wrapper.className+=" CodeMirror-wrap",cm.display.sizer.style.minWidth=""):(cm.display.wrapper.className=cm.display.wrapper.className.replace(" CodeMirror-wrap",""),computeMaxLength(cm)),estimateLineHeights(cm),regChange(cm),clearCaches(cm),setTimeout(function(){updateScrollbars(cm)},100)}function estimateHeight(cm){var th=textHeight(cm.display),wrapping=cm.options.lineWrapping,perLine=wrapping&&Math.max(5,cm.display.scroller.clientWidth/charWidth(cm.display)-3);return function(line){return lineIsHidden(cm.doc,line)?0:wrapping?(Math.ceil(line.text.length/perLine)||1)*th:th}}function estimateLineHeights(cm){var doc=cm.doc,est=estimateHeight(cm);doc.iter(function(line){var estHeight=est(line);estHeight!=line.height&&updateLineHeight(line,estHeight)})}function keyMapChanged(cm){var map=keyMap[cm.options.keyMap],style=map.style;cm.display.wrapper.className=cm.display.wrapper.className.replace(/\s*cm-keymap-\S+/g,"")+(style?" cm-keymap-"+style:"")}function themeChanged(cm){cm.display.wrapper.className=cm.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+cm.options.theme.replace(/(^|\s)\s*/g," cm-s-"),clearCaches(cm)}function guttersChanged(cm){updateGutters(cm),regChange(cm),setTimeout(function(){alignHorizontally(cm)},20)}function updateGutters(cm){var gutters=cm.display.gutters,specs=cm.options.gutters;removeChildren(gutters);for(var i=0;i<specs.length;++i){var gutterClass=specs[i],gElt=gutters.appendChild(elt("div",null,"CodeMirror-gutter "+gutterClass));"CodeMirror-linenumbers"==gutterClass&&(cm.display.lineGutter=gElt,gElt.style.width=(cm.display.lineNumWidth||1)+"px")}gutters.style.display=i?"":"none"}function lineLength(doc,line){if(0==line.height)return 0;for(var merged,len=line.text.length,cur=line;merged=collapsedSpanAtStart(cur);){var found=merged.find();cur=getLine(doc,found.from.line),len+=found.from.ch-found.to.ch}for(cur=line;merged=collapsedSpanAtEnd(cur);){var found=merged.find();len-=cur.text.length-found.from.ch,cur=getLine(doc,found.to.line),len+=cur.text.length-found.to.ch}return len}function computeMaxLength(cm){var d=cm.display,doc=cm.doc;d.maxLine=getLine(doc,doc.first),d.maxLineLength=lineLength(doc,d.maxLine),d.maxLineChanged=!0,doc.iter(function(line){var len=lineLength(doc,line);len>d.maxLineLength&&(d.maxLineLength=len,d.maxLine=line)})}function setGuttersForLineNumbers(options){var found=indexOf(options.gutters,"CodeMirror-linenumbers");-1==found&&options.lineNumbers?options.gutters=options.gutters.concat(["CodeMirror-linenumbers"]):found>-1&&!options.lineNumbers&&(options.gutters=options.gutters.slice(0),options.gutters.splice(found,1))}function updateScrollbars(cm){var d=cm.display,docHeight=cm.doc.height,totalHeight=docHeight+paddingVert(d);d.sizer.style.minHeight=d.heightForcer.style.top=totalHeight+"px",d.gutters.style.height=Math.max(totalHeight,d.scroller.clientHeight-scrollerCutOff)+"px";var scrollHeight=Math.max(totalHeight,d.scroller.scrollHeight),needsH=d.scroller.scrollWidth>d.scroller.clientWidth+1,needsV=scrollHeight>d.scroller.clientHeight+1;needsV?(d.scrollbarV.style.display="block",d.scrollbarV.style.bottom=needsH?scrollbarWidth(d.measure)+"px":"0",d.scrollbarV.firstChild.style.height=Math.max(0,scrollHeight-d.scroller.clientHeight+d.scrollbarV.clientHeight)+"px"):(d.scrollbarV.style.display="",d.scrollbarV.firstChild.style.height="0"),needsH?(d.scrollbarH.style.display="block",d.scrollbarH.style.right=needsV?scrollbarWidth(d.measure)+"px":"0",d.scrollbarH.firstChild.style.width=d.scroller.scrollWidth-d.scroller.clientWidth+d.scrollbarH.clientWidth+"px"):(d.scrollbarH.style.display="",d.scrollbarH.firstChild.style.width="0"),needsH&&needsV?(d.scrollbarFiller.style.display="block",d.scrollbarFiller.style.height=d.scrollbarFiller.style.width=scrollbarWidth(d.measure)+"px"):d.scrollbarFiller.style.display="",needsH&&cm.options.coverGutterNextToScrollbar&&cm.options.fixedGutter?(d.gutterFiller.style.display="block",d.gutterFiller.style.height=scrollbarWidth(d.measure)+"px",d.gutterFiller.style.width=d.gutters.offsetWidth+"px"):d.gutterFiller.style.display="",mac_geLion&&0===scrollbarWidth(d.measure)&&(d.scrollbarV.style.minWidth=d.scrollbarH.style.minHeight=mac_geMountainLion?"18px":"12px",d.scrollbarV.style.pointerEvents=d.scrollbarH.style.pointerEvents="none")}function visibleLines(display,doc,viewPort){var top=display.scroller.scrollTop,height=display.wrapper.clientHeight;"number"==typeof viewPort?top=viewPort:viewPort&&(top=viewPort.top,height=viewPort.bottom-viewPort.top),top=Math.floor(top-paddingTop(display));var bottom=Math.ceil(top+height);return{from:lineAtHeight(doc,top),to:lineAtHeight(doc,bottom)}}function alignHorizontally(cm){var display=cm.display;if(display.alignWidgets||display.gutters.firstChild&&cm.options.fixedGutter){for(var comp=compensateForHScroll(display)-display.scroller.scrollLeft+cm.doc.scrollLeft,gutterW=display.gutters.offsetWidth,l=comp+"px",n=display.lineDiv.firstChild;n;n=n.nextSibling)if(n.alignable)for(var i=0,a=n.alignable;i<a.length;++i)a[i].style.left=l;cm.options.fixedGutter&&(display.gutters.style.left=comp+gutterW+"px")}}function maybeUpdateLineNumberWidth(cm){if(!cm.options.lineNumbers)return!1;var doc=cm.doc,last=lineNumberFor(cm.options,doc.first+doc.size-1),display=cm.display;if(last.length!=display.lineNumChars){var test=display.measure.appendChild(elt("div",[elt("div",last)],"CodeMirror-linenumber CodeMirror-gutter-elt")),innerW=test.firstChild.offsetWidth,padding=test.offsetWidth-innerW;return display.lineGutter.style.width="",display.lineNumInnerWidth=Math.max(innerW,display.lineGutter.offsetWidth-padding),display.lineNumWidth=display.lineNumInnerWidth+padding,display.lineNumChars=display.lineNumInnerWidth?last.length:-1,display.lineGutter.style.width=display.lineNumWidth+"px",!0}return!1}function lineNumberFor(options,i){return String(options.lineNumberFormatter(i+options.firstLineNumber))}function compensateForHScroll(display){return getRect(display.scroller).left-getRect(display.sizer).left}function updateDisplay(cm,changes,viewPort,forced){for(var updated,oldFrom=cm.display.showingFrom,oldTo=cm.display.showingTo,visible=visibleLines(cm.display,cm.doc,viewPort),first=!0;;first=!1){var oldWidth=cm.display.scroller.clientWidth;if(!updateDisplayInner(cm,changes,visible,forced))break;if(updated=!0,changes=[],updateSelection(cm),updateScrollbars(cm),first&&cm.options.lineWrapping&&oldWidth!=cm.display.scroller.clientWidth)forced=!0;else if(forced=!1,viewPort&&(viewPort=Math.min(cm.display.scroller.scrollHeight-cm.display.scroller.clientHeight,"number"==typeof viewPort?viewPort:viewPort.top)),visible=visibleLines(cm.display,cm.doc,viewPort),visible.from>=cm.display.showingFrom&&visible.to<=cm.display.showingTo)break}return updated&&(signalLater(cm,"update",cm),(cm.display.showingFrom!=oldFrom||cm.display.showingTo!=oldTo)&&signalLater(cm,"viewportChange",cm,cm.display.showingFrom,cm.display.showingTo)),updated}function updateDisplayInner(cm,changes,visible,forced){var display=cm.display,doc=cm.doc;if(!display.wrapper.offsetWidth)return display.showingFrom=display.showingTo=doc.first,display.viewOffset=0,void 0;if(!(!forced&&0==changes.length&&visible.from>display.showingFrom&&visible.to<display.showingTo)){maybeUpdateLineNumberWidth(cm)&&(changes=[{from:doc.first,to:doc.first+doc.size}]);var gutterW=display.sizer.style.marginLeft=display.gutters.offsetWidth+"px";display.scrollbarH.style.left=cm.options.fixedGutter?gutterW:"0";var positionsChangedFrom=1/0;if(cm.options.lineNumbers)for(var i=0;i<changes.length;++i)changes[i].diff&&changes[i].from<positionsChangedFrom&&(positionsChangedFrom=changes[i].from);var end=doc.first+doc.size,from=Math.max(visible.from-cm.options.viewportMargin,doc.first),to=Math.min(end,visible.to+cm.options.viewportMargin);if(display.showingFrom<from&&from-display.showingFrom<20&&(from=Math.max(doc.first,display.showingFrom)),display.showingTo>to&&display.showingTo-to<20&&(to=Math.min(end,display.showingTo)),sawCollapsedSpans)for(from=lineNo(visualLine(doc,getLine(doc,from)));end>to&&lineIsHidden(doc,getLine(doc,to));)++to;var intact=[{from:Math.max(display.showingFrom,doc.first),to:Math.min(display.showingTo,end)}];if(intact=intact[0].from>=intact[0].to?[]:computeIntact(intact,changes),sawCollapsedSpans)for(var i=0;i<intact.length;++i)for(var merged,range=intact[i];merged=collapsedSpanAtEnd(getLine(doc,range.to-1));){var newTo=merged.find().from.line;if(!(newTo>range.from)){intact.splice(i--,1);break}range.to=newTo}for(var intactLines=0,i=0;i<intact.length;++i){var range=intact[i];range.from<from&&(range.from=from),range.to>to&&(range.to=to),range.from>=range.to?intact.splice(i--,1):intactLines+=range.to-range.from}if(!forced&&intactLines==to-from&&from==display.showingFrom&&to==display.showingTo)return updateViewOffset(cm),void 0;intact.sort(function(a,b){return a.from-b.from});try{var focused=document.activeElement}catch(e){}.7*(to-from)>intactLines&&(display.lineDiv.style.display="none"),patchDisplay(cm,from,to,intact,positionsChangedFrom),display.lineDiv.style.display="",focused&&document.activeElement!=focused&&focused.offsetHeight&&focused.focus();var different=from!=display.showingFrom||to!=display.showingTo||display.lastSizeC!=display.wrapper.clientHeight;return different&&(display.lastSizeC=display.wrapper.clientHeight,startWorker(cm,400)),display.showingFrom=from,display.showingTo=to,display.gutters.style.height="",updateHeightsInViewport(cm),updateViewOffset(cm),!0}}function updateHeightsInViewport(cm){for(var height,display=cm.display,prevBottom=display.lineDiv.offsetTop,node=display.lineDiv.firstChild;node;node=node.nextSibling)if(node.lineObj){if(ie_lt8){var bot=node.offsetTop+node.offsetHeight;height=bot-prevBottom,prevBottom=bot}else{var box=getRect(node);height=box.bottom-box.top}var diff=node.lineObj.height-height;if(2>height&&(height=textHeight(display)),diff>.001||-.001>diff){updateLineHeight(node.lineObj,height);var widgets=node.lineObj.widgets;if(widgets)for(var i=0;i<widgets.length;++i)widgets[i].height=widgets[i].node.offsetHeight}}}function updateViewOffset(cm){var off=cm.display.viewOffset=heightAtLine(cm,getLine(cm.doc,cm.display.showingFrom));cm.display.mover.style.top=off+"px"}function computeIntact(intact,changes){for(var i=0,l=changes.length||0;l>i;++i){for(var change=changes[i],intact2=[],diff=change.diff||0,j=0,l2=intact.length;l2>j;++j){var range=intact[j];change.to<=range.from&&change.diff?intact2.push({from:range.from+diff,to:range.to+diff}):change.to<=range.from||change.from>=range.to?intact2.push(range):(change.from>range.from&&intact2.push({from:range.from,to:change.from}),change.to<range.to&&intact2.push({from:change.to+diff,to:range.to+diff}))}intact=intact2}return intact}function getDimensions(cm){for(var d=cm.display,left={},width={},n=d.gutters.firstChild,i=0;n;n=n.nextSibling,++i)left[cm.options.gutters[i]]=n.offsetLeft,width[cm.options.gutters[i]]=n.offsetWidth;return{fixedPos:compensateForHScroll(d),gutterTotalWidth:d.gutters.offsetWidth,gutterLeft:left,gutterWidth:width,wrapperWidth:d.wrapper.clientWidth}}function patchDisplay(cm,from,to,intact,updateNumbersFrom){function rm(node){var next=node.nextSibling;return webkit&&mac&&cm.display.currentWheelTarget==node?(node.style.display="none",node.lineObj=null):node.parentNode.removeChild(node),next}var dims=getDimensions(cm),display=cm.display,lineNumbers=cm.options.lineNumbers;intact.length||webkit&&cm.display.currentWheelTarget||removeChildren(display.lineDiv);var container=display.lineDiv,cur=container.firstChild,nextIntact=intact.shift(),lineN=from;for(cm.doc.iter(from,to,function(line){if(nextIntact&&nextIntact.to==lineN&&(nextIntact=intact.shift()),lineIsHidden(cm.doc,line)){if(0!=line.height&&updateLineHeight(line,0),line.widgets&&cur&&cur.previousSibling)for(var i=0;i<line.widgets.length;++i){var w=line.widgets[i];if(w.showIfHidden){var prev=cur.previousSibling;if(/pre/i.test(prev.nodeName)){var wrap=elt("div",null,null,"position: relative");prev.parentNode.replaceChild(wrap,prev),wrap.appendChild(prev),prev=wrap}var wnode=prev.appendChild(elt("div",[w.node],"CodeMirror-linewidget"));w.handleMouseEvents||(wnode.ignoreEvents=!0),positionLineWidget(w,wnode,prev,dims)}}}else if(nextIntact&&nextIntact.from<=lineN&&nextIntact.to>lineN){for(;cur.lineObj!=line;)cur=rm(cur);lineNumbers&&lineN>=updateNumbersFrom&&cur.lineNumber&&setTextContent(cur.lineNumber,lineNumberFor(cm.options,lineN)),cur=cur.nextSibling}else{if(line.widgets)for(var reuse,j=0,search=cur;search&&20>j;++j,search=search.nextSibling)if(search.lineObj==line&&/div/i.test(search.nodeName)){reuse=search;break}var lineNode=buildLineElement(cm,line,lineN,dims,reuse);if(lineNode!=reuse)container.insertBefore(lineNode,cur);else{for(;cur!=reuse;)cur=rm(cur);cur=cur.nextSibling}lineNode.lineObj=line}++lineN});cur;)cur=rm(cur)}function buildLineElement(cm,line,lineNo,dims,reuse){var wrap,built=buildLineContent(cm,line),lineElement=built.pre,markers=line.gutterMarkers,display=cm.display,bgClass=built.bgClass?built.bgClass+" "+(line.bgClass||""):line.bgClass;if(!(cm.options.lineNumbers||markers||bgClass||line.wrapClass||line.widgets))return lineElement;if(reuse){reuse.alignable=null;for(var next,isOk=!0,widgetsSeen=0,insertBefore=null,n=reuse.firstChild;n;n=next)if(next=n.nextSibling,/\bCodeMirror-linewidget\b/.test(n.className)){for(var i=0;i<line.widgets.length;++i){var widget=line.widgets[i];if(widget.node==n.firstChild){widget.above||insertBefore||(insertBefore=n),positionLineWidget(widget,n,reuse,dims),++widgetsSeen;break}}if(i==line.widgets.length){isOk=!1;break}}else reuse.removeChild(n);reuse.insertBefore(lineElement,insertBefore),isOk&&widgetsSeen==line.widgets.length&&(wrap=reuse,reuse.className=line.wrapClass||"")}if(wrap||(wrap=elt("div",null,line.wrapClass,"position: relative"),wrap.appendChild(lineElement)),bgClass&&wrap.insertBefore(elt("div",null,bgClass+" CodeMirror-linebackground"),wrap.firstChild),cm.options.lineNumbers||markers){var gutterWrap=wrap.insertBefore(elt("div",null,"CodeMirror-gutter-wrapper","position: absolute; left: "+(cm.options.fixedGutter?dims.fixedPos:-dims.gutterTotalWidth)+"px"),lineElement);if(cm.options.fixedGutter&&(wrap.alignable||(wrap.alignable=[])).push(gutterWrap),!cm.options.lineNumbers||markers&&markers["CodeMirror-linenumbers"]||(wrap.lineNumber=gutterWrap.appendChild(elt("div",lineNumberFor(cm.options,lineNo),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+dims.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+display.lineNumInnerWidth+"px"))),markers)for(var k=0;k<cm.options.gutters.length;++k){var id=cm.options.gutters[k],found=markers.hasOwnProperty(id)&&markers[id];found&&gutterWrap.appendChild(elt("div",[found],"CodeMirror-gutter-elt","left: "+dims.gutterLeft[id]+"px; width: "+dims.gutterWidth[id]+"px"))}}if(ie_lt8&&(wrap.style.zIndex=2),line.widgets&&wrap!=reuse)for(var i=0,ws=line.widgets;i<ws.length;++i){var widget=ws[i],node=elt("div",[widget.node],"CodeMirror-linewidget");widget.handleMouseEvents||(node.ignoreEvents=!0),positionLineWidget(widget,node,wrap,dims),widget.above?wrap.insertBefore(node,cm.options.lineNumbers&&0!=line.height?gutterWrap:lineElement):wrap.appendChild(node),signalLater(widget,"redraw")}return wrap}function positionLineWidget(widget,node,wrap,dims){if(widget.noHScroll){(wrap.alignable||(wrap.alignable=[])).push(node);var width=dims.wrapperWidth;node.style.left=dims.fixedPos+"px",widget.coverGutter||(width-=dims.gutterTotalWidth,node.style.paddingLeft=dims.gutterTotalWidth+"px"),node.style.width=width+"px"}widget.coverGutter&&(node.style.zIndex=5,node.style.position="relative",widget.noHScroll||(node.style.marginLeft=-dims.gutterTotalWidth+"px"))}function updateSelection(cm){var display=cm.display,collapsed=posEq(cm.doc.sel.from,cm.doc.sel.to);if(collapsed||cm.options.showCursorWhenSelecting?updateSelectionCursor(cm):display.cursor.style.display=display.otherCursor.style.display="none",collapsed?display.selectionDiv.style.display="none":updateSelectionRange(cm),cm.options.moveInputWithCursor){var headPos=cursorCoords(cm,cm.doc.sel.head,"div"),wrapOff=getRect(display.wrapper),lineOff=getRect(display.lineDiv);display.inputDiv.style.top=Math.max(0,Math.min(display.wrapper.clientHeight-10,headPos.top+lineOff.top-wrapOff.top))+"px",display.inputDiv.style.left=Math.max(0,Math.min(display.wrapper.clientWidth-10,headPos.left+lineOff.left-wrapOff.left))+"px"}}function updateSelectionCursor(cm){var display=cm.display,pos=cursorCoords(cm,cm.doc.sel.head,"div");display.cursor.style.left=pos.left+"px",display.cursor.style.top=pos.top+"px",display.cursor.style.height=Math.max(0,pos.bottom-pos.top)*cm.options.cursorHeight+"px",display.cursor.style.display="",pos.other?(display.otherCursor.style.display="",display.otherCursor.style.left=pos.other.left+"px",display.otherCursor.style.top=pos.other.top+"px",display.otherCursor.style.height=.85*(pos.other.bottom-pos.other.top)+"px"):display.otherCursor.style.display="none"}function updateSelectionRange(cm){function add(left,top,width,bottom){0>top&&(top=0),fragment.appendChild(elt("div",null,"CodeMirror-selected","position: absolute; left: "+left+"px; top: "+top+"px; width: "+(null==width?rightSide-left:width)+"px; height: "+(bottom-top)+"px"))}function drawForLine(line,fromArg,toArg){function coords(ch,bias){return charCoords(cm,Pos(line,ch),"div",lineObj,bias)}var start,end,lineObj=getLine(doc,line),lineLen=lineObj.text.length;return iterateBidiSections(getOrder(lineObj),fromArg||0,null==toArg?lineLen:toArg,function(from,to,dir){var rightPos,left,right,leftPos=coords(from,"left");if(from==to)rightPos=leftPos,left=right=leftPos.left;else{if(rightPos=coords(to-1,"right"),"rtl"==dir){var tmp=leftPos;leftPos=rightPos,rightPos=tmp}left=leftPos.left,right=rightPos.right}null==fromArg&&0==from&&(left=leftSide),rightPos.top-leftPos.top>3&&(add(left,leftPos.top,null,leftPos.bottom),left=leftSide,leftPos.bottom<rightPos.top&&add(left,leftPos.bottom,null,rightPos.top)),null==toArg&&to==lineLen&&(right=rightSide),(!start||leftPos.top<start.top||leftPos.top==start.top&&leftPos.left<start.left)&&(start=leftPos),(!end||rightPos.bottom>end.bottom||rightPos.bottom==end.bottom&&rightPos.right>end.right)&&(end=rightPos),leftSide+1>left&&(left=leftSide),add(left,rightPos.top,right-left,rightPos.bottom)}),{start:start,end:end}}var display=cm.display,doc=cm.doc,sel=cm.doc.sel,fragment=document.createDocumentFragment(),padding=paddingH(cm.display),leftSide=padding.left,rightSide=display.lineSpace.offsetWidth-padding.right;if(sel.from.line==sel.to.line)drawForLine(sel.from.line,sel.from.ch,sel.to.ch);else{var fromLine=getLine(doc,sel.from.line),toLine=getLine(doc,sel.to.line),singleVLine=visualLine(doc,fromLine)==visualLine(doc,toLine),leftEnd=drawForLine(sel.from.line,sel.from.ch,singleVLine?fromLine.text.length:null).end,rightStart=drawForLine(sel.to.line,singleVLine?0:null,sel.to.ch).start;singleVLine&&(leftEnd.top<rightStart.top-2?(add(leftEnd.right,leftEnd.top,null,leftEnd.bottom),add(leftSide,rightStart.top,rightStart.left,rightStart.bottom)):add(leftEnd.right,leftEnd.top,rightStart.left-leftEnd.right,leftEnd.bottom)),leftEnd.bottom<rightStart.top&&add(leftSide,leftEnd.bottom,null,rightStart.top)}removeChildrenAndAdd(display.selectionDiv,fragment),display.selectionDiv.style.display=""}function restartBlink(cm){if(cm.state.focused){var display=cm.display;clearInterval(display.blinker);var on=!0;display.cursor.style.visibility=display.otherCursor.style.visibility="",cm.options.cursorBlinkRate>0&&(display.blinker=setInterval(function(){display.cursor.style.visibility=display.otherCursor.style.visibility=(on=!on)?"":"hidden"},cm.options.cursorBlinkRate))}}function startWorker(cm,time){cm.doc.mode.startState&&cm.doc.frontier<cm.display.showingTo&&cm.state.highlight.set(time,bind(highlightWorker,cm))}function highlightWorker(cm){var doc=cm.doc;if(doc.frontier<doc.first&&(doc.frontier=doc.first),!(doc.frontier>=cm.display.showingTo)){var prevChange,end=+new Date+cm.options.workTime,state=copyState(doc.mode,getStateBefore(cm,doc.frontier)),changed=[];doc.iter(doc.frontier,Math.min(doc.first+doc.size,cm.display.showingTo+500),function(line){if(doc.frontier>=cm.display.showingFrom){var oldStyles=line.styles;line.styles=highlightLine(cm,line,state,!0);for(var ischange=!oldStyles||oldStyles.length!=line.styles.length,i=0;!ischange&&i<oldStyles.length;++i)ischange=oldStyles[i]!=line.styles[i];ischange&&(prevChange&&prevChange.end==doc.frontier?prevChange.end++:changed.push(prevChange={start:doc.frontier,end:doc.frontier+1})),line.stateAfter=copyState(doc.mode,state)}else processLine(cm,line.text,state),line.stateAfter=doc.frontier%5==0?copyState(doc.mode,state):null;return++doc.frontier,+new Date>end?(startWorker(cm,cm.options.workDelay),!0):void 0}),changed.length&&operation(cm,function(){for(var i=0;i<changed.length;++i)regChange(this,changed[i].start,changed[i].end)})()}}function findStartLine(cm,n,precise){for(var minindent,minline,doc=cm.doc,lim=precise?-1:n-(cm.doc.mode.innerMode?1e3:100),search=n;search>lim;--search){if(search<=doc.first)return doc.first;var line=getLine(doc,search-1);if(line.stateAfter&&(!precise||search<=doc.frontier))return search;var indented=countColumn(line.text,null,cm.options.tabSize);(null==minline||minindent>indented)&&(minline=search-1,minindent=indented)}return minline}function getStateBefore(cm,n,precise){var doc=cm.doc,display=cm.display;if(!doc.mode.startState)return!0;var pos=findStartLine(cm,n,precise),state=pos>doc.first&&getLine(doc,pos-1).stateAfter;return state=state?copyState(doc.mode,state):startState(doc.mode),doc.iter(pos,n,function(line){processLine(cm,line.text,state);var save=pos==n-1||pos%5==0||pos>=display.showingFrom&&pos<display.showingTo;line.stateAfter=save?copyState(doc.mode,state):null,++pos}),precise&&(doc.frontier=pos),state}function paddingTop(display){return display.lineSpace.offsetTop}function paddingVert(display){return display.mover.offsetHeight-display.lineSpace.offsetHeight}function paddingH(display){if(display.cachedPaddingH)return display.cachedPaddingH;var e=removeChildrenAndAdd(display.measure,elt("pre","x")),style=window.getComputedStyle?window.getComputedStyle(e):e.currentStyle;return display.cachedPaddingH={left:parseInt(style.paddingLeft),right:parseInt(style.paddingRight)}}function measureChar(cm,line,ch,data,bias){var dir=-1;if(data=data||measureLine(cm,line),data.crude){var left=data.left+ch*data.width;return{left:left,right:left+data.width,top:data.top,bottom:data.bottom}}for(var pos=ch;;pos+=dir){var r=data[pos];if(r)break;0>dir&&0==pos&&(dir=1)}return bias=pos>ch?"left":ch>pos?"right":bias,"left"==bias&&r.leftSide?r=r.leftSide:"right"==bias&&r.rightSide&&(r=r.rightSide),{left:ch>pos?r.right:r.left,right:pos>ch?r.left:r.right,top:r.top,bottom:r.bottom}}function findCachedMeasurement(cm,line){for(var cache=cm.display.measureLineCache,i=0;i<cache.length;++i){var memo=cache[i];if(memo.text==line.text&&memo.markedSpans==line.markedSpans&&cm.display.scroller.clientWidth==memo.width&&memo.classes==line.textClass+"|"+line.wrapClass)return memo}}function clearCachedMeasurement(cm,line){var exists=findCachedMeasurement(cm,line);exists&&(exists.text=exists.measure=exists.markedSpans=null)}function measureLine(cm,line){var cached=findCachedMeasurement(cm,line);if(cached)return cached.measure;var measure=measureLineInner(cm,line),cache=cm.display.measureLineCache,memo={text:line.text,width:cm.display.scroller.clientWidth,markedSpans:line.markedSpans,measure:measure,classes:line.textClass+"|"+line.wrapClass};return 16==cache.length?cache[++cm.display.measureLineCachePos%16]=memo:cache.push(memo),measure}function measureLineInner(cm,line){function measureRect(rect){var top=rect.top-outer.top,bot=rect.bottom-outer.top;bot>maxBot&&(bot=maxBot),0>top&&(top=0);for(var i=vranges.length-2;i>=0;i-=2){var rtop=vranges[i],rbot=vranges[i+1];if(!(rtop>bot||top>rbot)&&(top>=rtop&&rbot>=bot||rtop>=top&&bot>=rbot||Math.min(bot,rbot)-Math.max(top,rtop)>=bot-top>>1)){vranges[i]=Math.min(top,rtop),vranges[i+1]=Math.max(bot,rbot);break}}return 0>i&&(i=vranges.length,vranges.push(top,bot)),{left:rect.left-outer.left,right:rect.right-outer.left,top:i,bottom:null}}function finishRect(rect){rect.bottom=vranges[rect.top+1],rect.top=vranges[rect.top]}if(!cm.options.lineWrapping&&line.text.length>=cm.options.crudeMeasuringFrom)return crudelyMeasureLine(cm,line);var display=cm.display,measure=emptyArray(line.text.length),pre=buildLineContent(cm,line,measure,!0).pre;if(old_ie&&!ie_lt8&&!cm.options.lineWrapping&&pre.childNodes.length>100){for(var fragment=document.createDocumentFragment(),chunk=10,n=pre.childNodes.length,i=0,chunks=Math.ceil(n/chunk);chunks>i;++i){for(var wrap=elt("div",null,null,"display: inline-block"),j=0;chunk>j&&n;++j)wrap.appendChild(pre.firstChild),--n;fragment.appendChild(wrap)}pre.appendChild(fragment)}removeChildrenAndAdd(display.measure,pre);var outer=getRect(display.lineDiv),vranges=[],data=emptyArray(line.text.length),maxBot=pre.offsetHeight;ie_lt9&&display.measure.first!=pre&&removeChildrenAndAdd(display.measure,pre);for(var cur,i=0;i<measure.length;++i)if(cur=measure[i]){var node=cur,rect=null;if(/\bCodeMirror-widget\b/.test(cur.className)&&cur.getClientRects){1==cur.firstChild.nodeType&&(node=cur.firstChild);var rects=node.getClientRects();rects.length>1&&(rect=data[i]=measureRect(rects[0]),rect.rightSide=measureRect(rects[rects.length-1]))}rect||(rect=data[i]=measureRect(getRect(node))),cur.measureRight&&(rect.right=getRect(cur.measureRight).left-outer.left),cur.leftSide&&(rect.leftSide=measureRect(getRect(cur.leftSide)))}removeChildren(cm.display.measure);for(var cur,i=0;i<data.length;++i)(cur=data[i])&&(finishRect(cur),cur.leftSide&&finishRect(cur.leftSide),cur.rightSide&&finishRect(cur.rightSide));return data}function crudelyMeasureLine(cm,line){var copy=new Line(line.text.slice(0,100),null);
line.textClass&&(copy.textClass=line.textClass);var measure=measureLineInner(cm,copy),left=measureChar(cm,copy,0,measure,"left"),right=measureChar(cm,copy,99,measure,"right");return{crude:!0,top:left.top,left:left.left,bottom:left.bottom,width:(right.right-left.left)/100}}function measureLineWidth(cm,line){var hasBadSpan=!1;if(line.markedSpans)for(var i=0;i<line.markedSpans;++i){var sp=line.markedSpans[i];!sp.collapsed||null!=sp.to&&sp.to!=line.text.length||(hasBadSpan=!0)}var cached=!hasBadSpan&&findCachedMeasurement(cm,line);if(cached||line.text.length>=cm.options.crudeMeasuringFrom)return measureChar(cm,line,line.text.length,cached&&cached.measure,"right").right;var pre=buildLineContent(cm,line,null,!0).pre,end=pre.appendChild(zeroWidthElement(cm.display.measure));return removeChildrenAndAdd(cm.display.measure,pre),getRect(end).right-getRect(cm.display.lineDiv).left}function clearCaches(cm){cm.display.measureLineCache.length=cm.display.measureLineCachePos=0,cm.display.cachedCharWidth=cm.display.cachedTextHeight=cm.display.cachedPaddingH=null,cm.options.lineWrapping||(cm.display.maxLineChanged=!0),cm.display.lineNumChars=null}function pageScrollX(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function pageScrollY(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function intoCoordSystem(cm,lineObj,rect,context){if(lineObj.widgets)for(var i=0;i<lineObj.widgets.length;++i)if(lineObj.widgets[i].above){var size=widgetHeight(lineObj.widgets[i]);rect.top+=size,rect.bottom+=size}if("line"==context)return rect;context||(context="local");var yOff=heightAtLine(cm,lineObj);if("local"==context?yOff+=paddingTop(cm.display):yOff-=cm.display.viewOffset,"page"==context||"window"==context){var lOff=getRect(cm.display.lineSpace);yOff+=lOff.top+("window"==context?0:pageScrollY());var xOff=lOff.left+("window"==context?0:pageScrollX());rect.left+=xOff,rect.right+=xOff}return rect.top+=yOff,rect.bottom+=yOff,rect}function fromCoordSystem(cm,coords,context){if("div"==context)return coords;var left=coords.left,top=coords.top;if("page"==context)left-=pageScrollX(),top-=pageScrollY();else if("local"==context||!context){var localBox=getRect(cm.display.sizer);left+=localBox.left,top+=localBox.top}var lineSpaceBox=getRect(cm.display.lineSpace);return{left:left-lineSpaceBox.left,top:top-lineSpaceBox.top}}function charCoords(cm,pos,context,lineObj,bias){return lineObj||(lineObj=getLine(cm.doc,pos.line)),intoCoordSystem(cm,lineObj,measureChar(cm,lineObj,pos.ch,null,bias),context)}function cursorCoords(cm,pos,context,lineObj,measurement){function get(ch,right){var m=measureChar(cm,lineObj,ch,measurement,right?"right":"left");return right?m.left=m.right:m.right=m.left,intoCoordSystem(cm,lineObj,m,context)}function getBidi(ch,partPos){var part=order[partPos],right=part.level%2;return ch==bidiLeft(part)&&partPos&&part.level<order[partPos-1].level?(part=order[--partPos],ch=bidiRight(part)-(part.level%2?0:1),right=!0):ch==bidiRight(part)&&partPos<order.length-1&&part.level<order[partPos+1].level&&(part=order[++partPos],ch=bidiLeft(part)-part.level%2,right=!1),right&&ch==part.to&&ch>part.from?get(ch-1):get(ch,right)}lineObj=lineObj||getLine(cm.doc,pos.line),measurement||(measurement=measureLine(cm,lineObj));var order=getOrder(lineObj),ch=pos.ch;if(!order)return get(ch);var partPos=getBidiPartAt(order,ch),val=getBidi(ch,partPos);return null!=bidiOther&&(val.other=getBidi(ch,bidiOther)),val}function PosWithInfo(line,ch,outside,xRel){var pos=new Pos(line,ch);return pos.xRel=xRel,outside&&(pos.outside=!0),pos}function coordsChar(cm,x,y){var doc=cm.doc;if(y+=cm.display.viewOffset,0>y)return PosWithInfo(doc.first,0,!0,-1);var lineNo=lineAtHeight(doc,y),last=doc.first+doc.size-1;if(lineNo>last)return PosWithInfo(doc.first+doc.size-1,getLine(doc,last).text.length,!0,1);for(0>x&&(x=0);;){var lineObj=getLine(doc,lineNo),found=coordsCharInner(cm,lineObj,lineNo,x,y),merged=collapsedSpanAtEnd(lineObj),mergedPos=merged&&merged.find();if(!merged||!(found.ch>mergedPos.from.ch||found.ch==mergedPos.from.ch&&found.xRel>0))return found;lineNo=mergedPos.to.line}}function coordsCharInner(cm,lineObj,lineNo,x,y){function getX(ch){var sp=cursorCoords(cm,Pos(lineNo,ch),"line",lineObj,measurement);return wrongLine=!0,innerOff>sp.bottom?sp.left-adjust:innerOff<sp.top?sp.left+adjust:(wrongLine=!1,sp.left)}var innerOff=y-heightAtLine(cm,lineObj),wrongLine=!1,adjust=2*cm.display.wrapper.clientWidth,measurement=measureLine(cm,lineObj),bidi=getOrder(lineObj),dist=lineObj.text.length,from=lineLeft(lineObj),to=lineRight(lineObj),fromX=getX(from),fromOutside=wrongLine,toX=getX(to),toOutside=wrongLine;if(x>toX)return PosWithInfo(lineNo,to,toOutside,1);for(;;){if(bidi?to==from||to==moveVisually(lineObj,from,1):1>=to-from){for(var ch=fromX>x||toX-x>=x-fromX?from:to,xDiff=x-(ch==from?fromX:toX);isExtendingChar(lineObj.text.charAt(ch));)++ch;var pos=PosWithInfo(lineNo,ch,ch==from?fromOutside:toOutside,0>xDiff?-1:xDiff?1:0);return pos}var step=Math.ceil(dist/2),middle=from+step;if(bidi){middle=from;for(var i=0;step>i;++i)middle=moveVisually(lineObj,middle,1)}var middleX=getX(middle);middleX>x?(to=middle,toX=middleX,(toOutside=wrongLine)&&(toX+=1e3),dist=step):(from=middle,fromX=middleX,fromOutside=wrongLine,dist-=step)}}function textHeight(display){if(null!=display.cachedTextHeight)return display.cachedTextHeight;if(null==measureText){measureText=elt("pre");for(var i=0;49>i;++i)measureText.appendChild(document.createTextNode("x")),measureText.appendChild(elt("br"));measureText.appendChild(document.createTextNode("x"))}removeChildrenAndAdd(display.measure,measureText);var height=measureText.offsetHeight/50;return height>3&&(display.cachedTextHeight=height),removeChildren(display.measure),height||1}function charWidth(display){if(null!=display.cachedCharWidth)return display.cachedCharWidth;var anchor=elt("span","x"),pre=elt("pre",[anchor]);removeChildrenAndAdd(display.measure,pre);var width=anchor.offsetWidth;return width>2&&(display.cachedCharWidth=width),width||10}function startOperation(cm){cm.curOp={changes:[],forceUpdate:!1,updateInput:null,userSelChange:null,textChanged:null,selectionChanged:!1,cursorActivity:!1,updateMaxLine:!1,updateScrollPos:!1,id:++nextOpId},delayedCallbackDepth++||(delayedCallbacks=[])}function endOperation(cm){var op=cm.curOp,doc=cm.doc,display=cm.display;if(cm.curOp=null,op.updateMaxLine&&computeMaxLength(cm),display.maxLineChanged&&!cm.options.lineWrapping&&display.maxLine){var width=measureLineWidth(cm,display.maxLine);display.sizer.style.minWidth=Math.max(0,width+3)+"px",display.maxLineChanged=!1;var maxScrollLeft=Math.max(0,display.sizer.offsetLeft+display.sizer.offsetWidth-display.scroller.clientWidth);maxScrollLeft<doc.scrollLeft&&!op.updateScrollPos&&setScrollLeft(cm,Math.min(display.scroller.scrollLeft,maxScrollLeft),!0)}var newScrollPos,updated;if(op.updateScrollPos)newScrollPos=op.updateScrollPos;else if(op.selectionChanged&&display.scroller.clientHeight){var coords=cursorCoords(cm,doc.sel.head);newScrollPos=calculateScrollPos(cm,coords.left,coords.top,coords.left,coords.bottom)}if((op.changes.length||op.forceUpdate||newScrollPos&&null!=newScrollPos.scrollTop)&&(updated=updateDisplay(cm,op.changes,newScrollPos&&newScrollPos.scrollTop,op.forceUpdate),cm.display.scroller.offsetHeight&&(cm.doc.scrollTop=cm.display.scroller.scrollTop)),!updated&&op.selectionChanged&&updateSelection(cm),op.updateScrollPos){var top=Math.max(0,Math.min(display.scroller.scrollHeight-display.scroller.clientHeight,newScrollPos.scrollTop)),left=Math.max(0,Math.min(display.scroller.scrollWidth-display.scroller.clientWidth,newScrollPos.scrollLeft));display.scroller.scrollTop=display.scrollbarV.scrollTop=doc.scrollTop=top,display.scroller.scrollLeft=display.scrollbarH.scrollLeft=doc.scrollLeft=left,alignHorizontally(cm),op.scrollToPos&&scrollPosIntoView(cm,clipPos(cm.doc,op.scrollToPos.from),clipPos(cm.doc,op.scrollToPos.to),op.scrollToPos.margin)}else newScrollPos&&scrollCursorIntoView(cm);op.selectionChanged&&restartBlink(cm),cm.state.focused&&op.updateInput&&resetInput(cm,op.userSelChange);var hidden=op.maybeHiddenMarkers,unhidden=op.maybeUnhiddenMarkers;if(hidden)for(var i=0;i<hidden.length;++i)hidden[i].lines.length||signal(hidden[i],"hide");if(unhidden)for(var i=0;i<unhidden.length;++i)unhidden[i].lines.length&&signal(unhidden[i],"unhide");var delayed;if(--delayedCallbackDepth||(delayed=delayedCallbacks,delayedCallbacks=null),op.textChanged&&signal(cm,"change",cm,op.textChanged),op.cursorActivity&&signal(cm,"cursorActivity",cm),delayed)for(var i=0;i<delayed.length;++i)delayed[i]()}function operation(cm1,f){return function(){var cm=cm1||this,withOp=!cm.curOp;withOp&&startOperation(cm);try{var result=f.apply(cm,arguments)}finally{withOp&&endOperation(cm)}return result}}function docOperation(f){return function(){var result,withOp=this.cm&&!this.cm.curOp;withOp&&startOperation(this.cm);try{result=f.apply(this,arguments)}finally{withOp&&endOperation(this.cm)}return result}}function runInOp(cm,f){var result,withOp=!cm.curOp;withOp&&startOperation(cm);try{result=f()}finally{withOp&&endOperation(cm)}return result}function regChange(cm,from,to,lendiff){null==from&&(from=cm.doc.first),null==to&&(to=cm.doc.first+cm.doc.size),cm.curOp.changes.push({from:from,to:to,diff:lendiff})}function slowPoll(cm){cm.display.pollingFast||cm.display.poll.set(cm.options.pollInterval,function(){readInput(cm),cm.state.focused&&slowPoll(cm)})}function fastPoll(cm){function p(){var changed=readInput(cm);changed||missed?(cm.display.pollingFast=!1,slowPoll(cm)):(missed=!0,cm.display.poll.set(60,p))}var missed=!1;cm.display.pollingFast=!0,cm.display.poll.set(20,p)}function readInput(cm){var input=cm.display.input,prevInput=cm.display.prevInput,doc=cm.doc,sel=doc.sel;if(!cm.state.focused||hasSelection(input)||isReadOnly(cm)||cm.options.disableInput)return!1;cm.state.pasteIncoming&&cm.state.fakedLastChar&&(input.value=input.value.substring(0,input.value.length-1),cm.state.fakedLastChar=!1);var text=input.value;if(text==prevInput&&posEq(sel.from,sel.to))return!1;if(ie&&!ie_lt9&&cm.display.inputHasSelection===text)return resetInput(cm,!0),!1;var withOp=!cm.curOp;withOp&&startOperation(cm),sel.shift=!1;for(var same=0,l=Math.min(prevInput.length,text.length);l>same&&prevInput.charCodeAt(same)==text.charCodeAt(same);)++same;var from=sel.from,to=sel.to,inserted=text.slice(same);same<prevInput.length?from=Pos(from.line,from.ch-(prevInput.length-same)):cm.state.overwrite&&posEq(from,to)&&!cm.state.pasteIncoming&&(to=Pos(to.line,Math.min(getLine(doc,to.line).text.length,to.ch+inserted.length)));var updateInput=cm.curOp.updateInput,changeEvent={from:from,to:to,text:splitLines(inserted),origin:cm.state.pasteIncoming?"paste":cm.state.cutIncoming?"cut":"+input"};if(makeChange(cm.doc,changeEvent,"end"),cm.curOp.updateInput=updateInput,signalLater(cm,"inputRead",cm,changeEvent),inserted&&!cm.state.pasteIncoming&&cm.options.electricChars&&cm.options.smartIndent&&sel.head.ch<100){var electric=cm.getModeAt(sel.head).electricChars;if(electric)for(var i=0;i<electric.length;i++)if(inserted.indexOf(electric.charAt(i))>-1){indentLine(cm,sel.head.line,"smart");break}}return text.length>1e3||text.indexOf("\n")>-1?input.value=cm.display.prevInput="":cm.display.prevInput=text,withOp&&endOperation(cm),cm.state.pasteIncoming=cm.state.cutIncoming=!1,!0}function resetInput(cm,user){var minimal,selected,doc=cm.doc;if(posEq(doc.sel.from,doc.sel.to))user&&(cm.display.prevInput=cm.display.input.value="",ie&&!ie_lt9&&(cm.display.inputHasSelection=null));else{cm.display.prevInput="",minimal=hasCopyEvent&&(doc.sel.to.line-doc.sel.from.line>100||(selected=cm.getSelection()).length>1e3);var content=minimal?"-":selected||cm.getSelection();cm.display.input.value=content,cm.state.focused&&selectInput(cm.display.input),ie&&!ie_lt9&&(cm.display.inputHasSelection=content)}cm.display.inaccurateSelection=minimal}function focusInput(cm){"nocursor"==cm.options.readOnly||mobile&&document.activeElement==cm.display.input||cm.display.input.focus()}function ensureFocus(cm){cm.state.focused||(focusInput(cm),onFocus(cm))}function isReadOnly(cm){return cm.options.readOnly||cm.doc.cantEdit}function registerEventHandlers(cm){function reFocus(){cm.state.focused&&setTimeout(bind(focusInput,cm),0)}function onResize(){null==resizeTimer&&(resizeTimer=setTimeout(function(){resizeTimer=null,d.cachedCharWidth=d.cachedTextHeight=d.cachedPaddingH=knownScrollbarWidth=null,clearCaches(cm),runInOp(cm,bind(regChange,cm))},100))}function unregister(){for(var p=d.wrapper.parentNode;p&&p!=document.body;p=p.parentNode);p?setTimeout(unregister,5e3):off(window,"resize",onResize)}function drag_(e){signalDOMEvent(cm,e)||cm.options.onDragEvent&&cm.options.onDragEvent(cm,addStop(e))||e_stop(e)}function prepareCopy(e){d.inaccurateSelection&&(d.prevInput="",d.inaccurateSelection=!1,d.input.value=cm.getSelection(),selectInput(d.input)),"cut"==e.type&&(cm.state.cutIncoming=!0)}var d=cm.display;on(d.scroller,"mousedown",operation(cm,onMouseDown)),old_ie?on(d.scroller,"dblclick",operation(cm,function(e){if(!signalDOMEvent(cm,e)){var pos=posFromMouse(cm,e);if(pos&&!clickInGutter(cm,e)&&!eventInWidget(cm.display,e)){e_preventDefault(e);var word=findWordAt(getLine(cm.doc,pos.line).text,pos);extendSelection(cm.doc,word.from,word.to)}}})):on(d.scroller,"dblclick",function(e){signalDOMEvent(cm,e)||e_preventDefault(e)}),on(d.lineSpace,"selectstart",function(e){eventInWidget(d,e)||e_preventDefault(e)}),captureMiddleClick||on(d.scroller,"contextmenu",function(e){onContextMenu(cm,e)}),on(d.scroller,"scroll",function(){d.scroller.clientHeight&&(setScrollTop(cm,d.scroller.scrollTop),setScrollLeft(cm,d.scroller.scrollLeft,!0),signal(cm,"scroll",cm))}),on(d.scrollbarV,"scroll",function(){d.scroller.clientHeight&&setScrollTop(cm,d.scrollbarV.scrollTop)}),on(d.scrollbarH,"scroll",function(){d.scroller.clientHeight&&setScrollLeft(cm,d.scrollbarH.scrollLeft)}),on(d.scroller,"mousewheel",function(e){onScrollWheel(cm,e)}),on(d.scroller,"DOMMouseScroll",function(e){onScrollWheel(cm,e)}),on(d.scrollbarH,"mousedown",reFocus),on(d.scrollbarV,"mousedown",reFocus),on(d.wrapper,"scroll",function(){d.wrapper.scrollTop=d.wrapper.scrollLeft=0});var resizeTimer;on(window,"resize",onResize),setTimeout(unregister,5e3),on(d.input,"keyup",operation(cm,onKeyUp)),on(d.input,"input",function(){ie&&!ie_lt9&&cm.display.inputHasSelection&&(cm.display.inputHasSelection=null),fastPoll(cm)}),on(d.input,"keydown",operation(cm,onKeyDown)),on(d.input,"keypress",operation(cm,onKeyPress)),on(d.input,"focus",bind(onFocus,cm)),on(d.input,"blur",bind(onBlur,cm)),cm.options.dragDrop&&(on(d.scroller,"dragstart",function(e){onDragStart(cm,e)}),on(d.scroller,"dragenter",drag_),on(d.scroller,"dragover",drag_),on(d.scroller,"drop",operation(cm,onDrop))),on(d.scroller,"paste",function(e){eventInWidget(d,e)||(focusInput(cm),fastPoll(cm))}),on(d.input,"paste",function(){if(webkit&&!cm.state.fakedLastChar&&!(new Date-cm.state.lastMiddleDown<200)){var start=d.input.selectionStart,end=d.input.selectionEnd;d.input.value+="$",d.input.selectionStart=start,d.input.selectionEnd=end,cm.state.fakedLastChar=!0}cm.state.pasteIncoming=!0,fastPoll(cm)}),on(d.input,"cut",prepareCopy),on(d.input,"copy",prepareCopy),khtml&&on(d.sizer,"mouseup",function(){document.activeElement==d.input&&d.input.blur(),focusInput(cm)})}function eventInWidget(display,e){for(var n=e_target(e);n!=display.wrapper;n=n.parentNode)if(!n||n.ignoreEvents||n.parentNode==display.sizer&&n!=display.mover)return!0}function posFromMouse(cm,e,liberal){var display=cm.display;if(!liberal){var target=e_target(e);if(target==display.scrollbarH||target==display.scrollbarH.firstChild||target==display.scrollbarV||target==display.scrollbarV.firstChild||target==display.scrollbarFiller||target==display.gutterFiller)return null}var x,y,space=getRect(display.lineSpace);try{x=e.clientX,y=e.clientY}catch(e){return null}return coordsChar(cm,x-space.left,y-space.top)}function onMouseDown(e){function doSelect(cur){if(!posEq(lastPos,cur)){if(lastPos=cur,"single"==type)return extendSelection(cm.doc,clipPos(doc,start),cur),void 0;if(startstart=clipPos(doc,startstart),startend=clipPos(doc,startend),"double"==type){var word=findWordAt(getLine(doc,cur.line).text,cur);posLess(cur,startstart)?extendSelection(cm.doc,word.from,startend):extendSelection(cm.doc,startstart,word.to)}else"triple"==type&&(posLess(cur,startstart)?extendSelection(cm.doc,startend,clipPos(doc,Pos(cur.line,0))):extendSelection(cm.doc,startstart,clipPos(doc,Pos(cur.line+1,0))))}}function extend(e){var curCount=++counter,cur=posFromMouse(cm,e,!0);if(cur)if(posEq(cur,last)){var outside=e.clientY<editorSize.top?-20:e.clientY>editorSize.bottom?20:0;outside&&setTimeout(operation(cm,function(){counter==curCount&&(display.scroller.scrollTop+=outside,extend(e))}),50)}else{ensureFocus(cm),last=cur,doSelect(cur);var visible=visibleLines(display,doc);(cur.line>=visible.to||cur.line<visible.from)&&setTimeout(operation(cm,function(){counter==curCount&&extend(e)}),150)}}function done(e){counter=1/0,e_preventDefault(e),focusInput(cm),off(document,"mousemove",move),off(document,"mouseup",up)}if(!signalDOMEvent(this,e)){var cm=this,display=cm.display,doc=cm.doc,sel=doc.sel;if(sel.shift=e.shiftKey,eventInWidget(display,e))return webkit||(display.scroller.draggable=!1,setTimeout(function(){display.scroller.draggable=!0},100)),void 0;if(!clickInGutter(cm,e)){var start=posFromMouse(cm,e);switch(window.focus(),e_button(e)){case 3:return captureMiddleClick&&onContextMenu.call(cm,cm,e),void 0;case 2:return webkit&&(cm.state.lastMiddleDown=+new Date),start&&extendSelection(cm.doc,start),setTimeout(bind(focusInput,cm),20),e_preventDefault(e),void 0}if(!start)return e_target(e)==display.scroller&&e_preventDefault(e),void 0;setTimeout(bind(ensureFocus,cm),0);var now=+new Date,type="single";if(lastDoubleClick&&lastDoubleClick.time>now-400&&posEq(lastDoubleClick.pos,start))type="triple",e_preventDefault(e),setTimeout(bind(focusInput,cm),20),selectLine(cm,start.line);else if(lastClick&&lastClick.time>now-400&&posEq(lastClick.pos,start)){type="double",lastDoubleClick={time:now,pos:start},e_preventDefault(e);var word=findWordAt(getLine(doc,start.line).text,start);extendSelection(cm.doc,word.from,word.to)}else lastClick={time:now,pos:start};var last=start;if(cm.options.dragDrop&&dragAndDrop&&!isReadOnly(cm)&&!posEq(sel.from,sel.to)&&!posLess(start,sel.from)&&!posLess(sel.to,start)&&"single"==type){var dragEnd=operation(cm,function(e2){webkit&&(display.scroller.draggable=!1),cm.state.draggingText=!1,off(document,"mouseup",dragEnd),off(display.scroller,"drop",dragEnd),Math.abs(e.clientX-e2.clientX)+Math.abs(e.clientY-e2.clientY)<10&&(e_preventDefault(e2),extendSelection(cm.doc,start),focusInput(cm),old_ie&&!ie_lt9&&setTimeout(function(){document.body.focus(),focusInput(cm)},20))});return webkit&&(display.scroller.draggable=!0),cm.state.draggingText=dragEnd,display.scroller.dragDrop&&display.scroller.dragDrop(),on(document,"mouseup",dragEnd),on(display.scroller,"drop",dragEnd),void 0}e_preventDefault(e),"single"==type&&extendSelection(cm.doc,clipPos(doc,start));var startstart=sel.from,startend=sel.to,lastPos=start,editorSize=getRect(display.wrapper),counter=0,move=operation(cm,function(e){(ie&&!ie_lt10?e.buttons:e_button(e))?extend(e):done(e)}),up=operation(cm,done);on(document,"mousemove",move),on(document,"mouseup",up)}}}function gutterEvent(cm,e,type,prevent,signalfn){try{var mX=e.clientX,mY=e.clientY}catch(e){return!1}if(mX>=Math.floor(getRect(cm.display.gutters).right))return!1;prevent&&e_preventDefault(e);var display=cm.display,lineBox=getRect(display.lineDiv);if(mY>lineBox.bottom||!hasHandler(cm,type))return e_defaultPrevented(e);mY-=lineBox.top-display.viewOffset;for(var i=0;i<cm.options.gutters.length;++i){var g=display.gutters.childNodes[i];if(g&&getRect(g).right>=mX){var line=lineAtHeight(cm.doc,mY),gutter=cm.options.gutters[i];return signalfn(cm,type,cm,line,gutter,e),e_defaultPrevented(e)}}}function contextMenuInGutter(cm,e){return hasHandler(cm,"gutterContextMenu")?gutterEvent(cm,e,"gutterContextMenu",!1,signal):!1}function clickInGutter(cm,e){return gutterEvent(cm,e,"gutterClick",!0,signalLater)}function onDrop(e){var cm=this;if(!(signalDOMEvent(cm,e)||eventInWidget(cm.display,e)||cm.options.onDragEvent&&cm.options.onDragEvent(cm,addStop(e)))){e_preventDefault(e),ie&&(lastDrop=+new Date);var pos=posFromMouse(cm,e,!0),files=e.dataTransfer.files;if(pos&&!isReadOnly(cm))if(files&&files.length&&window.FileReader&&window.File)for(var n=files.length,text=Array(n),read=0,loadFile=function(file,i){var reader=new FileReader;reader.onload=function(){text[i]=reader.result,++read==n&&(pos=clipPos(cm.doc,pos),makeChange(cm.doc,{from:pos,to:pos,text:splitLines(text.join("\n")),origin:"paste"},"around"))},reader.readAsText(file)},i=0;n>i;++i)loadFile(files[i],i);else{if(cm.state.draggingText&&!posLess(pos,cm.doc.sel.from)&&!posLess(cm.doc.sel.to,pos))return cm.state.draggingText(e),setTimeout(bind(focusInput,cm),20),void 0;try{var text=e.dataTransfer.getData("Text");if(text){var curFrom=cm.doc.sel.from,curTo=cm.doc.sel.to;setSelection(cm.doc,pos,pos),cm.state.draggingText&&replaceRange(cm.doc,"",curFrom,curTo,"paste"),cm.replaceSelection(text,null,"paste"),focusInput(cm)}}catch(e){}}}}function onDragStart(cm,e){if(ie&&(!cm.state.draggingText||+new Date-lastDrop<100))return e_stop(e),void 0;if(!signalDOMEvent(cm,e)&&!eventInWidget(cm.display,e)){var txt=cm.getSelection();if(e.dataTransfer.setData("Text",txt),e.dataTransfer.setDragImage&&!safari){var img=elt("img",null,null,"position: fixed; left: 0; top: 0;");img.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",opera&&(img.width=img.height=1,cm.display.wrapper.appendChild(img),img._top=img.offsetTop),e.dataTransfer.setDragImage(img,0,0),opera&&img.parentNode.removeChild(img)}}}function setScrollTop(cm,val){Math.abs(cm.doc.scrollTop-val)<2||(cm.doc.scrollTop=val,gecko||updateDisplay(cm,[],val),cm.display.scroller.scrollTop!=val&&(cm.display.scroller.scrollTop=val),cm.display.scrollbarV.scrollTop!=val&&(cm.display.scrollbarV.scrollTop=val),gecko&&updateDisplay(cm,[]),startWorker(cm,100))}function setScrollLeft(cm,val,isScroller){(isScroller?val==cm.doc.scrollLeft:Math.abs(cm.doc.scrollLeft-val)<2)||(val=Math.min(val,cm.display.scroller.scrollWidth-cm.display.scroller.clientWidth),cm.doc.scrollLeft=val,alignHorizontally(cm),cm.display.scroller.scrollLeft!=val&&(cm.display.scroller.scrollLeft=val),cm.display.scrollbarH.scrollLeft!=val&&(cm.display.scrollbarH.scrollLeft=val))}function onScrollWheel(cm,e){var dx=e.wheelDeltaX,dy=e.wheelDeltaY;null==dx&&e.detail&&e.axis==e.HORIZONTAL_AXIS&&(dx=e.detail),null==dy&&e.detail&&e.axis==e.VERTICAL_AXIS?dy=e.detail:null==dy&&(dy=e.wheelDelta);var display=cm.display,scroll=display.scroller;if(dx&&scroll.scrollWidth>scroll.clientWidth||dy&&scroll.scrollHeight>scroll.clientHeight){if(dy&&mac&&webkit)for(var cur=e.target;cur!=scroll;cur=cur.parentNode)if(cur.lineObj){cm.display.currentWheelTarget=cur;break}if(dx&&!gecko&&!opera&&null!=wheelPixelsPerUnit)return dy&&setScrollTop(cm,Math.max(0,Math.min(scroll.scrollTop+dy*wheelPixelsPerUnit,scroll.scrollHeight-scroll.clientHeight))),setScrollLeft(cm,Math.max(0,Math.min(scroll.scrollLeft+dx*wheelPixelsPerUnit,scroll.scrollWidth-scroll.clientWidth))),e_preventDefault(e),display.wheelStartX=null,void 0;if(dy&&null!=wheelPixelsPerUnit){var pixels=dy*wheelPixelsPerUnit,top=cm.doc.scrollTop,bot=top+display.wrapper.clientHeight;0>pixels?top=Math.max(0,top+pixels-50):bot=Math.min(cm.doc.height,bot+pixels+50),updateDisplay(cm,[],{top:top,bottom:bot})}20>wheelSamples&&(null==display.wheelStartX?(display.wheelStartX=scroll.scrollLeft,display.wheelStartY=scroll.scrollTop,display.wheelDX=dx,display.wheelDY=dy,setTimeout(function(){if(null!=display.wheelStartX){var movedX=scroll.scrollLeft-display.wheelStartX,movedY=scroll.scrollTop-display.wheelStartY,sample=movedY&&display.wheelDY&&movedY/display.wheelDY||movedX&&display.wheelDX&&movedX/display.wheelDX;display.wheelStartX=display.wheelStartY=null,sample&&(wheelPixelsPerUnit=(wheelPixelsPerUnit*wheelSamples+sample)/(wheelSamples+1),++wheelSamples)}},200)):(display.wheelDX+=dx,display.wheelDY+=dy))}}function doHandleBinding(cm,bound,dropShift){if("string"==typeof bound&&(bound=commands[bound],!bound))return!1;cm.display.pollingFast&&readInput(cm)&&(cm.display.pollingFast=!1);var doc=cm.doc,prevShift=doc.sel.shift,done=!1;try{isReadOnly(cm)&&(cm.state.suppressEdits=!0),dropShift&&(doc.sel.shift=!1),done=bound(cm)!=Pass}finally{doc.sel.shift=prevShift,cm.state.suppressEdits=!1}return done}function allKeyMaps(cm){var maps=cm.state.keyMaps.slice(0);return cm.options.extraKeys&&maps.push(cm.options.extraKeys),maps.push(cm.options.keyMap),maps}function handleKeyBinding(cm,e){var startMap=getKeyMap(cm.options.keyMap),next=startMap.auto;clearTimeout(maybeTransition),next&&!isModifierKey(e)&&(maybeTransition=setTimeout(function(){getKeyMap(cm.options.keyMap)==startMap&&(cm.options.keyMap=next.call?next.call(null,cm):next,keyMapChanged(cm))},50));var name=keyName(e,!0),handled=!1;if(!name)return!1;var keymaps=allKeyMaps(cm);return handled=e.shiftKey?lookupKey("Shift-"+name,keymaps,function(b){return doHandleBinding(cm,b,!0)})||lookupKey(name,keymaps,function(b){return("string"==typeof b?/^go[A-Z]/.test(b):b.motion)?doHandleBinding(cm,b):void 0}):lookupKey(name,keymaps,function(b){return doHandleBinding(cm,b)}),handled&&(e_preventDefault(e),restartBlink(cm),ie_lt9&&(e.oldKeyCode=e.keyCode,e.keyCode=0),signalLater(cm,"keyHandled",cm,name,e)),handled}function handleCharBinding(cm,e,ch){var handled=lookupKey("'"+ch+"'",allKeyMaps(cm),function(b){return doHandleBinding(cm,b,!0)});return handled&&(e_preventDefault(e),restartBlink(cm),signalLater(cm,"keyHandled",cm,"'"+ch+"'",e)),handled}function onKeyUp(e){var cm=this;signalDOMEvent(cm,e)||cm.options.onKeyEvent&&cm.options.onKeyEvent(cm,addStop(e))||16==e.keyCode&&(cm.doc.sel.shift=!1)}function onKeyDown(e){var cm=this;if(ensureFocus(cm),!(signalDOMEvent(cm,e)||cm.options.onKeyEvent&&cm.options.onKeyEvent(cm,addStop(e)))){old_ie&&27==e.keyCode&&(e.returnValue=!1);var code=e.keyCode;cm.doc.sel.shift=16==code||e.shiftKey;var handled=handleKeyBinding(cm,e);opera&&(lastStoppedKey=handled?code:null,!handled&&88==code&&!hasCopyEvent&&(mac?e.metaKey:e.ctrlKey)&&cm.replaceSelection(""))}}function onKeyPress(e){var cm=this;if(!(signalDOMEvent(cm,e)||cm.options.onKeyEvent&&cm.options.onKeyEvent(cm,addStop(e)))){var keyCode=e.keyCode,charCode=e.charCode;if(opera&&keyCode==lastStoppedKey)return lastStoppedKey=null,e_preventDefault(e),void 0;if(!(opera&&(!e.which||e.which<10)||khtml)||!handleKeyBinding(cm,e)){var ch=String.fromCharCode(null==charCode?keyCode:charCode);handleCharBinding(cm,e,ch)||(ie&&!ie_lt9&&(cm.display.inputHasSelection=null),fastPoll(cm))}}}function onFocus(cm){"nocursor"!=cm.options.readOnly&&(cm.state.focused||(signal(cm,"focus",cm),cm.state.focused=!0,-1==cm.display.wrapper.className.search(/\bCodeMirror-focused\b/)&&(cm.display.wrapper.className+=" CodeMirror-focused"),cm.curOp||(resetInput(cm,!0),webkit&&setTimeout(bind(resetInput,cm,!0),0))),slowPoll(cm),restartBlink(cm))}function onBlur(cm){cm.state.focused&&(signal(cm,"blur",cm),cm.state.focused=!1,cm.display.wrapper.className=cm.display.wrapper.className.replace(" CodeMirror-focused","")),clearInterval(cm.display.blinker),setTimeout(function(){cm.state.focused||(cm.doc.sel.shift=!1)},150)}function onContextMenu(cm,e){function prepareSelectAllHack(){if(null!=display.input.selectionStart){var extval=display.input.value="​"+(posEq(sel.from,sel.to)?"":display.input.value);display.prevInput="​",display.input.selectionStart=1,display.input.selectionEnd=extval.length}}function rehide(){if(display.inputDiv.style.position="relative",display.input.style.cssText=oldCSS,ie_lt9&&(display.scrollbarV.scrollTop=display.scroller.scrollTop=scrollPos),slowPoll(cm),null!=display.input.selectionStart){(!ie||ie_lt9)&&prepareSelectAllHack(),clearTimeout(detectingSelectAll);var i=0,poll=function(){"​"==display.prevInput&&0==display.input.selectionStart?operation(cm,commands.selectAll)(cm):i++<10?detectingSelectAll=setTimeout(poll,500):resetInput(cm)};detectingSelectAll=setTimeout(poll,200)}}if(!signalDOMEvent(cm,e,"contextmenu")){var display=cm.display,sel=cm.doc.sel;if(!eventInWidget(display,e)&&!contextMenuInGutter(cm,e)){var pos=posFromMouse(cm,e),scrollPos=display.scroller.scrollTop;if(pos&&!opera){var reset=cm.options.resetSelectionOnContextMenu;reset&&(posEq(sel.from,sel.to)||posLess(pos,sel.from)||!posLess(pos,sel.to))&&operation(cm,setSelection)(cm.doc,pos,pos);var oldCSS=display.input.style.cssText;if(display.inputDiv.style.position="absolute",display.input.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(e.clientY-5)+"px; left: "+(e.clientX-5)+"px; z-index: 1000; background: transparent; outline: none;border-width: 0; outline: none; overflow: hidden; opacity: .05; -ms-opacity: .05; filter: alpha(opacity=5);",focusInput(cm),resetInput(cm,!0),posEq(sel.from,sel.to)&&(display.input.value=display.prevInput=" "),ie&&!ie_lt9&&prepareSelectAllHack(),captureMiddleClick){e_stop(e);var mouseup=function(){off(window,"mouseup",mouseup),setTimeout(rehide,20)};on(window,"mouseup",mouseup)}else setTimeout(rehide,50)}}}}function clipPostChange(doc,change,pos){if(!posLess(change.from,pos))return clipPos(doc,pos);var diff=change.text.length-1-(change.to.line-change.from.line);if(pos.line>change.to.line+diff){var preLine=pos.line-diff,lastLine=doc.first+doc.size-1;return preLine>lastLine?Pos(lastLine,getLine(doc,lastLine).text.length):clipToLen(pos,getLine(doc,preLine).text.length)}if(pos.line==change.to.line+diff)return clipToLen(pos,lst(change.text).length+(1==change.text.length?change.from.ch:0)+getLine(doc,change.to.line).text.length-change.to.ch);var inside=pos.line-change.from.line;return clipToLen(pos,change.text[inside].length+(inside?0:change.from.ch))}function computeSelAfterChange(doc,change,hint){if(hint&&"object"==typeof hint)return{anchor:clipPostChange(doc,change,hint.anchor),head:clipPostChange(doc,change,hint.head)};if("start"==hint)return{anchor:change.from,head:change.from};var end=changeEnd(change);if("around"==hint)return{anchor:change.from,head:end};if("end"==hint)return{anchor:end,head:end};var adjustPos=function(pos){if(posLess(pos,change.from))return pos;if(!posLess(change.to,pos))return end;var line=pos.line+change.text.length-(change.to.line-change.from.line)-1,ch=pos.ch;return pos.line==change.to.line&&(ch+=end.ch-change.to.ch),Pos(line,ch)};return{anchor:adjustPos(doc.sel.anchor),head:adjustPos(doc.sel.head)}}function filterChange(doc,change,update){var obj={canceled:!1,from:change.from,to:change.to,text:change.text,origin:change.origin,cancel:function(){this.canceled=!0}};return update&&(obj.update=function(from,to,text,origin){from&&(this.from=clipPos(doc,from)),to&&(this.to=clipPos(doc,to)),text&&(this.text=text),void 0!==origin&&(this.origin=origin)}),signal(doc,"beforeChange",doc,obj),doc.cm&&signal(doc.cm,"beforeChange",doc.cm,obj),obj.canceled?null:{from:obj.from,to:obj.to,text:obj.text,origin:obj.origin}}function makeChange(doc,change,selUpdate,ignoreReadOnly){if(doc.cm){if(!doc.cm.curOp)return operation(doc.cm,makeChange)(doc,change,selUpdate,ignoreReadOnly);if(doc.cm.state.suppressEdits)return}if(!(hasHandler(doc,"beforeChange")||doc.cm&&hasHandler(doc.cm,"beforeChange"))||(change=filterChange(doc,change,!0))){var split=sawReadOnlySpans&&!ignoreReadOnly&&removeReadOnlyRanges(doc,change.from,change.to);if(split){for(var i=split.length-1;i>=1;--i)makeChangeNoReadonly(doc,{from:split[i].from,to:split[i].to,text:[""]});split.length&&makeChangeNoReadonly(doc,{from:split[0].from,to:split[0].to,text:change.text},selUpdate)}else makeChangeNoReadonly(doc,change,selUpdate)}}function makeChangeNoReadonly(doc,change,selUpdate){if(1!=change.text.length||""!=change.text[0]||!posEq(change.from,change.to)){var selAfter=computeSelAfterChange(doc,change,selUpdate);addToHistory(doc,change,selAfter,doc.cm?doc.cm.curOp.id:0/0),makeChangeSingleDoc(doc,change,selAfter,stretchSpansOverChange(doc,change));var rebased=[];linkedDocs(doc,function(doc,sharedHist){sharedHist||-1!=indexOf(rebased,doc.history)||(rebaseHist(doc.history,change),rebased.push(doc.history)),makeChangeSingleDoc(doc,change,null,stretchSpansOverChange(doc,change))})}}function makeChangeFromHistory(doc,type){if(!doc.cm||!doc.cm.state.suppressEdits){var hist=doc.history,event=("undo"==type?hist.done:hist.undone).pop();if(event){var anti={changes:[],anchorBefore:event.anchorAfter,headBefore:event.headAfter,anchorAfter:event.anchorBefore,headAfter:event.headBefore,generation:hist.generation};
("undo"==type?hist.undone:hist.done).push(anti),hist.generation=event.generation||++hist.maxGeneration;for(var filter=hasHandler(doc,"beforeChange")||doc.cm&&hasHandler(doc.cm,"beforeChange"),i=event.changes.length-1;i>=0;--i){var change=event.changes[i];if(change.origin=type,filter&&!filterChange(doc,change,!1))return("undo"==type?hist.done:hist.undone).length=0,void 0;anti.changes.push(historyChangeFromChange(doc,change));var after=i?computeSelAfterChange(doc,change,null):{anchor:event.anchorBefore,head:event.headBefore};makeChangeSingleDoc(doc,change,after,mergeOldSpans(doc,change));var rebased=[];linkedDocs(doc,function(doc,sharedHist){sharedHist||-1!=indexOf(rebased,doc.history)||(rebaseHist(doc.history,change),rebased.push(doc.history)),makeChangeSingleDoc(doc,change,null,mergeOldSpans(doc,change))})}}}}function shiftDoc(doc,distance){function shiftPos(pos){return Pos(pos.line+distance,pos.ch)}doc.first+=distance,doc.cm&&regChange(doc.cm,doc.first,doc.first,distance),doc.sel.head=shiftPos(doc.sel.head),doc.sel.anchor=shiftPos(doc.sel.anchor),doc.sel.from=shiftPos(doc.sel.from),doc.sel.to=shiftPos(doc.sel.to)}function makeChangeSingleDoc(doc,change,selAfter,spans){if(doc.cm&&!doc.cm.curOp)return operation(doc.cm,makeChangeSingleDoc)(doc,change,selAfter,spans);if(change.to.line<doc.first)return shiftDoc(doc,change.text.length-1-(change.to.line-change.from.line)),void 0;if(!(change.from.line>doc.lastLine())){if(change.from.line<doc.first){var shift=change.text.length-1-(doc.first-change.from.line);shiftDoc(doc,shift),change={from:Pos(doc.first,0),to:Pos(change.to.line+shift,change.to.ch),text:[lst(change.text)],origin:change.origin}}var last=doc.lastLine();change.to.line>last&&(change={from:change.from,to:Pos(last,getLine(doc,last).text.length),text:[change.text[0]],origin:change.origin}),change.removed=getBetween(doc,change.from,change.to),selAfter||(selAfter=computeSelAfterChange(doc,change,null)),doc.cm?makeChangeSingleDocInEditor(doc.cm,change,spans,selAfter):updateDoc(doc,change,spans,selAfter)}}function makeChangeSingleDocInEditor(cm,change,spans,selAfter){var doc=cm.doc,display=cm.display,from=change.from,to=change.to,recomputeMaxLength=!1,checkWidthStart=from.line;cm.options.lineWrapping||(checkWidthStart=lineNo(visualLine(doc,getLine(doc,from.line))),doc.iter(checkWidthStart,to.line+1,function(line){return line==display.maxLine?(recomputeMaxLength=!0,!0):void 0})),posLess(doc.sel.head,change.from)||posLess(change.to,doc.sel.head)||(cm.curOp.cursorActivity=!0),updateDoc(doc,change,spans,selAfter,estimateHeight(cm)),cm.options.lineWrapping||(doc.iter(checkWidthStart,from.line+change.text.length,function(line){var len=lineLength(doc,line);len>display.maxLineLength&&(display.maxLine=line,display.maxLineLength=len,display.maxLineChanged=!0,recomputeMaxLength=!1)}),recomputeMaxLength&&(cm.curOp.updateMaxLine=!0)),doc.frontier=Math.min(doc.frontier,from.line),startWorker(cm,400);var lendiff=change.text.length-(to.line-from.line)-1;if(regChange(cm,from.line,to.line+1,lendiff),hasHandler(cm,"change")){var changeObj={from:from,to:to,text:change.text,removed:change.removed,origin:change.origin};if(cm.curOp.textChanged){for(var cur=cm.curOp.textChanged;cur.next;cur=cur.next);cur.next=changeObj}else cm.curOp.textChanged=changeObj}}function replaceRange(doc,code,from,to,origin){if(to||(to=from),posLess(to,from)){var tmp=to;to=from,from=tmp}"string"==typeof code&&(code=splitLines(code)),makeChange(doc,{from:from,to:to,text:code,origin:origin},null)}function Pos(line,ch){return this instanceof Pos?(this.line=line,this.ch=ch,void 0):new Pos(line,ch)}function posEq(a,b){return a.line==b.line&&a.ch==b.ch}function posLess(a,b){return a.line<b.line||a.line==b.line&&a.ch<b.ch}function cmp(a,b){return a.line-b.line||a.ch-b.ch}function copyPos(x){return Pos(x.line,x.ch)}function clipLine(doc,n){return Math.max(doc.first,Math.min(n,doc.first+doc.size-1))}function clipPos(doc,pos){if(pos.line<doc.first)return Pos(doc.first,0);var last=doc.first+doc.size-1;return pos.line>last?Pos(last,getLine(doc,last).text.length):clipToLen(pos,getLine(doc,pos.line).text.length)}function clipToLen(pos,linelen){var ch=pos.ch;return null==ch||ch>linelen?Pos(pos.line,linelen):0>ch?Pos(pos.line,0):pos}function isLine(doc,l){return l>=doc.first&&l<doc.first+doc.size}function extendSelection(doc,pos,other,bias){if(doc.sel.shift||doc.sel.extend){var anchor=doc.sel.anchor;if(other){var posBefore=posLess(pos,anchor);posBefore!=posLess(other,anchor)?(anchor=pos,pos=other):posBefore!=posLess(pos,other)&&(pos=other)}setSelection(doc,anchor,pos,bias)}else setSelection(doc,pos,other||pos,bias);doc.cm&&(doc.cm.curOp.userSelChange=!0)}function filterSelectionChange(doc,anchor,head){var obj={anchor:anchor,head:head};return signal(doc,"beforeSelectionChange",doc,obj),doc.cm&&signal(doc.cm,"beforeSelectionChange",doc.cm,obj),obj.anchor=clipPos(doc,obj.anchor),obj.head=clipPos(doc,obj.head),obj}function setSelection(doc,anchor,head,bias,checkAtomic){if(!checkAtomic&&hasHandler(doc,"beforeSelectionChange")||doc.cm&&hasHandler(doc.cm,"beforeSelectionChange")){var filtered=filterSelectionChange(doc,anchor,head);head=filtered.head,anchor=filtered.anchor}var sel=doc.sel;if(sel.goalColumn=null,null==bias&&(bias=posLess(head,sel.head)?-1:1),(checkAtomic||!posEq(anchor,sel.anchor))&&(anchor=skipAtomic(doc,anchor,bias,"push"!=checkAtomic)),(checkAtomic||!posEq(head,sel.head))&&(head=skipAtomic(doc,head,bias,"push"!=checkAtomic)),!posEq(sel.anchor,anchor)||!posEq(sel.head,head)){sel.anchor=anchor,sel.head=head;var inv=posLess(head,anchor);sel.from=inv?head:anchor,sel.to=inv?anchor:head,doc.cm&&(doc.cm.curOp.updateInput=doc.cm.curOp.selectionChanged=doc.cm.curOp.cursorActivity=!0),signalLater(doc,"cursorActivity",doc)}}function reCheckSelection(cm){setSelection(cm.doc,cm.doc.sel.from,cm.doc.sel.to,null,"push")}function skipAtomic(doc,pos,bias,mayClear){var flipped=!1,curPos=pos,dir=bias||1;doc.cantEdit=!1;search:for(;;){var line=getLine(doc,curPos.line);if(line.markedSpans)for(var i=0;i<line.markedSpans.length;++i){var sp=line.markedSpans[i],m=sp.marker;if((null==sp.from||(m.inclusiveLeft?sp.from<=curPos.ch:sp.from<curPos.ch))&&(null==sp.to||(m.inclusiveRight?sp.to>=curPos.ch:sp.to>curPos.ch))){if(mayClear&&(signal(m,"beforeCursorEnter"),m.explicitlyCleared)){if(line.markedSpans){--i;continue}break}if(!m.atomic)continue;var newPos=m.find()[0>dir?"from":"to"];if(posEq(newPos,curPos)&&(newPos.ch+=dir,newPos.ch<0?newPos=newPos.line>doc.first?clipPos(doc,Pos(newPos.line-1)):null:newPos.ch>line.text.length&&(newPos=newPos.line<doc.first+doc.size-1?Pos(newPos.line+1,0):null),!newPos)){if(flipped)return mayClear?(doc.cantEdit=!0,Pos(doc.first,0)):skipAtomic(doc,pos,bias,!0);flipped=!0,newPos=pos,dir=-dir}curPos=newPos;continue search}}return curPos}}function scrollCursorIntoView(cm){var coords=scrollPosIntoView(cm,cm.doc.sel.head,null,cm.options.cursorScrollMargin);if(cm.state.focused){var display=cm.display,box=getRect(display.sizer),doScroll=null;if(coords.top+box.top<0?doScroll=!0:coords.bottom+box.top>(window.innerHeight||document.documentElement.clientHeight)&&(doScroll=!1),null!=doScroll&&!phantom){var scrollNode=elt("div","​",null,"position: absolute; top: "+(coords.top-display.viewOffset)+"px; height: "+(coords.bottom-coords.top+scrollerCutOff)+"px; left: "+coords.left+"px; width: 2px;");cm.display.lineSpace.appendChild(scrollNode),scrollNode.scrollIntoView(doScroll),cm.display.lineSpace.removeChild(scrollNode)}}}function scrollPosIntoView(cm,pos,end,margin){for(null==margin&&(margin=0);;){var changed=!1,coords=cursorCoords(cm,pos),endCoords=end&&end!=pos?cursorCoords(cm,end):coords,scrollPos=calculateScrollPos(cm,Math.min(coords.left,endCoords.left),Math.min(coords.top,endCoords.top)-margin,Math.max(coords.left,endCoords.left),Math.max(coords.bottom,endCoords.bottom)+margin),startTop=cm.doc.scrollTop,startLeft=cm.doc.scrollLeft;if(null!=scrollPos.scrollTop&&(setScrollTop(cm,scrollPos.scrollTop),Math.abs(cm.doc.scrollTop-startTop)>1&&(changed=!0)),null!=scrollPos.scrollLeft&&(setScrollLeft(cm,scrollPos.scrollLeft),Math.abs(cm.doc.scrollLeft-startLeft)>1&&(changed=!0)),!changed)return coords}}function scrollIntoView(cm,x1,y1,x2,y2){var scrollPos=calculateScrollPos(cm,x1,y1,x2,y2);null!=scrollPos.scrollTop&&setScrollTop(cm,scrollPos.scrollTop),null!=scrollPos.scrollLeft&&setScrollLeft(cm,scrollPos.scrollLeft)}function calculateScrollPos(cm,x1,y1,x2,y2){var display=cm.display,snapMargin=textHeight(cm.display);0>y1&&(y1=0);var screen=display.scroller.clientHeight-scrollerCutOff,screentop=display.scroller.scrollTop,result={},docBottom=cm.doc.height+paddingVert(display),atTop=snapMargin>y1,atBottom=y2>docBottom-snapMargin;if(screentop>y1)result.scrollTop=atTop?0:y1;else if(y2>screentop+screen){var newTop=Math.min(y1,(atBottom?docBottom:y2)-screen);newTop!=screentop&&(result.scrollTop=newTop)}var screenw=display.scroller.clientWidth-scrollerCutOff,screenleft=display.scroller.scrollLeft;x1+=display.gutters.offsetWidth,x2+=display.gutters.offsetWidth;var gutterw=display.gutters.offsetWidth,atLeft=gutterw+10>x1;return screenleft+gutterw>x1||atLeft?(atLeft&&(x1=0),result.scrollLeft=Math.max(0,x1-10-gutterw)):x2>screenw+screenleft-3&&(result.scrollLeft=x2+10-screenw),result}function updateScrollPos(cm,left,top){cm.curOp.updateScrollPos={scrollLeft:null==left?cm.doc.scrollLeft:left,scrollTop:null==top?cm.doc.scrollTop:top}}function addToScrollPos(cm,left,top){var pos=cm.curOp.updateScrollPos||(cm.curOp.updateScrollPos={scrollLeft:cm.doc.scrollLeft,scrollTop:cm.doc.scrollTop}),scroll=cm.display.scroller;pos.scrollTop=Math.max(0,Math.min(scroll.scrollHeight-scroll.clientHeight,pos.scrollTop+top)),pos.scrollLeft=Math.max(0,Math.min(scroll.scrollWidth-scroll.clientWidth,pos.scrollLeft+left))}function indentLine(cm,n,how,aggressive){var state,doc=cm.doc;null==how&&(how="add"),"smart"==how&&(cm.doc.mode.indent?state=getStateBefore(cm,n):how="prev");var tabSize=cm.options.tabSize,line=getLine(doc,n),curSpace=countColumn(line.text,null,tabSize);line.stateAfter&&(line.stateAfter=null);var indentation,curSpaceString=line.text.match(/^\s*/)[0];if(aggressive||/\S/.test(line.text)){if("smart"==how&&(indentation=cm.doc.mode.indent(state,line.text.slice(curSpaceString.length),line.text),indentation==Pass)){if(!aggressive)return;how="prev"}}else indentation=0,how="not";"prev"==how?indentation=n>doc.first?countColumn(getLine(doc,n-1).text,null,tabSize):0:"add"==how?indentation=curSpace+cm.options.indentUnit:"subtract"==how?indentation=curSpace-cm.options.indentUnit:"number"==typeof how&&(indentation=curSpace+how),indentation=Math.max(0,indentation);var indentString="",pos=0;if(cm.options.indentWithTabs)for(var i=Math.floor(indentation/tabSize);i;--i)pos+=tabSize,indentString+="	";indentation>pos&&(indentString+=spaceStr(indentation-pos)),indentString!=curSpaceString?replaceRange(cm.doc,indentString,Pos(n,0),Pos(n,curSpaceString.length),"+input"):doc.sel.head.line==n&&doc.sel.head.ch<curSpaceString.length&&setSelection(doc,Pos(n,curSpaceString.length),Pos(n,curSpaceString.length),1),line.stateAfter=null}function changeLine(cm,handle,op){var no=handle,line=handle,doc=cm.doc;return"number"==typeof handle?line=getLine(doc,clipLine(doc,handle)):no=lineNo(handle),null==no?null:op(line,no)?(regChange(cm,no,no+1),line):null}function findPosH(doc,pos,dir,unit,visually){function findNextLine(){var l=line+dir;return l<doc.first||l>=doc.first+doc.size?possible=!1:(line=l,lineObj=getLine(doc,l))}function moveOnce(boundToLine){var next=(visually?moveVisually:moveLogically)(lineObj,ch,dir,!0);if(null==next){if(boundToLine||!findNextLine())return possible=!1;ch=visually?(0>dir?lineRight:lineLeft)(lineObj):0>dir?lineObj.text.length:0}else ch=next;return!0}var line=pos.line,ch=pos.ch,origDir=dir,lineObj=getLine(doc,line),possible=!0;if("char"==unit)moveOnce();else if("column"==unit)moveOnce(!0);else if("word"==unit||"group"==unit)for(var sawType=null,group="group"==unit,first=!0;!(0>dir)||moveOnce(!first);first=!1){var cur=lineObj.text.charAt(ch)||"\n",type=isWordChar(cur)?"w":group&&"\n"==cur?"n":!group||/\s/.test(cur)?null:"p";if(!group||first||type||(type="s"),sawType&&sawType!=type){0>dir&&(dir=1,moveOnce());break}if(type&&(sawType=type),dir>0&&!moveOnce(!first))break}var result=skipAtomic(doc,Pos(line,ch),origDir,!0);return possible||(result.hitSide=!0),result}function findPosV(cm,pos,dir,unit){var y,doc=cm.doc,x=pos.left;if("page"==unit){var pageSize=Math.min(cm.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);y=pos.top+dir*(pageSize-(0>dir?1.5:.5)*textHeight(cm.display))}else"line"==unit&&(y=dir>0?pos.bottom+3:pos.top-3);for(;;){var target=coordsChar(cm,x,y);if(!target.outside)break;if(0>dir?0>=y:y>=doc.height){target.hitSide=!0;break}y+=5*dir}return target}function findWordAt(line,pos){var start=pos.ch,end=pos.ch;if(line){(pos.xRel<0||end==line.length)&&start?--start:++end;for(var startChar=line.charAt(start),check=isWordChar(startChar)?isWordChar:/\s/.test(startChar)?function(ch){return/\s/.test(ch)}:function(ch){return!/\s/.test(ch)&&!isWordChar(ch)};start>0&&check(line.charAt(start-1));)--start;for(;end<line.length&&check(line.charAt(end));)++end}return{from:Pos(pos.line,start),to:Pos(pos.line,end)}}function selectLine(cm,line){extendSelection(cm.doc,Pos(line,0),clipPos(cm.doc,Pos(line+1,0)))}function option(name,deflt,handle,notOnInit){CodeMirror.defaults[name]=deflt,handle&&(optionHandlers[name]=notOnInit?function(cm,val,old){old!=Init&&handle(cm,val,old)}:handle)}function copyState(mode,state){if(state===!0)return state;if(mode.copyState)return mode.copyState(state);var nstate={};for(var n in state){var val=state[n];val instanceof Array&&(val=val.concat([])),nstate[n]=val}return nstate}function startState(mode,a1,a2){return mode.startState?mode.startState(a1,a2):!0}function getKeyMap(val){return"string"==typeof val?keyMap[val]:val}function lookupKey(name,maps,handle){function lookup(map){map=getKeyMap(map);var found=map[name];if(found===!1)return"stop";if(null!=found&&handle(found))return!0;if(map.nofallthrough)return"stop";var fallthrough=map.fallthrough;if(null==fallthrough)return!1;if("[object Array]"!=Object.prototype.toString.call(fallthrough))return lookup(fallthrough);for(var i=0,e=fallthrough.length;e>i;++i){var done=lookup(fallthrough[i]);if(done)return done}return!1}for(var i=0;i<maps.length;++i){var done=lookup(maps[i]);if(done)return"stop"!=done}}function isModifierKey(event){var name=keyNames[event.keyCode];return"Ctrl"==name||"Alt"==name||"Shift"==name||"Mod"==name}function keyName(event,noShift){if(opera&&34==event.keyCode&&event["char"])return!1;var name=keyNames[event.keyCode];return null==name||event.altGraphKey?!1:(event.altKey&&(name="Alt-"+name),(flipCtrlCmd?event.metaKey:event.ctrlKey)&&(name="Ctrl-"+name),(flipCtrlCmd?event.ctrlKey:event.metaKey)&&(name="Cmd-"+name),!noShift&&event.shiftKey&&(name="Shift-"+name),name)}function StringStream(string,tabSize){this.pos=this.start=0,this.string=string,this.tabSize=tabSize||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0}function TextMarker(doc,type){this.lines=[],this.type=type,this.doc=doc}function markText(doc,from,to,options,type){if(options&&options.shared)return markTextShared(doc,from,to,options,type);if(doc.cm&&!doc.cm.curOp)return operation(doc.cm,markText)(doc,from,to,options,type);var marker=new TextMarker(doc,type);if(options&&copyObj(options,marker),posLess(to,from)||posEq(from,to)&&marker.clearWhenEmpty!==!1)return marker;if(marker.replacedWith&&(marker.collapsed=!0,marker.replacedWith=elt("span",[marker.replacedWith],"CodeMirror-widget"),options.handleMouseEvents||(marker.replacedWith.ignoreEvents=!0)),marker.collapsed){if(conflictingCollapsedRange(doc,from.line,from,to,marker)||from.line!=to.line&&conflictingCollapsedRange(doc,to.line,from,to,marker))throw new Error("Inserting collapsed marker partially overlapping an existing one");sawCollapsedSpans=!0}marker.addToHistory&&addToHistory(doc,{from:from,to:to,origin:"markText"},{head:doc.sel.head,anchor:doc.sel.anchor},0/0);var updateMaxLine,curLine=from.line,cm=doc.cm;return doc.iter(curLine,to.line+1,function(line){cm&&marker.collapsed&&!cm.options.lineWrapping&&visualLine(doc,line)==cm.display.maxLine&&(updateMaxLine=!0);var span={from:null,to:null,marker:marker};curLine==from.line&&(span.from=from.ch),curLine==to.line&&(span.to=to.ch),marker.collapsed&&curLine!=from.line&&updateLineHeight(line,0),addMarkedSpan(line,span),++curLine}),marker.collapsed&&doc.iter(from.line,to.line+1,function(line){lineIsHidden(doc,line)&&updateLineHeight(line,0)}),marker.clearOnEnter&&on(marker,"beforeCursorEnter",function(){marker.clear()}),marker.readOnly&&(sawReadOnlySpans=!0,(doc.history.done.length||doc.history.undone.length)&&doc.clearHistory()),marker.collapsed&&(marker.id=++nextMarkerId,marker.atomic=!0),cm&&(updateMaxLine&&(cm.curOp.updateMaxLine=!0),(marker.className||marker.title||marker.startStyle||marker.endStyle||marker.collapsed)&&regChange(cm,from.line,to.line+1),marker.atomic&&reCheckSelection(cm)),marker}function SharedTextMarker(markers,primary){this.markers=markers,this.primary=primary;for(var i=0,me=this;i<markers.length;++i)markers[i].parent=this,on(markers[i],"clear",function(){me.clear()})}function markTextShared(doc,from,to,options,type){options=copyObj(options),options.shared=!1;var markers=[markText(doc,from,to,options,type)],primary=markers[0],widget=options.replacedWith;return linkedDocs(doc,function(doc){widget&&(options.replacedWith=widget.cloneNode(!0)),markers.push(markText(doc,clipPos(doc,from),clipPos(doc,to),options,type));for(var i=0;i<doc.linked.length;++i)if(doc.linked[i].isParent)return;primary=lst(markers)}),new SharedTextMarker(markers,primary)}function getMarkedSpanFor(spans,marker){if(spans)for(var i=0;i<spans.length;++i){var span=spans[i];if(span.marker==marker)return span}}function removeMarkedSpan(spans,span){for(var r,i=0;i<spans.length;++i)spans[i]!=span&&(r||(r=[])).push(spans[i]);return r}function addMarkedSpan(line,span){line.markedSpans=line.markedSpans?line.markedSpans.concat([span]):[span],span.marker.attachLine(line)}function markedSpansBefore(old,startCh,isInsert){if(old)for(var nw,i=0;i<old.length;++i){var span=old[i],marker=span.marker,startsBefore=null==span.from||(marker.inclusiveLeft?span.from<=startCh:span.from<startCh);if(startsBefore||span.from==startCh&&"bookmark"==marker.type&&(!isInsert||!span.marker.insertLeft)){var endsAfter=null==span.to||(marker.inclusiveRight?span.to>=startCh:span.to>startCh);(nw||(nw=[])).push({from:span.from,to:endsAfter?null:span.to,marker:marker})}}return nw}function markedSpansAfter(old,endCh,isInsert){if(old)for(var nw,i=0;i<old.length;++i){var span=old[i],marker=span.marker,endsAfter=null==span.to||(marker.inclusiveRight?span.to>=endCh:span.to>endCh);if(endsAfter||span.from==endCh&&"bookmark"==marker.type&&(!isInsert||span.marker.insertLeft)){var startsBefore=null==span.from||(marker.inclusiveLeft?span.from<=endCh:span.from<endCh);(nw||(nw=[])).push({from:startsBefore?null:span.from-endCh,to:null==span.to?null:span.to-endCh,marker:marker})}}return nw}function stretchSpansOverChange(doc,change){var oldFirst=isLine(doc,change.from.line)&&getLine(doc,change.from.line).markedSpans,oldLast=isLine(doc,change.to.line)&&getLine(doc,change.to.line).markedSpans;if(!oldFirst&&!oldLast)return null;var startCh=change.from.ch,endCh=change.to.ch,isInsert=posEq(change.from,change.to),first=markedSpansBefore(oldFirst,startCh,isInsert),last=markedSpansAfter(oldLast,endCh,isInsert),sameLine=1==change.text.length,offset=lst(change.text).length+(sameLine?startCh:0);if(first)for(var i=0;i<first.length;++i){var span=first[i];if(null==span.to){var found=getMarkedSpanFor(last,span.marker);found?sameLine&&(span.to=null==found.to?null:found.to+offset):span.to=startCh}}if(last)for(var i=0;i<last.length;++i){var span=last[i];if(null!=span.to&&(span.to+=offset),null==span.from){var found=getMarkedSpanFor(first,span.marker);found||(span.from=offset,sameLine&&(first||(first=[])).push(span))}else span.from+=offset,sameLine&&(first||(first=[])).push(span)}first&&(first=clearEmptySpans(first)),last&&last!=first&&(last=clearEmptySpans(last));var newMarkers=[first];if(!sameLine){var gapMarkers,gap=change.text.length-2;if(gap>0&&first)for(var i=0;i<first.length;++i)null==first[i].to&&(gapMarkers||(gapMarkers=[])).push({from:null,to:null,marker:first[i].marker});for(var i=0;gap>i;++i)newMarkers.push(gapMarkers);newMarkers.push(last)}return newMarkers}function clearEmptySpans(spans){for(var i=0;i<spans.length;++i){var span=spans[i];null!=span.from&&span.from==span.to&&span.marker.clearWhenEmpty!==!1&&spans.splice(i--,1)}return spans.length?spans:null}function mergeOldSpans(doc,change){var old=getOldSpans(doc,change),stretched=stretchSpansOverChange(doc,change);if(!old)return stretched;if(!stretched)return old;for(var i=0;i<old.length;++i){var oldCur=old[i],stretchCur=stretched[i];if(oldCur&&stretchCur)spans:for(var j=0;j<stretchCur.length;++j){for(var span=stretchCur[j],k=0;k<oldCur.length;++k)if(oldCur[k].marker==span.marker)continue spans;oldCur.push(span)}else stretchCur&&(old[i]=stretchCur)}return old}function removeReadOnlyRanges(doc,from,to){var markers=null;if(doc.iter(from.line,to.line+1,function(line){if(line.markedSpans)for(var i=0;i<line.markedSpans.length;++i){var mark=line.markedSpans[i].marker;!mark.readOnly||markers&&-1!=indexOf(markers,mark)||(markers||(markers=[])).push(mark)}}),!markers)return null;for(var parts=[{from:from,to:to}],i=0;i<markers.length;++i)for(var mk=markers[i],m=mk.find(),j=0;j<parts.length;++j){var p=parts[j];if(!posLess(p.to,m.from)&&!posLess(m.to,p.from)){var newParts=[j,1];(posLess(p.from,m.from)||!mk.inclusiveLeft&&posEq(p.from,m.from))&&newParts.push({from:p.from,to:m.from}),(posLess(m.to,p.to)||!mk.inclusiveRight&&posEq(p.to,m.to))&&newParts.push({from:m.to,to:p.to}),parts.splice.apply(parts,newParts),j+=newParts.length-1}}return parts}function extraLeft(marker){return marker.inclusiveLeft?-1:0}function extraRight(marker){return marker.inclusiveRight?1:0}function compareCollapsedMarkers(a,b){var lenDiff=a.lines.length-b.lines.length;if(0!=lenDiff)return lenDiff;var aPos=a.find(),bPos=b.find(),fromCmp=cmp(aPos.from,bPos.from)||extraLeft(a)-extraLeft(b);if(fromCmp)return-fromCmp;var toCmp=cmp(aPos.to,bPos.to)||extraRight(a)-extraRight(b);return toCmp?toCmp:b.id-a.id}function collapsedSpanAtSide(line,start){var found,sps=sawCollapsedSpans&&line.markedSpans;if(sps)for(var sp,i=0;i<sps.length;++i)sp=sps[i],sp.marker.collapsed&&null==(start?sp.from:sp.to)&&(!found||compareCollapsedMarkers(found,sp.marker)<0)&&(found=sp.marker);return found}function collapsedSpanAtStart(line){return collapsedSpanAtSide(line,!0)}function collapsedSpanAtEnd(line){return collapsedSpanAtSide(line,!1)}function conflictingCollapsedRange(doc,lineNo,from,to,marker){var line=getLine(doc,lineNo),sps=sawCollapsedSpans&&line.markedSpans;if(sps)for(var i=0;i<sps.length;++i){var sp=sps[i];if(sp.marker.collapsed){var found=sp.marker.find(!0),fromCmp=cmp(found.from,from)||extraLeft(sp.marker)-extraLeft(marker),toCmp=cmp(found.to,to)||extraRight(sp.marker)-extraRight(marker);if(!(fromCmp>=0&&0>=toCmp||0>=fromCmp&&toCmp>=0)&&(0>=fromCmp&&(cmp(found.to,from)||extraRight(sp.marker)-extraLeft(marker))>0||fromCmp>=0&&(cmp(found.from,to)||extraLeft(sp.marker)-extraRight(marker))<0))return!0}}}function visualLine(doc,line){for(var merged;merged=collapsedSpanAtStart(line);)line=getLine(doc,merged.find().from.line);return line}function lineIsHidden(doc,line){var sps=sawCollapsedSpans&&line.markedSpans;if(sps)for(var sp,i=0;i<sps.length;++i)if(sp=sps[i],sp.marker.collapsed){if(null==sp.from)return!0;if(!sp.marker.replacedWith&&0==sp.from&&sp.marker.inclusiveLeft&&lineIsHiddenInner(doc,line,sp))return!0}}function lineIsHiddenInner(doc,line,span){if(null==span.to){var end=span.marker.find().to,endLine=getLine(doc,end.line);return lineIsHiddenInner(doc,endLine,getMarkedSpanFor(endLine.markedSpans,span.marker))}if(span.marker.inclusiveRight&&span.to==line.text.length)return!0;for(var sp,i=0;i<line.markedSpans.length;++i)if(sp=line.markedSpans[i],sp.marker.collapsed&&!sp.marker.replacedWith&&sp.from==span.to&&(null==sp.to||sp.to!=span.from)&&(sp.marker.inclusiveLeft||span.marker.inclusiveRight)&&lineIsHiddenInner(doc,line,sp))return!0}function detachMarkedSpans(line){var spans=line.markedSpans;if(spans){for(var i=0;i<spans.length;++i)spans[i].marker.detachLine(line);line.markedSpans=null}}function attachMarkedSpans(line,spans){if(spans){for(var i=0;i<spans.length;++i)spans[i].marker.attachLine(line);line.markedSpans=spans}}function widgetOperation(f){return function(){var withOp=!this.cm.curOp;withOp&&startOperation(this.cm);try{var result=f.apply(this,arguments)}finally{withOp&&endOperation(this.cm)}return result}}function widgetHeight(widget){return null!=widget.height?widget.height:(widget.node.parentNode&&1==widget.node.parentNode.nodeType||removeChildrenAndAdd(widget.cm.display.measure,elt("div",[widget.node],null,"position: relative")),widget.height=widget.node.offsetHeight)}function addLineWidget(cm,handle,node,options){var widget=new LineWidget(cm,node,options);return widget.noHScroll&&(cm.display.alignWidgets=!0),changeLine(cm,handle,function(line){var widgets=line.widgets||(line.widgets=[]);if(null==widget.insertAt?widgets.push(widget):widgets.splice(Math.min(widgets.length-1,Math.max(0,widget.insertAt)),0,widget),widget.line=line,!lineIsHidden(cm.doc,line)||widget.showIfHidden){var aboveVisible=heightAtLine(cm,line)<cm.doc.scrollTop;updateLineHeight(line,line.height+widgetHeight(widget)),aboveVisible&&addToScrollPos(cm,0,widget.height),cm.curOp.forceUpdate=!0}return!0}),widget}function updateLine(line,text,markedSpans,estimateHeight){line.text=text,line.stateAfter&&(line.stateAfter=null),line.styles&&(line.styles=null),null!=line.order&&(line.order=null),detachMarkedSpans(line),attachMarkedSpans(line,markedSpans);var estHeight=estimateHeight?estimateHeight(line):1;estHeight!=line.height&&updateLineHeight(line,estHeight)}function cleanUpLine(line){line.parent=null,detachMarkedSpans(line)}function runMode(cm,text,mode,state,f,forceToEnd){var flattenSpans=mode.flattenSpans;null==flattenSpans&&(flattenSpans=cm.options.flattenSpans);var style,curStart=0,curStyle=null,stream=new StringStream(text,cm.options.tabSize);for(""==text&&mode.blankLine&&mode.blankLine(state);!stream.eol();){if(stream.pos>cm.options.maxHighlightLength?(flattenSpans=!1,forceToEnd&&processLine(cm,text,state,stream.pos),stream.pos=text.length,style=null):style=mode.token(stream,state),cm.options.addModeClass){var mName=CodeMirror.innerMode(mode,state).mode.name;mName&&(style="m-"+(style?mName+" "+style:mName))}flattenSpans&&curStyle==style||(curStart<stream.start&&f(stream.start,curStyle),curStart=stream.start,curStyle=style),stream.start=stream.pos}for(;curStart<stream.pos;){var pos=Math.min(stream.pos,curStart+5e4);f(pos,curStyle),curStart=pos}}function highlightLine(cm,line,state,forceToEnd){var st=[cm.state.modeGen];runMode(cm,line.text,cm.doc.mode,state,function(end,style){st.push(end,style)},forceToEnd);for(var o=0;o<cm.state.overlays.length;++o){var overlay=cm.state.overlays[o],i=1,at=0;runMode(cm,line.text,overlay.mode,!0,function(end,style){for(var start=i;end>at;){var i_end=st[i];i_end>end&&st.splice(i,1,end,st[i+1],i_end),i+=2,at=Math.min(end,i_end)}if(style)if(overlay.opaque)st.splice(start,i-start,end,style),i=start+2;else for(;i>start;start+=2){var cur=st[start+1];st[start+1]=cur?cur+" "+style:style}})}return st}function getLineStyles(cm,line){return line.styles&&line.styles[0]==cm.state.modeGen||(line.styles=highlightLine(cm,line,line.stateAfter=getStateBefore(cm,lineNo(line)))),line.styles}function processLine(cm,text,state,startAt){var mode=cm.doc.mode,stream=new StringStream(text,cm.options.tabSize);for(stream.start=stream.pos=startAt||0,""==text&&mode.blankLine&&mode.blankLine(state);!stream.eol()&&stream.pos<=cm.options.maxHighlightLength;)mode.token(stream,state),stream.start=stream.pos}function interpretTokenStyle(style,builder){if(!style)return null;for(;;){var lineClass=style.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!lineClass)break;style=style.slice(0,lineClass.index)+style.slice(lineClass.index+lineClass[0].length);var prop=lineClass[1]?"bgClass":"textClass";null==builder[prop]?builder[prop]=lineClass[2]:new RegExp("(?:^|s)"+lineClass[2]+"(?:$|s)").test(builder[prop])||(builder[prop]+=" "+lineClass[2])}if(/^\s*$/.test(style))return null;var cache=builder.cm.options.addModeClass?styleToClassCacheWithMode:styleToClassCache;return cache[style]||(cache[style]=style.replace(/\S+/g,"cm-$&"))}function buildLineContent(cm,realLine,measure,copyWidgets){for(var merged,line=realLine,empty=!0;merged=collapsedSpanAtStart(line);)line=getLine(cm.doc,merged.find().from.line);var builder={pre:elt("pre"),col:0,pos:0,measure:null,measuredSomething:!1,cm:cm,copyWidgets:copyWidgets};do{line.text&&(empty=!1),builder.measure=line==realLine&&measure,builder.pos=0,builder.addToken=builder.measure?buildTokenMeasure:buildToken,(ie||webkit)&&cm.getOption("lineWrapping")&&(builder.addToken=buildTokenSplitSpaces(builder.addToken));var next=insertLineContent(line,builder,getLineStyles(cm,line));measure&&line==realLine&&!builder.measuredSomething&&(measure[0]=builder.pre.appendChild(zeroWidthElement(cm.display.measure)),builder.measuredSomething=!0),next&&(line=getLine(cm.doc,next.to.line))}while(next);!measure||builder.measuredSomething||measure[0]||(measure[0]=builder.pre.appendChild(empty?elt("span"," "):zeroWidthElement(cm.display.measure))),builder.pre.firstChild||lineIsHidden(cm.doc,realLine)||builder.pre.appendChild(document.createTextNode(" "));var order;if(measure&&ie&&(order=getOrder(line))){var l=order.length-1;order[l].from==order[l].to&&--l;var last=order[l],prev=order[l-1];if(last.from+1==last.to&&prev&&last.level<prev.level){var span=measure[builder.pos-1];span&&span.parentNode.insertBefore(span.measureRight=zeroWidthElement(cm.display.measure),span.nextSibling)}}var textClass=builder.textClass?builder.textClass+" "+(realLine.textClass||""):realLine.textClass;return textClass&&(builder.pre.className=textClass),signal(cm,"renderLine",cm,realLine,builder.pre),builder}function defaultSpecialCharPlaceholder(ch){var token=elt("span","•","cm-invalidchar");return token.title="\\u"+ch.charCodeAt(0).toString(16),token}function buildToken(builder,text,style,startStyle,endStyle,title){if(text){var special=builder.cm.options.specialChars;if(special.test(text))for(var content=document.createDocumentFragment(),pos=0;;){special.lastIndex=pos;var m=special.exec(text),skipped=m?m.index-pos:text.length-pos;if(skipped&&(content.appendChild(document.createTextNode(text.slice(pos,pos+skipped))),builder.col+=skipped),!m)break;if(pos+=skipped+1,"	"==m[0]){var tabSize=builder.cm.options.tabSize,tabWidth=tabSize-builder.col%tabSize;content.appendChild(elt("span",spaceStr(tabWidth),"cm-tab")),builder.col+=tabWidth}else{var token=builder.cm.options.specialCharPlaceholder(m[0]);content.appendChild(token),builder.col+=1}}else{builder.col+=text.length;var content=document.createTextNode(text)}if(style||startStyle||endStyle||builder.measure){var fullStyle=style||"";startStyle&&(fullStyle+=startStyle),endStyle&&(fullStyle+=endStyle);var token=elt("span",[content],fullStyle);return title&&(token.title=title),builder.pre.appendChild(token)}builder.pre.appendChild(content)}}function buildTokenMeasure(builder,text,style,startStyle,endStyle){for(var wrapping=builder.cm.options.lineWrapping,i=0;i<text.length;++i){for(var start=0==i,to=i+1;to<text.length&&isExtendingChar(text.charAt(to));)++to;var ch=text.slice(i,to);i=to-1,i&&wrapping&&spanAffectsWrapping(text,i)&&builder.pre.appendChild(elt("wbr"));var old=builder.measure[builder.pos],span=builder.measure[builder.pos]=buildToken(builder,ch,style,start&&startStyle,i==text.length-1&&endStyle);old&&(span.leftSide=old.leftSide||old),old_ie&&wrapping&&" "==ch&&i&&!/\s/.test(text.charAt(i-1))&&i<text.length-1&&!/\s/.test(text.charAt(i+1))&&(span.style.whiteSpace="normal"),builder.pos+=ch.length}text.length&&(builder.measuredSomething=!0)}function buildTokenSplitSpaces(inner){function split(old){for(var out=" ",i=0;i<old.length-2;++i)out+=i%2?" ":" ";return out+=" "}return function(builder,text,style,startStyle,endStyle,title){return inner(builder,text.replace(/ {3,}/g,split),style,startStyle,endStyle,title)}}function buildCollapsedSpan(builder,size,marker,ignoreWidget){var widget=!ignoreWidget&&marker.replacedWith;if(widget&&(builder.copyWidgets&&(widget=widget.cloneNode(!0)),builder.pre.appendChild(widget),builder.measure)){if(size)builder.measure[builder.pos]=widget;
else{var elt=zeroWidthElement(builder.cm.display.measure);if("bookmark"!=marker.type||marker.insertLeft){if(builder.measure[builder.pos])return;builder.measure[builder.pos]=builder.pre.insertBefore(elt,widget)}else builder.measure[builder.pos]=builder.pre.appendChild(elt)}builder.measuredSomething=!0}builder.pos+=size}function insertLineContent(line,builder,styles){var spans=line.markedSpans,allText=line.text,at=0;if(spans)for(var style,spanStyle,spanEndStyle,spanStartStyle,title,collapsed,len=allText.length,pos=0,i=1,text="",nextChange=0;;){if(nextChange==pos){spanStyle=spanEndStyle=spanStartStyle=title="",collapsed=null,nextChange=1/0;for(var foundBookmarks=[],j=0;j<spans.length;++j){var sp=spans[j],m=sp.marker;sp.from<=pos&&(null==sp.to||sp.to>pos)?(null!=sp.to&&nextChange>sp.to&&(nextChange=sp.to,spanEndStyle=""),m.className&&(spanStyle+=" "+m.className),m.startStyle&&sp.from==pos&&(spanStartStyle+=" "+m.startStyle),m.endStyle&&sp.to==nextChange&&(spanEndStyle+=" "+m.endStyle),m.title&&!title&&(title=m.title),m.collapsed&&(!collapsed||compareCollapsedMarkers(collapsed.marker,m)<0)&&(collapsed=sp)):sp.from>pos&&nextChange>sp.from&&(nextChange=sp.from),"bookmark"==m.type&&sp.from==pos&&m.replacedWith&&foundBookmarks.push(m)}if(collapsed&&(collapsed.from||0)==pos&&(buildCollapsedSpan(builder,(null==collapsed.to?len:collapsed.to)-pos,collapsed.marker,null==collapsed.from),null==collapsed.to))return collapsed.marker.find();if(!collapsed&&foundBookmarks.length)for(var j=0;j<foundBookmarks.length;++j)buildCollapsedSpan(builder,0,foundBookmarks[j])}if(pos>=len)break;for(var upto=Math.min(len,nextChange);;){if(text){var end=pos+text.length;if(!collapsed){var tokenText=end>upto?text.slice(0,upto-pos):text;builder.addToken(builder,tokenText,style?style+spanStyle:spanStyle,spanStartStyle,pos+tokenText.length==nextChange?spanEndStyle:"",title)}if(end>=upto){text=text.slice(upto-pos),pos=upto;break}pos=end,spanStartStyle=""}text=allText.slice(at,at=styles[i++]),style=interpretTokenStyle(styles[i++],builder)}}else for(var i=1;i<styles.length;i+=2)builder.addToken(builder,allText.slice(at,at=styles[i]),interpretTokenStyle(styles[i+1],builder))}function updateDoc(doc,change,markedSpans,selAfter,estimateHeight){function spansFor(n){return markedSpans?markedSpans[n]:null}function update(line,text,spans){updateLine(line,text,spans,estimateHeight),signalLater(line,"change",line,change)}var from=change.from,to=change.to,text=change.text,firstLine=getLine(doc,from.line),lastLine=getLine(doc,to.line),lastText=lst(text),lastSpans=spansFor(text.length-1),nlines=to.line-from.line;if(0!=from.ch||0!=to.ch||""!=lastText||doc.cm&&!doc.cm.options.wholeLineUpdateBefore)if(firstLine==lastLine)if(1==text.length)update(firstLine,firstLine.text.slice(0,from.ch)+lastText+firstLine.text.slice(to.ch),lastSpans);else{for(var added=[],i=1,e=text.length-1;e>i;++i)added.push(new Line(text[i],spansFor(i),estimateHeight));added.push(new Line(lastText+firstLine.text.slice(to.ch),lastSpans,estimateHeight)),update(firstLine,firstLine.text.slice(0,from.ch)+text[0],spansFor(0)),doc.insert(from.line+1,added)}else if(1==text.length)update(firstLine,firstLine.text.slice(0,from.ch)+text[0]+lastLine.text.slice(to.ch),spansFor(0)),doc.remove(from.line+1,nlines);else{update(firstLine,firstLine.text.slice(0,from.ch)+text[0],spansFor(0)),update(lastLine,lastText+lastLine.text.slice(to.ch),lastSpans);for(var i=1,e=text.length-1,added=[];e>i;++i)added.push(new Line(text[i],spansFor(i),estimateHeight));nlines>1&&doc.remove(from.line+1,nlines-1),doc.insert(from.line+1,added)}else{for(var i=0,e=text.length-1,added=[];e>i;++i)added.push(new Line(text[i],spansFor(i),estimateHeight));update(lastLine,lastLine.text,lastSpans),nlines&&doc.remove(from.line,nlines),added.length&&doc.insert(from.line,added)}signalLater(doc,"change",doc,change),setSelection(doc,selAfter.anchor,selAfter.head,null,!0)}function LeafChunk(lines){this.lines=lines,this.parent=null;for(var i=0,e=lines.length,height=0;e>i;++i)lines[i].parent=this,height+=lines[i].height;this.height=height}function BranchChunk(children){this.children=children;for(var size=0,height=0,i=0,e=children.length;e>i;++i){var ch=children[i];size+=ch.chunkSize(),height+=ch.height,ch.parent=this}this.size=size,this.height=height,this.parent=null}function linkedDocs(doc,f,sharedHistOnly){function propagate(doc,skip,sharedHist){if(doc.linked)for(var i=0;i<doc.linked.length;++i){var rel=doc.linked[i];if(rel.doc!=skip){var shared=sharedHist&&rel.sharedHist;(!sharedHistOnly||shared)&&(f(rel.doc,shared),propagate(rel.doc,doc,shared))}}}propagate(doc,null,!0)}function attachDoc(cm,doc){if(doc.cm)throw new Error("This document is already in use.");cm.doc=doc,doc.cm=cm,estimateLineHeights(cm),loadMode(cm),cm.options.lineWrapping||computeMaxLength(cm),cm.options.mode=doc.modeOption,regChange(cm)}function getLine(chunk,n){for(n-=chunk.first;!chunk.lines;)for(var i=0;;++i){var child=chunk.children[i],sz=child.chunkSize();if(sz>n){chunk=child;break}n-=sz}return chunk.lines[n]}function getBetween(doc,start,end){var out=[],n=start.line;return doc.iter(start.line,end.line+1,function(line){var text=line.text;n==end.line&&(text=text.slice(0,end.ch)),n==start.line&&(text=text.slice(start.ch)),out.push(text),++n}),out}function getLines(doc,from,to){var out=[];return doc.iter(from,to,function(line){out.push(line.text)}),out}function updateLineHeight(line,height){for(var diff=height-line.height,n=line;n;n=n.parent)n.height+=diff}function lineNo(line){if(null==line.parent)return null;for(var cur=line.parent,no=indexOf(cur.lines,line),chunk=cur.parent;chunk;cur=chunk,chunk=chunk.parent)for(var i=0;chunk.children[i]!=cur;++i)no+=chunk.children[i].chunkSize();return no+cur.first}function lineAtHeight(chunk,h){var n=chunk.first;outer:do{for(var i=0,e=chunk.children.length;e>i;++i){var child=chunk.children[i],ch=child.height;if(ch>h){chunk=child;continue outer}h-=ch,n+=child.chunkSize()}return n}while(!chunk.lines);for(var i=0,e=chunk.lines.length;e>i;++i){var line=chunk.lines[i],lh=line.height;if(lh>h)break;h-=lh}return n+i}function heightAtLine(cm,lineObj){lineObj=visualLine(cm.doc,lineObj);for(var h=0,chunk=lineObj.parent,i=0;i<chunk.lines.length;++i){var line=chunk.lines[i];if(line==lineObj)break;h+=line.height}for(var p=chunk.parent;p;chunk=p,p=chunk.parent)for(var i=0;i<p.children.length;++i){var cur=p.children[i];if(cur==chunk)break;h+=cur.height}return h}function getOrder(line){var order=line.order;return null==order&&(order=line.order=bidiOrdering(line.text)),order}function makeHistory(startGen){return{done:[],undone:[],undoDepth:1/0,lastTime:0,lastOp:null,lastOrigin:null,generation:startGen||1,maxGeneration:startGen||1}}function attachLocalSpans(doc,change,from,to){var existing=change["spans_"+doc.id],n=0;doc.iter(Math.max(doc.first,from),Math.min(doc.first+doc.size,to),function(line){line.markedSpans&&((existing||(existing=change["spans_"+doc.id]={}))[n]=line.markedSpans),++n})}function historyChangeFromChange(doc,change){var from={line:change.from.line,ch:change.from.ch},histChange={from:from,to:changeEnd(change),text:getBetween(doc,change.from,change.to)};return attachLocalSpans(doc,histChange,change.from.line,change.to.line+1),linkedDocs(doc,function(doc){attachLocalSpans(doc,histChange,change.from.line,change.to.line+1)},!0),histChange}function addToHistory(doc,change,selAfter,opId){var hist=doc.history;hist.undone.length=0;var time=+new Date,cur=lst(hist.done);if(cur&&(hist.lastOp==opId||hist.lastOrigin==change.origin&&change.origin&&("+"==change.origin.charAt(0)&&doc.cm&&hist.lastTime>time-doc.cm.options.historyEventDelay||"*"==change.origin.charAt(0)))){var last=lst(cur.changes);posEq(change.from,change.to)&&posEq(change.from,last.to)?last.to=changeEnd(change):cur.changes.push(historyChangeFromChange(doc,change)),cur.anchorAfter=selAfter.anchor,cur.headAfter=selAfter.head}else for(cur={changes:[historyChangeFromChange(doc,change)],generation:hist.generation,anchorBefore:doc.sel.anchor,headBefore:doc.sel.head,anchorAfter:selAfter.anchor,headAfter:selAfter.head},hist.done.push(cur);hist.done.length>hist.undoDepth;)hist.done.shift();hist.generation=++hist.maxGeneration,hist.lastTime=time,hist.lastOp=opId,hist.lastOrigin=change.origin,last||signal(doc,"historyAdded")}function removeClearedSpans(spans){if(!spans)return null;for(var out,i=0;i<spans.length;++i)spans[i].marker.explicitlyCleared?out||(out=spans.slice(0,i)):out&&out.push(spans[i]);return out?out.length?out:null:spans}function getOldSpans(doc,change){var found=change["spans_"+doc.id];if(!found)return null;for(var i=0,nw=[];i<change.text.length;++i)nw.push(removeClearedSpans(found[i]));return nw}function copyHistoryArray(events,newGroup){for(var i=0,copy=[];i<events.length;++i){var event=events[i],changes=event.changes,newChanges=[];copy.push({changes:newChanges,anchorBefore:event.anchorBefore,headBefore:event.headBefore,anchorAfter:event.anchorAfter,headAfter:event.headAfter});for(var j=0;j<changes.length;++j){var m,change=changes[j];if(newChanges.push({from:change.from,to:change.to,text:change.text}),newGroup)for(var prop in change)(m=prop.match(/^spans_(\d+)$/))&&indexOf(newGroup,Number(m[1]))>-1&&(lst(newChanges)[prop]=change[prop],delete change[prop])}}return copy}function rebaseHistSel(pos,from,to,diff){to<pos.line?pos.line+=diff:from<pos.line&&(pos.line=from,pos.ch=0)}function rebaseHistArray(array,from,to,diff){for(var i=0;i<array.length;++i){for(var sub=array[i],ok=!0,j=0;j<sub.changes.length;++j){var cur=sub.changes[j];if(sub.copied||(cur.from=copyPos(cur.from),cur.to=copyPos(cur.to)),to<cur.from.line)cur.from.line+=diff,cur.to.line+=diff;else if(from<=cur.to.line){ok=!1;break}}sub.copied||(sub.anchorBefore=copyPos(sub.anchorBefore),sub.headBefore=copyPos(sub.headBefore),sub.anchorAfter=copyPos(sub.anchorAfter),sub.readAfter=copyPos(sub.headAfter),sub.copied=!0),ok?(rebaseHistSel(sub.anchorBefore),rebaseHistSel(sub.headBefore),rebaseHistSel(sub.anchorAfter),rebaseHistSel(sub.headAfter)):(array.splice(0,i+1),i=0)}}function rebaseHist(hist,change){var from=change.from.line,to=change.to.line,diff=change.text.length-(to-from)-1;rebaseHistArray(hist.done,from,to,diff),rebaseHistArray(hist.undone,from,to,diff)}function stopMethod(){e_stop(this)}function addStop(event){return event.stop||(event.stop=stopMethod),event}function e_preventDefault(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function e_stopPropagation(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function e_defaultPrevented(e){return null!=e.defaultPrevented?e.defaultPrevented:0==e.returnValue}function e_stop(e){e_preventDefault(e),e_stopPropagation(e)}function e_target(e){return e.target||e.srcElement}function e_button(e){var b=e.which;return null==b&&(1&e.button?b=1:2&e.button?b=3:4&e.button&&(b=2)),mac&&e.ctrlKey&&1==b&&(b=3),b}function on(emitter,type,f){if(emitter.addEventListener)emitter.addEventListener(type,f,!1);else if(emitter.attachEvent)emitter.attachEvent("on"+type,f);else{var map=emitter._handlers||(emitter._handlers={}),arr=map[type]||(map[type]=[]);arr.push(f)}}function off(emitter,type,f){if(emitter.removeEventListener)emitter.removeEventListener(type,f,!1);else if(emitter.detachEvent)emitter.detachEvent("on"+type,f);else{var arr=emitter._handlers&&emitter._handlers[type];if(!arr)return;for(var i=0;i<arr.length;++i)if(arr[i]==f){arr.splice(i,1);break}}}function signal(emitter,type){var arr=emitter._handlers&&emitter._handlers[type];if(arr)for(var args=Array.prototype.slice.call(arguments,2),i=0;i<arr.length;++i)arr[i].apply(null,args)}function signalLater(emitter,type){function bnd(f){return function(){f.apply(null,args)}}var arr=emitter._handlers&&emitter._handlers[type];if(arr){var args=Array.prototype.slice.call(arguments,2);delayedCallbacks||(++delayedCallbackDepth,delayedCallbacks=[],setTimeout(fireDelayed,0));for(var i=0;i<arr.length;++i)delayedCallbacks.push(bnd(arr[i]))}}function signalDOMEvent(cm,e,override){return signal(cm,override||e.type,cm,e),e_defaultPrevented(e)||e.codemirrorIgnore}function fireDelayed(){--delayedCallbackDepth;var delayed=delayedCallbacks;delayedCallbacks=null;for(var i=0;i<delayed.length;++i)delayed[i]()}function hasHandler(emitter,type){var arr=emitter._handlers&&emitter._handlers[type];return arr&&arr.length>0}function eventMixin(ctor){ctor.prototype.on=function(type,f){on(this,type,f)},ctor.prototype.off=function(type,f){off(this,type,f)}}function Delayed(){this.id=null}function countColumn(string,end,tabSize,startIndex,startValue){null==end&&(end=string.search(/[^\s\u00a0]/),-1==end&&(end=string.length));for(var i=startIndex||0,n=startValue||0;end>i;++i)"	"==string.charAt(i)?n+=tabSize-n%tabSize:++n;return n}function spaceStr(n){for(;spaceStrs.length<=n;)spaceStrs.push(lst(spaceStrs)+" ");return spaceStrs[n]}function lst(arr){return arr[arr.length-1]}function selectInput(node){if(ios)node.selectionStart=0,node.selectionEnd=node.value.length;else try{node.select()}catch(_e){}}function indexOf(collection,elt){if(collection.indexOf)return collection.indexOf(elt);for(var i=0,e=collection.length;e>i;++i)if(collection[i]==elt)return i;return-1}function createObj(base,props){function Obj(){}Obj.prototype=base;var inst=new Obj;return props&&copyObj(props,inst),inst}function copyObj(obj,target){target||(target={});for(var prop in obj)obj.hasOwnProperty(prop)&&(target[prop]=obj[prop]);return target}function emptyArray(size){for(var a=[],i=0;size>i;++i)a.push(void 0);return a}function bind(f){var args=Array.prototype.slice.call(arguments,1);return function(){return f.apply(null,args)}}function isWordChar(ch){return/\w/.test(ch)||ch>""&&(ch.toUpperCase()!=ch.toLowerCase()||nonASCIISingleCaseWordChar.test(ch))}function isEmpty(obj){for(var n in obj)if(obj.hasOwnProperty(n)&&obj[n])return!1;return!0}function isExtendingChar(ch){return ch.charCodeAt(0)>=768&&extendingChars.test(ch)}function elt(tag,content,className,style){var e=document.createElement(tag);if(className&&(e.className=className),style&&(e.style.cssText=style),"string"==typeof content)setTextContent(e,content);else if(content)for(var i=0;i<content.length;++i)e.appendChild(content[i]);return e}function removeChildren(e){for(var count=e.childNodes.length;count>0;--count)e.removeChild(e.firstChild);return e}function removeChildrenAndAdd(parent,e){return removeChildren(parent).appendChild(e)}function setTextContent(e,str){ie_lt9?(e.innerHTML="",e.appendChild(document.createTextNode(str))):e.textContent=str}function getRect(node){return node.getBoundingClientRect()}function spanAffectsWrapping(){return!1}function scrollbarWidth(measure){if(null!=knownScrollbarWidth)return knownScrollbarWidth;var test=elt("div",null,null,"width: 50px; height: 50px; overflow-x: scroll");return removeChildrenAndAdd(measure,test),test.offsetWidth&&(knownScrollbarWidth=test.offsetHeight-test.clientHeight),knownScrollbarWidth||0}function zeroWidthElement(measure){if(null==zwspSupported){var test=elt("span","​");removeChildrenAndAdd(measure,elt("span",[test,document.createTextNode("x")])),0!=measure.firstChild.offsetHeight&&(zwspSupported=test.offsetWidth<=1&&test.offsetHeight>2&&!ie_lt8)}return zwspSupported?elt("span","​"):elt("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px")}function iterateBidiSections(order,from,to,f){if(!order)return f(from,to,"ltr");for(var found=!1,i=0;i<order.length;++i){var part=order[i];(part.from<to&&part.to>from||from==to&&part.to==from)&&(f(Math.max(part.from,from),Math.min(part.to,to),1==part.level?"rtl":"ltr"),found=!0)}found||f(from,to,"ltr")}function bidiLeft(part){return part.level%2?part.to:part.from}function bidiRight(part){return part.level%2?part.from:part.to}function lineLeft(line){var order=getOrder(line);return order?bidiLeft(order[0]):0}function lineRight(line){var order=getOrder(line);return order?bidiRight(lst(order)):line.text.length}function lineStart(cm,lineN){var line=getLine(cm.doc,lineN),visual=visualLine(cm.doc,line);visual!=line&&(lineN=lineNo(visual));var order=getOrder(visual),ch=order?order[0].level%2?lineRight(visual):lineLeft(visual):0;return Pos(lineN,ch)}function lineEnd(cm,lineN){for(var merged,line;merged=collapsedSpanAtEnd(line=getLine(cm.doc,lineN));)lineN=merged.find().to.line;var order=getOrder(line),ch=order?order[0].level%2?lineLeft(line):lineRight(line):line.text.length;return Pos(lineN,ch)}function compareBidiLevel(order,a,b){var linedir=order[0].level;return a==linedir?!0:b==linedir?!1:b>a}function getBidiPartAt(order,pos){bidiOther=null;for(var found,i=0;i<order.length;++i){var cur=order[i];if(cur.from<pos&&cur.to>pos)return i;if(cur.from==pos||cur.to==pos){if(null!=found)return compareBidiLevel(order,cur.level,order[found].level)?(cur.from!=cur.to&&(bidiOther=found),i):(cur.from!=cur.to&&(bidiOther=i),found);found=i}}return found}function moveInLine(line,pos,dir,byUnit){if(!byUnit)return pos+dir;do pos+=dir;while(pos>0&&isExtendingChar(line.text.charAt(pos)));return pos}function moveVisually(line,start,dir,byUnit){var bidi=getOrder(line);if(!bidi)return moveLogically(line,start,dir,byUnit);for(var pos=getBidiPartAt(bidi,start),part=bidi[pos],target=moveInLine(line,start,part.level%2?-dir:dir,byUnit);;){if(target>part.from&&target<part.to)return target;if(target==part.from||target==part.to)return getBidiPartAt(bidi,target)==pos?target:(part=bidi[pos+=dir],dir>0==part.level%2?part.to:part.from);if(part=bidi[pos+=dir],!part)return null;target=dir>0==part.level%2?moveInLine(line,part.to,-1,byUnit):moveInLine(line,part.from,1,byUnit)}}function moveLogically(line,start,dir,byUnit){var target=start+dir;if(byUnit)for(;target>0&&isExtendingChar(line.text.charAt(target));)target+=dir;return 0>target||target>line.text.length?null:target}var gecko=/gecko\/\d/i.test(navigator.userAgent),old_ie=/MSIE \d/.test(navigator.userAgent),ie_lt8=old_ie&&(null==document.documentMode||document.documentMode<8),ie_lt9=old_ie&&(null==document.documentMode||document.documentMode<9),ie_lt10=old_ie&&(null==document.documentMode||document.documentMode<10),ie_gt10=/Trident\/([7-9]|\d{2,})\./.test(navigator.userAgent),ie=old_ie||ie_gt10,webkit=/WebKit\//.test(navigator.userAgent),qtwebkit=webkit&&/Qt\/\d+\.\d+/.test(navigator.userAgent),chrome=/Chrome\//.test(navigator.userAgent),opera=/Opera\//.test(navigator.userAgent),safari=/Apple Computer/.test(navigator.vendor),khtml=/KHTML\//.test(navigator.userAgent),mac_geLion=/Mac OS X 1\d\D([7-9]|\d\d)\D/.test(navigator.userAgent),mac_geMountainLion=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(navigator.userAgent),phantom=/PhantomJS/.test(navigator.userAgent),ios=/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent),mobile=ios||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(navigator.userAgent),mac=ios||/Mac/.test(navigator.platform),windows=/win/i.test(navigator.platform),opera_version=opera&&navigator.userAgent.match(/Version\/(\d*\.\d*)/);opera_version&&(opera_version=Number(opera_version[1])),opera_version&&opera_version>=15&&(opera=!1,webkit=!0);var measureText,lastClick,lastDoubleClick,flipCtrlCmd=mac&&(qtwebkit||opera&&(null==opera_version||12.11>opera_version)),captureMiddleClick=gecko||ie&&!ie_lt9,sawReadOnlySpans=!1,sawCollapsedSpans=!1,nextOpId=0,lastDrop=0,wheelSamples=0,wheelPixelsPerUnit=null;ie?wheelPixelsPerUnit=-.53:gecko?wheelPixelsPerUnit=15:chrome?wheelPixelsPerUnit=-.7:safari&&(wheelPixelsPerUnit=-1/3);var maybeTransition,detectingSelectAll,lastStoppedKey=null,changeEnd=CodeMirror.changeEnd=function(change){return change.text?Pos(change.from.line+change.text.length-1,lst(change.text).length+(1==change.text.length?change.from.ch:0)):change.to};CodeMirror.Pos=Pos,CodeMirror.prototype={constructor:CodeMirror,focus:function(){window.focus(),focusInput(this),fastPoll(this)},setOption:function(option,value){var options=this.options,old=options[option];(options[option]!=value||"mode"==option)&&(options[option]=value,optionHandlers.hasOwnProperty(option)&&operation(this,optionHandlers[option])(this,value,old))},getOption:function(option){return this.options[option]},getDoc:function(){return this.doc},addKeyMap:function(map,bottom){this.state.keyMaps[bottom?"push":"unshift"](map)},removeKeyMap:function(map){for(var maps=this.state.keyMaps,i=0;i<maps.length;++i)if(maps[i]==map||"string"!=typeof maps[i]&&maps[i].name==map)return maps.splice(i,1),!0},addOverlay:operation(null,function(spec,options){var mode=spec.token?spec:CodeMirror.getMode(this.options,spec);if(mode.startState)throw new Error("Overlays may not be stateful.");this.state.overlays.push({mode:mode,modeSpec:spec,opaque:options&&options.opaque}),this.state.modeGen++,regChange(this)}),removeOverlay:operation(null,function(spec){for(var overlays=this.state.overlays,i=0;i<overlays.length;++i){var cur=overlays[i].modeSpec;if(cur==spec||"string"==typeof spec&&cur.name==spec)return overlays.splice(i,1),this.state.modeGen++,regChange(this),void 0}}),indentLine:operation(null,function(n,dir,aggressive){"string"!=typeof dir&&"number"!=typeof dir&&(dir=null==dir?this.options.smartIndent?"smart":"prev":dir?"add":"subtract"),isLine(this.doc,n)&&indentLine(this,n,dir,aggressive)}),indentSelection:operation(null,function(how){var sel=this.doc.sel;if(posEq(sel.from,sel.to))return indentLine(this,sel.from.line,how,!0);for(var e=sel.to.line-(sel.to.ch?0:1),i=sel.from.line;e>=i;++i)indentLine(this,i,how)}),getTokenAt:function(pos,precise){var doc=this.doc;pos=clipPos(doc,pos);for(var state=getStateBefore(this,pos.line,precise),mode=this.doc.mode,line=getLine(doc,pos.line),stream=new StringStream(line.text,this.options.tabSize);stream.pos<pos.ch&&!stream.eol();){stream.start=stream.pos;var style=mode.token(stream,state)}return{start:stream.start,end:stream.pos,string:stream.current(),className:style||null,type:style||null,state:state}},getTokenTypeAt:function(pos){pos=clipPos(this.doc,pos);var styles=getLineStyles(this,getLine(this.doc,pos.line)),before=0,after=(styles.length-1)/2,ch=pos.ch;if(0==ch)return styles[2];for(;;){var mid=before+after>>1;if((mid?styles[2*mid-1]:0)>=ch)after=mid;else{if(!(styles[2*mid+1]<ch))return styles[2*mid+2];before=mid+1}}},getModeAt:function(pos){var mode=this.doc.mode;return mode.innerMode?CodeMirror.innerMode(mode,this.getTokenAt(pos).state).mode:mode},getHelper:function(pos,type){return this.getHelpers(pos,type)[0]},getHelpers:function(pos,type){var found=[];if(!helpers.hasOwnProperty(type))return helpers;var help=helpers[type],mode=this.getModeAt(pos);if("string"==typeof mode[type])help[mode[type]]&&found.push(help[mode[type]]);else if(mode[type])for(var i=0;i<mode[type].length;i++){var val=help[mode[type][i]];val&&found.push(val)}else mode.helperType&&help[mode.helperType]?found.push(help[mode.helperType]):help[mode.name]&&found.push(help[mode.name]);for(var i=0;i<help._global.length;i++){var cur=help._global[i];cur.pred(mode,this)&&-1==indexOf(found,cur.val)&&found.push(cur.val)}return found},getStateAfter:function(line,precise){var doc=this.doc;return line=clipLine(doc,null==line?doc.first+doc.size-1:line),getStateBefore(this,line+1,precise)},cursorCoords:function(start,mode){var pos,sel=this.doc.sel;return pos=null==start?sel.head:"object"==typeof start?clipPos(this.doc,start):start?sel.from:sel.to,cursorCoords(this,pos,mode||"page")},charCoords:function(pos,mode){return charCoords(this,clipPos(this.doc,pos),mode||"page")},coordsChar:function(coords,mode){return coords=fromCoordSystem(this,coords,mode||"page"),coordsChar(this,coords.left,coords.top)},lineAtHeight:function(height,mode){return height=fromCoordSystem(this,{top:height,left:0},mode||"page").top,lineAtHeight(this.doc,height+this.display.viewOffset)},heightAtLine:function(line,mode){var end=!1,last=this.doc.first+this.doc.size-1;line<this.doc.first?line=this.doc.first:line>last&&(line=last,end=!0);var lineObj=getLine(this.doc,line);return intoCoordSystem(this,getLine(this.doc,line),{top:0,left:0},mode||"page").top+(end?lineObj.height:0)},defaultTextHeight:function(){return textHeight(this.display)},defaultCharWidth:function(){return charWidth(this.display)},setGutterMarker:operation(null,function(line,gutterID,value){return changeLine(this,line,function(line){var markers=line.gutterMarkers||(line.gutterMarkers={});return markers[gutterID]=value,!value&&isEmpty(markers)&&(line.gutterMarkers=null),!0})}),clearGutter:operation(null,function(gutterID){var cm=this,doc=cm.doc,i=doc.first;doc.iter(function(line){line.gutterMarkers&&line.gutterMarkers[gutterID]&&(line.gutterMarkers[gutterID]=null,regChange(cm,i,i+1),isEmpty(line.gutterMarkers)&&(line.gutterMarkers=null)),++i})}),addLineClass:operation(null,function(handle,where,cls){return changeLine(this,handle,function(line){var prop="text"==where?"textClass":"background"==where?"bgClass":"wrapClass";if(line[prop]){if(new RegExp("(?:^|\\s)"+cls+"(?:$|\\s)").test(line[prop]))return!1;line[prop]+=" "+cls}else line[prop]=cls;return!0})}),removeLineClass:operation(null,function(handle,where,cls){return changeLine(this,handle,function(line){var prop="text"==where?"textClass":"background"==where?"bgClass":"wrapClass",cur=line[prop];if(!cur)return!1;if(null==cls)line[prop]=null;else{var found=cur.match(new RegExp("(?:^|\\s+)"+cls+"(?:$|\\s+)"));if(!found)return!1;var end=found.index+found[0].length;line[prop]=cur.slice(0,found.index)+(found.index&&end!=cur.length?" ":"")+cur.slice(end)||null}return!0})}),addLineWidget:operation(null,function(handle,node,options){return addLineWidget(this,handle,node,options)}),removeLineWidget:function(widget){widget.clear()},lineInfo:function(line){if("number"==typeof line){if(!isLine(this.doc,line))return null;var n=line;if(line=getLine(this.doc,line),!line)return null}else{var n=lineNo(line);if(null==n)return null}return{line:n,handle:line,text:line.text,gutterMarkers:line.gutterMarkers,textClass:line.textClass,bgClass:line.bgClass,wrapClass:line.wrapClass,widgets:line.widgets}},getViewport:function(){return{from:this.display.showingFrom,to:this.display.showingTo}},addWidget:function(pos,node,scroll,vert,horiz){var display=this.display;pos=cursorCoords(this,clipPos(this.doc,pos));var top=pos.bottom,left=pos.left;if(node.style.position="absolute",display.sizer.appendChild(node),"over"==vert)top=pos.top;else if("above"==vert||"near"==vert){var vspace=Math.max(display.wrapper.clientHeight,this.doc.height),hspace=Math.max(display.sizer.clientWidth,display.lineSpace.clientWidth);("above"==vert||pos.bottom+node.offsetHeight>vspace)&&pos.top>node.offsetHeight?top=pos.top-node.offsetHeight:pos.bottom+node.offsetHeight<=vspace&&(top=pos.bottom),left+node.offsetWidth>hspace&&(left=hspace-node.offsetWidth)}node.style.top=top+"px",node.style.left=node.style.right="","right"==horiz?(left=display.sizer.clientWidth-node.offsetWidth,node.style.right="0px"):("left"==horiz?left=0:"middle"==horiz&&(left=(display.sizer.clientWidth-node.offsetWidth)/2),node.style.left=left+"px"),scroll&&scrollIntoView(this,left,top,left+node.offsetWidth,top+node.offsetHeight)},triggerOnKeyDown:operation(null,onKeyDown),triggerOnKeyPress:operation(null,onKeyPress),triggerOnKeyUp:operation(null,onKeyUp),execCommand:function(cmd){return commands.hasOwnProperty(cmd)?commands[cmd](this):void 0},findPosH:function(from,amount,unit,visually){var dir=1;0>amount&&(dir=-1,amount=-amount);for(var i=0,cur=clipPos(this.doc,from);amount>i&&(cur=findPosH(this.doc,cur,dir,unit,visually),!cur.hitSide);++i);return cur},moveH:operation(null,function(dir,unit){var pos,sel=this.doc.sel;pos=sel.shift||sel.extend||posEq(sel.from,sel.to)?findPosH(this.doc,sel.head,dir,unit,this.options.rtlMoveVisually):0>dir?sel.from:sel.to,extendSelection(this.doc,pos,pos,dir)}),deleteH:operation(null,function(dir,unit){var sel=this.doc.sel;posEq(sel.from,sel.to)?replaceRange(this.doc,"",sel.from,findPosH(this.doc,sel.head,dir,unit,!1),"+delete"):replaceRange(this.doc,"",sel.from,sel.to,"+delete"),this.curOp.userSelChange=!0}),findPosV:function(from,amount,unit,goalColumn){var dir=1,x=goalColumn;0>amount&&(dir=-1,amount=-amount);for(var i=0,cur=clipPos(this.doc,from);amount>i;++i){var coords=cursorCoords(this,cur,"div");if(null==x?x=coords.left:coords.left=x,cur=findPosV(this,coords,dir,unit),cur.hitSide)break}return cur},moveV:operation(null,function(dir,unit){var target,goal,sel=this.doc.sel;if(sel.shift||sel.extend||posEq(sel.from,sel.to)){var pos=cursorCoords(this,sel.head,"div");null!=sel.goalColumn&&(pos.left=sel.goalColumn),target=findPosV(this,pos,dir,unit),"page"==unit&&addToScrollPos(this,0,charCoords(this,target,"div").top-pos.top),goal=pos.left}else target=0>dir?sel.from:sel.to;extendSelection(this.doc,target,target,dir),null!=goal&&(sel.goalColumn=goal)}),toggleOverwrite:function(value){(null==value||value!=this.state.overwrite)&&((this.state.overwrite=!this.state.overwrite)?this.display.cursor.className+=" CodeMirror-overwrite":this.display.cursor.className=this.display.cursor.className.replace(" CodeMirror-overwrite",""),signal(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return document.activeElement==this.display.input},scrollTo:operation(null,function(x,y){updateScrollPos(this,x,y)}),getScrollInfo:function(){var scroller=this.display.scroller,co=scrollerCutOff;return{left:scroller.scrollLeft,top:scroller.scrollTop,height:scroller.scrollHeight-co,width:scroller.scrollWidth-co,clientHeight:scroller.clientHeight-co,clientWidth:scroller.clientWidth-co}},scrollIntoView:operation(null,function(range,margin){null==range?range={from:this.doc.sel.head,to:null}:"number"==typeof range?range={from:Pos(range,0),to:null}:null==range.from&&(range={from:range,to:null}),range.to||(range.to=range.from),margin||(margin=0);var coords=range;null!=range.from.line&&(this.curOp.scrollToPos={from:range.from,to:range.to,margin:margin},coords={from:cursorCoords(this,range.from),to:cursorCoords(this,range.to)});var sPos=calculateScrollPos(this,Math.min(coords.from.left,coords.to.left),Math.min(coords.from.top,coords.to.top)-margin,Math.max(coords.from.right,coords.to.right),Math.max(coords.from.bottom,coords.to.bottom)+margin);updateScrollPos(this,sPos.scrollLeft,sPos.scrollTop)}),setSize:operation(null,function(width,height){function interpret(val){return"number"==typeof val||/^\d+$/.test(String(val))?val+"px":val}null!=width&&(this.display.wrapper.style.width=interpret(width)),null!=height&&(this.display.wrapper.style.height=interpret(height)),this.options.lineWrapping&&(this.display.measureLineCache.length=this.display.measureLineCachePos=0),this.curOp.forceUpdate=!0,signal(this,"refresh",this)}),operation:function(f){return runInOp(this,f)},refresh:operation(null,function(){var oldHeight=this.display.cachedTextHeight;clearCaches(this),updateScrollPos(this,this.doc.scrollLeft,this.doc.scrollTop),regChange(this),(null==oldHeight||Math.abs(oldHeight-textHeight(this.display))>.5)&&estimateLineHeights(this),signal(this,"refresh",this)}),swapDoc:operation(null,function(doc){var old=this.doc;return old.cm=null,attachDoc(this,doc),clearCaches(this),resetInput(this,!0),updateScrollPos(this,doc.scrollLeft,doc.scrollTop),signalLater(this,"swapDoc",this,old),old}),getInputField:function(){return this.display.input},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},eventMixin(CodeMirror);var optionHandlers=CodeMirror.optionHandlers={},defaults=CodeMirror.defaults={},Init=CodeMirror.Init={toString:function(){return"CodeMirror.Init"}};option("value","",function(cm,val){cm.setValue(val)},!0),option("mode",null,function(cm,val){cm.doc.modeOption=val,loadMode(cm)},!0),option("indentUnit",2,loadMode,!0),option("indentWithTabs",!1),option("smartIndent",!0),option("tabSize",4,function(cm){resetModeState(cm),clearCaches(cm),regChange(cm)},!0),option("specialChars",/[\t\u0000-\u0019\u00ad\u200b\u2028\u2029\ufeff]/g,function(cm,val){cm.options.specialChars=new RegExp(val.source+(val.test("	")?"":"|	"),"g"),cm.refresh()},!0),option("specialCharPlaceholder",defaultSpecialCharPlaceholder,function(cm){cm.refresh()},!0),option("electricChars",!0),option("rtlMoveVisually",!windows),option("wholeLineUpdateBefore",!0),option("theme","default",function(cm){themeChanged(cm),guttersChanged(cm)},!0),option("keyMap","default",keyMapChanged),option("extraKeys",null),option("onKeyEvent",null),option("onDragEvent",null),option("lineWrapping",!1,wrappingChanged,!0),option("gutters",[],function(cm){setGuttersForLineNumbers(cm.options),guttersChanged(cm)},!0),option("fixedGutter",!0,function(cm,val){cm.display.gutters.style.left=val?compensateForHScroll(cm.display)+"px":"0",cm.refresh()},!0),option("coverGutterNextToScrollbar",!1,updateScrollbars,!0),option("lineNumbers",!1,function(cm){setGuttersForLineNumbers(cm.options),guttersChanged(cm)
},!0),option("firstLineNumber",1,guttersChanged,!0),option("lineNumberFormatter",function(integer){return integer},guttersChanged,!0),option("showCursorWhenSelecting",!1,updateSelection,!0),option("resetSelectionOnContextMenu",!0),option("readOnly",!1,function(cm,val){"nocursor"==val?(onBlur(cm),cm.display.input.blur(),cm.display.disabled=!0):(cm.display.disabled=!1,val||resetInput(cm,!0))}),option("disableInput",!1,function(cm,val){val||resetInput(cm,!0)},!0),option("dragDrop",!0),option("cursorBlinkRate",530),option("cursorScrollMargin",0),option("cursorHeight",1),option("workTime",100),option("workDelay",100),option("flattenSpans",!0,resetModeState,!0),option("addModeClass",!1,resetModeState,!0),option("pollInterval",100),option("undoDepth",40,function(cm,val){cm.doc.history.undoDepth=val}),option("historyEventDelay",500),option("viewportMargin",10,function(cm){cm.refresh()},!0),option("maxHighlightLength",1e4,resetModeState,!0),option("crudeMeasuringFrom",1e4),option("moveInputWithCursor",!0,function(cm,val){val||(cm.display.inputDiv.style.top=cm.display.inputDiv.style.left=0)}),option("tabindex",null,function(cm,val){cm.display.input.tabIndex=val||""}),option("autofocus",null);var modes=CodeMirror.modes={},mimeModes=CodeMirror.mimeModes={};CodeMirror.defineMode=function(name,mode){if(CodeMirror.defaults.mode||"null"==name||(CodeMirror.defaults.mode=name),arguments.length>2){mode.dependencies=[];for(var i=2;i<arguments.length;++i)mode.dependencies.push(arguments[i])}modes[name]=mode},CodeMirror.defineMIME=function(mime,spec){mimeModes[mime]=spec},CodeMirror.resolveMode=function(spec){if("string"==typeof spec&&mimeModes.hasOwnProperty(spec))spec=mimeModes[spec];else if(spec&&"string"==typeof spec.name&&mimeModes.hasOwnProperty(spec.name)){var found=mimeModes[spec.name];"string"==typeof found&&(found={name:found}),spec=createObj(found,spec),spec.name=found.name}else if("string"==typeof spec&&/^[\w\-]+\/[\w\-]+\+xml$/.test(spec))return CodeMirror.resolveMode("application/xml");return"string"==typeof spec?{name:spec}:spec||{name:"null"}},CodeMirror.getMode=function(options,spec){var spec=CodeMirror.resolveMode(spec),mfactory=modes[spec.name];if(!mfactory)return CodeMirror.getMode(options,"text/plain");var modeObj=mfactory(options,spec);if(modeExtensions.hasOwnProperty(spec.name)){var exts=modeExtensions[spec.name];for(var prop in exts)exts.hasOwnProperty(prop)&&(modeObj.hasOwnProperty(prop)&&(modeObj["_"+prop]=modeObj[prop]),modeObj[prop]=exts[prop])}if(modeObj.name=spec.name,spec.helperType&&(modeObj.helperType=spec.helperType),spec.modeProps)for(var prop in spec.modeProps)modeObj[prop]=spec.modeProps[prop];return modeObj},CodeMirror.defineMode("null",function(){return{token:function(stream){stream.skipToEnd()}}}),CodeMirror.defineMIME("text/plain","null");var modeExtensions=CodeMirror.modeExtensions={};CodeMirror.extendMode=function(mode,properties){var exts=modeExtensions.hasOwnProperty(mode)?modeExtensions[mode]:modeExtensions[mode]={};copyObj(properties,exts)},CodeMirror.defineExtension=function(name,func){CodeMirror.prototype[name]=func},CodeMirror.defineDocExtension=function(name,func){Doc.prototype[name]=func},CodeMirror.defineOption=option;var initHooks=[];CodeMirror.defineInitHook=function(f){initHooks.push(f)};var helpers=CodeMirror.helpers={};CodeMirror.registerHelper=function(type,name,value){helpers.hasOwnProperty(type)||(helpers[type]=CodeMirror[type]={_global:[]}),helpers[type][name]=value},CodeMirror.registerGlobalHelper=function(type,name,predicate,value){CodeMirror.registerHelper(type,name,value),helpers[type]._global.push({pred:predicate,val:value})},CodeMirror.isWordChar=isWordChar,CodeMirror.copyState=copyState,CodeMirror.startState=startState,CodeMirror.innerMode=function(mode,state){for(;mode.innerMode;){var info=mode.innerMode(state);if(!info||info.mode==mode)break;state=info.state,mode=info.mode}return info||{mode:mode,state:state}};var commands=CodeMirror.commands={selectAll:function(cm){cm.setSelection(Pos(cm.firstLine(),0),Pos(cm.lastLine()))},killLine:function(cm){var from=cm.getCursor(!0),to=cm.getCursor(!1),sel=!posEq(from,to);sel||cm.getLine(from.line).length!=from.ch?cm.replaceRange("",from,sel?to:Pos(from.line),"+delete"):cm.replaceRange("",from,Pos(from.line+1,0),"+delete")},deleteLine:function(cm){var l=cm.getCursor().line;cm.replaceRange("",Pos(l,0),Pos(l+1,0),"+delete")},delLineLeft:function(cm){var cur=cm.getCursor();cm.replaceRange("",Pos(cur.line,0),cur,"+delete")},undo:function(cm){cm.undo()},redo:function(cm){cm.redo()},goDocStart:function(cm){cm.extendSelection(Pos(cm.firstLine(),0))},goDocEnd:function(cm){cm.extendSelection(Pos(cm.lastLine()))},goLineStart:function(cm){cm.extendSelection(lineStart(cm,cm.getCursor().line))},goLineStartSmart:function(cm){var cur=cm.getCursor(),start=lineStart(cm,cur.line),line=cm.getLineHandle(start.line),order=getOrder(line);if(order&&0!=order[0].level)cm.extendSelection(start);else{var firstNonWS=Math.max(0,line.text.search(/\S/)),inWS=cur.line==start.line&&cur.ch<=firstNonWS&&cur.ch;cm.extendSelection(Pos(start.line,inWS?0:firstNonWS))}},goLineEnd:function(cm){cm.extendSelection(lineEnd(cm,cm.getCursor().line))},goLineRight:function(cm){var top=cm.charCoords(cm.getCursor(),"div").top+5;cm.extendSelection(cm.coordsChar({left:cm.display.lineDiv.offsetWidth+100,top:top},"div"))},goLineLeft:function(cm){var top=cm.charCoords(cm.getCursor(),"div").top+5;cm.extendSelection(cm.coordsChar({left:0,top:top},"div"))},goLineUp:function(cm){cm.moveV(-1,"line")},goLineDown:function(cm){cm.moveV(1,"line")},goPageUp:function(cm){cm.moveV(-1,"page")},goPageDown:function(cm){cm.moveV(1,"page")},goCharLeft:function(cm){cm.moveH(-1,"char")},goCharRight:function(cm){cm.moveH(1,"char")},goColumnLeft:function(cm){cm.moveH(-1,"column")},goColumnRight:function(cm){cm.moveH(1,"column")},goWordLeft:function(cm){cm.moveH(-1,"word")},goGroupRight:function(cm){cm.moveH(1,"group")},goGroupLeft:function(cm){cm.moveH(-1,"group")},goWordRight:function(cm){cm.moveH(1,"word")},delCharBefore:function(cm){cm.deleteH(-1,"char")},delCharAfter:function(cm){cm.deleteH(1,"char")},delWordBefore:function(cm){cm.deleteH(-1,"word")},delWordAfter:function(cm){cm.deleteH(1,"word")},delGroupBefore:function(cm){cm.deleteH(-1,"group")},delGroupAfter:function(cm){cm.deleteH(1,"group")},indentAuto:function(cm){cm.indentSelection("smart")},indentMore:function(cm){cm.indentSelection("add")},indentLess:function(cm){cm.indentSelection("subtract")},insertTab:function(cm){cm.replaceSelection("	","end","+input")},defaultTab:function(cm){cm.somethingSelected()?cm.indentSelection("add"):cm.replaceSelection("	","end","+input")},transposeChars:function(cm){var cur=cm.getCursor(),line=cm.getLine(cur.line);cur.ch>0&&cur.ch<line.length-1&&cm.replaceRange(line.charAt(cur.ch)+line.charAt(cur.ch-1),Pos(cur.line,cur.ch-1),Pos(cur.line,cur.ch+1))},newlineAndIndent:function(cm){operation(cm,function(){cm.replaceSelection("\n","end","+input"),cm.indentLine(cm.getCursor().line,null,!0)})()},toggleOverwrite:function(cm){cm.toggleOverwrite()}},keyMap=CodeMirror.keyMap={};keyMap.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite"},keyMap.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-Up":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Down":"goDocEnd","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore",fallthrough:"basic"},keyMap.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineStart","Cmd-Right":"goLineEnd","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delLineLeft",fallthrough:["basic","emacsy"]},keyMap["default"]=mac?keyMap.macDefault:keyMap.pcDefault,keyMap.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars"},CodeMirror.lookupKey=lookupKey,CodeMirror.isModifierKey=isModifierKey,CodeMirror.keyName=keyName,CodeMirror.fromTextArea=function(textarea,options){function save(){textarea.value=cm.getValue()}if(options||(options={}),options.value=textarea.value,!options.tabindex&&textarea.tabindex&&(options.tabindex=textarea.tabindex),!options.placeholder&&textarea.placeholder&&(options.placeholder=textarea.placeholder),null==options.autofocus){var hasFocus=document.body;try{hasFocus=document.activeElement}catch(e){}options.autofocus=hasFocus==textarea||null!=textarea.getAttribute("autofocus")&&hasFocus==document.body}if(textarea.form&&(on(textarea.form,"submit",save),!options.leaveSubmitMethodAlone)){var form=textarea.form,realSubmit=form.submit;try{var wrappedSubmit=form.submit=function(){save(),form.submit=realSubmit,form.submit(),form.submit=wrappedSubmit}}catch(e){}}textarea.style.display="none";var cm=CodeMirror(function(node){textarea.parentNode.insertBefore(node,textarea.nextSibling)},options);return cm.save=save,cm.getTextArea=function(){return textarea},cm.toTextArea=function(){save(),textarea.parentNode.removeChild(cm.getWrapperElement()),textarea.style.display="",textarea.form&&(off(textarea.form,"submit",save),"function"==typeof textarea.form.submit&&(textarea.form.submit=realSubmit))},cm},StringStream.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==this.lineStart},peek:function(){return this.string.charAt(this.pos)||void 0},next:function(){return this.pos<this.string.length?this.string.charAt(this.pos++):void 0},eat:function(match){var ch=this.string.charAt(this.pos);if("string"==typeof match)var ok=ch==match;else var ok=ch&&(match.test?match.test(ch):match(ch));return ok?(++this.pos,ch):void 0},eatWhile:function(match){for(var start=this.pos;this.eat(match););return this.pos>start},eatSpace:function(){for(var start=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>start},skipToEnd:function(){this.pos=this.string.length},skipTo:function(ch){var found=this.string.indexOf(ch,this.pos);return found>-1?(this.pos=found,!0):void 0},backUp:function(n){this.pos-=n},column:function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?countColumn(this.string,this.lineStart,this.tabSize):0)},indentation:function(){return countColumn(this.string,null,this.tabSize)-(this.lineStart?countColumn(this.string,this.lineStart,this.tabSize):0)},match:function(pattern,consume,caseInsensitive){if("string"!=typeof pattern){var match=this.string.slice(this.pos).match(pattern);return match&&match.index>0?null:(match&&consume!==!1&&(this.pos+=match[0].length),match)}var cased=function(str){return caseInsensitive?str.toLowerCase():str},substr=this.string.substr(this.pos,pattern.length);return cased(substr)==cased(pattern)?(consume!==!1&&(this.pos+=pattern.length),!0):void 0},current:function(){return this.string.slice(this.start,this.pos)},hideFirstChars:function(n,inner){this.lineStart+=n;try{return inner()}finally{this.lineStart-=n}}},CodeMirror.StringStream=StringStream,CodeMirror.TextMarker=TextMarker,eventMixin(TextMarker),TextMarker.prototype.clear=function(){if(!this.explicitlyCleared){var cm=this.doc.cm,withOp=cm&&!cm.curOp;if(withOp&&startOperation(cm),hasHandler(this,"clear")){var found=this.find();found&&signalLater(this,"clear",found.from,found.to)}for(var min=null,max=null,i=0;i<this.lines.length;++i){var line=this.lines[i],span=getMarkedSpanFor(line.markedSpans,this);null!=span.to&&(max=lineNo(line)),line.markedSpans=removeMarkedSpan(line.markedSpans,span),null!=span.from?min=lineNo(line):this.collapsed&&!lineIsHidden(this.doc,line)&&cm&&updateLineHeight(line,textHeight(cm.display))}if(cm&&this.collapsed&&!cm.options.lineWrapping)for(var i=0;i<this.lines.length;++i){var visual=visualLine(cm.doc,this.lines[i]),len=lineLength(cm.doc,visual);len>cm.display.maxLineLength&&(cm.display.maxLine=visual,cm.display.maxLineLength=len,cm.display.maxLineChanged=!0)}null!=min&&cm&&regChange(cm,min,max+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,cm&&reCheckSelection(cm)),withOp&&endOperation(cm)}},TextMarker.prototype.find=function(bothSides){for(var from,to,i=0;i<this.lines.length;++i){var line=this.lines[i],span=getMarkedSpanFor(line.markedSpans,this);if(null!=span.from||null!=span.to){var found=lineNo(line);null!=span.from&&(from=Pos(found,span.from)),null!=span.to&&(to=Pos(found,span.to))}}return"bookmark"!=this.type||bothSides?from&&{from:from,to:to}:from},TextMarker.prototype.changed=function(){var pos=this.find(),cm=this.doc.cm;if(pos&&cm){"bookmark"!=this.type&&(pos=pos.from);var line=getLine(this.doc,pos.line);if(clearCachedMeasurement(cm,line),pos.line>=cm.display.showingFrom&&pos.line<cm.display.showingTo){for(var node=cm.display.lineDiv.firstChild;node;node=node.nextSibling)if(node.lineObj==line){node.offsetHeight!=line.height&&updateLineHeight(line,node.offsetHeight);break}runInOp(cm,function(){cm.curOp.selectionChanged=cm.curOp.forceUpdate=cm.curOp.updateMaxLine=!0})}}},TextMarker.prototype.attachLine=function(line){if(!this.lines.length&&this.doc.cm){var op=this.doc.cm.curOp;op.maybeHiddenMarkers&&-1!=indexOf(op.maybeHiddenMarkers,this)||(op.maybeUnhiddenMarkers||(op.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(line)},TextMarker.prototype.detachLine=function(line){if(this.lines.splice(indexOf(this.lines,line),1),!this.lines.length&&this.doc.cm){var op=this.doc.cm.curOp;(op.maybeHiddenMarkers||(op.maybeHiddenMarkers=[])).push(this)}};var nextMarkerId=0;CodeMirror.SharedTextMarker=SharedTextMarker,eventMixin(SharedTextMarker),SharedTextMarker.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var i=0;i<this.markers.length;++i)this.markers[i].clear();signalLater(this,"clear")}},SharedTextMarker.prototype.find=function(){return this.primary.find()};var LineWidget=CodeMirror.LineWidget=function(cm,node,options){if(options)for(var opt in options)options.hasOwnProperty(opt)&&(this[opt]=options[opt]);this.cm=cm,this.node=node};eventMixin(LineWidget),LineWidget.prototype.clear=widgetOperation(function(){var ws=this.line.widgets,no=lineNo(this.line);if(null!=no&&ws){for(var i=0;i<ws.length;++i)ws[i]==this&&ws.splice(i--,1);ws.length||(this.line.widgets=null);var aboveVisible=heightAtLine(this.cm,this.line)<this.cm.doc.scrollTop;updateLineHeight(this.line,Math.max(0,this.line.height-widgetHeight(this))),aboveVisible&&addToScrollPos(this.cm,0,-this.height),regChange(this.cm,no,no+1)}}),LineWidget.prototype.changed=widgetOperation(function(){var oldH=this.height;this.height=null;var diff=widgetHeight(this)-oldH;if(diff){updateLineHeight(this.line,this.line.height+diff);var no=lineNo(this.line);regChange(this.cm,no,no+1)}});var Line=CodeMirror.Line=function(text,markedSpans,estimateHeight){this.text=text,attachMarkedSpans(this,markedSpans),this.height=estimateHeight?estimateHeight(this):1};eventMixin(Line),Line.prototype.lineNo=function(){return lineNo(this)};var styleToClassCache={},styleToClassCacheWithMode={};LeafChunk.prototype={chunkSize:function(){return this.lines.length},removeInner:function(at,n){for(var i=at,e=at+n;e>i;++i){var line=this.lines[i];this.height-=line.height,cleanUpLine(line),signalLater(line,"delete")}this.lines.splice(at,n)},collapse:function(lines){lines.splice.apply(lines,[lines.length,0].concat(this.lines))},insertInner:function(at,lines,height){this.height+=height,this.lines=this.lines.slice(0,at).concat(lines).concat(this.lines.slice(at));for(var i=0,e=lines.length;e>i;++i)lines[i].parent=this},iterN:function(at,n,op){for(var e=at+n;e>at;++at)if(op(this.lines[at]))return!0}},BranchChunk.prototype={chunkSize:function(){return this.size},removeInner:function(at,n){this.size-=n;for(var i=0;i<this.children.length;++i){var child=this.children[i],sz=child.chunkSize();if(sz>at){var rm=Math.min(n,sz-at),oldHeight=child.height;if(child.removeInner(at,rm),this.height-=oldHeight-child.height,sz==rm&&(this.children.splice(i--,1),child.parent=null),0==(n-=rm))break;at=0}else at-=sz}if(this.size-n<25){var lines=[];this.collapse(lines),this.children=[new LeafChunk(lines)],this.children[0].parent=this}},collapse:function(lines){for(var i=0,e=this.children.length;e>i;++i)this.children[i].collapse(lines)},insertInner:function(at,lines,height){this.size+=lines.length,this.height+=height;for(var i=0,e=this.children.length;e>i;++i){var child=this.children[i],sz=child.chunkSize();if(sz>=at){if(child.insertInner(at,lines,height),child.lines&&child.lines.length>50){for(;child.lines.length>50;){var spilled=child.lines.splice(child.lines.length-25,25),newleaf=new LeafChunk(spilled);child.height-=newleaf.height,this.children.splice(i+1,0,newleaf),newleaf.parent=this}this.maybeSpill()}break}at-=sz}},maybeSpill:function(){if(!(this.children.length<=10)){var me=this;do{var spilled=me.children.splice(me.children.length-5,5),sibling=new BranchChunk(spilled);if(me.parent){me.size-=sibling.size,me.height-=sibling.height;var myIndex=indexOf(me.parent.children,me);me.parent.children.splice(myIndex+1,0,sibling)}else{var copy=new BranchChunk(me.children);copy.parent=me,me.children=[copy,sibling],me=copy}sibling.parent=me.parent}while(me.children.length>10);me.parent.maybeSpill()}},iterN:function(at,n,op){for(var i=0,e=this.children.length;e>i;++i){var child=this.children[i],sz=child.chunkSize();if(sz>at){var used=Math.min(n,sz-at);if(child.iterN(at,used,op))return!0;if(0==(n-=used))break;at=0}else at-=sz}}};var nextDocId=0,Doc=CodeMirror.Doc=function(text,mode,firstLine){if(!(this instanceof Doc))return new Doc(text,mode,firstLine);null==firstLine&&(firstLine=0),BranchChunk.call(this,[new LeafChunk([new Line("",null)])]),this.first=firstLine,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.history=makeHistory(),this.cleanGeneration=1,this.frontier=firstLine;var start=Pos(firstLine,0);this.sel={from:start,to:start,head:start,anchor:start,shift:!1,extend:!1,goalColumn:null},this.id=++nextDocId,this.modeOption=mode,"string"==typeof text&&(text=splitLines(text)),updateDoc(this,{from:start,to:start,text:text},null,{head:start,anchor:start})};Doc.prototype=createObj(BranchChunk.prototype,{constructor:Doc,iter:function(from,to,op){op?this.iterN(from-this.first,to-from,op):this.iterN(this.first,this.first+this.size,from)},insert:function(at,lines){for(var height=0,i=0,e=lines.length;e>i;++i)height+=lines[i].height;this.insertInner(at-this.first,lines,height)},remove:function(at,n){this.removeInner(at-this.first,n)},getValue:function(lineSep){var lines=getLines(this,this.first,this.first+this.size);return lineSep===!1?lines:lines.join(lineSep||"\n")},setValue:function(code){var top=Pos(this.first,0),last=this.first+this.size-1;makeChange(this,{from:top,to:Pos(last,getLine(this,last).text.length),text:splitLines(code),origin:"setValue"},{head:top,anchor:top},!0)},replaceRange:function(code,from,to,origin){from=clipPos(this,from),to=to?clipPos(this,to):from,replaceRange(this,code,from,to,origin)},getRange:function(from,to,lineSep){var lines=getBetween(this,clipPos(this,from),clipPos(this,to));return lineSep===!1?lines:lines.join(lineSep||"\n")},getLine:function(line){var l=this.getLineHandle(line);return l&&l.text},setLine:function(line,text){isLine(this,line)&&replaceRange(this,text,Pos(line,0),clipPos(this,Pos(line)))},removeLine:function(line){line?replaceRange(this,"",clipPos(this,Pos(line-1)),clipPos(this,Pos(line))):replaceRange(this,"",Pos(0,0),clipPos(this,Pos(1,0)))},getLineHandle:function(line){return isLine(this,line)?getLine(this,line):void 0},getLineNumber:function(line){return lineNo(line)},getLineHandleVisualStart:function(line){return"number"==typeof line&&(line=getLine(this,line)),visualLine(this,line)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(pos){return clipPos(this,pos)},getCursor:function(start){var pos,sel=this.sel;return pos=null==start||"head"==start?sel.head:"anchor"==start?sel.anchor:"end"==start||start===!1?sel.to:sel.from,copyPos(pos)},somethingSelected:function(){return!posEq(this.sel.head,this.sel.anchor)},setCursor:docOperation(function(line,ch,extend){var pos=clipPos(this,"number"==typeof line?Pos(line,ch||0):line);extend?extendSelection(this,pos):setSelection(this,pos,pos)}),setSelection:docOperation(function(anchor,head,bias){setSelection(this,clipPos(this,anchor),clipPos(this,head||anchor),bias)}),extendSelection:docOperation(function(from,to,bias){extendSelection(this,clipPos(this,from),to&&clipPos(this,to),bias)}),getSelection:function(lineSep){return this.getRange(this.sel.from,this.sel.to,lineSep)},replaceSelection:function(code,collapse,origin){makeChange(this,{from:this.sel.from,to:this.sel.to,text:splitLines(code),origin:origin},collapse||"around")},undo:docOperation(function(){makeChangeFromHistory(this,"undo")}),redo:docOperation(function(){makeChangeFromHistory(this,"redo")}),setExtending:function(val){this.sel.extend=val},historySize:function(){var hist=this.history;return{undo:hist.done.length,redo:hist.undone.length}},clearHistory:function(){this.history=makeHistory(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(forceSplit){return forceSplit&&(this.history.lastOp=this.history.lastOrigin=null),this.history.generation},isClean:function(gen){return this.history.generation==(gen||this.cleanGeneration)},getHistory:function(){return{done:copyHistoryArray(this.history.done),undone:copyHistoryArray(this.history.undone)}},setHistory:function(histData){var hist=this.history=makeHistory(this.history.maxGeneration);hist.done=histData.done.slice(0),hist.undone=histData.undone.slice(0)},markText:function(from,to,options){return markText(this,clipPos(this,from),clipPos(this,to),options,"range")},setBookmark:function(pos,options){var realOpts={replacedWith:options&&(null==options.nodeType?options.widget:options),insertLeft:options&&options.insertLeft,clearWhenEmpty:!1};return pos=clipPos(this,pos),markText(this,pos,pos,realOpts,"bookmark")},findMarksAt:function(pos){pos=clipPos(this,pos);var markers=[],spans=getLine(this,pos.line).markedSpans;if(spans)for(var i=0;i<spans.length;++i){var span=spans[i];(null==span.from||span.from<=pos.ch)&&(null==span.to||span.to>=pos.ch)&&markers.push(span.marker.parent||span.marker)}return markers},findMarks:function(from,to){from=clipPos(this,from),to=clipPos(this,to);var found=[],lineNo=from.line;return this.iter(from.line,to.line+1,function(line){var spans=line.markedSpans;if(spans)for(var i=0;i<spans.length;i++){var span=spans[i];lineNo==from.line&&from.ch>span.to||null==span.from&&lineNo!=from.line||lineNo==to.line&&span.from>to.ch||found.push(span.marker.parent||span.marker)}++lineNo}),found},getAllMarks:function(){var markers=[];return this.iter(function(line){var sps=line.markedSpans;if(sps)for(var i=0;i<sps.length;++i)null!=sps[i].from&&markers.push(sps[i].marker)}),markers},posFromIndex:function(off){var ch,lineNo=this.first;return this.iter(function(line){var sz=line.text.length+1;return sz>off?(ch=off,!0):(off-=sz,++lineNo,void 0)}),clipPos(this,Pos(lineNo,ch))},indexFromPos:function(coords){coords=clipPos(this,coords);var index=coords.ch;return coords.line<this.first||coords.ch<0?0:(this.iter(this.first,coords.line,function(line){index+=line.text.length+1}),index)},copy:function(copyHistory){var doc=new Doc(getLines(this,this.first,this.first+this.size),this.modeOption,this.first);return doc.scrollTop=this.scrollTop,doc.scrollLeft=this.scrollLeft,doc.sel={from:this.sel.from,to:this.sel.to,head:this.sel.head,anchor:this.sel.anchor,shift:this.sel.shift,extend:!1,goalColumn:this.sel.goalColumn},copyHistory&&(doc.history.undoDepth=this.history.undoDepth,doc.setHistory(this.getHistory())),doc},linkedDoc:function(options){options||(options={});var from=this.first,to=this.first+this.size;null!=options.from&&options.from>from&&(from=options.from),null!=options.to&&options.to<to&&(to=options.to);var copy=new Doc(getLines(this,from,to),options.mode||this.modeOption,from);return options.sharedHist&&(copy.history=this.history),(this.linked||(this.linked=[])).push({doc:copy,sharedHist:options.sharedHist}),copy.linked=[{doc:this,isParent:!0,sharedHist:options.sharedHist}],copy},unlinkDoc:function(other){if(other instanceof CodeMirror&&(other=other.doc),this.linked)for(var i=0;i<this.linked.length;++i){var link=this.linked[i];if(link.doc==other){this.linked.splice(i,1),other.unlinkDoc(this);break}}if(other.history==this.history){var splitIds=[other.id];linkedDocs(other,function(doc){splitIds.push(doc.id)},!0),other.history=makeHistory(),other.history.done=copyHistoryArray(this.history.done,splitIds),other.history.undone=copyHistoryArray(this.history.undone,splitIds)}},iterLinkedDocs:function(f){linkedDocs(this,f)},getMode:function(){return this.mode},getEditor:function(){return this.cm}}),Doc.prototype.eachLine=Doc.prototype.iter;var dontDelegate="iter insert remove copy getEditor".split(" ");for(var prop in Doc.prototype)Doc.prototype.hasOwnProperty(prop)&&indexOf(dontDelegate,prop)<0&&(CodeMirror.prototype[prop]=function(method){return function(){return method.apply(this.doc,arguments)}}(Doc.prototype[prop]));eventMixin(Doc),CodeMirror.e_stop=e_stop,CodeMirror.e_preventDefault=e_preventDefault,CodeMirror.e_stopPropagation=e_stopPropagation;var delayedCallbacks,delayedCallbackDepth=0;CodeMirror.on=on,CodeMirror.off=off,CodeMirror.signal=signal;var scrollerCutOff=30,Pass=CodeMirror.Pass={toString:function(){return"CodeMirror.Pass"}};Delayed.prototype={set:function(ms,f){clearTimeout(this.id),this.id=setTimeout(f,ms)}},CodeMirror.countColumn=countColumn;var spaceStrs=[""],nonASCIISingleCaseWordChar=/[\u00df\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,extendingChars=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;CodeMirror.replaceGetRect=function(f){getRect=f};var dragAndDrop=function(){if(ie_lt9)return!1;var div=elt("div");return"draggable"in div||"dragDrop"in div}();gecko?spanAffectsWrapping=function(str,i){return 36==str.charCodeAt(i-1)&&39==str.charCodeAt(i)}:safari&&!/Version\/([6-9]|\d\d)\b/.test(navigator.userAgent)?spanAffectsWrapping=function(str,i){return/\-[^ \-?]|\?[^ !\'\"\),.\-\/:;\?\]\}]/.test(str.slice(i-1,i+1))}:webkit&&/Chrome\/(?:29|[3-9]\d|\d\d\d)\./.test(navigator.userAgent)?spanAffectsWrapping=function(str,i){var code=str.charCodeAt(i-1);return code>=8208&&8212>=code}:webkit&&(spanAffectsWrapping=function(str,i){if(i>1&&45==str.charCodeAt(i-1)){if(/\w/.test(str.charAt(i-2))&&/[^\-?\.]/.test(str.charAt(i)))return!0;if(i>2&&/[\d\.,]/.test(str.charAt(i-2))&&/[\d\.,]/.test(str.charAt(i)))return!1}return/[~!#%&*)=+}\]\\|\"\.>,:;][({[<]|-[^\-?\.\u2010-\u201f\u2026]|\?[\w~`@#$%\^&*(_=+{[|><]|\u2026[\w~`@#$%\^&*(_=+{[><]/.test(str.slice(i-1,i+1))});var knownScrollbarWidth,zwspSupported,splitLines=3!="\n\nb".split(/\n/).length?function(string){for(var pos=0,result=[],l=string.length;l>=pos;){var nl=string.indexOf("\n",pos);-1==nl&&(nl=string.length);var line=string.slice(pos,"\r"==string.charAt(nl-1)?nl-1:nl),rt=line.indexOf("\r");-1!=rt?(result.push(line.slice(0,rt)),pos+=rt+1):(result.push(line),pos=nl+1)}return result}:function(string){return string.split(/\r\n?|\n/)};CodeMirror.splitLines=splitLines;var hasSelection=window.getSelection?function(te){try{return te.selectionStart!=te.selectionEnd}catch(e){return!1}}:function(te){try{var range=te.ownerDocument.selection.createRange()}catch(e){}return range&&range.parentElement()==te?0!=range.compareEndPoints("StartToEnd",range):!1},hasCopyEvent=function(){var e=elt("div");return"oncopy"in e?!0:(e.setAttribute("oncopy","return;"),"function"==typeof e.oncopy)}(),keyNames={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",107:"=",109:"-",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"};CodeMirror.keyNames=keyNames,function(){for(var i=0;10>i;i++)keyNames[i+48]=keyNames[i+96]=String(i);for(var i=65;90>=i;i++)keyNames[i]=String.fromCharCode(i);for(var i=1;12>=i;i++)keyNames[i+111]=keyNames[i+63235]="F"+i}();var bidiOther,bidiOrdering=function(){function charType(code){return 255>=code?lowTypes.charAt(code):code>=1424&&1524>=code?"R":code>=1536&&1791>=code?arabicTypes.charAt(code-1536):code>=1792&&2220>=code?"r":"L"}var lowTypes="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLL",arabicTypes="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmmrrrrrrrrrrrrrrrrrr",bidiRE=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,isNeutral=/[stwN]/,isStrong=/[LRr]/,countsAsLeft=/[Lb1n]/,countsAsNum=/[1n]/,outerType="L";return function(str){if(!bidiRE.test(str))return!1;for(var type,len=str.length,types=[],i=0;len>i;++i)types.push(type=charType(str.charCodeAt(i)));for(var i=0,prev=outerType;len>i;++i){var type=types[i];
"m"==type?types[i]=prev:prev=type}for(var i=0,cur=outerType;len>i;++i){var type=types[i];"1"==type&&"r"==cur?types[i]="n":isStrong.test(type)&&(cur=type,"r"==type&&(types[i]="R"))}for(var i=1,prev=types[0];len-1>i;++i){var type=types[i];"+"==type&&"1"==prev&&"1"==types[i+1]?types[i]="1":","!=type||prev!=types[i+1]||"1"!=prev&&"n"!=prev||(types[i]=prev),prev=type}for(var i=0;len>i;++i){var type=types[i];if(","==type)types[i]="N";else if("%"==type){for(var end=i+1;len>end&&"%"==types[end];++end);for(var replace=i&&"!"==types[i-1]||len>end&&"1"==types[end]?"1":"N",j=i;end>j;++j)types[j]=replace;i=end-1}}for(var i=0,cur=outerType;len>i;++i){var type=types[i];"L"==cur&&"1"==type?types[i]="L":isStrong.test(type)&&(cur=type)}for(var i=0;len>i;++i)if(isNeutral.test(types[i])){for(var end=i+1;len>end&&isNeutral.test(types[end]);++end);for(var before="L"==(i?types[i-1]:outerType),after="L"==(len>end?types[end]:outerType),replace=before||after?"L":"R",j=i;end>j;++j)types[j]=replace;i=end-1}for(var m,order=[],i=0;len>i;)if(countsAsLeft.test(types[i])){var start=i;for(++i;len>i&&countsAsLeft.test(types[i]);++i);order.push({from:start,to:i,level:0})}else{var pos=i,at=order.length;for(++i;len>i&&"L"!=types[i];++i);for(var j=pos;i>j;)if(countsAsNum.test(types[j])){j>pos&&order.splice(at,0,{from:pos,to:j,level:1});var nstart=j;for(++j;i>j&&countsAsNum.test(types[j]);++j);order.splice(at,0,{from:nstart,to:j,level:2}),pos=j}else++j;i>pos&&order.splice(at,0,{from:pos,to:i,level:1})}return 1==order[0].level&&(m=str.match(/^\s+/))&&(order[0].from=m[0].length,order.unshift({from:0,to:m[0].length,level:0})),1==lst(order).level&&(m=str.match(/\s+$/))&&(lst(order).to-=m[0].length,order.push({from:len-m[0].length,to:len,level:0})),order[0].level!=lst(order).level&&order.push({from:len,to:len,level:order[0].level}),order}}();return CodeMirror.version="3.22.0",CodeMirror}(),CodeMirror.defineMode("xml",function(config,parserConfig){function inText(stream,state){function chain(parser){return state.tokenize=parser,parser(stream,state)}var ch=stream.next();if("<"==ch){if(stream.eat("!"))return stream.eat("[")?stream.match("CDATA[")?chain(inBlock("atom","]]>")):null:stream.match("--")?chain(inBlock("comment","-->")):stream.match("DOCTYPE",!0,!0)?(stream.eatWhile(/[\w\._\-]/),chain(doctype(1))):null;if(stream.eat("?"))return stream.eatWhile(/[\w\._\-]/),state.tokenize=inBlock("meta","?>"),"meta";var isClose=stream.eat("/");tagName="";for(var c;c=stream.eat(/[^\s\u00a0=<>\"\'\/?]/);)tagName+=c;return tagName?(type=isClose?"closeTag":"openTag",state.tokenize=inTag,"tag"):"tag error"}if("&"==ch){var ok;return ok=stream.eat("#")?stream.eat("x")?stream.eatWhile(/[a-fA-F\d]/)&&stream.eat(";"):stream.eatWhile(/[\d]/)&&stream.eat(";"):stream.eatWhile(/[\w\.\-:]/)&&stream.eat(";"),ok?"atom":"error"}return stream.eatWhile(/[^&<]/),null}function inTag(stream,state){var ch=stream.next();if(">"==ch||"/"==ch&&stream.eat(">"))return state.tokenize=inText,type=">"==ch?"endTag":"selfcloseTag","tag";if("="==ch)return type="equals",null;if("<"==ch){state.tokenize=inText,state.state=baseState,state.tagName=state.tagStart=null;var next=state.tokenize(stream,state);return next?next+" error":"error"}return/[\'\"]/.test(ch)?(state.tokenize=inAttribute(ch),state.stringStartCol=stream.column(),state.tokenize(stream,state)):(stream.eatWhile(/[^\s\u00a0=<>\"\']/),"word")}function inAttribute(quote){var closure=function(stream,state){for(;!stream.eol();)if(stream.next()==quote){state.tokenize=inTag;break}return"string"};return closure.isInAttribute=!0,closure}function inBlock(style,terminator){return function(stream,state){for(;!stream.eol();){if(stream.match(terminator)){state.tokenize=inText;break}stream.next()}return style}}function doctype(depth){return function(stream,state){for(var ch;null!=(ch=stream.next());){if("<"==ch)return state.tokenize=doctype(depth+1),state.tokenize(stream,state);if(">"==ch){if(1==depth){state.tokenize=inText;break}return state.tokenize=doctype(depth-1),state.tokenize(stream,state)}}return"meta"}}function Context(state,tagName,startOfLine){this.prev=state.context,this.tagName=tagName,this.indent=state.indented,this.startOfLine=startOfLine,(Kludges.doNotIndent.hasOwnProperty(tagName)||state.context&&state.context.noIndent)&&(this.noIndent=!0)}function popContext(state){state.context&&(state.context=state.context.prev)}function maybePopContext(state,nextTagName){for(var parentTagName;;){if(!state.context)return;if(parentTagName=state.context.tagName.toLowerCase(),!Kludges.contextGrabbers.hasOwnProperty(parentTagName)||!Kludges.contextGrabbers[parentTagName].hasOwnProperty(nextTagName))return;popContext(state)}}function baseState(type,stream,state){if("openTag"==type)return state.tagName=tagName,state.tagStart=stream.column(),attrState;if("closeTag"==type){var err=!1;return state.context?state.context.tagName!=tagName&&(Kludges.implicitlyClosed.hasOwnProperty(state.context.tagName.toLowerCase())&&popContext(state),err=!state.context||state.context.tagName!=tagName):err=!0,err&&(setStyle="error"),err?closeStateErr:closeState}return baseState}function closeState(type,_stream,state){return"endTag"!=type?(setStyle="error",closeState):(popContext(state),baseState)}function closeStateErr(type,stream,state){return setStyle="error",closeState(type,stream,state)}function attrState(type,_stream,state){if("word"==type)return setStyle="attribute",attrEqState;if("endTag"==type||"selfcloseTag"==type){var tagName=state.tagName,tagStart=state.tagStart;return state.tagName=state.tagStart=null,"selfcloseTag"==type||Kludges.autoSelfClosers.hasOwnProperty(tagName.toLowerCase())?maybePopContext(state,tagName.toLowerCase()):(maybePopContext(state,tagName.toLowerCase()),state.context=new Context(state,tagName,tagStart==state.indented)),baseState}return setStyle="error",attrState}function attrEqState(type,stream,state){return"equals"==type?attrValueState:(Kludges.allowMissing||(setStyle="error"),attrState(type,stream,state))}function attrValueState(type,stream,state){return"string"==type?attrContinuedState:"word"==type&&Kludges.allowUnquoted?(setStyle="string",attrState):(setStyle="error",attrState(type,stream,state))}function attrContinuedState(type,stream,state){return"string"==type?attrContinuedState:attrState(type,stream,state)}var indentUnit=config.indentUnit,multilineTagIndentFactor=parserConfig.multilineTagIndentFactor||1,multilineTagIndentPastTag=parserConfig.multilineTagIndentPastTag;null==multilineTagIndentPastTag&&(multilineTagIndentPastTag=!0);var tagName,type,setStyle,Kludges=parserConfig.htmlMode?{autoSelfClosers:{area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},implicitlyClosed:{dd:!0,li:!0,optgroup:!0,option:!0,p:!0,rp:!0,rt:!0,tbody:!0,td:!0,tfoot:!0,th:!0,tr:!0},contextGrabbers:{dd:{dd:!0,dt:!0},dt:{dd:!0,dt:!0},li:{li:!0},option:{option:!0,optgroup:!0},optgroup:{optgroup:!0},p:{address:!0,article:!0,aside:!0,blockquote:!0,dir:!0,div:!0,dl:!0,fieldset:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,menu:!0,nav:!0,ol:!0,p:!0,pre:!0,section:!0,table:!0,ul:!0},rp:{rp:!0,rt:!0},rt:{rp:!0,rt:!0},tbody:{tbody:!0,tfoot:!0},td:{td:!0,th:!0},tfoot:{tbody:!0},th:{td:!0,th:!0},thead:{tbody:!0,tfoot:!0},tr:{tr:!0}},doNotIndent:{pre:!0},allowUnquoted:!0,allowMissing:!0}:{autoSelfClosers:{},implicitlyClosed:{},contextGrabbers:{},doNotIndent:{},allowUnquoted:!1,allowMissing:!1},alignCDATA=parserConfig.alignCDATA;return{startState:function(){return{tokenize:inText,state:baseState,indented:0,tagName:null,tagStart:null,context:null}},token:function(stream,state){if(!state.tagName&&stream.sol()&&(state.indented=stream.indentation()),stream.eatSpace())return null;tagName=type=null;var style=state.tokenize(stream,state);return(style||type)&&"comment"!=style&&(setStyle=null,state.state=state.state(type||style,stream,state),setStyle&&(style="error"==setStyle?style+" error":setStyle)),style},indent:function(state,textAfter,fullLine){var context=state.context;if(state.tokenize.isInAttribute)return state.stringStartCol+1;if(context&&context.noIndent)return CodeMirror.Pass;if(state.tokenize!=inTag&&state.tokenize!=inText)return fullLine?fullLine.match(/^(\s*)/)[0].length:0;if(state.tagName)return multilineTagIndentPastTag?state.tagStart+state.tagName.length+2:state.tagStart+indentUnit*multilineTagIndentFactor;if(alignCDATA&&/<!\[CDATA\[/.test(textAfter))return 0;for(context&&/^<\//.test(textAfter)&&(context=context.prev);context&&!context.startOfLine;)context=context.prev;return context?context.indent+indentUnit:0},electricChars:"/",blockCommentStart:"<!--",blockCommentEnd:"-->",configuration:parserConfig.htmlMode?"html":"xml",helperType:parserConfig.htmlMode?"html":"xml"}}),CodeMirror.defineMIME("text/xml","xml"),CodeMirror.defineMIME("application/xml","xml"),CodeMirror.mimeModes.hasOwnProperty("text/html")||CodeMirror.defineMIME("text/html",{name:"xml",htmlMode:!0}),CodeMirror.defineMode("htmlmixed",function(config,parserConfig){function html(stream,state){var tagName=state.htmlState.tagName,style=htmlMode.token(stream,state.htmlState);if("script"==tagName&&/\btag\b/.test(style)&&">"==stream.current()){var scriptType=stream.string.slice(Math.max(0,stream.pos-100),stream.pos).match(/\btype\s*=\s*("[^"]+"|'[^']+'|\S+)[^<]*$/i);scriptType=scriptType?scriptType[1]:"",scriptType&&/[\"\']/.test(scriptType.charAt(0))&&(scriptType=scriptType.slice(1,scriptType.length-1));for(var i=0;i<scriptTypes.length;++i){var tp=scriptTypes[i];if("string"==typeof tp.matches?scriptType==tp.matches:tp.matches.test(scriptType)){tp.mode&&(state.token=script,state.localMode=tp.mode,state.localState=tp.mode.startState&&tp.mode.startState(htmlMode.indent(state.htmlState,"")));break}}}else"style"==tagName&&/\btag\b/.test(style)&&">"==stream.current()&&(state.token=css,state.localMode=cssMode,state.localState=cssMode.startState(htmlMode.indent(state.htmlState,"")));return style}function maybeBackup(stream,pat,style){var m,cur=stream.current(),close=cur.search(pat);return close>-1?stream.backUp(cur.length-close):(m=cur.match(/<\/?$/))&&(stream.backUp(cur.length),stream.match(pat,!1)||stream.match(cur)),style}function script(stream,state){return stream.match(/^<\/\s*script\s*>/i,!1)?(state.token=html,state.localState=state.localMode=null,html(stream,state)):maybeBackup(stream,/<\/\s*script\s*>/,state.localMode.token(stream,state.localState))}function css(stream,state){return stream.match(/^<\/\s*style\s*>/i,!1)?(state.token=html,state.localState=state.localMode=null,html(stream,state)):maybeBackup(stream,/<\/\s*style\s*>/,cssMode.token(stream,state.localState))}var htmlMode=CodeMirror.getMode(config,{name:"xml",htmlMode:!0,multilineTagIndentFactor:parserConfig.multilineTagIndentFactor,multilineTagIndentPastTag:parserConfig.multilineTagIndentPastTag}),cssMode=CodeMirror.getMode(config,"css"),scriptTypes=[],scriptTypesConf=parserConfig&&parserConfig.scriptTypes;if(scriptTypes.push({matches:/^(?:text|application)\/(?:x-)?(?:java|ecma)script$|^$/i,mode:CodeMirror.getMode(config,"javascript")}),scriptTypesConf)for(var i=0;i<scriptTypesConf.length;++i){var conf=scriptTypesConf[i];scriptTypes.push({matches:conf.matches,mode:conf.mode&&CodeMirror.getMode(config,conf.mode)})}return scriptTypes.push({matches:/./,mode:CodeMirror.getMode(config,"text/plain")}),{startState:function(){var state=htmlMode.startState();return{token:html,localMode:null,localState:null,htmlState:state}},copyState:function(state){if(state.localState)var local=CodeMirror.copyState(state.localMode,state.localState);return{token:state.token,localMode:state.localMode,localState:local,htmlState:CodeMirror.copyState(htmlMode,state.htmlState)}},token:function(stream,state){return state.token(stream,state)},indent:function(state,textAfter){return!state.localMode||/^\s*<\//.test(textAfter)?htmlMode.indent(state.htmlState,textAfter):state.localMode.indent?state.localMode.indent(state.localState,textAfter):CodeMirror.Pass},innerMode:function(state){return{state:state.localState||state.htmlState,mode:state.localMode||htmlMode}}}},"xml","javascript","css"),CodeMirror.defineMIME("text/html","htmlmixed"),CodeMirror.defineMode("javascript",function(config,parserConfig){function readRegexp(stream){for(var next,escaped=!1,inSet=!1;null!=(next=stream.next());){if(!escaped){if("/"==next&&!inSet)return;"["==next?inSet=!0:inSet&&"]"==next&&(inSet=!1)}escaped=!escaped&&"\\"==next}}function ret(tp,style,cont){return type=tp,content=cont,style}function tokenBase(stream,state){var ch=stream.next();if('"'==ch||"'"==ch)return state.tokenize=tokenString(ch),state.tokenize(stream,state);if("."==ch&&stream.match(/^\d+(?:[eE][+\-]?\d+)?/))return ret("number","number");if("."==ch&&stream.match(".."))return ret("spread","meta");if(/[\[\]{}\(\),;\:\.]/.test(ch))return ret(ch);if("="==ch&&stream.eat(">"))return ret("=>","operator");if("0"==ch&&stream.eat(/x/i))return stream.eatWhile(/[\da-f]/i),ret("number","number");if(/\d/.test(ch))return stream.match(/^\d*(?:\.\d*)?(?:[eE][+\-]?\d+)?/),ret("number","number");if("/"==ch)return stream.eat("*")?(state.tokenize=tokenComment,tokenComment(stream,state)):stream.eat("/")?(stream.skipToEnd(),ret("comment","comment")):"operator"==state.lastType||"keyword c"==state.lastType||"sof"==state.lastType||/^[\[{}\(,;:]$/.test(state.lastType)?(readRegexp(stream),stream.eatWhile(/[gimy]/),ret("regexp","string-2")):(stream.eatWhile(isOperatorChar),ret("operator","operator",stream.current()));if("`"==ch)return state.tokenize=tokenQuasi,tokenQuasi(stream,state);if("#"==ch)return stream.skipToEnd(),ret("error","error");if(isOperatorChar.test(ch))return stream.eatWhile(isOperatorChar),ret("operator","operator",stream.current());stream.eatWhile(/[\w\$_]/);var word=stream.current(),known=keywords.propertyIsEnumerable(word)&&keywords[word];return known&&"."!=state.lastType?ret(known.type,known.style,word):ret("variable","variable",word)}function tokenString(quote){return function(stream,state){var next,escaped=!1;if(jsonldMode&&"@"==stream.peek()&&stream.match(isJsonldKeyword))return state.tokenize=tokenBase,ret("jsonld-keyword","meta");for(;null!=(next=stream.next())&&(next!=quote||escaped);)escaped=!escaped&&"\\"==next;return escaped||(state.tokenize=tokenBase),ret("string","string")}}function tokenComment(stream,state){for(var ch,maybeEnd=!1;ch=stream.next();){if("/"==ch&&maybeEnd){state.tokenize=tokenBase;break}maybeEnd="*"==ch}return ret("comment","comment")}function tokenQuasi(stream,state){for(var next,escaped=!1;null!=(next=stream.next());){if(!escaped&&("`"==next||"$"==next&&stream.eat("{"))){state.tokenize=tokenBase;break}escaped=!escaped&&"\\"==next}return ret("quasi","string-2",stream.current())}function findFatArrow(stream,state){state.fatArrowAt&&(state.fatArrowAt=null);var arrow=stream.string.indexOf("=>",stream.start);if(!(0>arrow)){for(var depth=0,sawSomething=!1,pos=arrow-1;pos>=0;--pos){var ch=stream.string.charAt(pos),bracket=brackets.indexOf(ch);if(bracket>=0&&3>bracket){if(!depth){++pos;break}if(0==--depth)break}else if(bracket>=3&&6>bracket)++depth;else if(/[$\w]/.test(ch))sawSomething=!0;else if(sawSomething&&!depth){++pos;break}}sawSomething&&!depth&&(state.fatArrowAt=pos)}}function JSLexical(indented,column,type,align,prev,info){this.indented=indented,this.column=column,this.type=type,this.prev=prev,this.info=info,null!=align&&(this.align=align)}function inScope(state,varname){for(var v=state.localVars;v;v=v.next)if(v.name==varname)return!0;for(var cx=state.context;cx;cx=cx.prev)for(var v=cx.vars;v;v=v.next)if(v.name==varname)return!0}function parseJS(state,style,type,content,stream){var cc=state.cc;for(cx.state=state,cx.stream=stream,cx.marked=null,cx.cc=cc,state.lexical.hasOwnProperty("align")||(state.lexical.align=!0);;){var combinator=cc.length?cc.pop():jsonMode?expression:statement;if(combinator(type,content)){for(;cc.length&&cc[cc.length-1].lex;)cc.pop()();return cx.marked?cx.marked:"variable"==type&&inScope(state,content)?"variable-2":style}}}function pass(){for(var i=arguments.length-1;i>=0;i--)cx.cc.push(arguments[i])}function cont(){return pass.apply(null,arguments),!0}function register(varname){function inList(list){for(var v=list;v;v=v.next)if(v.name==varname)return!0;return!1}var state=cx.state;if(state.context){if(cx.marked="def",inList(state.localVars))return;state.localVars={name:varname,next:state.localVars}}else{if(inList(state.globalVars))return;parserConfig.globalVars&&(state.globalVars={name:varname,next:state.globalVars})}}function pushcontext(){cx.state.context={prev:cx.state.context,vars:cx.state.localVars},cx.state.localVars=defaultVars}function popcontext(){cx.state.localVars=cx.state.context.vars,cx.state.context=cx.state.context.prev}function pushlex(type,info){var result=function(){var state=cx.state,indent=state.indented;"stat"==state.lexical.type&&(indent=state.lexical.indented),state.lexical=new JSLexical(indent,cx.stream.column(),type,null,state.lexical,info)};return result.lex=!0,result}function poplex(){var state=cx.state;state.lexical.prev&&(")"==state.lexical.type&&(state.indented=state.lexical.indented),state.lexical=state.lexical.prev)}function expect(wanted){return function(type){return type==wanted?cont():";"==wanted?pass():cont(arguments.callee)}}function statement(type,value){return"var"==type?cont(pushlex("vardef",value.length),vardef,expect(";"),poplex):"keyword a"==type?cont(pushlex("form"),expression,statement,poplex):"keyword b"==type?cont(pushlex("form"),statement,poplex):"{"==type?cont(pushlex("}"),block,poplex):";"==type?cont():"if"==type?cont(pushlex("form"),expression,statement,poplex,maybeelse):"function"==type?cont(functiondef):"for"==type?cont(pushlex("form"),forspec,statement,poplex):"variable"==type?cont(pushlex("stat"),maybelabel):"switch"==type?cont(pushlex("form"),expression,pushlex("}","switch"),expect("{"),block,poplex,poplex):"case"==type?cont(expression,expect(":")):"default"==type?cont(expect(":")):"catch"==type?cont(pushlex("form"),pushcontext,expect("("),funarg,expect(")"),statement,poplex,popcontext):"module"==type?cont(pushlex("form"),pushcontext,afterModule,popcontext,poplex):"class"==type?cont(pushlex("form"),className,objlit,poplex):"export"==type?cont(pushlex("form"),afterExport,poplex):"import"==type?cont(pushlex("form"),afterImport,poplex):pass(pushlex("stat"),expression,expect(";"),poplex)}function expression(type){return expressionInner(type,!1)}function expressionNoComma(type){return expressionInner(type,!0)}function expressionInner(type,noComma){if(cx.state.fatArrowAt==cx.stream.start){var body=noComma?arrowBodyNoComma:arrowBody;if("("==type)return cont(pushcontext,pushlex(")"),commasep(pattern,")"),poplex,expect("=>"),body,popcontext);if("variable"==type)return pass(pushcontext,pattern,expect("=>"),body,popcontext)}var maybeop=noComma?maybeoperatorNoComma:maybeoperatorComma;return atomicTypes.hasOwnProperty(type)?cont(maybeop):"function"==type?cont(functiondef):"keyword c"==type?cont(noComma?maybeexpressionNoComma:maybeexpression):"("==type?cont(pushlex(")"),maybeexpression,comprehension,expect(")"),poplex,maybeop):"operator"==type||"spread"==type?cont(noComma?expressionNoComma:expression):"["==type?cont(pushlex("]"),arrayLiteral,poplex,maybeop):"{"==type?contCommasep(objprop,"}",null,maybeop):cont()}function maybeexpression(type){return type.match(/[;\}\)\],]/)?pass():pass(expression)}function maybeexpressionNoComma(type){return type.match(/[;\}\)\],]/)?pass():pass(expressionNoComma)}function maybeoperatorComma(type,value){return","==type?cont(expression):maybeoperatorNoComma(type,value,!1)}function maybeoperatorNoComma(type,value,noComma){var me=0==noComma?maybeoperatorComma:maybeoperatorNoComma,expr=0==noComma?expression:expressionNoComma;return"=>"==value?cont(pushcontext,noComma?arrowBodyNoComma:arrowBody,popcontext):"operator"==type?/\+\+|--/.test(value)?cont(me):"?"==value?cont(expression,expect(":"),expr):cont(expr):"quasi"==type?(cx.cc.push(me),quasi(value)):";"!=type?"("==type?contCommasep(expressionNoComma,")","call",me):"."==type?cont(property,me):"["==type?cont(pushlex("]"),maybeexpression,expect("]"),poplex,me):void 0:void 0}function quasi(value){return"${"!=value.slice(value.length-2)?cont():cont(expression,continueQuasi)}function continueQuasi(type){return"}"==type?(cx.marked="string-2",cx.state.tokenize=tokenQuasi,cont()):void 0}function arrowBody(type){return findFatArrow(cx.stream,cx.state),"{"==type?pass(statement):pass(expression)}function arrowBodyNoComma(type){return findFatArrow(cx.stream,cx.state),"{"==type?pass(statement):pass(expressionNoComma)}function maybelabel(type){return":"==type?cont(poplex,statement):pass(maybeoperatorComma,expect(";"),poplex)}function property(type){return"variable"==type?(cx.marked="property",cont()):void 0}function objprop(type,value){if("variable"==type){if(cx.marked="property","get"==value||"set"==value)return cont(getterSetter)}else if("number"==type||"string"==type)cx.marked=jsonldMode?"property":type+" property";else if("["==type)return cont(expression,expect("]"),afterprop);return atomicTypes.hasOwnProperty(type)?cont(afterprop):void 0}function getterSetter(type){return"variable"!=type?pass(afterprop):(cx.marked="property",cont(functiondef))}function afterprop(type){return":"==type?cont(expressionNoComma):"("==type?pass(functiondef):void 0}function commasep(what,end){function proceed(type){if(","==type){var lex=cx.state.lexical;return"call"==lex.info&&(lex.pos=(lex.pos||0)+1),cont(what,proceed)}return type==end?cont():cont(expect(end))}return function(type){return type==end?cont():pass(what,proceed)}}function contCommasep(what,end,info){for(var i=3;i<arguments.length;i++)cx.cc.push(arguments[i]);return cont(pushlex(end,info),commasep(what,end),poplex)}function block(type){return"}"==type?cont():pass(statement,block)}function maybetype(type){return isTS&&":"==type?cont(typedef):void 0}function typedef(type){return"variable"==type?(cx.marked="variable-3",cont()):void 0}function vardef(){return pass(pattern,maybetype,maybeAssign,vardefCont)}function pattern(type,value){return"variable"==type?(register(value),cont()):"["==type?contCommasep(pattern,"]"):"{"==type?contCommasep(proppattern,"}"):void 0}function proppattern(type,value){return"variable"!=type||cx.stream.match(/^\s*:/,!1)?("variable"==type&&(cx.marked="property"),cont(expect(":"),pattern,maybeAssign)):(register(value),cont(maybeAssign))}function maybeAssign(_type,value){return"="==value?cont(expressionNoComma):void 0}function vardefCont(type){return","==type?cont(vardef):void 0}function maybeelse(type,value){return"keyword b"==type&&"else"==value?cont(pushlex("form"),statement,poplex):void 0}function forspec(type){return"("==type?cont(pushlex(")"),forspec1,expect(")"),poplex):void 0}function forspec1(type){return"var"==type?cont(vardef,expect(";"),forspec2):";"==type?cont(forspec2):"variable"==type?cont(formaybeinof):pass(expression,expect(";"),forspec2)}function formaybeinof(_type,value){return"in"==value||"of"==value?(cx.marked="keyword",cont(expression)):cont(maybeoperatorComma,forspec2)}function forspec2(type,value){return";"==type?cont(forspec3):"in"==value||"of"==value?(cx.marked="keyword",cont(expression)):pass(expression,expect(";"),forspec3)}function forspec3(type){")"!=type&&cont(expression)}function functiondef(type,value){return"*"==value?(cx.marked="keyword",cont(functiondef)):"variable"==type?(register(value),cont(functiondef)):"("==type?cont(pushcontext,pushlex(")"),commasep(funarg,")"),poplex,statement,popcontext):void 0}function funarg(type){return"spread"==type?cont(funarg):pass(pattern,maybetype)}function className(type,value){return"variable"==type?(register(value),cont(classNameAfter)):void 0}function classNameAfter(_type,value){return"extends"==value?cont(expression):void 0}function objlit(type){return"{"==type?contCommasep(objprop,"}"):void 0}function afterModule(type,value){return"string"==type?cont(statement):"variable"==type?(register(value),cont(maybeFrom)):void 0}function afterExport(_type,value){return"*"==value?(cx.marked="keyword",cont(maybeFrom,expect(";"))):"default"==value?(cx.marked="keyword",cont(expression,expect(";"))):pass(statement)}function afterImport(type){return"string"==type?cont():pass(importSpec,maybeFrom)}function importSpec(type,value){return"{"==type?contCommasep(importSpec,"}"):("variable"==type&&register(value),cont())}function maybeFrom(_type,value){return"from"==value?(cx.marked="keyword",cont(expression)):void 0}function arrayLiteral(type){return"]"==type?cont():pass(expressionNoComma,maybeArrayComprehension)}function maybeArrayComprehension(type){return"for"==type?pass(comprehension,expect("]")):","==type?cont(commasep(expressionNoComma,"]")):pass(commasep(expressionNoComma,"]"))}function comprehension(type){return"for"==type?cont(forspec,comprehension):"if"==type?cont(expression,comprehension):void 0}var type,content,indentUnit=config.indentUnit,statementIndent=parserConfig.statementIndent,jsonldMode=parserConfig.jsonld,jsonMode=parserConfig.json||jsonldMode,isTS=parserConfig.typescript,keywords=function(){function kw(type){return{type:type,style:"keyword"}}var A=kw("keyword a"),B=kw("keyword b"),C=kw("keyword c"),operator=kw("operator"),atom={type:"atom",style:"atom"},jsKeywords={"if":kw("if"),"while":A,"with":A,"else":B,"do":B,"try":B,"finally":B,"return":C,"break":C,"continue":C,"new":C,"delete":C,"throw":C,"debugger":C,"var":kw("var"),"const":kw("var"),let:kw("var"),"function":kw("function"),"catch":kw("catch"),"for":kw("for"),"switch":kw("switch"),"case":kw("case"),"default":kw("default"),"in":operator,"typeof":operator,"instanceof":operator,"true":atom,"false":atom,"null":atom,undefined:atom,NaN:atom,Infinity:atom,"this":kw("this"),module:kw("module"),"class":kw("class"),"super":kw("atom"),yield:C,"export":kw("export"),"import":kw("import"),"extends":C};if(isTS){var type={type:"variable",style:"variable-3"},tsKeywords={"interface":kw("interface"),"extends":kw("extends"),constructor:kw("constructor"),"public":kw("public"),"private":kw("private"),"protected":kw("protected"),"static":kw("static"),string:type,number:type,bool:type,any:type};for(var attr in tsKeywords)jsKeywords[attr]=tsKeywords[attr]}return jsKeywords}(),isOperatorChar=/[+\-*&%=<>!?|~^]/,isJsonldKeyword=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/,brackets="([{}])",atomicTypes={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,"this":!0,"jsonld-keyword":!0},cx={state:null,column:null,marked:null,cc:null},defaultVars={name:"this",next:{name:"arguments"}};return poplex.lex=!0,{startState:function(basecolumn){var state={tokenize:tokenBase,lastType:"sof",cc:[],lexical:new JSLexical((basecolumn||0)-indentUnit,0,"block",!1),localVars:parserConfig.localVars,context:parserConfig.localVars&&{vars:parserConfig.localVars},indented:0};return parserConfig.globalVars&&(state.globalVars=parserConfig.globalVars),state},token:function(stream,state){if(stream.sol()&&(state.lexical.hasOwnProperty("align")||(state.lexical.align=!1),state.indented=stream.indentation(),findFatArrow(stream,state)),state.tokenize!=tokenComment&&stream.eatSpace())return null;var style=state.tokenize(stream,state);return"comment"==type?style:(state.lastType="operator"!=type||"++"!=content&&"--"!=content?type:"incdec",parseJS(state,style,type,content,stream))},indent:function(state,textAfter){if(state.tokenize==tokenComment)return CodeMirror.Pass;if(state.tokenize!=tokenBase)return 0;for(var firstChar=textAfter&&textAfter.charAt(0),lexical=state.lexical,i=state.cc.length-1;i>=0;--i){var c=state.cc[i];if(c==poplex)lexical=lexical.prev;else if(c!=maybeelse)break}"stat"==lexical.type&&"}"==firstChar&&(lexical=lexical.prev),statementIndent&&")"==lexical.type&&"stat"==lexical.prev.type&&(lexical=lexical.prev);var type=lexical.type,closing=firstChar==type;return"vardef"==type?lexical.indented+("operator"==state.lastType||","==state.lastType?lexical.info+1:0):"form"==type&&"{"==firstChar?lexical.indented:"form"==type?lexical.indented+indentUnit:"stat"==type?lexical.indented+("operator"==state.lastType||","==state.lastType?statementIndent||indentUnit:0):"switch"!=lexical.info||closing||0==parserConfig.doubleIndentSwitch?lexical.align?lexical.column+(closing?0:1):lexical.indented+(closing?0:indentUnit):lexical.indented+(/^(?:case|default)\b/.test(textAfter)?indentUnit:2*indentUnit)},electricChars:":{}",blockCommentStart:jsonMode?null:"/*",blockCommentEnd:jsonMode?null:"*/",lineComment:jsonMode?null:"//",fold:"brace",helperType:jsonMode?"json":"javascript",jsonldMode:jsonldMode,jsonMode:jsonMode}}),CodeMirror.defineMIME("text/javascript","javascript"),CodeMirror.defineMIME("text/ecmascript","javascript"),CodeMirror.defineMIME("application/javascript","javascript"),CodeMirror.defineMIME("application/ecmascript","javascript"),CodeMirror.defineMIME("application/json",{name:"javascript",json:!0}),CodeMirror.defineMIME("application/x-json",{name:"javascript",json:!0}),CodeMirror.defineMIME("application/ld+json",{name:"javascript",jsonld:!0}),CodeMirror.defineMIME("text/typescript",{name:"javascript",typescript:!0}),CodeMirror.defineMIME("application/typescript",{name:"javascript",typescript:!0}),CodeMirror.defineMode("css",function(config,parserConfig){"use strict";function ret(style,tp){return type=tp,style}function tokenBase(stream,state){var ch=stream.next();if(tokenHooks[ch]){var result=tokenHooks[ch](stream,state);if(result!==!1)return result}return"@"==ch?(stream.eatWhile(/[\w\\\-]/),ret("def",stream.current())):"="==ch||("~"==ch||"|"==ch)&&stream.eat("=")?ret(null,"compare"):'"'==ch||"'"==ch?(state.tokenize=tokenString(ch),state.tokenize(stream,state)):"#"==ch?(stream.eatWhile(/[\w\\\-]/),ret("atom","hash")):"!"==ch?(stream.match(/^\s*\w*/),ret("keyword","important")):/\d/.test(ch)||"."==ch&&stream.eat(/\d/)?(stream.eatWhile(/[\w.%]/),ret("number","unit")):"-"!==ch?/[,+>*\/]/.test(ch)?ret(null,"select-op"):"."==ch&&stream.match(/^-?[_a-z][_a-z0-9-]*/i)?ret("qualifier","qualifier"):/[:;{}\[\]\(\)]/.test(ch)?ret(null,ch):"u"==ch&&stream.match("rl(")?(stream.backUp(1),state.tokenize=tokenParenthesized,ret("property","word")):/[\w\\\-]/.test(ch)?(stream.eatWhile(/[\w\\\-]/),ret("property","word")):ret(null,null):/[\d.]/.test(stream.peek())?(stream.eatWhile(/[\w.%]/),ret("number","unit")):stream.match(/^[^-]+-/)?ret("meta","meta"):void 0}function tokenString(quote){return function(stream,state){for(var ch,escaped=!1;null!=(ch=stream.next());){if(ch==quote&&!escaped){")"==quote&&stream.backUp(1);break}escaped=!escaped&&"\\"==ch}return(ch==quote||!escaped&&")"!=quote)&&(state.tokenize=null),ret("string","string")}}function tokenParenthesized(stream,state){return stream.next(),state.tokenize=stream.match(/\s*[\"\']/,!1)?null:tokenString(")"),ret(null,"(")}function Context(type,indent,prev){this.type=type,this.indent=indent,this.prev=prev}function pushContext(state,stream,type){return state.context=new Context(type,stream.indentation()+indentUnit,state.context),type}function popContext(state){return state.context=state.context.prev,state.context.type}function pass(type,stream,state){return states[state.context.type](type,stream,state)}function popAndPass(type,stream,state,n){for(var i=n||1;i>0;i--)state.context=state.context.prev;return pass(type,stream,state)}function wordAsValue(stream){var word=stream.current().toLowerCase();override=valueKeywords.hasOwnProperty(word)?"atom":colorKeywords.hasOwnProperty(word)?"keyword":"variable"}parserConfig.propertyKeywords||(parserConfig=CodeMirror.resolveMode("text/css"));var type,override,indentUnit=config.indentUnit,tokenHooks=parserConfig.tokenHooks,mediaTypes=parserConfig.mediaTypes||{},mediaFeatures=parserConfig.mediaFeatures||{},propertyKeywords=parserConfig.propertyKeywords||{},colorKeywords=parserConfig.colorKeywords||{},valueKeywords=parserConfig.valueKeywords||{},fontProperties=parserConfig.fontProperties||{},allowNested=parserConfig.allowNested,states={};return states.top=function(type,stream,state){if("{"==type)return pushContext(state,stream,"block");if("}"==type&&state.context.prev)return popContext(state);if("@media"==type)return pushContext(state,stream,"media");if("@font-face"==type)return"font_face_before";if(/^@(-(moz|ms|o|webkit)-)?keyframes$/.test(type))return"keyframes";if(type&&"@"==type.charAt(0))return pushContext(state,stream,"at");if("hash"==type)override="builtin";else if("word"==type)override="tag";else{if("variable-definition"==type)return"maybeprop";if("interpolation"==type)return pushContext(state,stream,"interpolation");if(":"==type)return"pseudo";if(allowNested&&"("==type)return pushContext(state,stream,"params")}return state.context.type},states.block=function(type,stream,state){return"word"==type?propertyKeywords.hasOwnProperty(stream.current().toLowerCase())?(override="property","maybeprop"):allowNested?(override=stream.match(/^\s*:/,!1)?"property":"tag","block"):(override+=" error","maybeprop"):"meta"==type?"block":allowNested||"hash"!=type&&"qualifier"!=type?states.top(type,stream,state):(override="error","block")
},states.maybeprop=function(type,stream,state){return":"==type?pushContext(state,stream,"prop"):pass(type,stream,state)},states.prop=function(type,stream,state){if(";"==type)return popContext(state);if("{"==type&&allowNested)return pushContext(state,stream,"propBlock");if("}"==type||"{"==type)return popAndPass(type,stream,state);if("("==type)return pushContext(state,stream,"parens");if("hash"!=type||/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/.test(stream.current())){if("word"==type)wordAsValue(stream);else if("interpolation"==type)return pushContext(state,stream,"interpolation")}else override+=" error";return"prop"},states.propBlock=function(type,_stream,state){return"}"==type?popContext(state):"word"==type?(override="property","maybeprop"):state.context.type},states.parens=function(type,stream,state){return"{"==type||"}"==type?popAndPass(type,stream,state):")"==type?popContext(state):"parens"},states.pseudo=function(type,stream,state){return"word"==type?(override="variable-3",state.context.type):pass(type,stream,state)},states.media=function(type,stream,state){if("("==type)return pushContext(state,stream,"media_parens");if("}"==type)return popAndPass(type,stream,state);if("{"==type)return popContext(state)&&pushContext(state,stream,allowNested?"block":"top");if("word"==type){var word=stream.current().toLowerCase();override="only"==word||"not"==word||"and"==word?"keyword":mediaTypes.hasOwnProperty(word)?"attribute":mediaFeatures.hasOwnProperty(word)?"property":"error"}return state.context.type},states.media_parens=function(type,stream,state){return")"==type?popContext(state):"{"==type||"}"==type?popAndPass(type,stream,state,2):states.media(type,stream,state)},states.font_face_before=function(type,stream,state){return"{"==type?pushContext(state,stream,"font_face"):pass(type,stream,state)},states.font_face=function(type,stream,state){return"}"==type?popContext(state):"word"==type?(override=fontProperties.hasOwnProperty(stream.current().toLowerCase())?"property":"error","maybeprop"):"font_face"},states.keyframes=function(type,stream,state){return"word"==type?(override="variable","keyframes"):"{"==type?pushContext(state,stream,"top"):pass(type,stream,state)},states.at=function(type,stream,state){return";"==type?popContext(state):"{"==type||"}"==type?popAndPass(type,stream,state):("word"==type?override="tag":"hash"==type&&(override="builtin"),"at")},states.interpolation=function(type,stream,state){return"}"==type?popContext(state):"{"==type||";"==type?popAndPass(type,stream,state):("variable"!=type&&(override="error"),"interpolation")},states.params=function(type,stream,state){return")"==type?popContext(state):"{"==type||"}"==type?popAndPass(type,stream,state):("word"==type&&wordAsValue(stream),"params")},{startState:function(base){return{tokenize:null,state:"top",context:new Context("top",base||0,null)}},token:function(stream,state){if(!state.tokenize&&stream.eatSpace())return null;var style=(state.tokenize||tokenBase)(stream,state);return style&&"object"==typeof style&&(type=style[1],style=style[0]),override=style,state.state=states[state.state](type,stream,state),override},indent:function(state,textAfter){var cx=state.context,ch=textAfter&&textAfter.charAt(0),indent=cx.indent;return"prop"==cx.type&&"}"==ch&&(cx=cx.prev),!cx.prev||("}"!=ch||"block"!=cx.type&&"top"!=cx.type&&"interpolation"!=cx.type&&"font_face"!=cx.type)&&(")"!=ch||"parens"!=cx.type&&"params"!=cx.type&&"media_parens"!=cx.type)&&("{"!=ch||"at"!=cx.type&&"media"!=cx.type)||(indent=cx.indent-indentUnit,cx=cx.prev),indent},electricChars:"}",blockCommentStart:"/*",blockCommentEnd:"*/",fold:"brace"}}),function(){function keySet(array){for(var keys={},i=0;i<array.length;++i)keys[array[i]]=!0;return keys}function tokenCComment(stream,state){for(var ch,maybeEnd=!1;null!=(ch=stream.next());){if(maybeEnd&&"/"==ch){state.tokenize=null;break}maybeEnd="*"==ch}return["comment","comment"]}function tokenSGMLComment(stream,state){return stream.skipTo("-->")?(stream.match("-->"),state.tokenize=null):stream.skipToEnd(),["comment","comment"]}var mediaTypes_=["all","aural","braille","handheld","print","projection","screen","tty","tv","embossed"],mediaTypes=keySet(mediaTypes_),mediaFeatures_=["width","min-width","max-width","height","min-height","max-height","device-width","min-device-width","max-device-width","device-height","min-device-height","max-device-height","aspect-ratio","min-aspect-ratio","max-aspect-ratio","device-aspect-ratio","min-device-aspect-ratio","max-device-aspect-ratio","color","min-color","max-color","color-index","min-color-index","max-color-index","monochrome","min-monochrome","max-monochrome","resolution","min-resolution","max-resolution","scan","grid"],mediaFeatures=keySet(mediaFeatures_),propertyKeywords_=["align-content","align-items","align-self","alignment-adjust","alignment-baseline","anchor-point","animation","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-timing-function","appearance","azimuth","backface-visibility","background","background-attachment","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","baseline-shift","binding","bleed","bookmark-label","bookmark-level","bookmark-state","bookmark-target","border","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-decoration-break","box-shadow","box-sizing","break-after","break-before","break-inside","caption-side","clear","clip","color","color-profile","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","content","counter-increment","counter-reset","crop","cue","cue-after","cue-before","cursor","direction","display","dominant-baseline","drop-initial-after-adjust","drop-initial-after-align","drop-initial-before-adjust","drop-initial-before-align","drop-initial-size","drop-initial-value","elevation","empty-cells","fit","fit-position","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","float-offset","flow-from","flow-into","font","font-feature-settings","font-family","font-kerning","font-language-override","font-size","font-size-adjust","font-stretch","font-style","font-synthesis","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","font-variant-position","font-weight","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-position","grid-auto-rows","grid-column","grid-column-end","grid-column-start","grid-row","grid-row-end","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","hanging-punctuation","height","hyphens","icon","image-orientation","image-rendering","image-resolution","inline-box-align","justify-content","left","letter-spacing","line-break","line-height","line-stacking","line-stacking-ruby","line-stacking-shift","line-stacking-strategy","list-style","list-style-image","list-style-position","list-style-type","margin","margin-bottom","margin-left","margin-right","margin-top","marker-offset","marks","marquee-direction","marquee-loop","marquee-play-count","marquee-speed","marquee-style","max-height","max-width","min-height","min-width","move-to","nav-down","nav-index","nav-left","nav-right","nav-up","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-style","overflow-wrap","overflow-x","overflow-y","padding","padding-bottom","padding-left","padding-right","padding-top","page","page-break-after","page-break-before","page-break-inside","page-policy","pause","pause-after","pause-before","perspective","perspective-origin","pitch","pitch-range","play-during","position","presentation-level","punctuation-trim","quotes","region-break-after","region-break-before","region-break-inside","region-fragment","rendering-intent","resize","rest","rest-after","rest-before","richness","right","rotation","rotation-point","ruby-align","ruby-overhang","ruby-position","ruby-span","shape-inside","shape-outside","size","speak","speak-as","speak-header","speak-numeral","speak-punctuation","speech-rate","stress","string-set","tab-size","table-layout","target","target-name","target-new","target-position","text-align","text-align-last","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-style","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-height","text-indent","text-justify","text-outline","text-overflow","text-shadow","text-size-adjust","text-space-collapse","text-transform","text-underline-position","text-wrap","top","transform","transform-origin","transform-style","transition","transition-delay","transition-duration","transition-property","transition-timing-function","unicode-bidi","vertical-align","visibility","voice-balance","voice-duration","voice-family","voice-pitch","voice-range","voice-rate","voice-stress","voice-volume","volume","white-space","widows","width","word-break","word-spacing","word-wrap","z-index","zoom","clip-path","clip-rule","mask","enable-background","filter","flood-color","flood-opacity","lighting-color","stop-color","stop-opacity","pointer-events","color-interpolation","color-interpolation-filters","color-profile","color-rendering","fill","fill-opacity","fill-rule","image-rendering","marker","marker-end","marker-mid","marker-start","shape-rendering","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","text-rendering","baseline-shift","dominant-baseline","glyph-orientation-horizontal","glyph-orientation-vertical","kerning","text-anchor","writing-mode"],propertyKeywords=keySet(propertyKeywords_),colorKeywords_=["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"],colorKeywords=keySet(colorKeywords_),valueKeywords_=["above","absolute","activeborder","activecaption","afar","after-white-space","ahead","alias","all","all-scroll","alternate","always","amharic","amharic-abegede","antialiased","appworkspace","arabic-indic","armenian","asterisks","auto","avoid","avoid-column","avoid-page","avoid-region","background","backwards","baseline","below","bidi-override","binary","bengali","blink","block","block-axis","bold","bolder","border","border-box","both","bottom","break","break-all","break-word","button","button-bevel","buttonface","buttonhighlight","buttonshadow","buttontext","cambodian","capitalize","caps-lock-indicator","caption","captiontext","caret","cell","center","checkbox","circle","cjk-earthly-branch","cjk-heavenly-stem","cjk-ideographic","clear","clip","close-quote","col-resize","collapse","column","compact","condensed","contain","content","content-box","context-menu","continuous","copy","cover","crop","cross","crosshair","currentcolor","cursive","dashed","decimal","decimal-leading-zero","default","default-button","destination-atop","destination-in","destination-out","destination-over","devanagari","disc","discard","document","dot-dash","dot-dot-dash","dotted","double","down","e-resize","ease","ease-in","ease-in-out","ease-out","element","ellipse","ellipsis","embed","end","ethiopic","ethiopic-abegede","ethiopic-abegede-am-et","ethiopic-abegede-gez","ethiopic-abegede-ti-er","ethiopic-abegede-ti-et","ethiopic-halehame-aa-er","ethiopic-halehame-aa-et","ethiopic-halehame-am-et","ethiopic-halehame-gez","ethiopic-halehame-om-et","ethiopic-halehame-sid-et","ethiopic-halehame-so-et","ethiopic-halehame-ti-er","ethiopic-halehame-ti-et","ethiopic-halehame-tig","ew-resize","expanded","extra-condensed","extra-expanded","fantasy","fast","fill","fixed","flat","footnotes","forwards","from","geometricPrecision","georgian","graytext","groove","gujarati","gurmukhi","hand","hangul","hangul-consonant","hebrew","help","hidden","hide","higher","highlight","highlighttext","hiragana","hiragana-iroha","horizontal","hsl","hsla","icon","ignore","inactiveborder","inactivecaption","inactivecaptiontext","infinite","infobackground","infotext","inherit","initial","inline","inline-axis","inline-block","inline-table","inset","inside","intrinsic","invert","italic","justify","kannada","katakana","katakana-iroha","keep-all","khmer","landscape","lao","large","larger","left","level","lighter","line-through","linear","lines","list-item","listbox","listitem","local","logical","loud","lower","lower-alpha","lower-armenian","lower-greek","lower-hexadecimal","lower-latin","lower-norwegian","lower-roman","lowercase","ltr","malayalam","match","media-controls-background","media-current-time-display","media-fullscreen-button","media-mute-button","media-play-button","media-return-to-realtime-button","media-rewind-button","media-seek-back-button","media-seek-forward-button","media-slider","media-sliderthumb","media-time-remaining-display","media-volume-slider","media-volume-slider-container","media-volume-sliderthumb","medium","menu","menulist","menulist-button","menulist-text","menulist-textfield","menutext","message-box","middle","min-intrinsic","mix","mongolian","monospace","move","multiple","myanmar","n-resize","narrower","ne-resize","nesw-resize","no-close-quote","no-drop","no-open-quote","no-repeat","none","normal","not-allowed","nowrap","ns-resize","nw-resize","nwse-resize","oblique","octal","open-quote","optimizeLegibility","optimizeSpeed","oriya","oromo","outset","outside","outside-shape","overlay","overline","padding","padding-box","painted","page","paused","persian","plus-darker","plus-lighter","pointer","polygon","portrait","pre","pre-line","pre-wrap","preserve-3d","progress","push-button","radio","read-only","read-write","read-write-plaintext-only","rectangle","region","relative","repeat","repeat-x","repeat-y","reset","reverse","rgb","rgba","ridge","right","round","row-resize","rtl","run-in","running","s-resize","sans-serif","scroll","scrollbar","se-resize","searchfield","searchfield-cancel-button","searchfield-decoration","searchfield-results-button","searchfield-results-decoration","semi-condensed","semi-expanded","separate","serif","show","sidama","single","skip-white-space","slide","slider-horizontal","slider-vertical","sliderthumb-horizontal","sliderthumb-vertical","slow","small","small-caps","small-caption","smaller","solid","somali","source-atop","source-in","source-out","source-over","space","square","square-button","start","static","status-bar","stretch","stroke","sub","subpixel-antialiased","super","sw-resize","table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row","table-row-group","telugu","text","text-bottom","text-top","textarea","textfield","thai","thick","thin","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","tibetan","tigre","tigrinya-er","tigrinya-er-abegede","tigrinya-et","tigrinya-et-abegede","to","top","transparent","ultra-condensed","ultra-expanded","underline","up","upper-alpha","upper-armenian","upper-greek","upper-hexadecimal","upper-latin","upper-norwegian","upper-roman","uppercase","urdu","url","vertical","vertical-text","visible","visibleFill","visiblePainted","visibleStroke","visual","w-resize","wait","wave","wider","window","windowframe","windowtext","x-large","x-small","xor","xx-large","xx-small"],valueKeywords=keySet(valueKeywords_),fontProperties_=["font-family","src","unicode-range","font-variant","font-feature-settings","font-stretch","font-weight","font-style"],fontProperties=keySet(fontProperties_),allWords=mediaTypes_.concat(mediaFeatures_).concat(propertyKeywords_).concat(colorKeywords_).concat(valueKeywords_);CodeMirror.registerHelper("hintWords","css",allWords),CodeMirror.defineMIME("text/css",{mediaTypes:mediaTypes,mediaFeatures:mediaFeatures,propertyKeywords:propertyKeywords,colorKeywords:colorKeywords,valueKeywords:valueKeywords,fontProperties:fontProperties,tokenHooks:{"<":function(stream,state){return stream.match("!--")?(state.tokenize=tokenSGMLComment,tokenSGMLComment(stream,state)):!1},"/":function(stream,state){return stream.eat("*")?(state.tokenize=tokenCComment,tokenCComment(stream,state)):!1}},name:"css"}),CodeMirror.defineMIME("text/x-scss",{mediaTypes:mediaTypes,mediaFeatures:mediaFeatures,propertyKeywords:propertyKeywords,colorKeywords:colorKeywords,valueKeywords:valueKeywords,fontProperties:fontProperties,allowNested:!0,tokenHooks:{"/":function(stream,state){return stream.eat("/")?(stream.skipToEnd(),["comment","comment"]):stream.eat("*")?(state.tokenize=tokenCComment,tokenCComment(stream,state)):["operator","operator"]},":":function(stream){return stream.match(/\s*{/)?[null,"{"]:!1},$:function(stream){return stream.match(/^[\w-]+/),stream.match(/^\s*:/,!1)?["variable-2","variable-definition"]:["variable-2","variable"]},"#":function(stream){return stream.eat("{")?[null,"interpolation"]:!1}},name:"css",helperType:"scss"}),CodeMirror.defineMIME("text/x-less",{mediaTypes:mediaTypes,mediaFeatures:mediaFeatures,propertyKeywords:propertyKeywords,colorKeywords:colorKeywords,valueKeywords:valueKeywords,fontProperties:fontProperties,allowNested:!0,tokenHooks:{"/":function(stream,state){return stream.eat("/")?(stream.skipToEnd(),["comment","comment"]):stream.eat("*")?(state.tokenize=tokenCComment,tokenCComment(stream,state)):["operator","operator"]},"@":function(stream){return stream.match(/^(charset|document|font-face|import|(-(moz|ms|o|webkit)-)?keyframes|media|namespace|page|supports)\b/,!1)?!1:(stream.eatWhile(/[\w\\\-]/),stream.match(/^\s*:/,!1)?["variable-2","variable-definition"]:["variable-2","variable"])},"&":function(){return["atom","atom"]}},name:"css",helperType:"less"})}(),CodeMirror.defineMode("ruby",function(config){function wordObj(words){for(var o={},i=0,e=words.length;e>i;++i)o[words[i]]=!0;return o}function chain(newtok,stream,state){return state.tokenize.push(newtok),newtok(stream,state)}function tokenBase(stream,state){if(curPunc=null,stream.sol()&&stream.match("=begin")&&stream.eol())return state.tokenize.push(readBlockComment),"comment";if(stream.eatSpace())return null;var m,ch=stream.next();if("`"==ch||"'"==ch||'"'==ch)return chain(readQuoted(ch,"string",'"'==ch||"`"==ch),stream,state);if("/"!=ch||stream.eol()||" "==stream.peek()){if("%"==ch){var style="string",embed=!0;stream.eat("s")?style="atom":stream.eat(/[WQ]/)?style="string":stream.eat(/[r]/)?style="string-2":stream.eat(/[wxq]/)&&(style="string",embed=!1);var delim=stream.eat(/[^\w\s]/);return delim?(matching.propertyIsEnumerable(delim)&&(delim=matching[delim]),chain(readQuoted(delim,style,embed,!0),stream,state)):"operator"}if("#"==ch)return stream.skipToEnd(),"comment";if("<"==ch&&(m=stream.match(/^<-?[\`\"\']?([a-zA-Z_?]\w*)[\`\"\']?(?:;|$)/)))return chain(readHereDoc(m[1]),stream,state);if("0"==ch)return stream.eat("x")?stream.eatWhile(/[\da-fA-F]/):stream.eat("b")?stream.eatWhile(/[01]/):stream.eatWhile(/[0-7]/),"number";if(/\d/.test(ch))return stream.match(/^[\d_]*(?:\.[\d_]+)?(?:[eE][+\-]?[\d_]+)?/),"number";if("?"==ch){for(;stream.match(/^\\[CM]-/););return stream.eat("\\")?stream.eatWhile(/\w/):stream.next(),"string"}return":"==ch?stream.eat("'")?chain(readQuoted("'","atom",!1),stream,state):stream.eat('"')?chain(readQuoted('"',"atom",!0),stream,state):stream.eat(/[\<\>]/)?(stream.eat(/[\<\>]/),"atom"):stream.eat(/[\+\-\*\/\&\|\:\!]/)?"atom":stream.eat(/[a-zA-Z$@_]/)?(stream.eatWhile(/[\w]/),stream.eat(/[\?\!\=]/),"atom"):"operator":"@"==ch&&stream.match(/^@?[a-zA-Z_]/)?(stream.eat("@"),stream.eatWhile(/[\w]/),"variable-2"):"$"==ch?(stream.eat(/[a-zA-Z_]/)?stream.eatWhile(/[\w]/):stream.eat(/\d/)?stream.eat(/\d/):stream.next(),"variable-3"):/[a-zA-Z_]/.test(ch)?(stream.eatWhile(/[\w]/),stream.eat(/[\?\!]/),stream.eat(":")?"atom":"ident"):"|"!=ch||!state.varList&&"{"!=state.lastTok&&"do"!=state.lastTok?/[\(\)\[\]{}\\;]/.test(ch)?(curPunc=ch,null):"-"==ch&&stream.eat(">")?"arrow":/[=+\-\/*:\.^%<>~|]/.test(ch)?(stream.eatWhile(/[=+\-\/*:\.^%<>~|]/),"operator"):null:(curPunc="|",null)}return stream.eat("=")?"operator":chain(readQuoted(ch,"string-2",!0),stream,state)}function tokenBaseUntilBrace(){var depth=1;return function(stream,state){if("}"==stream.peek()){if(depth--,0==depth)return state.tokenize.pop(),state.tokenize[state.tokenize.length-1](stream,state)}else"{"==stream.peek()&&depth++;return tokenBase(stream,state)}}function tokenBaseOnce(){var alreadyCalled=!1;return function(stream,state){return alreadyCalled?(state.tokenize.pop(),state.tokenize[state.tokenize.length-1](stream,state)):(alreadyCalled=!0,tokenBase(stream,state))}}function readQuoted(quote,style,embed,unescaped){return function(stream,state){var ch,escaped=!1;for("read-quoted-paused"===state.context.type&&(state.context=state.context.prev,stream.eat("}"));null!=(ch=stream.next());){if(ch==quote&&(unescaped||!escaped)){state.tokenize.pop();break}if(embed&&"#"==ch&&!escaped){if(stream.eat("{")){"}"==quote&&(state.context={prev:state.context,type:"read-quoted-paused"}),state.tokenize.push(tokenBaseUntilBrace());break}if(/[@\$]/.test(stream.peek())){state.tokenize.push(tokenBaseOnce());break}}escaped=!escaped&&"\\"==ch}return style}}function readHereDoc(phrase){return function(stream,state){return stream.match(phrase)?state.tokenize.pop():stream.skipToEnd(),"string"}}function readBlockComment(stream,state){return stream.sol()&&stream.match("=end")&&stream.eol()&&state.tokenize.pop(),stream.skipToEnd(),"comment"}var curPunc,keywords=wordObj(["alias","and","BEGIN","begin","break","case","class","def","defined?","do","else","elsif","END","end","ensure","false","for","if","in","module","next","not","or","redo","rescue","retry","return","self","super","then","true","undef","unless","until","when","while","yield","nil","raise","throw","catch","fail","loop","callcc","caller","lambda","proc","public","protected","private","require","load","require_relative","extend","autoload","__END__","__FILE__","__LINE__","__dir__"]),indentWords=wordObj(["def","class","case","for","while","module","then","catch","loop","proc","begin"]),dedentWords=wordObj(["end","until"]),matching={"[":"]","{":"}","(":")"};return{startState:function(){return{tokenize:[tokenBase],indented:0,context:{type:"top",indented:-config.indentUnit},continuedLine:!1,lastTok:null,varList:!1}},token:function(stream,state){stream.sol()&&(state.indented=stream.indentation());var kwtype,style=state.tokenize[state.tokenize.length-1](stream,state);if("ident"==style){var word=stream.current();style=keywords.propertyIsEnumerable(stream.current())?"keyword":/^[A-Z]/.test(word)?"tag":"def"==state.lastTok||"class"==state.lastTok||state.varList?"def":"variable",indentWords.propertyIsEnumerable(word)?kwtype="indent":dedentWords.propertyIsEnumerable(word)?kwtype="dedent":"if"!=word&&"unless"!=word||stream.column()!=stream.indentation()?"do"==word&&state.context.indented<state.indented&&(kwtype="indent"):kwtype="indent"}return(curPunc||style&&"comment"!=style)&&(state.lastTok=word||curPunc||style),"|"==curPunc&&(state.varList=!state.varList),"indent"==kwtype||/[\(\[\{]/.test(curPunc)?state.context={prev:state.context,type:curPunc||style,indented:state.indented}:("dedent"==kwtype||/[\)\]\}]/.test(curPunc))&&state.context.prev&&(state.context=state.context.prev),stream.eol()&&(state.continuedLine="\\"==curPunc||"operator"==style),style},indent:function(state,textAfter){if(state.tokenize[state.tokenize.length-1]!=tokenBase)return 0;var firstChar=textAfter&&textAfter.charAt(0),ct=state.context,closing=ct.type==matching[firstChar]||"keyword"==ct.type&&/^(?:end|until|else|elsif|when|rescue)\b/.test(textAfter);return ct.indented+(closing?0:config.indentUnit)+(state.continuedLine?config.indentUnit:0)},electricChars:"}de",lineComment:"#"}}),CodeMirror.defineMIME("text/x-ruby","ruby"),CodeMirror.defineMode("htmlembedded",function(config,parserConfig){function htmlDispatch(stream,state){return stream.match(scriptStartRegex,!1)?(state.token=scriptingDispatch,scriptingMode.token(stream,state.scriptState)):htmlMixedMode.token(stream,state.htmlState)}function scriptingDispatch(stream,state){return stream.match(scriptEndRegex,!1)?(state.token=htmlDispatch,htmlMixedMode.token(stream,state.htmlState)):scriptingMode.token(stream,state.scriptState)}var scriptingMode,htmlMixedMode,scriptStartRegex=parserConfig.scriptStartRegex||/^<%/i,scriptEndRegex=parserConfig.scriptEndRegex||/^%>/i;return{startState:function(){return scriptingMode=scriptingMode||CodeMirror.getMode(config,parserConfig.scriptingModeSpec),htmlMixedMode=htmlMixedMode||CodeMirror.getMode(config,"htmlmixed"),{token:parserConfig.startOpen?scriptingDispatch:htmlDispatch,htmlState:CodeMirror.startState(htmlMixedMode),scriptState:CodeMirror.startState(scriptingMode)}},token:function(stream,state){return state.token(stream,state)},indent:function(state,textAfter){return state.token==htmlDispatch?htmlMixedMode.indent(state.htmlState,textAfter):scriptingMode.indent?scriptingMode.indent(state.scriptState,textAfter):void 0},copyState:function(state){return{token:state.token,htmlState:CodeMirror.copyState(htmlMixedMode,state.htmlState),scriptState:CodeMirror.copyState(scriptingMode,state.scriptState)}},innerMode:function(state){return state.token==scriptingDispatch?{state:state.scriptState,mode:scriptingMode}:{state:state.htmlState,mode:htmlMixedMode}}}},"htmlmixed"),CodeMirror.defineMIME("application/x-ejs",{name:"htmlembedded",scriptingModeSpec:"javascript"}),CodeMirror.defineMIME("application/x-aspx",{name:"htmlembedded",scriptingModeSpec:"text/x-csharp"}),CodeMirror.defineMIME("application/x-jsp",{name:"htmlembedded",scriptingModeSpec:"text/x-java"}),CodeMirror.defineMIME("application/x-erb",{name:"htmlembedded",scriptingModeSpec:"ruby"}),CodeMirror.runMode=function(string,modespec,callback,options){var mode=CodeMirror.getMode(CodeMirror.defaults,modespec),ie=/MSIE \d/.test(navigator.userAgent),ie_lt9=ie&&(null==document.documentMode||document.documentMode<9);if(1==callback.nodeType){var tabSize=options&&options.tabSize||CodeMirror.defaults.tabSize,node=callback,col=0;node.innerHTML="",callback=function(text,style){if("\n"==text)return node.appendChild(document.createTextNode(ie_lt9?"\r":text)),col=0,void 0;for(var content="",pos=0;;){var idx=text.indexOf("	",pos);if(-1==idx){content+=text.slice(pos),col+=text.length-pos;break}col+=idx-pos,content+=text.slice(pos,idx);var size=tabSize-col%tabSize;col+=size;for(var i=0;size>i;++i)content+=" ";pos=idx+1}if(style){var sp=node.appendChild(document.createElement("span"));sp.className="cm-"+style.replace(/ +/g," cm-"),sp.appendChild(document.createTextNode(content))}else node.appendChild(document.createTextNode(content))}}for(var lines=CodeMirror.splitLines(string),state=options&&options.state||CodeMirror.startState(mode),i=0,e=lines.length;e>i;++i){i&&callback("\n");for(var stream=new CodeMirror.StringStream(lines[i]);!stream.eol();){var style=mode.token(stream,state);callback(stream.current(),style,i,stream.start,state),stream.start=stream.pos}}},function(){"use strict";function doFold(cm,pos,options,force){function getRange(allowFolded){var range=finder(cm,pos);if(!range||range.to.line-range.from.line<minSize)return null;for(var marks=cm.findMarksAt(range.from),i=0;i<marks.length;++i)if(marks[i].__isFold&&"fold"!==force){if(!allowFolded)return null;range.cleared=!0,marks[i].clear()}return range}var finder=options&&(options.call?options:options.rangeFinder);finder||(finder=CodeMirror.fold.auto),"number"==typeof pos&&(pos=CodeMirror.Pos(pos,0));var minSize=options&&options.minFoldSize||0,range=getRange(!0);if(options&&options.scanUp)for(;!range&&pos.line>cm.firstLine();)pos=CodeMirror.Pos(pos.line-1,0),range=getRange(!1);if(range&&!range.cleared&&"unfold"!==force){var myWidget=makeWidget(options);CodeMirror.on(myWidget,"mousedown",function(){myRange.clear()});var myRange=cm.markText(range.from,range.to,{replacedWith:myWidget,clearOnEnter:!0,__isFold:!0});myRange.on("clear",function(from,to){CodeMirror.signal(cm,"unfold",cm,from,to)}),CodeMirror.signal(cm,"fold",cm,range.from,range.to)}}function makeWidget(options){var widget=options&&options.widget||"↔";if("string"==typeof widget){var text=document.createTextNode(widget);widget=document.createElement("span"),widget.appendChild(text),widget.className="CodeMirror-foldmarker"}return widget}CodeMirror.newFoldFunction=function(rangeFinder,widget){return function(cm,pos){doFold(cm,pos,{rangeFinder:rangeFinder,widget:widget})}},CodeMirror.defineExtension("foldCode",function(pos,options,force){doFold(this,pos,options,force)}),CodeMirror.defineExtension("isFolded",function(pos){for(var marks=this.findMarksAt(pos),i=0;i<marks.length;++i)if(marks[i].__isFold)return!0}),CodeMirror.commands.fold=function(cm){cm.foldCode(cm.getCursor())},CodeMirror.registerHelper("fold","combine",function(){var funcs=Array.prototype.slice.call(arguments,0);return function(cm,start){for(var i=0;i<funcs.length;++i){var found=funcs[i](cm,start);if(found)return found}}}),CodeMirror.registerHelper("fold","auto",function(cm,start){for(var helpers=cm.getHelpers(start,"fold"),i=0;i<helpers.length;i++){var cur=helpers[i](cm,start);if(cur)return cur}})}(),function(){"use strict";function State(options){this.options=options,this.from=this.to=0}function parseOptions(opts){return opts===!0&&(opts={}),null==opts.gutter&&(opts.gutter="CodeMirror-foldgutter"),null==opts.indicatorOpen&&(opts.indicatorOpen="CodeMirror-foldgutter-open"),null==opts.indicatorFolded&&(opts.indicatorFolded="CodeMirror-foldgutter-folded"),opts}function isFolded(cm,line){for(var marks=cm.findMarksAt(Pos(line)),i=0;i<marks.length;++i)if(marks[i].__isFold&&marks[i].find().from.line==line)return!0}function marker(spec){if("string"==typeof spec){var elt=document.createElement("div");return elt.className=spec,elt}return spec.cloneNode(!0)}function updateFoldInfo(cm,from,to){var opts=cm.state.foldGutter.options,cur=from;cm.eachLine(from,to,function(line){var mark=null;if(isFolded(cm,cur))mark=marker(opts.indicatorFolded);else{var pos=Pos(cur,0),func=opts.rangeFinder||CodeMirror.fold.auto,range=func&&func(cm,pos);range&&range.from.line+1<range.to.line&&(mark=marker(opts.indicatorOpen))}cm.setGutterMarker(line,opts.gutter,mark),++cur})}function updateInViewport(cm){var vp=cm.getViewport(),state=cm.state.foldGutter;state&&(cm.operation(function(){updateFoldInfo(cm,vp.from,vp.to)}),state.from=vp.from,state.to=vp.to)}function onGutterClick(cm,line,gutter){var opts=cm.state.foldGutter.options;
gutter==opts.gutter&&cm.foldCode(Pos(line,0),opts.rangeFinder)}function onChange(cm){var state=cm.state.foldGutter,opts=cm.state.foldGutter.options;state.from=state.to=0,clearTimeout(state.changeUpdate),state.changeUpdate=setTimeout(function(){updateInViewport(cm)},opts.foldOnChangeTimeSpan||600)}function onViewportChange(cm){var state=cm.state.foldGutter,opts=cm.state.foldGutter.options;clearTimeout(state.changeUpdate),state.changeUpdate=setTimeout(function(){var vp=cm.getViewport();state.from==state.to||vp.from-state.to>20||state.from-vp.to>20?updateInViewport(cm):cm.operation(function(){vp.from<state.from&&(updateFoldInfo(cm,vp.from,state.from),state.from=vp.from),vp.to>state.to&&(updateFoldInfo(cm,state.to,vp.to),state.to=vp.to)})},opts.updateViewportTimeSpan||400)}function onFold(cm,from){var state=cm.state.foldGutter,line=from.line;line>=state.from&&line<state.to&&updateFoldInfo(cm,line,line+1)}CodeMirror.defineOption("foldGutter",!1,function(cm,val,old){old&&old!=CodeMirror.Init&&(cm.clearGutter(cm.state.foldGutter.options.gutter),cm.state.foldGutter=null,cm.off("gutterClick",onGutterClick),cm.off("change",onChange),cm.off("viewportChange",onViewportChange),cm.off("fold",onFold),cm.off("unfold",onFold),cm.off("swapDoc",updateInViewport)),val&&(cm.state.foldGutter=new State(parseOptions(val)),updateInViewport(cm),cm.on("gutterClick",onGutterClick),cm.on("change",onChange),cm.on("viewportChange",onViewportChange),cm.on("fold",onFold),cm.on("unfold",onFold),cm.on("swapDoc",updateInViewport))});var Pos=CodeMirror.Pos}(),CodeMirror.registerHelper("fold","brace",function(cm,start){function findOpening(openCh){for(var at=start.ch,pass=0;;){var found=0>=at?-1:lineText.lastIndexOf(openCh,at-1);if(-1!=found){if(1==pass&&found<start.ch)break;if(tokenType=cm.getTokenTypeAt(CodeMirror.Pos(line,found+1)),!/^(comment|string)/.test(tokenType))return found+1;at=found-1}else{if(1==pass)break;pass=1,at=lineText.length}}}var startCh,tokenType,line=start.line,lineText=cm.getLine(line),startToken="{",endToken="}",startCh=findOpening("{");if(null==startCh&&(startToken="[",endToken="]",startCh=findOpening("[")),null!=startCh){var end,endCh,count=1,lastLine=cm.lastLine();outer:for(var i=line;lastLine>=i;++i)for(var text=cm.getLine(i),pos=i==line?startCh:0;;){var nextOpen=text.indexOf(startToken,pos),nextClose=text.indexOf(endToken,pos);if(0>nextOpen&&(nextOpen=text.length),0>nextClose&&(nextClose=text.length),pos=Math.min(nextOpen,nextClose),pos==text.length)break;if(cm.getTokenTypeAt(CodeMirror.Pos(i,pos+1))==tokenType)if(pos==nextOpen)++count;else if(!--count){end=i,endCh=pos;break outer}++pos}if(null!=end&&(line!=end||endCh!=startCh))return{from:CodeMirror.Pos(line,startCh),to:CodeMirror.Pos(end,endCh)}}}),CodeMirror.braceRangeFinder=CodeMirror.fold.brace,CodeMirror.registerHelper("fold","import",function(cm,start){function hasImport(line){if(line<cm.firstLine()||line>cm.lastLine())return null;var start=cm.getTokenAt(CodeMirror.Pos(line,1));if(/\S/.test(start.string)||(start=cm.getTokenAt(CodeMirror.Pos(line,start.end+1))),"keyword"!=start.type||"import"!=start.string)return null;for(var i=line,e=Math.min(cm.lastLine(),line+10);e>=i;++i){var text=cm.getLine(i),semi=text.indexOf(";");if(-1!=semi)return{startCh:start.end,end:CodeMirror.Pos(i,semi)}}}var prev,start=start.line,has=hasImport(start);if(!has||hasImport(start-1)||(prev=hasImport(start-2))&&prev.end.line==start-1)return null;for(var end=has.end;;){var next=hasImport(end.line+1);if(null==next)break;end=next.end}return{from:cm.clipPos(CodeMirror.Pos(start,has.startCh+1)),to:end}}),CodeMirror.importRangeFinder=CodeMirror.fold["import"],CodeMirror.registerHelper("fold","include",function(cm,start){function hasInclude(line){if(line<cm.firstLine()||line>cm.lastLine())return null;var start=cm.getTokenAt(CodeMirror.Pos(line,1));return/\S/.test(start.string)||(start=cm.getTokenAt(CodeMirror.Pos(line,start.end+1))),"meta"==start.type&&"#include"==start.string.slice(0,8)?start.start+8:void 0}var start=start.line,has=hasInclude(start);if(null==has||null!=hasInclude(start-1))return null;for(var end=start;;){var next=hasInclude(end+1);if(null==next)break;++end}return{from:CodeMirror.Pos(start,has+1),to:cm.clipPos(CodeMirror.Pos(end))}}),CodeMirror.includeRangeFinder=CodeMirror.fold.include,CodeMirror.registerGlobalHelper("fold","comment",function(mode){return mode.blockCommentStart&&mode.blockCommentEnd},function(cm,start){var mode=cm.getModeAt(start),startToken=mode.blockCommentStart,endToken=mode.blockCommentEnd;if(startToken&&endToken){for(var startCh,line=start.line,lineText=cm.getLine(line),at=start.ch,pass=0;;){var found=0>=at?-1:lineText.lastIndexOf(startToken,at-1);if(-1!=found){if(1==pass&&found<start.ch)return;if(/comment/.test(cm.getTokenTypeAt(CodeMirror.Pos(line,found+1)))){startCh=found+startToken.length;break}at=found-1}else{if(1==pass)return;pass=1,at=lineText.length}}var end,endCh,depth=1,lastLine=cm.lastLine();outer:for(var i=line;lastLine>=i;++i)for(var text=cm.getLine(i),pos=i==line?startCh:0;;){var nextOpen=text.indexOf(startToken,pos),nextClose=text.indexOf(endToken,pos);if(0>nextOpen&&(nextOpen=text.length),0>nextClose&&(nextClose=text.length),pos=Math.min(nextOpen,nextClose),pos==text.length)break;if(pos==nextOpen)++depth;else if(!--depth){end=i,endCh=pos;break outer}++pos}if(null!=end&&(line!=end||endCh!=startCh))return{from:CodeMirror.Pos(line,startCh),to:CodeMirror.Pos(end,endCh)}}}),CodeMirror.registerHelper("fold","indent",function(cm,start){var tabSize=cm.getOption("tabSize"),firstLine=cm.getLine(start.line);if(/\S/.test(firstLine)){for(var getIndent=function(line){return CodeMirror.countColumn(line,null,tabSize)},myIndent=getIndent(firstLine),lastLineInFold=null,i=start.line+1,end=cm.lastLine();end>=i;++i){var curLine=cm.getLine(i),curIndent=getIndent(curLine);if(curIndent>myIndent)lastLineInFold=i;else if(/\S/.test(curLine))break}return lastLineInFold?{from:CodeMirror.Pos(start.line,firstLine.length),to:CodeMirror.Pos(lastLineInFold,cm.getLine(lastLineInFold).length)}:void 0}}),CodeMirror.indentRangeFinder=CodeMirror.fold.indent,CodeMirror.registerHelper("fold","markdown",function(cm,start){function isHeader(lineNo){var tokentype=cm.getTokenTypeAt(CodeMirror.Pos(lineNo,0));return tokentype&&/\bheader\b/.test(tokentype)}function headerLevel(lineNo,line,nextLine){var match=line&&line.match(/^#+/);return match&&isHeader(lineNo)?match[0].length:(match=nextLine&&nextLine.match(/^[=\-]+\s*$/),match&&isHeader(lineNo+1)?"="==nextLine[0]?1:2:maxDepth)}var maxDepth=100,firstLine=cm.getLine(start.line),nextLine=cm.getLine(start.line+1),level=headerLevel(start.line,firstLine,nextLine);if(level===maxDepth)return void 0;for(var lastLineNo=cm.lastLine(),end=start.line,nextNextLine=cm.getLine(end+2);lastLineNo>end&&!(headerLevel(end+1,nextLine,nextNextLine)<=level);)++end,nextLine=nextNextLine,nextNextLine=cm.getLine(end+2);return{from:CodeMirror.Pos(start.line,firstLine.length),to:CodeMirror.Pos(end,cm.getLine(end).length)}}),function(){"use strict";function cmp(a,b){return a.line-b.line||a.ch-b.ch}function Iter(cm,line,ch,range){this.line=line,this.ch=ch,this.cm=cm,this.text=cm.getLine(line),this.min=range?range.from:cm.firstLine(),this.max=range?range.to-1:cm.lastLine()}function tagAt(iter,ch){var type=iter.cm.getTokenTypeAt(Pos(iter.line,ch));return type&&/\btag\b/.test(type)}function nextLine(iter){return iter.line>=iter.max?void 0:(iter.ch=0,iter.text=iter.cm.getLine(++iter.line),!0)}function prevLine(iter){return iter.line<=iter.min?void 0:(iter.text=iter.cm.getLine(--iter.line),iter.ch=iter.text.length,!0)}function toTagEnd(iter){for(;;){var gt=iter.text.indexOf(">",iter.ch);if(-1==gt){if(nextLine(iter))continue;return}{if(tagAt(iter,gt+1)){var lastSlash=iter.text.lastIndexOf("/",gt),selfClose=lastSlash>-1&&!/\S/.test(iter.text.slice(lastSlash+1,gt));return iter.ch=gt+1,selfClose?"selfClose":"regular"}iter.ch=gt+1}}}function toTagStart(iter){for(;;){var lt=iter.ch?iter.text.lastIndexOf("<",iter.ch-1):-1;if(-1==lt){if(prevLine(iter))continue;return}if(tagAt(iter,lt+1)){xmlTagStart.lastIndex=lt,iter.ch=lt;var match=xmlTagStart.exec(iter.text);if(match&&match.index==lt)return match}else iter.ch=lt}}function toNextTag(iter){for(;;){xmlTagStart.lastIndex=iter.ch;var found=xmlTagStart.exec(iter.text);if(!found){if(nextLine(iter))continue;return}{if(tagAt(iter,found.index+1))return iter.ch=found.index+found[0].length,found;iter.ch=found.index+1}}}function toPrevTag(iter){for(;;){var gt=iter.ch?iter.text.lastIndexOf(">",iter.ch-1):-1;if(-1==gt){if(prevLine(iter))continue;return}{if(tagAt(iter,gt+1)){var lastSlash=iter.text.lastIndexOf("/",gt),selfClose=lastSlash>-1&&!/\S/.test(iter.text.slice(lastSlash+1,gt));return iter.ch=gt+1,selfClose?"selfClose":"regular"}iter.ch=gt}}}function findMatchingClose(iter,tag){for(var stack=[];;){var end,next=toNextTag(iter),startLine=iter.line,startCh=iter.ch-(next?next[0].length:0);if(!next||!(end=toTagEnd(iter)))return;if("selfClose"!=end)if(next[1]){for(var i=stack.length-1;i>=0;--i)if(stack[i]==next[2]){stack.length=i;break}if(0>i&&(!tag||tag==next[2]))return{tag:next[2],from:Pos(startLine,startCh),to:Pos(iter.line,iter.ch)}}else stack.push(next[2])}}function findMatchingOpen(iter,tag){for(var stack=[];;){var prev=toPrevTag(iter);if(!prev)return;if("selfClose"!=prev){var endLine=iter.line,endCh=iter.ch,start=toTagStart(iter);if(!start)return;if(start[1])stack.push(start[2]);else{for(var i=stack.length-1;i>=0;--i)if(stack[i]==start[2]){stack.length=i;break}if(0>i&&(!tag||tag==start[2]))return{tag:start[2],from:Pos(iter.line,iter.ch),to:Pos(endLine,endCh)}}}else toTagStart(iter)}}var Pos=CodeMirror.Pos,nameStartChar="A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",nameChar=nameStartChar+"-:.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040",xmlTagStart=new RegExp("<(/?)(["+nameStartChar+"]["+nameChar+"]*)","g");CodeMirror.registerHelper("fold","xml",function(cm,start){for(var iter=new Iter(cm,start.line,0);;){var end,openTag=toNextTag(iter);if(!openTag||iter.line!=start.line||!(end=toTagEnd(iter)))return;if(!openTag[1]&&"selfClose"!=end){var start=Pos(iter.line,iter.ch),close=findMatchingClose(iter,openTag[2]);return close&&{from:start,to:close.from}}}}),CodeMirror.tagRangeFinder=CodeMirror.fold.xml,CodeMirror.findMatchingTag=function(cm,pos,range){var iter=new Iter(cm,pos.line,pos.ch,range);if(-1!=iter.text.indexOf(">")||-1!=iter.text.indexOf("<")){var end=toTagEnd(iter),to=end&&Pos(iter.line,iter.ch),start=end&&toTagStart(iter);if(end&&"selfClose"!=end&&start&&!(cmp(iter,pos)>0)){var here={from:Pos(iter.line,iter.ch),to:to,tag:start[2]};return start[1]?{open:findMatchingOpen(iter,start[2]),close:here,at:"close"}:(iter=new Iter(cm,to.line,to.ch,range),{open:here,close:findMatchingClose(iter,start[2]),at:"open"})}}},CodeMirror.findEnclosingTag=function(cm,pos,range){for(var iter=new Iter(cm,pos.line,pos.ch,range);;){var open=findMatchingOpen(iter);if(!open)break;var forward=new Iter(cm,pos.line,pos.ch,range),close=findMatchingClose(forward,open.tag);if(close)return{open:open,close:close}}},CodeMirror.scanForClosingTag=function(cm,pos,name,end){var iter=new Iter(cm,pos.line,pos.ch,end?{from:0,to:end}:null);return!!findMatchingClose(iter,name)}}(),function(){var Filter,STYLES,defaults,extend,toHexString,_i,_results,__slice=[].slice;STYLES={ef0:"color:#000",ef1:"color:#A00",ef2:"color:#0A0",ef3:"color:#A50",ef4:"color:#00A",ef5:"color:#A0A",ef6:"color:#0AA",ef7:"color:#AAA",ef8:"color:#555",ef9:"color:#F55",ef10:"color:#5F5",ef11:"color:#FF5",ef12:"color:#55F",ef13:"color:#F5F",ef14:"color:#5FF",ef15:"color:#FFF",eb0:"background-color:#000",eb1:"background-color:#A00",eb2:"background-color:#0A0",eb3:"background-color:#A50",eb4:"background-color:#00A",eb5:"background-color:#A0A",eb6:"background-color:#0AA",eb7:"background-color:#AAA",eb8:"background-color:#555",eb9:"background-color:#F55",eb10:"background-color:#5F5",eb11:"background-color:#FF5",eb12:"background-color:#55F",eb13:"background-color:#F5F",eb14:"background-color:#5FF",eb15:"background-color:#FFF"},toHexString=function(num){for(num=num.toString(16);num.length<2;)num="0"+num;return num},[0,1,2,3,4,5].forEach(function(red){return[0,1,2,3,4,5].forEach(function(green){return[0,1,2,3,4,5].forEach(function(blue){var b,c,g,n,r,rgb;return c=16+36*red+6*green+blue,r=red>0?40*red+55:0,g=green>0?40*green+55:0,b=blue>0?40*blue+55:0,rgb=function(){var _i,_len,_ref,_results;for(_ref=[r,g,b],_results=[],_i=0,_len=_ref.length;_len>_i;_i++)n=_ref[_i],_results.push(toHexString(n));return _results}().join(""),STYLES["ef"+c]="color:#"+rgb,STYLES["eb"+c]="background-color:#"+rgb})})}),function(){for(_results=[],_i=0;23>=_i;_i++)_results.push(_i);return _results}.apply(this).forEach(function(gray){var c,l;return c=gray+232,l=toHexString(10*gray+8),STYLES["ef"+c]="color:#"+l+l+l,STYLES["eb"+c]="background-color:#"+l+l+l}),extend=function(){var dest,k,obj,objs,v,_j,_len;for(dest=arguments[0],objs=2<=arguments.length?__slice.call(arguments,1):[],_j=0,_len=objs.length;_len>_j;_j++){obj=objs[_j];for(k in obj)v=obj[k],dest[k]=v}return dest},defaults={fg:"#FFF",bg:"#000"},Filter=function(){function Filter(options){null==options&&(options={}),this.opts=extend({},defaults,options),this.input=[],this.stack=[]}return Filter.prototype.toHtml=function(input){var buf;return this.input="string"==typeof input?[input]:input,buf=[],this.forEach(function(chunk){return buf.push(chunk)}),this.input=[],buf.join("")},Filter.prototype.forEach=function(callback){var buf,handleDisplay,_this=this;return buf="",handleDisplay=function(code){return code=parseInt(code,10),-1===code&&callback("<br/>"),0===code&&_this.stack.length&&callback(_this.resetStyles()),1===code&&callback(_this.pushTag("b")),code>2&&5>code&&callback(_this.pushTag("u")),code>4&&7>code&&callback(_this.pushTag("blink")),8===code&&callback(_this.pushStyle("display:none")),9===code&&callback(_this.pushTag("strike")),24===code&&callback(_this.closeTag("u")),code>29&&38>code&&callback(_this.pushStyle("ef"+(code-30))),39===code&&callback(_this.pushStyle("color:"+_this.opts.fg)),code>39&&48>code&&callback(_this.pushStyle("eb"+(code-40))),49===code&&callback(_this.pushStyle("background-color:"+_this.opts.bg)),code>89&&98>code&&callback(_this.pushStyle("ef"+(8+(code-90)))),code>99&&108>code?callback(_this.pushStyle("eb"+(8+(code-100)))):void 0},this.input.forEach(function(chunk){return buf+=chunk,_this.tokenize(buf,function(tok,data){switch(tok){case"text":return callback(data);case"display":return handleDisplay(data);case"xterm256":return callback(_this.pushStyle("ef"+data))}})}),this.stack.length?callback(this.resetStyles()):void 0},Filter.prototype.pushTag=function(tag,style){return null==style&&(style=""),style.length&&-1===style.indexOf(":")&&(style=STYLES[style]),this.stack.push(tag),["<"+tag,style?' style="'+style+'"':void 0,">"].join("")},Filter.prototype.pushStyle=function(style){return this.pushTag("span",style)},Filter.prototype.closeTag=function(style){var last;return this.stack.slice(-1)[0]===style&&(last=this.stack.pop()),null!=last?"</"+style+">":void 0},Filter.prototype.resetStyles=function(){var stack,_ref;return _ref=[this.stack,[]],stack=_ref[0],this.stack=_ref[1],stack.reverse().map(function(tag){return"</"+tag+">"}).join("")},Filter.prototype.tokenize=function(text,callback){var ansiHandler,ansiMatch,ansiMess,handler,i,length,newline,process,realText,remove,removeXterm256,tokens,_j,_len,_results1,_this=this;for(ansiMatch=!1,ansiHandler=3,remove=function(){return""},removeXterm256=function(m,g1){return callback("xterm256",g1),""},newline=function(m){return _this.opts.newline?callback("display",-1):callback("text",m),""},ansiMess=function(m,g1){var code,_j,_len;for(ansiMatch=!0,0===g1.trim().length&&(g1="0"),g1=g1.trimRight(";").split(";"),_j=0,_len=g1.length;_len>_j;_j++)code=g1[_j],callback("display",code);return""},realText=function(m){return callback("text",m),""},tokens=[{pattern:/^\x08+/,sub:remove},{pattern:/^\x1b\[38;5;(\d+)m/,sub:removeXterm256},{pattern:/^\n+/,sub:newline},{pattern:/^\x1b\[((?:\d{1,3};?)+|)m/,sub:ansiMess},{pattern:/^\x1b\[?[\d;]{0,3}/,sub:remove},{pattern:/^([^\x1b\x08\n]+)/,sub:realText}],process=function(handler,i){var matches;i>ansiHandler&&ansiMatch||(ansiMatch=!1,matches=text.match(handler.pattern),text=text.replace(handler.pattern,handler.sub))},_results1=[];(length=text.length)>0;){for(i=_j=0,_len=tokens.length;_len>_j;i=++_j)handler=tokens[i],process(handler,i);if(text.length===length)break;_results1.push(void 0)}return _results1},Filter}(),window.ansi_to_html=Filter}.call(this),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}};window.CSConsole=function(){function CSConsole(el,options){this.moveInputForward=__bind(this.moveInputForward,this),this.addColors=__bind(this.addColors,this),this.formatWidgetElementText=__bind(this.formatWidgetElementText,this),this.buildWidget=__bind(this.buildWidget,this),this.renderResponse=__bind(this.renderResponse,this),this.responseObject=__bind(this.responseObject,this),this.lineNumber=__bind(this.lineNumber,this),this.inputLine=__bind(this.inputLine,this),this.promptLength=__bind(this.promptLength,this),this.submit=__bind(this.submit,this),this.initCallbacks=__bind(this.initCallbacks,this),this.showWelcomeMessage=__bind(this.showWelcomeMessage,this),this.previousHistory=__bind(this.previousHistory,this),this.nextHistory=__bind(this.nextHistory,this),this.focusInput=__bind(this.focusInput,this),this.innerConsole=__bind(this.innerConsole,this),this.reset=__bind(this.reset,this),this.getAllInput=__bind(this.getAllInput,this),this.setPrompt=__bind(this.setPrompt,this),this.getValue=__bind(this.getValue,this),this.setValue=__bind(this.setValue,this),this.options=options,this.options.prompt||(this.options.prompt="> "),this.initCallbacks(options),this.initializeKeyMap(),this.initConsole(el),this.submitHistory=new CSConsoleHistory(this.options)}var CSConsoleHistory,KeyActions;return CSConsole.prototype.keyMap={"Alt-Delete":"delGroupAfter","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Right":"goLineEnd","Ctrl-E":"goLineEnd","Ctrl-Alt-Backspace":"delGroupAfter",Delete:"delCharAfter",End:"goLineEnd",Home:"goLineStartSmart",PageDown:"goPageDown",PageUp:"goPageUp",Right:"goCharRight","Ctrl-F":"goCharRight"},CSConsole.prototype.outputWidgets=[],CSConsole.prototype.currentLine=0,CSConsole.prototype.submitInProgress=!1,CSConsole.prototype.setValue=function(value){return this.console.setLine(this.lineNumber(),""+this.options.prompt+value)},CSConsole.prototype.getValue=function(){return this.getAllInput()},CSConsole.prototype.setPrompt=function(prompt){return this.console.setLine(this.currentLine,this.console.getLine(this.currentLine).replace(new RegExp(this.options.prompt),prompt)),this.options.prompt=prompt},CSConsole.prototype.focus=function(){return this.console.getInputField().focus()},CSConsole.prototype.appendToInput=function(value){return this.console.setLine(this.lineNumber(),""+this.console.getLine(this.lineNumber())+value)},CSConsole.prototype.getAllInput=function(){var input,lineInput,startingInput;for(startingInput=this.currentLine,input=[];startingInput<=this.lineNumber();)startingInput===this.currentLine?(lineInput=this.console.getLine(startingInput).substr(this.promptLength(),this.console.getLine(this.currentLine).length),input.push(lineInput)):input.push(this.console.getLine(startingInput)),startingInput++;return input.join("\n")},CSConsole.prototype.reset=function(welcomeMessage){var widget,_i,_len,_ref;for(null==welcomeMessage&&(welcomeMessage=!0),this.submitInProgress=!1,this.console.setValue(""),_ref=this.outputWidgets,_i=0,_len=_ref.length;_len>_i;_i++)widget=_ref[_i],this.console.removeLineWidget(widget);return this.outputWidgets=[],this.options.welcomeMessage&&welcomeMessage&&(this.showWelcomeMessage(),this.moveInputForward()),this.console.refresh(),this.console.scrollIntoView()},CSConsole.prototype.innerConsole=function(){return this.console},CSConsole.prototype.initializeKeyMap=function(){return window.CodeMirror.keyMap.console=this.keyMap},CSConsole.prototype.initConsole=function(el){var keyActions,_this=this;return el.className+=" cs-console cs-console-height cs-console-width",keyActions=new KeyActions(this.options),this.console=window.CodeMirror(el,{mode:{name:this.options.syntax,useCPP:!0},gutter:this.options.lineNumbers,lineNumbers:this.options.lineNumbers,theme:this.options.theme||"vibrant-ink",indentUnit:2,tabSize:2,keyMap:"console",lineWrapping:!0,onKeyEvent:this.focusInput,undoDepth:0,autoFocus:this.options.autoFocus,extraKeys:{Enter:this.submit,"Ctrl-M":this.submit,Tab:this.noop,Left:keyActions.goCharLeft,"Ctrl-B":keyActions.goCharLeft,Backspace:keyActions.delCharBefore,"Cmd-Up":keyActions.goDocStart,"Cmd-Down":keyActions.goDocEnd,"Cmd-Left":keyActions.goLineStart,Home:keyActions.goLineStart,"Ctrl-A":keyActions.goLineStart,"Alt-Backspace":keyActions.delGroupBefore,"Ctrl-W":keyActions.delGroupBefore,"Cmd-Backspace":keyActions.deleteLine,Up:this.nextHistory,Down:this.previousHistory,"Ctrl-P":this.nextHistory,"Ctrl-N":this.previousHistory,"Shift-Cmd-Right":this.noop,"Shift-Cmd-Left":this.noop,"Shift-Right":this.noop,"Shift-Alt-Right":this.noop,"Shift-Alt-Left":this.noop,"Ctrl-Enter":this.noop,"Alt-Enter":this.noop,"Shift-Tab":this.noop,"Cmd-S":this.noop,"Ctrl-Z":this.noop,"Cmd-Z":this.noop}}),keyActions.setConsole(this.console),setTimeout(function(){return _this.console.refresh()},1),this.console.getScrollerElement().className+=" cs-console-height",this.console.getWrapperElement().className+=" cs-console-height cs-console-width",this.options.welcomeMessage&&this.showWelcomeMessage(),this.options.initialValue&&(this.setValue(this.options.initialValue),this.moveInputForward()),this.options.autoFocus&&setTimeout(function(){return _this.console.getInputField().focus()},10),this.moveInputForward()},CSConsole.prototype.focusInput=function(){var cursorPos;return cursorPos=this.console.getCursor(),cursorPos.line===this.lineNumber()?(this.storedCursorPosition=this.console.getCursor(),cursorPos.ch<this.promptLength()&&this.console.setCursor({line:cursorPos.line,ch:this.promptLength()})):this.console.setCursor(this.storedCursorPosition),!1},CSConsole.prototype.nextHistory=function(){return this.setValue(this.submitHistory.nextHistory())},CSConsole.prototype.previousHistory=function(){return this.setValue(this.submitHistory.previousHistory())},CSConsole.prototype.showWelcomeMessage=function(){var line;return this.console.setValue(""),line={content:this.options.welcomeMessage},this.buildWidget(1,line,{above:!0})},CSConsole.prototype.initCallbacks=function(options){return this.commandValidate=options.commandValidate,this.commandHandle=options.commandHandle},CSConsole.prototype.submit=function(){var input;return input=this.getAllInput(),void 0!==this.options.commandValidate&&!this.options.commandValidate(input)||this.submitInProgress?this.submitInProgress?this.nonReactingNewline():this.moveInputForward():(this.submitInProgress=!0,this.submitHistory.push(input),this.submitHistory.resetIndex(),this.commandHandle(input,this.responseObject(),this.options.prompt))},CSConsole.prototype.nonReactingNewline=function(){return this.currentLine=this.lineNumber(),this.console.setLine(this.currentLine,""+this.inputLine()+"\n")},CSConsole.prototype.promptLength=function(){return this.options.prompt.length},CSConsole.prototype.inputLine=function(){return this.console.getLine(this.lineNumber())},CSConsole.prototype.lineNumber=function(){return this.console.lineCount()-1},CSConsole.prototype.responseObject=function(){var _this=this;return function(responseLines){return _this.renderResponse(responseLines)}},CSConsole.prototype.renderResponse=function(responseLines){var line,lineNumber,_i,_len;if(!responseLines)return this.moveInputForward(),this.submitInProgress=!1,void 0;if(lineNumber=this.lineNumber(),responseLines.constructor===Array)for(_i=0,_len=responseLines.length;_len>_i;_i++)line=responseLines[_i],this.buildWidget(lineNumber,line);else this.buildWidget(lineNumber,responseLines);return this.buildWidget(lineNumber,{content:document.createElement("p"),className:"cs-console-output-spacer bottom"}),this.moveInputForward(),this.submitInProgress=!1},CSConsole.prototype.htmlEscape=function(string){return(""+string).replace(/&(?!\w+;|#\d+;|#x[\da-f]+;)/gi,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},CSConsole.prototype.buildWidget=function(lineNumber,responseLine,widgetOptions){var widgetContent,widgetElement,_this=this;return null==widgetOptions&&(widgetOptions={}),widgetContent=responseLine?responseLine.content:"",this.isHtmlElement(widgetContent)?widgetElement=widgetContent:(widgetElement=document.createElement("div"),widgetElement.innerHTML=this.formatWidgetElementText(this.htmlEscape(widgetContent)),widgetElement.className="cs-console-output-element",widgetElement.style.whiteSpace="pre-wrap"),(null!=responseLine?responseLine.className:void 0)&&(widgetElement.className+=" "+responseLine.className),Object.keys(widgetOptions).indexOf("coverGutter")<0&&(widgetOptions.coverGutter=!1),Object.keys(widgetOptions).indexOf("noHScroll")<0&&(widgetOptions.noHScroll=!0),this.outputWidgets.push(this.console.addLineWidget(lineNumber,widgetElement,widgetOptions)),setTimeout(function(){return _this.console.scrollIntoView({line:_this.console.lineCount()-1,ch:0})},100)},CSConsole.prototype.isHtmlElement=function(obj){return obj&&obj.constructor.toString().search(/HTML.+Element/)>0},CSConsole.prototype.formatWidgetElementText=function(message){return message=message.replace(/^\s/,""),message="<p class='cs-console-output-spacer top'></p>"+message,this.addColors(message)},CSConsole.prototype.addColors=function(message){var filter;return filter=new window.ansi_to_html,filter.toHtml(message)},CSConsole.prototype.moveInputForward=function(){return this.currentLine=this.lineNumber()+1,this.console.setLine(this.currentLine-1,""+this.inputLine()+"\n"+this.options.prompt),this.storedCursorPosition={line:this.currentLine,ch:this.promptLength()},this.console.setCursor(this.storedCursorPosition)},CSConsole.prototype.noop=function(){},KeyActions=function(){function KeyActions(options){this.isCursorAtPrompt=__bind(this.isCursorAtPrompt,this),this.promptLength=__bind(this.promptLength,this),this.consoleLineCount=__bind(this.consoleLineCount,this),this.deleteLine=__bind(this.deleteLine,this),this.delGroupBefore=__bind(this.delGroupBefore,this),this.goLineStart=__bind(this.goLineStart,this),this.goDocEnd=__bind(this.goDocEnd,this),this.goDocStart=__bind(this.goDocStart,this),this.delCharBefore=__bind(this.delCharBefore,this),this.goCharLeft=__bind(this.goCharLeft,this),this.setConsole=__bind(this.setConsole,this),this.options=options}return KeyActions.prototype._defaultCommands=CodeMirror.commands,KeyActions.prototype.setConsole=function(console){return this.console=console},KeyActions.prototype.goCharLeft=function(){return this.isCursorAtPrompt()?this._defaultCommands.goCharLeft(this.console):void 0},KeyActions.prototype.delCharBefore=function(){return this.isCursorAtPrompt()?this._defaultCommands.delCharBefore(this.console):void 0},KeyActions.prototype.goDocStart=function(){return this.console.scrollIntoView({line:0,ch:0})},KeyActions.prototype.goDocEnd=function(){return this.console.scrollIntoView({line:this.consoleLineCount(),ch:0})},KeyActions.prototype.goLineStart=function(){var cursorPos;return cursorPos=this.console.getCursor(),this.console.setCursor({line:cursorPos.line,ch:this.promptLength()})},KeyActions.prototype.delGroupBefore=function(){var cursorStartPos,futurePos;return cursorStartPos=this.console.getCursor(),this.console.moveH(-1,"group"),futurePos=this.console.getCursor().ch,this.console.setCursor(cursorStartPos),futurePos>=this.promptLength()?this._defaultCommands.delGroupBefore(this.console):void 0},KeyActions.prototype.deleteLine=function(){return this.console.setLine(this.console.getCursor().line,this.options.prompt)},KeyActions.prototype.consoleLineCount=function(){return this.console.lineCount()-1},KeyActions.prototype.promptLength=function(){return this.options.prompt.length},KeyActions.prototype.isCursorAtPrompt=function(){return this.console.getCursor().ch>this.promptLength()},KeyActions}(),CSConsoleHistory=function(){function CSConsoleHistory(options){this.previousHistory=__bind(this.previousHistory,this),this.nextHistory=__bind(this.nextHistory,this),this.getHistory=__bind(this.getHistory,this),this.push=__bind(this.push,this);var localHistory;this.options=options,this.options.historyLabel&&(this.historyLabel="cs-"+this.options.historyLabel+"-console-history"),this.options.maxEntries&&(this.maxEntries=options.maxHistoryEntries),this.localStorageExists()&&(this.storage=window.localStorage,localHistory=this.getHistory(),localHistory&&(this.cachedHistory=localHistory),this.currentIndex=this.cachedHistory.length-1)}return CSConsoleHistory.prototype.storage={},CSConsoleHistory.prototype.currentIndex=0,CSConsoleHistory.prototype.historyLabel="cs-console-history",CSConsoleHistory.prototype.cachedHistory=[],CSConsoleHistory.prototype.maxEntries=25,CSConsoleHistory.prototype.localStorageExists=function(){var e;try{return!(null===window.localStorage||!window.localStorage)}catch(_error){return e=_error,!1}},CSConsoleHistory.prototype.push=function(item){var currentHistory,startSlice;if(item&&(currentHistory=this.getHistory(),currentHistory[currentHistory.length-1]!==item))return currentHistory.push(item),currentHistory.length>=this.maxEntries&&(startSlice=currentHistory.length-this.maxEntries,currentHistory=currentHistory.slice(startSlice,currentHistory.length)),this.cachedHistory=currentHistory,this.storage[this.historyLabel]=JSON.stringify(currentHistory),this.currentIndex=currentHistory.length-1},CSConsoleHistory.prototype.getHistory=function(){return this.storage[this.historyLabel]?JSON.parse(this.storage[this.historyLabel]):[]},CSConsoleHistory.prototype.nextHistory=function(){var history;return history=this.cachedHistory.length>0?this.cachedHistory[this.currentIndex]:"",this.currentIndex>0&&this.currentIndex--,history},CSConsoleHistory.prototype.previousHistory=function(){return this.currentIndex<this.cachedHistory.length-1?(this.currentIndex++,this.cachedHistory[this.currentIndex]):""},CSConsoleHistory.prototype.clearHistory=function(){return this.storage[this.historyLabel]="[]",this.cachedHistory=[]},CSConsoleHistory.prototype.resetIndex=function(){return this.currentIndex=this.cachedHistory.length-1},CSConsoleHistory}(),CSConsole}.call(this)}.call(this),function(){var root=this,previousUnderscore=root._,breaker={},ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype,push=ArrayProto.push,slice=ArrayProto.slice,concat=ArrayProto.concat,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty,nativeForEach=ArrayProto.forEach,nativeMap=ArrayProto.map,nativeReduce=ArrayProto.reduce,nativeReduceRight=ArrayProto.reduceRight,nativeFilter=ArrayProto.filter,nativeEvery=ArrayProto.every,nativeSome=ArrayProto.some,nativeIndexOf=ArrayProto.indexOf,nativeLastIndexOf=ArrayProto.lastIndexOf,nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind,_=function(obj){return obj instanceof _?obj:this instanceof _?(this._wrapped=obj,void 0):new _(obj)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=_),exports._=_):root._=_,_.VERSION="1.6.0";var each=_.each=_.forEach=function(obj,iterator,context){if(null==obj)return obj;if(nativeForEach&&obj.forEach===nativeForEach)obj.forEach(iterator,context);else if(obj.length===+obj.length){for(var i=0,length=obj.length;length>i;i++)if(iterator.call(context,obj[i],i,obj)===breaker)return}else for(var keys=_.keys(obj),i=0,length=keys.length;length>i;i++)if(iterator.call(context,obj[keys[i]],keys[i],obj)===breaker)return;return obj};_.map=_.collect=function(obj,iterator,context){var results=[];return null==obj?results:nativeMap&&obj.map===nativeMap?obj.map(iterator,context):(each(obj,function(value,index,list){results.push(iterator.call(context,value,index,list))}),results)};var reduceError="Reduce of empty array with no initial value";_.reduce=_.foldl=_.inject=function(obj,iterator,memo,context){var initial=arguments.length>2;if(null==obj&&(obj=[]),nativeReduce&&obj.reduce===nativeReduce)return context&&(iterator=_.bind(iterator,context)),initial?obj.reduce(iterator,memo):obj.reduce(iterator);if(each(obj,function(value,index,list){initial?memo=iterator.call(context,memo,value,index,list):(memo=value,initial=!0)
}),!initial)throw new TypeError(reduceError);return memo},_.reduceRight=_.foldr=function(obj,iterator,memo,context){var initial=arguments.length>2;if(null==obj&&(obj=[]),nativeReduceRight&&obj.reduceRight===nativeReduceRight)return context&&(iterator=_.bind(iterator,context)),initial?obj.reduceRight(iterator,memo):obj.reduceRight(iterator);var length=obj.length;if(length!==+length){var keys=_.keys(obj);length=keys.length}if(each(obj,function(value,index,list){index=keys?keys[--length]:--length,initial?memo=iterator.call(context,memo,obj[index],index,list):(memo=obj[index],initial=!0)}),!initial)throw new TypeError(reduceError);return memo},_.find=_.detect=function(obj,predicate,context){var result;return any(obj,function(value,index,list){return predicate.call(context,value,index,list)?(result=value,!0):void 0}),result},_.filter=_.select=function(obj,predicate,context){var results=[];return null==obj?results:nativeFilter&&obj.filter===nativeFilter?obj.filter(predicate,context):(each(obj,function(value,index,list){predicate.call(context,value,index,list)&&results.push(value)}),results)},_.reject=function(obj,predicate,context){return _.filter(obj,function(value,index,list){return!predicate.call(context,value,index,list)},context)},_.every=_.all=function(obj,predicate,context){predicate||(predicate=_.identity);var result=!0;return null==obj?result:nativeEvery&&obj.every===nativeEvery?obj.every(predicate,context):(each(obj,function(value,index,list){return(result=result&&predicate.call(context,value,index,list))?void 0:breaker}),!!result)};var any=_.some=_.any=function(obj,predicate,context){predicate||(predicate=_.identity);var result=!1;return null==obj?result:nativeSome&&obj.some===nativeSome?obj.some(predicate,context):(each(obj,function(value,index,list){return result||(result=predicate.call(context,value,index,list))?breaker:void 0}),!!result)};_.contains=_.include=function(obj,target){return null==obj?!1:nativeIndexOf&&obj.indexOf===nativeIndexOf?-1!=obj.indexOf(target):any(obj,function(value){return value===target})},_.invoke=function(obj,method){var args=slice.call(arguments,2),isFunc=_.isFunction(method);return _.map(obj,function(value){return(isFunc?method:value[method]).apply(value,args)})},_.pluck=function(obj,key){return _.map(obj,_.property(key))},_.where=function(obj,attrs){return _.filter(obj,_.matches(attrs))},_.findWhere=function(obj,attrs){return _.find(obj,_.matches(attrs))},_.max=function(obj,iterator,context){if(!iterator&&_.isArray(obj)&&obj[0]===+obj[0]&&obj.length<65535)return Math.max.apply(Math,obj);var result=-1/0,lastComputed=-1/0;return each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed>lastComputed&&(result=value,lastComputed=computed)}),result},_.min=function(obj,iterator,context){if(!iterator&&_.isArray(obj)&&obj[0]===+obj[0]&&obj.length<65535)return Math.min.apply(Math,obj);var result=1/0,lastComputed=1/0;return each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;lastComputed>computed&&(result=value,lastComputed=computed)}),result},_.shuffle=function(obj){var rand,index=0,shuffled=[];return each(obj,function(value){rand=_.random(index++),shuffled[index-1]=shuffled[rand],shuffled[rand]=value}),shuffled},_.sample=function(obj,n,guard){return null==n||guard?(obj.length!==+obj.length&&(obj=_.values(obj)),obj[_.random(obj.length-1)]):_.shuffle(obj).slice(0,Math.max(0,n))};var lookupIterator=function(value){return null==value?_.identity:_.isFunction(value)?value:_.property(value)};_.sortBy=function(obj,iterator,context){return iterator=lookupIterator(iterator),_.pluck(_.map(obj,function(value,index,list){return{value:value,index:index,criteria:iterator.call(context,value,index,list)}}).sort(function(left,right){var a=left.criteria,b=right.criteria;if(a!==b){if(a>b||void 0===a)return 1;if(b>a||void 0===b)return-1}return left.index-right.index}),"value")};var group=function(behavior){return function(obj,iterator,context){var result={};return iterator=lookupIterator(iterator),each(obj,function(value,index){var key=iterator.call(context,value,index,obj);behavior(result,key,value)}),result}};_.groupBy=group(function(result,key,value){_.has(result,key)?result[key].push(value):result[key]=[value]}),_.indexBy=group(function(result,key,value){result[key]=value}),_.countBy=group(function(result,key){_.has(result,key)?result[key]++:result[key]=1}),_.sortedIndex=function(array,obj,iterator,context){iterator=lookupIterator(iterator);for(var value=iterator.call(context,obj),low=0,high=array.length;high>low;){var mid=low+high>>>1;iterator.call(context,array[mid])<value?low=mid+1:high=mid}return low},_.toArray=function(obj){return obj?_.isArray(obj)?slice.call(obj):obj.length===+obj.length?_.map(obj,_.identity):_.values(obj):[]},_.size=function(obj){return null==obj?0:obj.length===+obj.length?obj.length:_.keys(obj).length},_.first=_.head=_.take=function(array,n,guard){return null==array?void 0:null==n||guard?array[0]:0>n?[]:slice.call(array,0,n)},_.initial=function(array,n,guard){return slice.call(array,0,array.length-(null==n||guard?1:n))},_.last=function(array,n,guard){return null==array?void 0:null==n||guard?array[array.length-1]:slice.call(array,Math.max(array.length-n,0))},_.rest=_.tail=_.drop=function(array,n,guard){return slice.call(array,null==n||guard?1:n)},_.compact=function(array){return _.filter(array,_.identity)};var flatten=function(input,shallow,output){return shallow&&_.every(input,_.isArray)?concat.apply(output,input):(each(input,function(value){_.isArray(value)||_.isArguments(value)?shallow?push.apply(output,value):flatten(value,shallow,output):output.push(value)}),output)};_.flatten=function(array,shallow){return flatten(array,shallow,[])},_.without=function(array){return _.difference(array,slice.call(arguments,1))},_.partition=function(array,predicate){var pass=[],fail=[];return each(array,function(elem){(predicate(elem)?pass:fail).push(elem)}),[pass,fail]},_.uniq=_.unique=function(array,isSorted,iterator,context){_.isFunction(isSorted)&&(context=iterator,iterator=isSorted,isSorted=!1);var initial=iterator?_.map(array,iterator,context):array,results=[],seen=[];return each(initial,function(value,index){(isSorted?index&&seen[seen.length-1]===value:_.contains(seen,value))||(seen.push(value),results.push(array[index]))}),results},_.union=function(){return _.uniq(_.flatten(arguments,!0))},_.intersection=function(array){var rest=slice.call(arguments,1);return _.filter(_.uniq(array),function(item){return _.every(rest,function(other){return _.contains(other,item)})})},_.difference=function(array){var rest=concat.apply(ArrayProto,slice.call(arguments,1));return _.filter(array,function(value){return!_.contains(rest,value)})},_.zip=function(){for(var length=_.max(_.pluck(arguments,"length").concat(0)),results=new Array(length),i=0;length>i;i++)results[i]=_.pluck(arguments,""+i);return results},_.object=function(list,values){if(null==list)return{};for(var result={},i=0,length=list.length;length>i;i++)values?result[list[i]]=values[i]:result[list[i][0]]=list[i][1];return result},_.indexOf=function(array,item,isSorted){if(null==array)return-1;var i=0,length=array.length;if(isSorted){if("number"!=typeof isSorted)return i=_.sortedIndex(array,item),array[i]===item?i:-1;i=0>isSorted?Math.max(0,length+isSorted):isSorted}if(nativeIndexOf&&array.indexOf===nativeIndexOf)return array.indexOf(item,isSorted);for(;length>i;i++)if(array[i]===item)return i;return-1},_.lastIndexOf=function(array,item,from){if(null==array)return-1;var hasIndex=null!=from;if(nativeLastIndexOf&&array.lastIndexOf===nativeLastIndexOf)return hasIndex?array.lastIndexOf(item,from):array.lastIndexOf(item);for(var i=hasIndex?from:array.length;i--;)if(array[i]===item)return i;return-1},_.range=function(start,stop,step){arguments.length<=1&&(stop=start||0,start=0),step=arguments[2]||1;for(var length=Math.max(Math.ceil((stop-start)/step),0),idx=0,range=new Array(length);length>idx;)range[idx++]=start,start+=step;return range};var ctor=function(){};_.bind=function(func,context){var args,bound;if(nativeBind&&func.bind===nativeBind)return nativeBind.apply(func,slice.call(arguments,1));if(!_.isFunction(func))throw new TypeError;return args=slice.call(arguments,2),bound=function(){if(!(this instanceof bound))return func.apply(context,args.concat(slice.call(arguments)));ctor.prototype=func.prototype;var self=new ctor;ctor.prototype=null;var result=func.apply(self,args.concat(slice.call(arguments)));return Object(result)===result?result:self}},_.partial=function(func){var boundArgs=slice.call(arguments,1);return function(){for(var position=0,args=boundArgs.slice(),i=0,length=args.length;length>i;i++)args[i]===_&&(args[i]=arguments[position++]);for(;position<arguments.length;)args.push(arguments[position++]);return func.apply(this,args)}},_.bindAll=function(obj){var funcs=slice.call(arguments,1);if(0===funcs.length)throw new Error("bindAll must be passed function names");return each(funcs,function(f){obj[f]=_.bind(obj[f],obj)}),obj},_.memoize=function(func,hasher){var memo={};return hasher||(hasher=_.identity),function(){var key=hasher.apply(this,arguments);return _.has(memo,key)?memo[key]:memo[key]=func.apply(this,arguments)}},_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(null,args)},wait)},_.defer=function(func){return _.delay.apply(_,[func,1].concat(slice.call(arguments,1)))},_.throttle=function(func,wait,options){var context,args,result,timeout=null,previous=0;options||(options={});var later=function(){previous=options.leading===!1?0:_.now(),timeout=null,result=func.apply(context,args),context=args=null};return function(){var now=_.now();previous||options.leading!==!1||(previous=now);var remaining=wait-(now-previous);return context=this,args=arguments,0>=remaining?(clearTimeout(timeout),timeout=null,previous=now,result=func.apply(context,args),context=args=null):timeout||options.trailing===!1||(timeout=setTimeout(later,remaining)),result}},_.debounce=function(func,wait,immediate){var timeout,args,context,timestamp,result,later=function(){var last=_.now()-timestamp;wait>last?timeout=setTimeout(later,wait-last):(timeout=null,immediate||(result=func.apply(context,args),context=args=null))};return function(){context=this,args=arguments,timestamp=_.now();var callNow=immediate&&!timeout;return timeout||(timeout=setTimeout(later,wait)),callNow&&(result=func.apply(context,args),context=args=null),result}},_.once=function(func){var memo,ran=!1;return function(){return ran?memo:(ran=!0,memo=func.apply(this,arguments),func=null,memo)}},_.wrap=function(func,wrapper){return _.partial(wrapper,func)},_.compose=function(){var funcs=arguments;return function(){for(var args=arguments,i=funcs.length-1;i>=0;i--)args=[funcs[i].apply(this,args)];return args[0]}},_.after=function(times,func){return function(){return--times<1?func.apply(this,arguments):void 0}},_.keys=function(obj){if(!_.isObject(obj))return[];if(nativeKeys)return nativeKeys(obj);var keys=[];for(var key in obj)_.has(obj,key)&&keys.push(key);return keys},_.values=function(obj){for(var keys=_.keys(obj),length=keys.length,values=new Array(length),i=0;length>i;i++)values[i]=obj[keys[i]];return values},_.pairs=function(obj){for(var keys=_.keys(obj),length=keys.length,pairs=new Array(length),i=0;length>i;i++)pairs[i]=[keys[i],obj[keys[i]]];return pairs},_.invert=function(obj){for(var result={},keys=_.keys(obj),i=0,length=keys.length;length>i;i++)result[obj[keys[i]]]=keys[i];return result},_.functions=_.methods=function(obj){var names=[];for(var key in obj)_.isFunction(obj[key])&&names.push(key);return names.sort()},_.extend=function(obj){return each(slice.call(arguments,1),function(source){if(source)for(var prop in source)obj[prop]=source[prop]}),obj},_.pick=function(obj){var copy={},keys=concat.apply(ArrayProto,slice.call(arguments,1));return each(keys,function(key){key in obj&&(copy[key]=obj[key])}),copy},_.omit=function(obj){var copy={},keys=concat.apply(ArrayProto,slice.call(arguments,1));for(var key in obj)_.contains(keys,key)||(copy[key]=obj[key]);return copy},_.defaults=function(obj){return each(slice.call(arguments,1),function(source){if(source)for(var prop in source)void 0===obj[prop]&&(obj[prop]=source[prop])}),obj},_.clone=function(obj){return _.isObject(obj)?_.isArray(obj)?obj.slice():_.extend({},obj):obj},_.tap=function(obj,interceptor){return interceptor(obj),obj};var eq=function(a,b,aStack,bStack){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a instanceof _&&(a=a._wrapped),b instanceof _&&(b=b._wrapped);var className=toString.call(a);if(className!=toString.call(b))return!1;switch(className){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var length=aStack.length;length--;)if(aStack[length]==a)return bStack[length]==b;var aCtor=a.constructor,bCtor=b.constructor;if(aCtor!==bCtor&&!(_.isFunction(aCtor)&&aCtor instanceof aCtor&&_.isFunction(bCtor)&&bCtor instanceof bCtor)&&"constructor"in a&&"constructor"in b)return!1;aStack.push(a),bStack.push(b);var size=0,result=!0;if("[object Array]"==className){if(size=a.length,result=size==b.length)for(;size--&&(result=eq(a[size],b[size],aStack,bStack)););}else{for(var key in a)if(_.has(a,key)&&(size++,!(result=_.has(b,key)&&eq(a[key],b[key],aStack,bStack))))break;if(result){for(key in b)if(_.has(b,key)&&!size--)break;result=!size}}return aStack.pop(),bStack.pop(),result};_.isEqual=function(a,b){return eq(a,b,[],[])},_.isEmpty=function(obj){if(null==obj)return!0;if(_.isArray(obj)||_.isString(obj))return 0===obj.length;for(var key in obj)if(_.has(obj,key))return!1;return!0},_.isElement=function(obj){return!(!obj||1!==obj.nodeType)},_.isArray=nativeIsArray||function(obj){return"[object Array]"==toString.call(obj)},_.isObject=function(obj){return obj===Object(obj)},each(["Arguments","Function","String","Number","Date","RegExp"],function(name){_["is"+name]=function(obj){return toString.call(obj)=="[object "+name+"]"}}),_.isArguments(arguments)||(_.isArguments=function(obj){return!(!obj||!_.has(obj,"callee"))}),"function"!=typeof/./&&(_.isFunction=function(obj){return"function"==typeof obj}),_.isFinite=function(obj){return isFinite(obj)&&!isNaN(parseFloat(obj))},_.isNaN=function(obj){return _.isNumber(obj)&&obj!=+obj},_.isBoolean=function(obj){return obj===!0||obj===!1||"[object Boolean]"==toString.call(obj)},_.isNull=function(obj){return null===obj},_.isUndefined=function(obj){return void 0===obj},_.has=function(obj,key){return hasOwnProperty.call(obj,key)},_.noConflict=function(){return root._=previousUnderscore,this},_.identity=function(value){return value},_.constant=function(value){return function(){return value}},_.property=function(key){return function(obj){return obj[key]}},_.matches=function(attrs){return function(obj){if(obj===attrs)return!0;for(var key in attrs)if(attrs[key]!==obj[key])return!1;return!0}},_.times=function(n,iterator,context){for(var accum=Array(Math.max(0,n)),i=0;n>i;i++)accum[i]=iterator.call(context,i);return accum},_.random=function(min,max){return null==max&&(max=min,min=0),min+Math.floor(Math.random()*(max-min+1))},_.now=Date.now||function(){return(new Date).getTime()};var entityMap={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};entityMap.unescape=_.invert(entityMap.escape);var entityRegexes={escape:new RegExp("["+_.keys(entityMap.escape).join("")+"]","g"),unescape:new RegExp("("+_.keys(entityMap.unescape).join("|")+")","g")};_.each(["escape","unescape"],function(method){_[method]=function(string){return null==string?"":(""+string).replace(entityRegexes[method],function(match){return entityMap[method][match]})}}),_.result=function(object,property){if(null==object)return void 0;var value=object[property];return _.isFunction(value)?value.call(object):value},_.mixin=function(obj){each(_.functions(obj),function(name){var func=_[name]=obj[name];_.prototype[name]=function(){var args=[this._wrapped];return push.apply(args,arguments),result.call(this,func.apply(_,args))}})};var idCounter=0;_.uniqueId=function(prefix){var id=++idCounter+"";return prefix?prefix+id:id},_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var noMatch=/(.)^/,escapes={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},escaper=/\\|'|\r|\n|\t|\u2028|\u2029/g;_.template=function(text,data,settings){var render;settings=_.defaults({},settings,_.templateSettings);var matcher=new RegExp([(settings.escape||noMatch).source,(settings.interpolate||noMatch).source,(settings.evaluate||noMatch).source].join("|")+"|$","g"),index=0,source="__p+='";text.replace(matcher,function(match,escape,interpolate,evaluate,offset){return source+=text.slice(index,offset).replace(escaper,function(match){return"\\"+escapes[match]}),escape&&(source+="'+\n((__t=("+escape+"))==null?'':_.escape(__t))+\n'"),interpolate&&(source+="'+\n((__t=("+interpolate+"))==null?'':__t)+\n'"),evaluate&&(source+="';\n"+evaluate+"\n__p+='"),index=offset+match.length,match}),source+="';\n",settings.variable||(source="with(obj||{}){\n"+source+"}\n"),source="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+source+"return __p;\n";try{render=new Function(settings.variable||"obj","_",source)}catch(e){throw e.source=source,e}if(data)return render(data,_);var template=function(data){return render.call(this,data,_)};return template.source="function("+(settings.variable||"obj")+"){\n"+source+"}",template},_.chain=function(obj){return _(obj).chain()};var result=function(obj){return this._chain?_(obj).chain():obj};_.mixin(_),each(["pop","push","reverse","shift","sort","splice","unshift"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){var obj=this._wrapped;return method.apply(obj,arguments),"shift"!=name&&"splice"!=name||0!==obj.length||delete obj[0],result.call(this,obj)}}),each(["concat","join","slice"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){return result.call(this,method.apply(this._wrapped,arguments))}}),_.extend(_.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return _})}.call(this),function(){var root=this,previousUnderscore=root._,breaker={},ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype,push=ArrayProto.push,slice=ArrayProto.slice,concat=ArrayProto.concat,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty,nativeForEach=ArrayProto.forEach,nativeMap=ArrayProto.map,nativeReduce=ArrayProto.reduce,nativeReduceRight=ArrayProto.reduceRight,nativeFilter=ArrayProto.filter,nativeEvery=ArrayProto.every,nativeSome=ArrayProto.some,nativeIndexOf=ArrayProto.indexOf,nativeLastIndexOf=ArrayProto.lastIndexOf,nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind,_=function(obj){return obj instanceof _?obj:this instanceof _?(this._wrapped=obj,void 0):new _(obj)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=_),exports._=_):root._=_,_.VERSION="1.5.1";var each=_.each=_.forEach=function(obj,iterator,context){if(null!=obj)if(nativeForEach&&obj.forEach===nativeForEach)obj.forEach(iterator,context);else if(obj.length===+obj.length){for(var i=0,l=obj.length;l>i;i++)if(iterator.call(context,obj[i],i,obj)===breaker)return}else for(var key in obj)if(_.has(obj,key)&&iterator.call(context,obj[key],key,obj)===breaker)return};_.map=_.collect=function(obj,iterator,context){var results=[];return null==obj?results:nativeMap&&obj.map===nativeMap?obj.map(iterator,context):(each(obj,function(value,index,list){results.push(iterator.call(context,value,index,list))}),results)};var reduceError="Reduce of empty array with no initial value";_.reduce=_.foldl=_.inject=function(obj,iterator,memo,context){var initial=arguments.length>2;if(null==obj&&(obj=[]),nativeReduce&&obj.reduce===nativeReduce)return context&&(iterator=_.bind(iterator,context)),initial?obj.reduce(iterator,memo):obj.reduce(iterator);if(each(obj,function(value,index,list){initial?memo=iterator.call(context,memo,value,index,list):(memo=value,initial=!0)}),!initial)throw new TypeError(reduceError);return memo},_.reduceRight=_.foldr=function(obj,iterator,memo,context){var initial=arguments.length>2;if(null==obj&&(obj=[]),nativeReduceRight&&obj.reduceRight===nativeReduceRight)return context&&(iterator=_.bind(iterator,context)),initial?obj.reduceRight(iterator,memo):obj.reduceRight(iterator);var length=obj.length;if(length!==+length){var keys=_.keys(obj);length=keys.length}if(each(obj,function(value,index,list){index=keys?keys[--length]:--length,initial?memo=iterator.call(context,memo,obj[index],index,list):(memo=obj[index],initial=!0)}),!initial)throw new TypeError(reduceError);return memo},_.find=_.detect=function(obj,iterator,context){var result;return any(obj,function(value,index,list){return iterator.call(context,value,index,list)?(result=value,!0):void 0}),result},_.filter=_.select=function(obj,iterator,context){var results=[];return null==obj?results:nativeFilter&&obj.filter===nativeFilter?obj.filter(iterator,context):(each(obj,function(value,index,list){iterator.call(context,value,index,list)&&results.push(value)}),results)},_.reject=function(obj,iterator,context){return _.filter(obj,function(value,index,list){return!iterator.call(context,value,index,list)},context)},_.every=_.all=function(obj,iterator,context){iterator||(iterator=_.identity);var result=!0;return null==obj?result:nativeEvery&&obj.every===nativeEvery?obj.every(iterator,context):(each(obj,function(value,index,list){return(result=result&&iterator.call(context,value,index,list))?void 0:breaker}),!!result)};var any=_.some=_.any=function(obj,iterator,context){iterator||(iterator=_.identity);var result=!1;return null==obj?result:nativeSome&&obj.some===nativeSome?obj.some(iterator,context):(each(obj,function(value,index,list){return result||(result=iterator.call(context,value,index,list))?breaker:void 0}),!!result)};_.contains=_.include=function(obj,target){return null==obj?!1:nativeIndexOf&&obj.indexOf===nativeIndexOf?-1!=obj.indexOf(target):any(obj,function(value){return value===target})},_.invoke=function(obj,method){var args=slice.call(arguments,2),isFunc=_.isFunction(method);return _.map(obj,function(value){return(isFunc?method:value[method]).apply(value,args)})},_.pluck=function(obj,key){return _.map(obj,function(value){return value[key]})},_.where=function(obj,attrs,first){return _.isEmpty(attrs)?first?void 0:[]:_[first?"find":"filter"](obj,function(value){for(var key in attrs)if(attrs[key]!==value[key])return!1;return!0})},_.findWhere=function(obj,attrs){return _.where(obj,attrs,!0)},_.max=function(obj,iterator,context){if(!iterator&&_.isArray(obj)&&obj[0]===+obj[0]&&obj.length<65535)return Math.max.apply(Math,obj);if(!iterator&&_.isEmpty(obj))return-1/0;var result={computed:-1/0,value:-1/0};return each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed>result.computed&&(result={value:value,computed:computed})}),result.value},_.min=function(obj,iterator,context){if(!iterator&&_.isArray(obj)&&obj[0]===+obj[0]&&obj.length<65535)return Math.min.apply(Math,obj);if(!iterator&&_.isEmpty(obj))return 1/0;var result={computed:1/0,value:1/0};return each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed<result.computed&&(result={value:value,computed:computed})}),result.value},_.shuffle=function(obj){var rand,index=0,shuffled=[];return each(obj,function(value){rand=_.random(index++),shuffled[index-1]=shuffled[rand],shuffled[rand]=value}),shuffled};var lookupIterator=function(value){return _.isFunction(value)?value:function(obj){return obj[value]}};_.sortBy=function(obj,value,context){var iterator=lookupIterator(value);return _.pluck(_.map(obj,function(value,index,list){return{value:value,index:index,criteria:iterator.call(context,value,index,list)}}).sort(function(left,right){var a=left.criteria,b=right.criteria;if(a!==b){if(a>b||void 0===a)return 1;if(b>a||void 0===b)return-1}return left.index<right.index?-1:1}),"value")};var group=function(obj,value,context,behavior){var result={},iterator=lookupIterator(null==value?_.identity:value);return each(obj,function(value,index){var key=iterator.call(context,value,index,obj);behavior(result,key,value)}),result};_.groupBy=function(obj,value,context){return group(obj,value,context,function(result,key,value){(_.has(result,key)?result[key]:result[key]=[]).push(value)})},_.countBy=function(obj,value,context){return group(obj,value,context,function(result,key){_.has(result,key)||(result[key]=0),result[key]++})},_.sortedIndex=function(array,obj,iterator,context){iterator=null==iterator?_.identity:lookupIterator(iterator);for(var value=iterator.call(context,obj),low=0,high=array.length;high>low;){var mid=low+high>>>1;iterator.call(context,array[mid])<value?low=mid+1:high=mid}return low},_.toArray=function(obj){return obj?_.isArray(obj)?slice.call(obj):obj.length===+obj.length?_.map(obj,_.identity):_.values(obj):[]},_.size=function(obj){return null==obj?0:obj.length===+obj.length?obj.length:_.keys(obj).length},_.first=_.head=_.take=function(array,n,guard){return null==array?void 0:null==n||guard?array[0]:slice.call(array,0,n)},_.initial=function(array,n,guard){return slice.call(array,0,array.length-(null==n||guard?1:n))},_.last=function(array,n,guard){return null==array?void 0:null==n||guard?array[array.length-1]:slice.call(array,Math.max(array.length-n,0))},_.rest=_.tail=_.drop=function(array,n,guard){return slice.call(array,null==n||guard?1:n)},_.compact=function(array){return _.filter(array,_.identity)};var flatten=function(input,shallow,output){return shallow&&_.every(input,_.isArray)?concat.apply(output,input):(each(input,function(value){_.isArray(value)||_.isArguments(value)?shallow?push.apply(output,value):flatten(value,shallow,output):output.push(value)}),output)};_.flatten=function(array,shallow){return flatten(array,shallow,[])},_.without=function(array){return _.difference(array,slice.call(arguments,1))},_.uniq=_.unique=function(array,isSorted,iterator,context){_.isFunction(isSorted)&&(context=iterator,iterator=isSorted,isSorted=!1);var initial=iterator?_.map(array,iterator,context):array,results=[],seen=[];return each(initial,function(value,index){(isSorted?index&&seen[seen.length-1]===value:_.contains(seen,value))||(seen.push(value),results.push(array[index]))}),results},_.union=function(){return _.uniq(_.flatten(arguments,!0))},_.intersection=function(array){var rest=slice.call(arguments,1);return _.filter(_.uniq(array),function(item){return _.every(rest,function(other){return _.indexOf(other,item)>=0})})},_.difference=function(array){var rest=concat.apply(ArrayProto,slice.call(arguments,1));return _.filter(array,function(value){return!_.contains(rest,value)})},_.zip=function(){for(var length=_.max(_.pluck(arguments,"length").concat(0)),results=new Array(length),i=0;length>i;i++)results[i]=_.pluck(arguments,""+i);return results},_.object=function(list,values){if(null==list)return{};for(var result={},i=0,l=list.length;l>i;i++)values?result[list[i]]=values[i]:result[list[i][0]]=list[i][1];return result},_.indexOf=function(array,item,isSorted){if(null==array)return-1;var i=0,l=array.length;if(isSorted){if("number"!=typeof isSorted)return i=_.sortedIndex(array,item),array[i]===item?i:-1;i=0>isSorted?Math.max(0,l+isSorted):isSorted}if(nativeIndexOf&&array.indexOf===nativeIndexOf)return array.indexOf(item,isSorted);for(;l>i;i++)if(array[i]===item)return i;return-1},_.lastIndexOf=function(array,item,from){if(null==array)return-1;var hasIndex=null!=from;if(nativeLastIndexOf&&array.lastIndexOf===nativeLastIndexOf)return hasIndex?array.lastIndexOf(item,from):array.lastIndexOf(item);for(var i=hasIndex?from:array.length;i--;)if(array[i]===item)return i;return-1},_.range=function(start,stop,step){arguments.length<=1&&(stop=start||0,start=0),step=arguments[2]||1;for(var len=Math.max(Math.ceil((stop-start)/step),0),idx=0,range=new Array(len);len>idx;)range[idx++]=start,start+=step;return range};var ctor=function(){};_.bind=function(func,context){var args,bound;if(nativeBind&&func.bind===nativeBind)return nativeBind.apply(func,slice.call(arguments,1));if(!_.isFunction(func))throw new TypeError;return args=slice.call(arguments,2),bound=function(){if(!(this instanceof bound))return func.apply(context,args.concat(slice.call(arguments)));ctor.prototype=func.prototype;var self=new ctor;ctor.prototype=null;var result=func.apply(self,args.concat(slice.call(arguments)));return Object(result)===result?result:self}},_.partial=function(func){var args=slice.call(arguments,1);return function(){return func.apply(this,args.concat(slice.call(arguments)))}},_.bindAll=function(obj){var funcs=slice.call(arguments,1);if(0===funcs.length)throw new Error("bindAll must be passed function names");return each(funcs,function(f){obj[f]=_.bind(obj[f],obj)}),obj},_.memoize=function(func,hasher){var memo={};return hasher||(hasher=_.identity),function(){var key=hasher.apply(this,arguments);return _.has(memo,key)?memo[key]:memo[key]=func.apply(this,arguments)}},_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(null,args)},wait)},_.defer=function(func){return _.delay.apply(_,[func,1].concat(slice.call(arguments,1)))},_.throttle=function(func,wait,options){var context,args,result,timeout=null,previous=0;options||(options={});var later=function(){previous=options.leading===!1?0:new Date,timeout=null,result=func.apply(context,args)};return function(){var now=new Date;previous||options.leading!==!1||(previous=now);var remaining=wait-(now-previous);return context=this,args=arguments,0>=remaining?(clearTimeout(timeout),timeout=null,previous=now,result=func.apply(context,args)):timeout||options.trailing===!1||(timeout=setTimeout(later,remaining)),result}},_.debounce=function(func,wait,immediate){var result,timeout=null;return function(){var context=this,args=arguments,later=function(){timeout=null,immediate||(result=func.apply(context,args))},callNow=immediate&&!timeout;return clearTimeout(timeout),timeout=setTimeout(later,wait),callNow&&(result=func.apply(context,args)),result}},_.once=function(func){var memo,ran=!1;return function(){return ran?memo:(ran=!0,memo=func.apply(this,arguments),func=null,memo)}},_.wrap=function(func,wrapper){return function(){var args=[func];return push.apply(args,arguments),wrapper.apply(this,args)}},_.compose=function(){var funcs=arguments;return function(){for(var args=arguments,i=funcs.length-1;i>=0;i--)args=[funcs[i].apply(this,args)];return args[0]}},_.after=function(times,func){return function(){return--times<1?func.apply(this,arguments):void 0}},_.keys=nativeKeys||function(obj){if(obj!==Object(obj))throw new TypeError("Invalid object");var keys=[];for(var key in obj)_.has(obj,key)&&keys.push(key);return keys},_.values=function(obj){var values=[];for(var key in obj)_.has(obj,key)&&values.push(obj[key]);return values},_.pairs=function(obj){var pairs=[];for(var key in obj)_.has(obj,key)&&pairs.push([key,obj[key]]);return pairs},_.invert=function(obj){var result={};for(var key in obj)_.has(obj,key)&&(result[obj[key]]=key);return result},_.functions=_.methods=function(obj){var names=[];for(var key in obj)_.isFunction(obj[key])&&names.push(key);return names.sort()},_.extend=function(obj){return each(slice.call(arguments,1),function(source){if(source)for(var prop in source)obj[prop]=source[prop]}),obj},_.pick=function(obj){var copy={},keys=concat.apply(ArrayProto,slice.call(arguments,1));return each(keys,function(key){key in obj&&(copy[key]=obj[key])}),copy},_.omit=function(obj){var copy={},keys=concat.apply(ArrayProto,slice.call(arguments,1));for(var key in obj)_.contains(keys,key)||(copy[key]=obj[key]);return copy},_.defaults=function(obj){return each(slice.call(arguments,1),function(source){if(source)for(var prop in source)void 0===obj[prop]&&(obj[prop]=source[prop])}),obj},_.clone=function(obj){return _.isObject(obj)?_.isArray(obj)?obj.slice():_.extend({},obj):obj},_.tap=function(obj,interceptor){return interceptor(obj),obj};var eq=function(a,b,aStack,bStack){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a instanceof _&&(a=a._wrapped),b instanceof _&&(b=b._wrapped);
var className=toString.call(a);if(className!=toString.call(b))return!1;switch(className){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var length=aStack.length;length--;)if(aStack[length]==a)return bStack[length]==b;var aCtor=a.constructor,bCtor=b.constructor;if(aCtor!==bCtor&&!(_.isFunction(aCtor)&&aCtor instanceof aCtor&&_.isFunction(bCtor)&&bCtor instanceof bCtor))return!1;aStack.push(a),bStack.push(b);var size=0,result=!0;if("[object Array]"==className){if(size=a.length,result=size==b.length)for(;size--&&(result=eq(a[size],b[size],aStack,bStack)););}else{for(var key in a)if(_.has(a,key)&&(size++,!(result=_.has(b,key)&&eq(a[key],b[key],aStack,bStack))))break;if(result){for(key in b)if(_.has(b,key)&&!size--)break;result=!size}}return aStack.pop(),bStack.pop(),result};_.isEqual=function(a,b){return eq(a,b,[],[])},_.isEmpty=function(obj){if(null==obj)return!0;if(_.isArray(obj)||_.isString(obj))return 0===obj.length;for(var key in obj)if(_.has(obj,key))return!1;return!0},_.isElement=function(obj){return!(!obj||1!==obj.nodeType)},_.isArray=nativeIsArray||function(obj){return"[object Array]"==toString.call(obj)},_.isObject=function(obj){return obj===Object(obj)},each(["Arguments","Function","String","Number","Date","RegExp"],function(name){_["is"+name]=function(obj){return toString.call(obj)=="[object "+name+"]"}}),_.isArguments(arguments)||(_.isArguments=function(obj){return!(!obj||!_.has(obj,"callee"))}),"function"!=typeof/./&&(_.isFunction=function(obj){return"function"==typeof obj}),_.isFinite=function(obj){return isFinite(obj)&&!isNaN(parseFloat(obj))},_.isNaN=function(obj){return _.isNumber(obj)&&obj!=+obj},_.isBoolean=function(obj){return obj===!0||obj===!1||"[object Boolean]"==toString.call(obj)},_.isNull=function(obj){return null===obj},_.isUndefined=function(obj){return void 0===obj},_.has=function(obj,key){return hasOwnProperty.call(obj,key)},_.noConflict=function(){return root._=previousUnderscore,this},_.identity=function(value){return value},_.times=function(n,iterator,context){for(var accum=Array(Math.max(0,n)),i=0;n>i;i++)accum[i]=iterator.call(context,i);return accum},_.random=function(min,max){return null==max&&(max=min,min=0),min+Math.floor(Math.random()*(max-min+1))};var entityMap={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};entityMap.unescape=_.invert(entityMap.escape);var entityRegexes={escape:new RegExp("["+_.keys(entityMap.escape).join("")+"]","g"),unescape:new RegExp("("+_.keys(entityMap.unescape).join("|")+")","g")};_.each(["escape","unescape"],function(method){_[method]=function(string){return null==string?"":(""+string).replace(entityRegexes[method],function(match){return entityMap[method][match]})}}),_.result=function(object,property){if(null==object)return void 0;var value=object[property];return _.isFunction(value)?value.call(object):value},_.mixin=function(obj){each(_.functions(obj),function(name){var func=_[name]=obj[name];_.prototype[name]=function(){var args=[this._wrapped];return push.apply(args,arguments),result.call(this,func.apply(_,args))}})};var idCounter=0;_.uniqueId=function(prefix){var id=++idCounter+"";return prefix?prefix+id:id},_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var noMatch=/(.)^/,escapes={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},escaper=/\\|'|\r|\n|\t|\u2028|\u2029/g;_.template=function(text,data,settings){var render;settings=_.defaults({},settings,_.templateSettings);var matcher=new RegExp([(settings.escape||noMatch).source,(settings.interpolate||noMatch).source,(settings.evaluate||noMatch).source].join("|")+"|$","g"),index=0,source="__p+='";text.replace(matcher,function(match,escape,interpolate,evaluate,offset){return source+=text.slice(index,offset).replace(escaper,function(match){return"\\"+escapes[match]}),escape&&(source+="'+\n((__t=("+escape+"))==null?'':_.escape(__t))+\n'"),interpolate&&(source+="'+\n((__t=("+interpolate+"))==null?'':__t)+\n'"),evaluate&&(source+="';\n"+evaluate+"\n__p+='"),index=offset+match.length,match}),source+="';\n",settings.variable||(source="with(obj||{}){\n"+source+"}\n"),source="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+source+"return __p;\n";try{render=new Function(settings.variable||"obj","_",source)}catch(e){throw e.source=source,e}if(data)return render(data,_);var template=function(data){return render.call(this,data,_)};return template.source="function("+(settings.variable||"obj")+"){\n"+source+"}",template},_.chain=function(obj){return _(obj).chain()};var result=function(obj){return this._chain?_(obj).chain():obj};_.mixin(_),each(["pop","push","reverse","shift","sort","splice","unshift"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){var obj=this._wrapped;return method.apply(obj,arguments),"shift"!=name&&"splice"!=name||0!==obj.length||delete obj[0],result.call(this,obj)}}),each(["concat","join","slice"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){return result.call(this,method.apply(this._wrapped,arguments))}}),_.extend(_.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this);var Backbone=Backbone||{};!function(){var array=[],slice=array.slice,triggerEvents=function(obj,events,args){var ev,i=-1,l=events.length;switch(args.length){case 0:for(;++i<l;)(ev=events[i]).callback.call(ev.ctx);return;case 1:for(;++i<l;)(ev=events[i]).callback.call(ev.ctx,args[0]);return;case 2:for(;++i<l;)(ev=events[i]).callback.call(ev.ctx,args[0],args[1]);return;case 3:for(;++i<l;)(ev=events[i]).callback.call(ev.ctx,args[0],args[1],args[2]);return;default:for(;++i<l;)(ev=events[i]).callback.apply(ev.ctx,args)}},Events=Backbone.Events={on:function(name,callback,context){this._events||(this._events={});var list=this._events[name]||(this._events[name]=[]);return list.push({callback:callback,context:context,ctx:context||this}),this},once:function(name,callback,context){var self=this,once=_.once(function(){self.off(name,once),callback.apply(this,arguments)});return once._callback=callback,this.on(name,once,context),this},off:function(name,callback,context){var list,ev,events,names,i,l,j,k;if(!this._events)return this;if(!name&&!callback&&!context)return this._events={},this;for(names=name?[name]:_.keys(this._events),i=0,l=names.length;l>i;i++)if(name=names[i],list=this._events[name]){if(events=[],callback||context)for(j=0,k=list.length;k>j;j++)ev=list[j],(callback&&callback!==(ev.callback._callback||ev.callback)||context&&context!==ev.context)&&events.push(ev);this._events[name]=events}return this},trigger:function(name){if(!this._events)return this;var args=slice.call(arguments,1),events=this._events[name],allEvents=this._events.all;return events&&triggerEvents(this,events,args),allEvents&&triggerEvents(this,allEvents,arguments),this},listenTo:function(object,events,callback){var listeners=this._listeners||(this._listeners={}),id=object._listenerId||(object._listenerId=_.uniqueId("l"));return listeners[id]=object,object.on(events,callback||this,this),this},stopListening:function(object,events,callback){var listeners=this._listeners;if(listeners){if(object)object.off(events,callback,this),events||callback||delete listeners[object._listenerId];else{for(var id in listeners)listeners[id].off(null,null,this);this._listeners={}}return this}}};Events.bind=Events.on,Events.unbind=Events.off,"undefined"!=typeof exports&&("undefined"!=typeof module&&module.exports&&(exports=module.exports=Events),exports.Backbone=exports.Backbone||Backbone)}(),function(){function raf(callback){var currTime=(new Date).getTime(),timeToCall=Math.max(0,16-(currTime-lastTime)),id=root.setTimeout(function(){callback(currTime+timeToCall)},timeToCall);return lastTime=currTime+timeToCall,id}var root=this,lastTime=0,vendors=["ms","moz","webkit","o"];if("undefined"!=typeof exports)return"undefined"!=typeof module&&module.exports&&(exports=module.exports=raf),exports.requestAnimationFrame=raf,void 0;for(var x=0;x<vendors.length&&!root.requestAnimationFrame;++x)root.requestAnimationFrame=root[vendors[x]+"RequestAnimationFrame"],root.cancelAnimationFrame=root[vendors[x]+"CancelAnimationFrame"]||root[vendors[x]+"CancelRequestAnimationFrame"];root.requestAnimationFrame||(root.requestAnimationFrame=raf),root.cancelAnimationFrame||(root.cancelAnimationFrame=function(id){clearTimeout(id)})}(),function(){function fitToWindow(){var wr=document.body.getBoundingClientRect(),width=this.width=wr.width,height=this.height=wr.height;this.renderer.setSize(width,height,this.ratio),this.trigger(Two.Events.resize,width,height)}function getNow(){return(root.performance&&root.performance.now?root.performance:Date).now()}var root=this,previousTwo=root.Two||{},sin=Math.sin,cos=Math.cos,atan2=Math.atan2,sqrt=Math.sqrt,abs=(Math.round,Math.abs),PI=Math.PI,TWO_PI=2*PI,HALF_PI=PI/2,pow=Math.pow,dom={hasEventListeners:_.isFunction(root.addEventListener),bind:function(elem,event,func,bool){return this.hasEventListeners?elem.addEventListener(event,func,!!bool):elem.attachEvent("on"+event,func),this},unbind:function(elem,event,func,bool){return this.hasEventListeners?elem.removeEventListeners(event,func,!!bool):elem.detachEvent("on"+event,func),this}},Two=root.Two=function(options){var params=_.defaults(options||{},{fullscreen:!1,width:640,height:480,type:Two.Types.svg,autostart:!1});if(_.each(params,function(v,k){"fullscreen"!==k&&"width"!==k&&"height"!==k&&"autostart"!==k&&(this[k]=v)},this),_.isElement(params.domElement)&&(this.type=Two.Types[params.domElement.tagName.toLowerCase()]),this.renderer=new Two[this.type](this),Two.Utils.setPlaying.call(this,params.autostart),this.frameCount=0,params.fullscreen){var fitted=_.bind(fitToWindow,this);_.extend(document.body.style,{overflow:"hidden",margin:0,padding:0,top:0,left:0,right:0,bottom:0,position:"fixed"}),_.extend(this.renderer.domElement.style,{display:"block",top:0,left:0,right:0,bottom:0,position:"fixed"}),dom.bind(root,"resize",fitted),fitted()}else _.isElement(params.domElement)||(this.renderer.setSize(params.width,params.height,this.ratio),this.width=params.width,this.height=params.height);this.scene=new Two.Group,this.renderer.add(this.scene),Two.Instances.push(this)};_.extend(Two,{Array:root.Float32Array||Array,Types:{webgl:"WebGLRenderer",svg:"SVGRenderer",canvas:"CanvasRenderer"},Version:"v0.3.0",Properties:{hierarchy:"hierarchy",demotion:"demotion"},Events:{play:"play",pause:"pause",update:"update",render:"render",resize:"resize",change:"change",remove:"remove",insert:"insert"},Commands:{move:"M",line:"L",curve:"C",close:"Z"},Resolution:8,Instances:[],noConflict:function(){return root.Two=previousTwo,this},Utils:{Curve:{CollinearityEpsilon:pow(10,-30),RecursionLimit:16,CuspLimit:0,Tolerance:{distance:.25,angle:0,epsilon:.01}},setPlaying:function(b){_.defer(_.bind(function(){this.playing=!!b},this))},getComputedMatrix:function(object){for(var matrix=new Two.Matrix,parent=object;parent&&parent._matrix;){var e=parent._matrix.elements;matrix.multiply(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9]),parent=parent.parent}return matrix},applySvgAttributes:function(node,elem){return elem.cap="butt",elem.join="bevel",_.each(node.attributes,function(v){var property=v.nodeName;switch(property){case"transform":break;case"visibility":elem.visible=!!v.nodeValue;break;case"stroke-linecap":elem.cap=v.nodeValue;break;case"stroke-linejoin":elem.join=v.nodeValue;break;case"stroke-miterlimit":elem.miter=v.nodeValue;break;case"stroke-width":elem.linewidth=parseFloat(v.nodeValue);break;case"stroke-opacity":case"fill-opacity":elem.opacity=v.nodeValue;break;case"fill":elem.fill=v.nodeValue;break;case"stroke":elem.stroke=v.nodeValue}}),elem},read:{svg:function(){return Two.Utils.read.g.apply(this,arguments)},g:function(node){var group=new Two.Group;return this.add(group),_.each(node.childNodes,function(n){var tag=n.nodeName;if(tag){var tagName=tag.replace(/svg\:/gi,"").toLowerCase();if(tagName in Two.Utils.read){var o=Two.Utils.read[tagName].call(this,n);group.add(o)}}},this),Two.Utils.applySvgAttributes(node,group)},polygon:function(node,open){var points=node.getAttribute("points"),verts=[];points.replace(/([\d\.?]+),([\d\.?]+)/g,function(match,p1,p2){verts.push(new Two.Anchor(parseFloat(p1),parseFloat(p2)))});var poly=new Two.Polygon(verts,!open).noStroke();return Two.Utils.applySvgAttributes(node,poly)},polyline:function(node){return Two.Utils.read.polygon(node,!0)},path:function(node){var coord,control,coords,path=node.getAttribute("d"),relative=!1,closed=!1,commands=path.match(/[a-df-z][^a-df-z]*/gi),last=commands.length-1,points=_.flatten(_.map(commands,function(command,i){var result,x,y,type=command[0],lower=type.toLowerCase();coords=command.slice(1).trim(),coords=coords.replace(/(-?\d+(?:\.\d*)?)[eE]([+\-]?\d+)/g,function(match,n1,n2){return parseFloat(n1)*Math.pow(10,n2)}),coords=coords.split(/[\s,]+|(?=\s?[+\-])/),relative=type===lower;var x1,y1,x2,y2,x3,y3,x4,y4,reflection;switch(lower){case"z":i>=last?closed=!0:(x=coord.x,y=coord.y,result=new Two.Anchor(x,y,void 0,void 0,void 0,void 0,Two.Commands.close));break;case"m":case"l":x=parseFloat(coords[0]),y=parseFloat(coords[1]),result=new Two.Anchor(x,y,void 0,void 0,void 0,void 0,"m"===lower?Two.Commands.move:Two.Commands.line),relative&&result.addSelf(coord),coord=result;break;case"h":case"v":var a="h"===lower?"x":"y",b="x"===a?"y":"x";result=new Two.Anchor(void 0,void 0,void 0,void 0,void 0,void 0,Two.Commands.line),result[a]=parseFloat(coords[0]),result[b]=coord[b],relative&&(result[a]+=coord[a]),coord=result;break;case"s":case"c":x1=coord.x,y1=coord.y,control||(control=(new Two.Vector).copy(coord)),"c"===lower?(x2=parseFloat(coords[0]),y2=parseFloat(coords[1]),x3=parseFloat(coords[2]),y3=parseFloat(coords[3]),x4=parseFloat(coords[4]),y4=parseFloat(coords[5])):(reflection=Two.Utils.getReflection(coord,control,relative),x2=reflection.x,y2=reflection.y,x3=parseFloat(coords[0]),y3=parseFloat(coords[1]),x4=parseFloat(coords[2]),y4=parseFloat(coords[3])),relative&&(x2+=x1,y2+=y1,x3+=x1,y3+=y1,x4+=x1,y4+=y1),_.isObject(coord.controls)||Two.Anchor.AppendCurveProperties(coord),coord.controls.right.set(x2,y2),result=new Two.Anchor(x4,y4,x3,y3,void 0,void 0,Two.Commands.curve),coord=result,control=result.controls.left;break;case"t":case"q":x1=coord.x,y1=coord.y,control||(control=(new Two.Vector).copy(coord)),control.isZero()?(x2=x1,y2=y1):(x2=control.x,y1=control.y),"q"===lower?(x3=parseFloat(coords[0]),y3=parseFloat(coords[1]),x4=parseFloat(coords[1]),y4=parseFloat(coords[2])):(reflection=Two.Utils.getReflection(coord,control,relative),x3=reflection.x,y3=reflection.y,x4=parseFloat(coords[0]),y4=parseFloat(coords[1])),relative&&(x2+=x1,y2+=y1,x3+=x1,y3+=y1,x4+=x1,y4+=y1),_.isObject(coord.controls)||Two.Anchor.AppendCurveProperties(coord),coord.controls.right.set(x2,y2),result=new Two.Anchor(x4,y4,x3,y3,void 0,void 0,Two.Commands.curve),coord=result,control=result.controls.left;break;case"a":throw new Two.Utils.Error("not yet able to interpret Elliptical Arcs.")}return result}));if(!(points.length<=1)){points=_.compact(points);var poly=new Two.Polygon(points,closed,void 0,!0).noStroke();return Two.Utils.applySvgAttributes(node,poly)}},circle:function(node){var x=parseFloat(node.getAttribute("cx")),y=parseFloat(node.getAttribute("cy")),r=parseFloat(node.getAttribute("r")),amount=Two.Resolution,points=_.map(_.range(amount),function(i){var pct=i/amount,theta=pct*TWO_PI,x=r*cos(theta),y=r*sin(theta);return new Two.Anchor(x,y)},this),circle=new Two.Polygon(points,!0,!0).noStroke();return circle.translation.set(x,y),Two.Utils.applySvgAttributes(node,circle)},ellipse:function(node){var x=parseFloat(node.getAttribute("cx")),y=parseFloat(node.getAttribute("cy")),width=parseFloat(node.getAttribute("rx")),height=parseFloat(node.getAttribute("ry")),amount=Two.Resolution,points=_.map(_.range(amount),function(i){var pct=i/amount,theta=pct*TWO_PI,x=width*cos(theta),y=height*sin(theta);return new Two.Anchor(x,y)},this),ellipse=new Two.Polygon(points,!0,!0).noStroke();return ellipse.translation.set(x,y),Two.Utils.applySvgAttributes(node,ellipse)},rect:function(node){var x=parseFloat(node.getAttribute("x")),y=parseFloat(node.getAttribute("y")),width=parseFloat(node.getAttribute("width")),height=parseFloat(node.getAttribute("height")),w2=width/2,h2=height/2,points=[new Two.Anchor(w2,h2),new Two.Anchor(-w2,h2),new Two.Anchor(-w2,-h2),new Two.Anchor(w2,-h2)],rect=new Two.Polygon(points,!0).noStroke();return rect.translation.set(x+w2,y+h2),Two.Utils.applySvgAttributes(node,rect)},line:function(node){var x1=parseFloat(node.getAttribute("x1")),y1=parseFloat(node.getAttribute("y1")),x2=parseFloat(node.getAttribute("x2")),y2=parseFloat(node.getAttribute("y2")),width=x2-x1,height=y2-y1,w2=width/2,h2=height/2,points=[new Two.Anchor(-w2,-h2),new Two.Anchor(w2,h2)],line=new Two.Polygon(points).noFill();return line.translation.set(x1+w2,y1+h2),Two.Utils.applySvgAttributes(node,line)}},subdivide:function(x1,y1,x2,y2,x3,y3,x4,y4,level){var da1,da2,epsilon=Two.Utils.Curve.CollinearityEpsilon,limit=Two.Utils.Curve.RecursionLimit,cuspLimit=Two.Utils.Curve.CuspLimit,tolerance=Two.Utils.Curve.Tolerance;if(level=level||0,level>limit)return[];var x12=(x1+x2)/2,y12=(y1+y2)/2,x23=(x2+x3)/2,y23=(y2+y3)/2,x34=(x3+x4)/2,y34=(y3+y4)/2,x123=(x12+x23)/2,y123=(y12+y23)/2,x234=(x23+x34)/2,y234=(y23+y34)/2,x1234=(x123+x234)/2,y1234=(y123+y234)/2,dx=x4-x1,dy=y4-y1,d2=abs((x2-x4)*dy-(y2-y4)*dx),d3=abs((x3-x4)*dy-(y3-y4)*dx);if(level>0){if(d2>epsilon&&d3>epsilon&&(d2+d3)*(d2+d3)<=tolerance.distance*(dx*dx+dy*dy)){if(tolerance.angle<tolerance.epsilon)return[new Two.Anchor(x1234,y1234)];var a23=atan2(y3-y2,x3-x2);if(da1=abs(a23-atan2(y2-y1,x2-x1)),da2=abs(atan2(y4-y3,x4-x3)-a23),da1>=PI&&(da1=TWO_PI-da1),da2>=PI&&(da2=TWO_PI-da2),da1+da2<tolerance.angle)return[new Two.Anchor(x1234,y1234)];if(0!==cuspLimit){if(da1>cuspLimit)return[new Two.Anchor(x2,y2)];if(da2>cuspLimit)return[new Two.Anchor(x3,y3)]}}}else if(d2>epsilon)if(d2*d2<=tolerance.distance*(dx*dx+dy*dy)){if(tolerance.angle<tolerance.epsilon)return[new Two.Anchor(x1234,y1234)];if(da1=abs(atan2(y3-y2,x3-x2)-atan2(y2-y1,x2-x1)),da1>=PI&&(da1=TWO_PI-da1),da1<tolerance.angle)return[new Two.Anchor(x2,y2),new Two.Anchor(x3,y3)];if(0!==cuspLimit&&da1>cuspLimit)return[new Two.Anchor(x2,y2)]}else if(d3>epsilon){if(d3*d3<=tolerance.distance*(dx*dx+dy*dy)){if(tolerance.angle<tolerance.epsilon)return[new Two.Anchor(x1234,y1234)];if(da1=abs(atan2(y4-y3,x4-x3)-atan2(y3-y2,x3-x2)),da1>=PI&&(da1=TWO_PI-da1),da1<tolerance.angle)return[new Two.Anchor(x2,y2),new Two.Anchor(x3,y3)];if(0!==cuspLimit&&da1>cuspLimit)return[new Two.Anchor(x3,y3)]}}else if(dx=x1234-(x1+x4)/2,dy=y1234-(y1+y4)/2,dx*dx+dy*dy<=tolerance.distance)return[new Two.Anchor(x1234,y1234)];return Two.Utils.subdivide(x1,y1,x12,y12,x123,y123,x1234,y1234,level+1).concat(Two.Utils.subdivide(x1234,y1234,x234,y234,x34,y34,x4,y4,level+1))},getCurveFromPoints:function(points,closed){for(var l=points.length,last=l-1,i=0;l>i;i++){var point=points[i];_.isObject(point.controls)||Two.Anchor.AppendCurveProperties(point);var prev=closed?mod(i-1,l):Math.max(i-1,0),next=closed?mod(i+1,l):Math.min(i+1,last),a=points[prev],b=point,c=points[next];getControlPoints(a,b,c),b._command=0===i?Two.Commands.move:Two.Commands.curve,b.controls.left.x=_.isNumber(b.controls.left.x)?b.controls.left.x:b.x,b.controls.left.y=_.isNumber(b.controls.left.y)?b.controls.left.y:b.y,b.controls.right.x=_.isNumber(b.controls.right.x)?b.controls.right.x:b.x,b.controls.right.y=_.isNumber(b.controls.right.y)?b.controls.right.y:b.y}},getControlPoints:function(a,b,c){var a1=angleBetween(a,b),a2=angleBetween(c,b),d1=distanceBetween(a,b),d2=distanceBetween(c,b),mid=(a1+a2)/2;return b.u=_.isObject(b.controls.left)?b.controls.left:new Two.Vector(b.x,b.y),b.v=_.isObject(b.controls.right)?b.controls.right:new Two.Vector(b.x,b.y),1e-4>d1||1e-4>d2?(b.controls.left.copy(b),b.controls.right.copy(b),b):(d1*=.33,d2*=.33,a1>a2?mid+=HALF_PI:mid-=HALF_PI,b.controls.left.x=b.x+cos(mid)*d1,b.controls.left.y=b.y+sin(mid)*d1,mid-=PI,b.controls.right.x=b.x+cos(mid)*d2,b.controls.right.y=b.y+sin(mid)*d2,b)},getReflection:function(a,b,relative){var d=a.distanceTo(b);if(1e-4>=d)return relative?new Two.Vector:a.clone();var theta=angleBetween(a,b);return new Two.Vector(d*Math.cos(theta)+(relative?0:a.x),d*Math.sin(theta)+(relative?0:a.y))},angleBetween:function(A,B){var dx=A.x-B.x,dy=A.y-B.y;return atan2(dy,dx)},distanceBetweenSquared:function(p1,p2){var dx=p1.x-p2.x,dy=p1.y-p2.y;return dx*dx+dy*dy},distanceBetween:function(p1,p2){return sqrt(distanceBetweenSquared(p1,p2))},mod:function(v,l){for(;0>v;)v+=l;return v%l},Collection:function(){Array.call(this),arguments.length>1?Array.prototype.push.apply(this,arguments):arguments[0]&&Array.isArray(arguments[0])&&Array.prototype.push.apply(this,arguments[0])},Error:function(message){this.name="two.js",this.message=message}}}),Two.Utils.Error.prototype=new Error,Two.Utils.Error.prototype.constructor=Two.Utils.Error,Two.Utils.Collection.prototype=new Array,Two.Utils.Collection.constructor=Two.Utils.Collection,_.extend(Two.Utils.Collection.prototype,Backbone.Events,{pop:function(){var popped=Array.prototype.pop.apply(this,arguments);return this.trigger(Two.Events.remove,[popped]),popped},shift:function(){var shifted=Array.prototype.shift.apply(this,arguments);return this.trigger(Two.Events.remove,[shifted]),shifted},push:function(){var pushed=Array.prototype.push.apply(this,arguments);return this.trigger(Two.Events.insert,arguments),pushed},unshift:function(){var unshifted=Array.prototype.unshift.apply(this,arguments);return this.trigger(Two.Events.insert,arguments),unshifted},splice:function(){var inserted,spliced=Array.prototype.splice.apply(this,arguments);return this.trigger(Two.Events.remove,spliced),arguments.length>2&&(inserted=this.slice(arguments[0],arguments.length-2),this.trigger(Two.Events.insert,inserted)),spliced}});var distanceBetween=Two.Utils.distanceBetween,distanceBetweenSquared=Two.Utils.distanceBetweenSquared,angleBetween=Two.Utils.angleBetween,getControlPoints=Two.Utils.getControlPoints,mod=(Two.Utils.getCurveFromPoints,Two.Utils.solveSegmentIntersection,Two.Utils.decoupleShapes,Two.Utils.mod);_.extend(Two.prototype,Backbone.Events,{appendTo:function(elem){return elem.appendChild(this.renderer.domElement),this},play:function(){return Two.Utils.setPlaying.call(this,!0),this.trigger(Two.Events.play)},pause:function(){return this.playing=!1,this.trigger(Two.Events.pause)},update:function(){var animated=!!this._lastFrame,now=getNow();this.frameCount++,animated&&(this.timeDelta=parseFloat((now-this._lastFrame).toFixed(3))),this._lastFrame=now;var width=this.width,height=this.height,renderer=this.renderer;return(width!==renderer.width||height!==renderer.height)&&renderer.setSize(width,height,this.ratio),this.trigger(Two.Events.update,this.frameCount,this.timeDelta),_.defer(_.bind(function(){this.render()},this)),this},render:function(){return this.renderer.render(),this.trigger(Two.Events.render,this.frameCount)},add:function(o){var objects=o;return _.isArray(o)||(objects=_.toArray(arguments)),this.scene.add(objects),this},remove:function(o){var objects=o;return _.isArray(o)||(objects=_.toArray(arguments)),this.scene.remove(objects),this},clear:function(){return _.each(this.scene.children,function(child){child.remove()}),this},makeLine:function(x1,y1,x2,y2){var width=x2-x1,height=y2-y1,w2=width/2,h2=height/2,points=[new Two.Anchor(-w2,-h2),new Two.Anchor(w2,h2)],line=new Two.Polygon(points).noFill();return line.translation.set(x1+w2,y1+h2),this.scene.add(line),line},makeRectangle:function(x,y,width,height){var w2=width/2,h2=height/2,points=[new Two.Anchor(w2,h2),new Two.Anchor(-w2,h2),new Two.Anchor(-w2,-h2),new Two.Anchor(w2,-h2)],rect=new Two.Polygon(points,!0);return rect.translation.set(x,y),this.scene.add(rect),rect},makeCircle:function(ox,oy,r){return this.makeEllipse(ox,oy,r,r)},makeEllipse:function(ox,oy,width,height){var amount=Two.Resolution,points=_.map(_.range(amount),function(i){var pct=i/amount,theta=pct*TWO_PI,x=width*cos(theta),y=height*sin(theta);return new Two.Anchor(x,y)},this),ellipse=new Two.Polygon(points,!0,!0);return ellipse.translation.set(ox,oy),this.scene.add(ellipse),ellipse},makeCurve:function(p){var l=arguments.length,points=p;if(!_.isArray(p)){points=[];for(var i=0;l>i;i+=2){var x=arguments[i];if(!_.isNumber(x))break;var y=arguments[i+1];points.push(new Two.Anchor(x,y))}}var last=arguments[l-1],poly=new Two.Polygon(points,!(_.isBoolean(last)?last:void 0),!0),rect=poly.getBoundingClientRect(),cx=rect.left+rect.width/2,cy=rect.top+rect.height/2;return _.each(poly.vertices,function(v){v.x-=cx,v.y-=cy}),poly.translation.set(cx,cy),this.scene.add(poly),poly},makePolygon:function(p){var l=arguments.length,points=p;if(!_.isArray(p)){points=[];for(var i=0;l>i;i+=2){var x=arguments[i];if(!_.isNumber(x))break;var y=arguments[i+1];points.push(new Two.Anchor(x,y))}}var last=arguments[l-1],poly=new Two.Polygon(points,!(_.isBoolean(last)?last:void 0)),rect=poly.getBoundingClientRect();return poly.center().translation.set(rect.left+rect.width/2,rect.top+rect.height/2),this.scene.add(poly),poly},makeGroup:function(o){var objects=o;_.isArray(o)||(objects=_.toArray(arguments));var group=new Two.Group;return this.scene.add(group),group.add(objects),group},interpret:function(svgNode){var tag=svgNode.tagName.toLowerCase();if(!(tag in Two.Utils.read))return null;var node=Two.Utils.read[tag].call(this,svgNode);return this.add(node),node}}),function(){_.each(Two.Instances,function(t){t.playing&&t.update()}),requestAnimationFrame(arguments.callee)}(),"function"==typeof define&&define.amd?define(function(){return Two}):"undefined"!=typeof module&&module.exports&&(module.exports=Two)}(),function(){var Vector=Two.Vector=function(x,y){this.x=x||0,this.y=y||0};_.extend(Vector,{MakeGetterSetter:function(object,property,value){var secret="_"+property;Object.defineProperty(object,property,{get:function(){return this[secret]},set:function(v){this[secret]=v,this.trigger(Two.Events.change,property)}}),object[secret]=value}}),_.extend(Vector.prototype,Backbone.Events,{set:function(x,y){return this.x=x,this.y=y,this},copy:function(v){return this.x=v.x,this.y=v.y,this},clear:function(){return this.x=0,this.y=0,this},clone:function(){return new Vector(this.x,this.y)},add:function(v1,v2){return this.x=v1.x+v2.x,this.y=v1.y+v2.y,this},addSelf:function(v){return this.x+=v.x,this.y+=v.y,this},sub:function(v1,v2){return this.x=v1.x-v2.x,this.y=v1.y-v2.y,this},subSelf:function(v){return this.x-=v.x,this.y-=v.y,this},multiplySelf:function(v){return this.x*=v.x,this.y*=v.y,this},multiplyScalar:function(s){return this.x*=s,this.y*=s,this},divideScalar:function(s){return s?(this.x/=s,this.y/=s):this.set(0,0),this},negate:function(){return this.multiplyScalar(-1)},dot:function(v){return this.x*v.x+this.y*v.y},lengthSquared:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(v){return Math.sqrt(this.distanceToSquared(v))},distanceToSquared:function(v){var dx=this.x-v.x,dy=this.y-v.y;return dx*dx+dy*dy},setLength:function(l){return this.normalize().multiplyScalar(l)},equals:function(v){return this.distanceTo(v)<1e-4},lerp:function(v,t){var x=(v.x-this.x)*t+this.x,y=(v.y-this.y)*t+this.y;return this.set(x,y)},isZero:function(){return this.length()<1e-4},toString:function(){return this.x+","+this.y},toObject:function(){return{x:this.x,y:this.y}}});var BoundProto={set:function(x,y){return this._x=x,this._y=y,this.trigger(Two.Events.change)},copy:function(v){return this._x=v.x,this._y=v.y,this.trigger(Two.Events.change)},clear:function(){return this._x=0,this._y=0,this.trigger(Two.Events.change)},clone:function(){return new Vector(this._x,this._y)},add:function(v1,v2){return this._x=v1.x+v2.x,this._y=v1.y+v2.y,this.trigger(Two.Events.change)},addSelf:function(v){return this._x+=v.x,this._y+=v.y,this.trigger(Two.Events.change)},sub:function(v1,v2){return this._x=v1.x-v2.x,this._y=v1.y-v2.y,this.trigger(Two.Events.change)},subSelf:function(v){return this._x-=v.x,this._y-=v.y,this.trigger(Two.Events.change)},multiplySelf:function(v){return this._x*=v.x,this._y*=v.y,this.trigger(Two.Events.change)},multiplyScalar:function(s){return this._x*=s,this._y*=s,this.trigger(Two.Events.change)},divideScalar:function(s){return s?(this._x/=s,this._y/=s,this.trigger(Two.Events.change)):this.clear()},negate:function(){return this.multiplyScalar(-1)},dot:function(v){return this._x*v.x+this._y*v.y},lengthSquared:function(){return this._x*this._x+this._y*this._y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(v){return Math.sqrt(this.distanceToSquared(v))},distanceToSquared:function(v){var dx=this._x-v.x,dy=this._y-v.y;return dx*dx+dy*dy},setLength:function(l){return this.normalize().multiplyScalar(l)},equals:function(v){return this.distanceTo(v)<1e-4},lerp:function(v,t){var x=(v.x-this._x)*t+this._x,y=(v.y-this._y)*t+this._y;return this.set(x,y)},isZero:function(){return this.length()<1e-4},toString:function(){return this._x+","+this._y},toObject:function(){return{x:this._x,y:this._y}}};Two.Vector.prototype.bind=Two.Vector.prototype.on=function(){return this._bound||(Two.Vector.MakeGetterSetter(this,"x",this.x),Two.Vector.MakeGetterSetter(this,"y",this.y),_.extend(this,BoundProto),this._bound=!0),Backbone.Events.bind.apply(this,arguments),this}}(),function(){var commands=Two.Commands,Anchor=Two.Anchor=function(x,y,ux,uy,vx,vy,command){return Two.Vector.call(this,x,y),this._broadcast=_.bind(function(){this.trigger(Two.Events.change)},this),Object.defineProperty(this,"command",{get:function(){return this._command},set:function(c){return this._command=c,this._command!==commands.curve||_.isObject(this.controls)||Anchor.AppendCurveProperties(this),this.trigger(Two.Events.change)}}),this._command=command||commands.move,command?(Anchor.AppendCurveProperties(this),_.isNumber(ux)&&(this.controls.left.x=ux),_.isNumber(uy)&&(this.controls.left.y=uy),_.isNumber(vx)&&(this.controls.right.x=vx),_.isNumber(vy)&&(this.controls.right.y=vy),void 0):this};_.extend(Anchor,{AppendCurveProperties:function(anchor){var x=anchor._x||anchor.x,y=anchor._y||anchor.y;anchor.controls={left:new Two.Vector(x,y),right:new Two.Vector(x,y)}}}),_.extend(Anchor.prototype,Two.Vector.prototype,{listen:function(){return _.isObject(this.controls)||Anchor.AppendCurveProperties(this),_.each(this.controls,function(v){v.bind(Two.Events.change,this._broadcast)},this),this},ignore:function(){return _.each(this.controls,function(v){v.unbind(Two.Events.change,this._broadcast)},this),this},clone:function(){var controls=this.controls;return new Two.Anchor(this.x,this.y,controls&&controls.left.x,controls&&controls.left.y,controls&&controls.right.x,controls&&controls.right.y,this.command)}})}(),function(){var cos=(_.range(6),Math.cos),sin=Math.sin,tan=Math.tan,Matrix=Two.Matrix=function(a){this.elements=new Two.Array(9);var elements=a;_.isArray(elements)||(elements=_.toArray(arguments)),this.identity().set(elements)};_.extend(Matrix,{Identity:[1,0,0,0,1,0,0,0,1],Multiply:function(A,B){if(B.length<=3){var x,y,z,a=B[0]||0,b=B[1]||0,c=B[2]||0,e=A;return x=e[0]*a+e[1]*b+e[2]*c,y=e[3]*a+e[4]*b+e[5]*c,z=e[6]*a+e[7]*b+e[8]*c,{x:x,y:y,z:z}}var A0=A[0],A1=A[1],A2=A[2],A3=A[3],A4=A[4],A5=A[5],A6=A[6],A7=A[7],A8=A[8],B0=B[0],B1=B[1],B2=B[2],B3=B[3],B4=B[4],B5=B[5],B6=B[6],B7=B[7],B8=B[8];return[A0*B0+A1*B3+A2*B6,A0*B1+A1*B4+A2*B7,A0*B2+A1*B5+A2*B8,A3*B0+A4*B3+A5*B6,A3*B1+A4*B4+A5*B7,A3*B2+A4*B5+A5*B8,A6*B0+A7*B3+A8*B6,A6*B1+A7*B4+A8*B7,A6*B2+A7*B5+A8*B8]}}),_.extend(Matrix.prototype,Backbone.Events,{set:function(a){{var elements=a;arguments.length}return _.isArray(elements)||(elements=_.toArray(arguments)),_.each(elements,function(v,i){_.isNumber(v)&&(this.elements[i]=v)},this),this.trigger(Two.Events.change)},identity:function(){return this.set(Matrix.Identity),this},multiply:function(a,b,c,d,e){var elements=arguments,l=elements.length;if(1>=l)return _.each(this.elements,function(v,i){this.elements[i]=v*a},this),this.trigger(Two.Events.change);if(3>=l){var x,y,z;return a=a||0,b=b||0,c=c||0,e=this.elements,x=e[0]*a+e[1]*b+e[2]*c,y=e[3]*a+e[4]*b+e[5]*c,z=e[6]*a+e[7]*b+e[8]*c,{x:x,y:y,z:z}
}var A=this.elements,B=elements;return A0=A[0],A1=A[1],A2=A[2],A3=A[3],A4=A[4],A5=A[5],A6=A[6],A7=A[7],A8=A[8],B0=B[0],B1=B[1],B2=B[2],B3=B[3],B4=B[4],B5=B[5],B6=B[6],B7=B[7],B8=B[8],this.elements[0]=A0*B0+A1*B3+A2*B6,this.elements[1]=A0*B1+A1*B4+A2*B7,this.elements[2]=A0*B2+A1*B5+A2*B8,this.elements[3]=A3*B0+A4*B3+A5*B6,this.elements[4]=A3*B1+A4*B4+A5*B7,this.elements[5]=A3*B2+A4*B5+A5*B8,this.elements[6]=A6*B0+A7*B3+A8*B6,this.elements[7]=A6*B1+A7*B4+A8*B7,this.elements[8]=A6*B2+A7*B5+A8*B8,this.trigger(Two.Events.change)},inverse:function(out){var a=this.elements,out=out||new Two.Matrix,a00=a[0],a01=a[1],a02=a[2],a10=a[3],a11=a[4],a12=a[5],a20=a[6],a21=a[7],a22=a[8],b01=a22*a11-a12*a21,b11=-a22*a10+a12*a20,b21=a21*a10-a11*a20,det=a00*b01+a01*b11+a02*b21;return det?(det=1/det,out.elements[0]=b01*det,out.elements[1]=(-a22*a01+a02*a21)*det,out.elements[2]=(a12*a01-a02*a11)*det,out.elements[3]=b11*det,out.elements[4]=(a22*a00-a02*a20)*det,out.elements[5]=(-a12*a00+a02*a10)*det,out.elements[6]=b21*det,out.elements[7]=(-a21*a00+a01*a20)*det,out.elements[8]=(a11*a00-a01*a10)*det,out):null},scale:function(sx,sy){var l=arguments.length;return 1>=l&&(sy=sx),this.multiply(sx,0,0,0,sy,0,0,0,1)},rotate:function(radians){var c=cos(radians),s=sin(radians);return this.multiply(c,-s,0,s,c,0,0,0,1)},translate:function(x,y){return this.multiply(1,0,x,0,1,y,0,0,1)},skewX:function(radians){var a=tan(radians);return this.multiply(1,a,0,0,1,0,0,0,1)},skewY:function(radians){var a=tan(radians);return this.multiply(1,0,0,a,1,0,0,0,1)},toString:function(){return this.toArray().join(" ")},toArray:function(fullMatrix){var elements=this.elements,a=parseFloat(elements[0].toFixed(3)),b=parseFloat(elements[1].toFixed(3)),c=parseFloat(elements[2].toFixed(3)),d=parseFloat(elements[3].toFixed(3)),e=parseFloat(elements[4].toFixed(3)),f=parseFloat(elements[5].toFixed(3));if(fullMatrix){var g=parseFloat(elements[6].toFixed(3)),h=parseFloat(elements[7].toFixed(3)),i=parseFloat(elements[8].toFixed(3));return[a,d,g,b,e,h,c,f,i]}return[a,d,b,e,c,f]},clone:function(){var a=this.elements[0],b=this.elements[1],c=this.elements[2],d=this.elements[3],e=this.elements[4],f=this.elements[5],g=this.elements[6],h=this.elements[7],i=this.elements[8];return new Two.Matrix(a,b,c,d,e,f,g,h,i)}})}(),function(){function getStyles(o){var styles={},id=o.id,translation=o.translation,rotation=o.rotation,scale=o.scale,stroke=o.stroke,linewidth=o.linewidth,fill=o.fill,opacity=o.opacity,visible=o.visible,cap=o.cap,join=o.join,miter=o.miter,closed=o.closed,vertices=o.vertices;return id&&(styles.id=Renderer.Identifier+id),translation&&_.isNumber(scale)&&_.isNumber(rotation)&&(styles.transform="matrix("+o._matrix.toString()+")"),stroke&&(styles.stroke=stroke),fill&&(styles.fill=fill),opacity&&(styles["stroke-opacity"]=styles["fill-opacity"]=opacity),styles.visibility=visible?"visible":"hidden",cap&&(styles["stroke-linecap"]=cap),join&&(styles["stroke-linejoin"]=join),miter&&(styles["stroke-miterlimit"]=miter),linewidth&&(styles["stroke-width"]=linewidth),vertices&&(styles.d=svg.toString(vertices,closed)),styles}function setStyles(elem,property,value,closed){switch(property){case"matrix":property="transform",value="matrix("+value.toString()+")";break;case"visible":property="visibility",value=value?"visible":"hidden";break;case"cap":property="stroke-linecap";break;case"join":property="stroke-linejoin";break;case"miter":property="stroke-miterlimit";break;case"linewidth":property="stroke-width";break;case"vertices":property="d",value=svg.toString(value,closed);break;case"opacity":return svg.setAttributes(elem,{"stroke-opacity":value,"fill-opacity":value}),void 0}elem.setAttribute(property,value)}function generateId(){var count=this.count;return this.count++,count}var mod=Two.Utils.mod,svg={version:1.1,ns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",createElement:function(name,attrs){var tag=name,elem=document.createElementNS(this.ns,tag);return"svg"===tag&&(attrs=_.defaults(attrs||{},{version:this.version})),_.isObject(attrs)&&this.setAttributes(elem,attrs),elem},setAttributes:function(elem,attrs){return _.each(attrs,function(v,k){this.setAttribute(k,v)},elem),this},removeAttributes:function(elem,attrs){return _.each(attrs,function(a){this.removeAttribute(a)},elem),this},toString:function(points,closed){var l=points.length,last=l-1;return _.map(points,function(b,i){var command,vx,vy,ux,uy,ar,bl,br,cl,prev=closed?mod(i-1,l):Math.max(i-1,0),next=closed?mod(i+1,l):Math.min(i+1,last),a=points[prev],c=points[next],x=b.x.toFixed(3),y=b.y.toFixed(3);switch(b._command){case Two.Commands.close:command=b._command;break;case Two.Commands.curve:var ar=a.controls&&a.controls.right||a,bl=b.controls&&b.controls.left||b;vx=ar.x.toFixed(3),vy=ar.y.toFixed(3),ux=bl.x.toFixed(3),uy=bl.y.toFixed(3),command=b._command+" "+vx+" "+vy+" "+ux+" "+uy+" "+x+" "+y;break;default:command=(b._command||(0===i?Two.Commands.move:Two.Commands.line))+" "+x+" "+y}return i>=last&&closed&&(b._command===Two.Commands.curve&&(br=b.controls&&b.controls.right||b,cl=c.controls&&c.controls.left||c,vx=br.x.toFixed(3),vy=br.y.toFixed(3),ux=cl.x.toFixed(3),uy=cl.y.toFixed(3),x=c.x.toFixed(3),y=c.y.toFixed(3),command+=" C "+vx+" "+vy+" "+ux+" "+uy+" "+x+" "+y),command+=" Z"),command}).join(" ")}},Renderer=Two[Two.Types.svg]=function(params){this.count=0,this.domElement=params.domElement||svg.createElement("svg"),this.elements=[],this.domElement.style.visibility="hidden",this.unveil=_.once(_.bind(function(){this.domElement.style.visibility="visible"},this))};_.extend(Renderer,{Identifier:"two-",Utils:svg}),_.extend(Renderer.prototype,Backbone.Events,{setSize:function(width,height){return this.width=width,this.height=height,svg.setAttributes(this.domElement,{width:width,height:height}),this},add:function(o){var objects=(arguments.length,o),elements=this.elements,domElement=this.domElement;return _.isArray(o)||(objects=_.map(arguments,function(a){return a})),_.each(objects,function(object){var elem,tag,styles,isGroup=object instanceof Two.Group;_.isUndefined(object.id)&&(object.id=generateId.call(this)),isGroup?(tag="g",_.isUndefined(object.parent)&&(object.parent=this,object.unbind(Two.Events.change).bind(Two.Events.change,_.bind(this.update,this))),styles=getStyles(object),delete styles.stroke,delete styles.fill,delete styles["fill-opacity"],delete styles["stroke-opacity"],delete styles["stroke-linecap"],delete styles["stroke-linejoin"],delete styles["stroke-miterlimit"],delete styles["stroke-width"]):(tag="path",styles=getStyles(object)),elem=svg.createElement(tag,styles),domElement.appendChild(elem),elements.push(elem)},this),this},update:function(id,property,value,closed){var elements=this.elements,elem=elements[id];switch(property){case Two.Properties.hierarchy:_.each(value,function(j){elem.appendChild(elements[j])});break;case Two.Properties.demotion:_.each(value,function(j){elem.removeChild(elements[j])});break;default:setStyles(elem,property,value,closed)}return this},render:function(){return this.unveil(),this}})}(),function(){function getStyles(o){var styles={},id=o.id,matrix=o._matrix,stroke=o.stroke,linewidth=o.linewidth,fill=o.fill,opacity=o.opacity,visible=o.visible,cap=o.cap,join=o.join,miter=o.miter,closed=o.closed,vertices=o.vertices;return id&&(styles.id=id),_.isObject(matrix)&&(styles.matrix=matrix.toArray()),stroke&&(styles.stroke=stroke),fill&&(styles.fill=fill),_.isNumber(opacity)&&(styles.opacity=opacity),cap&&(styles.cap=cap),join&&(styles.join=join),miter&&(styles.miter=miter),linewidth&&(styles.linewidth=linewidth),vertices&&(styles.commands=vertices),styles.visible=!!visible,styles.closed=!!closed,styles}function setStyles(elem,property,value,closed){switch(property){case"matrix":property="matrix",value=value.toArray();break;case"vertices":property="commands",elem.closed=closed}elem[property]=value}function generateId(){var count=this.count;return this.count++,count}var root=this,mod=Two.Utils.mod,Group=function(styles){_.each(styles,function(v,k){this[k]=v},this),this.children=[]};_.extend(Group.prototype,{appendChild:function(elem){{var parent=elem.parent;elem.id}return _.isUndefined(parent)||parent.removeChild(elem),this.children.push(elem),elem.parent=this,this},removeChild:function(elem){var index=_.indexOf(this.children,elem);return 0>index?this:this.children.splice(index,1)[0]},render:function(ctx){var matrix=this.matrix;return ctx.save(),ctx.transform(matrix[0],matrix[1],matrix[2],matrix[3],matrix[4],matrix[5]),_.each(this.children,function(child){child.render(ctx)}),ctx.restore(),this}});var Element=function(styles){_.each(styles,function(v,k){this[k]=v},this)};_.extend(Element.prototype,{render:function(ctx){var matrix=this.matrix,stroke=this.stroke,linewidth=this.linewidth,fill=this.fill,opacity=this.opacity,visible=this.visible,cap=this.cap,join=this.join,miter=this.miter,closed=this.closed,commands=this.commands,length=commands.length,last=length-1;return visible?(ctx.save(),matrix&&ctx.transform(matrix[0],matrix[1],matrix[2],matrix[3],matrix[4],matrix[5]),fill&&(ctx.fillStyle=fill),stroke&&(ctx.strokeStyle=stroke),linewidth&&(ctx.lineWidth=linewidth),miter&&(ctx.miterLimit=miter),join&&(ctx.lineJoin=join),cap&&(ctx.lineCap=cap),_.isNumber(opacity)&&(ctx.globalAlpha=opacity),ctx.beginPath(),_.each(commands,function(b,i){var next,prev,a,c,ux,uy,vx,vy,ar,bl,br,cl,x=b.x.toFixed(3),y=b.y.toFixed(3);switch(b._command){case Two.Commands.close:ctx.closePath();break;case Two.Commands.curve:prev=closed?mod(i-1,length):Math.max(i-1,0),next=closed?mod(i+1,length):Math.min(i+1,last),a=commands[prev],c=commands[next],ar=a.controls&&a.controls.right||a,bl=b.controls&&b.controls.left||b,vx=ar.x.toFixed(3),vy=ar.y.toFixed(3),ux=bl.x.toFixed(3),uy=bl.y.toFixed(3),ctx.bezierCurveTo(vx,vy,ux,uy,x,y),i>=last&&closed&&(br=b.controls&&b.controls.right||b,cl=c.controls&&c.controls.left||c,vx=br.x.toFixed(3),vy=br.y.toFixed(3),ux=cl.x.toFixed(3),uy=cl.y.toFixed(3),x=c.x.toFixed(3),y=c.y.toFixed(3),ctx.bezierCurveTo(vx,vy,ux,uy,x,y));break;case Two.Commands.line:ctx.lineTo(x,y);break;case Two.Commands.move:ctx.moveTo(x,y)}}),closed&&ctx.closePath(),ctx.fill(),ctx.stroke(),ctx.restore(),void 0):this}});var canvas={devicePixelRatio:root.devicePixelRatio||1,getBackingStoreRatio:function(ctx){return ctx.webkitBackingStorePixelRatio||ctx.mozBackingStorePixelRatio||ctx.msBackingStorePixelRatio||ctx.oBackingStorePixelRatio||ctx.backingStorePixelRatio||1},getRatio:function(ctx){return this.devicePixelRatio/this.getBackingStoreRatio(ctx)}},Renderer=Two[Two.Types.canvas]=function(params){this.count=0,this.domElement=params.domElement||document.createElement("canvas"),this.ctx=this.domElement.getContext("2d"),this.overdraw=!1,this.elements=[],this.stage=null};_.extend(Renderer,{Group:Group,Element:Element,getStyles:getStyles,setStyles:setStyles,Utils:canvas}),_.extend(Renderer.prototype,Backbone.Events,{setSize:function(width,height,ratio){return this.width=width,this.height=height,this.ratio=_.isUndefined(ratio)?canvas.getRatio(this.ctx):ratio,this.domElement.width=width*this.ratio,this.domElement.height=height*this.ratio,_.extend(this.domElement.style,{width:width+"px",height:height+"px"}),this},add:function(o){var proto=Object.getPrototypeOf(this);constructor=proto.constructor;var objects=(arguments.length,o),elements=this.elements,Group=(this.domElement,constructor.Group),Element=constructor.Element,getStyles=constructor.getStyles;return _.isArray(o)||(objects=_.map(arguments,function(a){return a})),_.each(objects,function(object){var elem,styles,isGroup=object instanceof Two.Group,isStage=_.isNull(this.stage);_.isUndefined(object.id)&&(object.id=generateId.call(this)),isGroup?(styles=getStyles.call(this,object),delete styles.stroke,delete styles.fill,delete styles.opacity,delete styles.cap,delete styles.join,delete styles.miter,delete styles.linewidth,elem=new Group(styles),isStage&&(this.stage=elem,this.stage.object=object,this.stage.parent=object.parent=this,object.unbind(Two.Events.change).bind(Two.Events.change,_.bind(this.update,this)))):elem=new Element(getStyles.call(this,object)),elements.push(elem),isStage||this.stage.appendChild(elem)},this),this},update:function(id,property,value,closed,strokeChanged){var proto=Object.getPrototypeOf(this),constructor=proto.constructor,elements=this.elements,elem=elements[id];switch(property){case Two.Properties.hierarchy:_.each(value,function(j){elem.appendChild(elements[j])});break;case Two.Properties.demotion:_.each(value,function(j){elem.removeChild(elements[j]),this.elements[j]=null},this);break;default:constructor.setStyles.call(this,elem,property,value,closed,strokeChanged)}return this},render:function(){if(_.isNull(this.stage))return this;var isOne=1===this.ratio;return isOne||(this.ctx.save(),this.ctx.scale(this.ratio,this.ratio)),this.overdraw||this.ctx.clearRect(0,0,this.width,this.height),this.stage.render(this.ctx),isOne||this.ctx.restore(),this}})}(),function(){function getStyles(o){var styles={},id=o.id,matrix=o._matrix,stroke=o.stroke,linewidth=o.linewidth,fill=o.fill,opacity=o.opacity,visible=o.visible,cap=o.cap,join=o.join,miter=o.miter,closed=o.closed,vertices=o.vertices;return id&&(styles.id=id),_.isObject(matrix)&&(styles.matrix=styles._matrix=matrix.toArray(!0),styles.scale=styles._scale=1),stroke&&(styles.stroke=stroke),fill&&(styles.fill=fill),_.isNumber(opacity)&&(styles.opacity=opacity),cap&&(styles.cap=cap),join&&(styles.join=join),miter&&(styles.miter=miter),linewidth&&(styles.linewidth=linewidth),vertices&&(styles.vertices=vertices,styles.commands=styles.vertices,styles.rect=webgl.getBoundingClientRect(styles.commands,styles.linewidth),styles.triangles=webgl.getTriangles(styles.rect)),styles.visible=!!visible,styles.closed=!!closed,o instanceof Two.Polygon&&(webgl.updateBuffer(this.ctx,styles,this.program),Element.prototype.updateTexture.call(styles,this.ctx)),styles}function setStyles(elem,property,value,closed,strokeChanged){var textureNeedsUpdate=!1;/matrix/.test(property)?(elem[property]=value.toArray(!0),_.isNumber(closed)&&(textureNeedsUpdate=elem.scale!==closed,elem.scale=closed),elem.updateMatrix()):/(stroke|fill|opacity|cap|join|miter|linewidth)/.test(property)?(elem[property]=value,elem.rect=expand(webgl.getBoundingClientRect(elem.commands,elem.linewidth),elem.rect),elem.triangles=webgl.getTriangles(elem.rect),webgl.updateBuffer(this.ctx,elem,this.program),textureNeedsUpdate=!0):"vertices"===property?(_.isUndefined(closed)||(elem.closed=closed),strokeChanged?elem.commands=value:(elem.vertices=value,elem.commands=elem.vertices),elem.rect=expand(webgl.getBoundingClientRect(elem.vertices,elem.linewidth),elem.rect),elem.triangles=webgl.getTriangles(elem.rect),webgl.updateBuffer(this.ctx,elem,this.program),textureNeedsUpdate=!0):elem[property]=value,textureNeedsUpdate&&elem.updateTexture(this.ctx)}function expand(r1,r2){var top=Math.min(r1.top,r2.top),left=Math.min(r1.left,r2.left),right=Math.max(r1.right,r2.right),bottom=Math.max(r1.bottom,r2.bottom),width=right-left,height=bottom-top,centroid={x:-left,y:-top};return{top:top,left:left,right:right,bottom:bottom,width:width,height:height,centroid:centroid}}var CanvasRenderer=Two[Two.Types.canvas],multiplyMatrix=Two.Matrix.Multiply,mod=Two.Utils.mod,Group=function(styles){CanvasRenderer.Group.call(this,styles)};_.extend(Group.prototype,CanvasRenderer.Group.prototype,{appendChild:function(){return CanvasRenderer.Group.prototype.appendChild.apply(this,arguments),this.updateMatrix(),this},updateTexture:function(ctx){return _.each(this.children,function(child){child.updateTexture(ctx)}),this},updateMatrix:function(parent){var matrix=parent&&parent._matrix||this.parent&&this.parent._matrix,scale=parent&&parent._scale||this.parent&&this.parent._scale;return matrix?(this._matrix=multiplyMatrix(this.matrix,matrix),this._scale=this.scale*scale,_.each(this.children,function(child){child.updateMatrix(this)},this),this):this},render:function(gl,program){_.each(this.children,function(child){child.render(gl,program)})}});var Element=function(styles){CanvasRenderer.Element.call(this,styles)};_.extend(Element.prototype,CanvasRenderer.Element.prototype,{updateMatrix:function(parent){var matrix=parent&&parent._matrix||this.parent&&this.parent._matrix,scale=parent&&parent._scale||this.parent&&this.parent._scale;return matrix?(this._matrix=multiplyMatrix(this.matrix,matrix),this._scale=this.scale*scale,this):this},updateTexture:function(ctx){return webgl.updateTexture(ctx,this),this},render:function(gl,program){return this.visible&&this.opacity&&this.buffer?(gl.bindBuffer(gl.ARRAY_BUFFER,this.textureCoordsBuffer),gl.vertexAttribPointer(program.textureCoords,2,gl.FLOAT,!1,0,0),gl.bindTexture(gl.TEXTURE_2D,this.texture),gl.uniformMatrix3fv(program.matrix,!1,this._matrix),gl.bindBuffer(gl.ARRAY_BUFFER,this.buffer),gl.vertexAttribPointer(program.position,2,gl.FLOAT,!1,0,0),gl.drawArrays(gl.TRIANGLES,0,6),this):this}});var webgl={canvas:document.createElement("canvas"),uv:new Two.Array([0,0,1,0,0,1,0,1,1,0,1,1]),getBoundingClientRect:function(vertices,border){var left=1/0,right=-1/0,top=1/0,bottom=-1/0;_.each(vertices,function(v){var a,b,c,d,x=v.x,y=v.y,controls=v.controls;if(top=Math.min(y,top),left=Math.min(x,left),right=Math.max(x,right),bottom=Math.max(y,bottom),v.controls){var cl=controls.left,cr=controls.right;cl&&cr&&(a=cl.x,b=cl.y,c=cr.x,d=cr.y,a&&b&&c&&d&&(top=Math.min(b,d,top),left=Math.min(a,c,left),right=Math.max(a,c,right),bottom=Math.max(b,d,bottom)))}}),_.isNumber(border)&&(top-=border,left-=border,right+=border,bottom+=border);var width=right-left,height=bottom-top,centroid={x:-left,y:-top};return{top:top,left:left,right:right,bottom:bottom,width:width,height:height,centroid:centroid}},getTriangles:function(rect){var top=rect.top,left=rect.left,right=rect.right,bottom=rect.bottom;return new Two.Array([left,top,right,top,left,bottom,left,bottom,right,top,right,bottom])},updateCanvas:function(elem){var commands=elem.commands,canvas=this.canvas,ctx=this.ctx,scale=elem._scale,stroke=elem.stroke,linewidth=elem.linewidth*scale,fill=elem.fill,opacity=elem.opacity,cap=elem.cap,join=elem.join,miter=elem.miter,closed=elem.closed,length=commands.length,last=length-1;canvas.width=Math.max(Math.ceil(elem.rect.width*scale),1),canvas.height=Math.max(Math.ceil(elem.rect.height*scale),1);var centroid=elem.rect.centroid,cx=centroid.x*scale,cy=centroid.y*scale;ctx.clearRect(0,0,canvas.width,canvas.height),fill&&(ctx.fillStyle=fill),stroke&&(ctx.strokeStyle=stroke),linewidth&&(ctx.lineWidth=linewidth),miter&&(ctx.miterLimit=miter),join&&(ctx.lineJoin=join),cap&&(ctx.lineCap=cap),_.isNumber(opacity)&&(ctx.globalAlpha=opacity),ctx.beginPath(),_.each(commands,function(b,i){var next,prev,a,c,ux,uy,vx,vy,ar,bl,br,cl,x=(b.x*scale+cx).toFixed(3),y=(b.y*scale+cy).toFixed(3);switch(b._command){case Two.Commands.close:ctx.closePath();break;case Two.Commands.curve:prev=closed?mod(i-1,length):Math.max(i-1,0),next=closed?mod(i+1,length):Math.min(i+1,last),a=commands[prev],c=commands[next],ar=a.controls&&a.controls.right||a,bl=b.controls&&b.controls.left||b,vx=(ar.x*scale+cx).toFixed(3),vy=(ar.y*scale+cy).toFixed(3),ux=(bl.x*scale+cx).toFixed(3),uy=(bl.y*scale+cy).toFixed(3),ctx.bezierCurveTo(vx,vy,ux,uy,x,y),i>=last&&closed&&(br=b.controls&&b.controls.right||b,cl=c.controls&&c.controls.left||c,vx=(br.x*scale+cx).toFixed(3),vy=(br.y*scale+cy).toFixed(3),ux=(cl.x*scale+cx).toFixed(3),uy=(cl.y*scale+cy).toFixed(3),x=(c.x*scale+cx).toFixed(3),y=(c.y*scale+cy).toFixed(3),ctx.bezierCurveTo(vx,vy,ux,uy,x,y));break;case Two.Commands.line:ctx.lineTo(x,y);break;case Two.Commands.move:ctx.moveTo(x,y)}}),closed&&ctx.closePath(),ctx.fill(),ctx.stroke()},updateTexture:function(gl,elem){this.updateCanvas(elem),elem.texture&&gl.deleteTexture(elem.texture),gl.bindBuffer(gl.ARRAY_BUFFER,elem.textureCoordsBuffer),elem.texture=gl.createTexture(),gl.bindTexture(gl.TEXTURE_2D,elem.texture),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.LINEAR),this.canvas.width<=0||this.canvas.height<=0||gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,this.canvas)},updateBuffer:function(gl,elem,program){_.isObject(elem.buffer)&&gl.deleteBuffer(elem.buffer),elem.buffer=gl.createBuffer(),gl.bindBuffer(gl.ARRAY_BUFFER,elem.buffer),gl.enableVertexAttribArray(program.position),gl.bufferData(gl.ARRAY_BUFFER,elem.triangles,gl.STATIC_DRAW),_.isObject(elem.textureCoordsBuffer)&&gl.deleteBuffer(elem.textureCoordsBuffer),elem.textureCoordsBuffer=gl.createBuffer(),gl.bindBuffer(gl.ARRAY_BUFFER,elem.textureCoordsBuffer),gl.enableVertexAttribArray(program.textureCoords),gl.bufferData(gl.ARRAY_BUFFER,this.uv,gl.STATIC_DRAW)},program:{create:function(gl,shaders){var program=gl.createProgram();_.each(shaders,function(s){gl.attachShader(program,s)}),gl.linkProgram(program);var linked=gl.getProgramParameter(program,gl.LINK_STATUS);if(!linked)throw error=gl.getProgramInfoLog(program),gl.deleteProgram(program),new Two.Utils.Error("unable to link program: "+error);return program}},shaders:{create:function(gl,source,type){var shader=gl.createShader(gl[type]);gl.shaderSource(shader,source),gl.compileShader(shader);var compiled=gl.getShaderParameter(shader,gl.COMPILE_STATUS);if(!compiled){var error=gl.getShaderInfoLog(shader);throw gl.deleteShader(shader),new Two.Utils.Error("unable to compile shader "+shader+": "+error)}return shader},types:{vertex:"VERTEX_SHADER",fragment:"FRAGMENT_SHADER"},vertex:["attribute vec2 a_position;","attribute vec2 a_textureCoords;","","uniform mat3 u_matrix;","uniform vec2 u_resolution;","","varying vec2 v_textureCoords;","","void main() {","   vec2 projected = (u_matrix * vec3(a_position, 1.0)).xy;","   vec2 normal = projected / u_resolution;","   vec2 clipspace = (normal * 2.0) - 1.0;","","   gl_Position = vec4(clipspace * vec2(1.0, -1.0), 0.0, 1.0);","   v_textureCoords = a_textureCoords;","}"].join("\n"),fragment:["precision mediump float;","","uniform sampler2D u_image;","varying vec2 v_textureCoords;","","void main() {","  gl_FragColor = texture2D(u_image, v_textureCoords);","}"].join("\n")}};webgl.ctx=webgl.canvas.getContext("2d");var Renderer=Two[Two.Types.webgl]=function(options){this.count=0,this.domElement=options.domElement||document.createElement("canvas"),this.elements=[],this.stage=null,this._matrix=[1,0,0,0,1,0,0,0,1],this._scale=1;var params=_.defaults(options||{},{antialias:!1,alpha:!0,premultipliedAlpha:!0,stencil:!0,preserveDrawingBuffer:!0,overdraw:!1});this.overdraw=params.overdraw;var gl=this.ctx=this.domElement.getContext("webgl",params)||this.domElement.getContext("experimental-webgl",params);if(!this.ctx)throw new Two.Utils.Error("unable to create a webgl context. Try using another renderer.");var vs=webgl.shaders.create(gl,webgl.shaders.vertex,webgl.shaders.types.vertex),fs=webgl.shaders.create(gl,webgl.shaders.fragment,webgl.shaders.types.fragment);this.program=webgl.program.create(gl,[vs,fs]),gl.useProgram(this.program),this.program.position=gl.getAttribLocation(this.program,"a_position"),this.program.matrix=gl.getUniformLocation(this.program,"u_matrix"),this.program.textureCoords=gl.getAttribLocation(this.program,"a_textureCoords"),gl.disable(gl.DEPTH_TEST),gl.enable(gl.BLEND),gl.blendEquationSeparate(gl.FUNC_ADD,gl.FUNC_ADD),gl.blendFuncSeparate(gl.SRC_ALPHA,gl.ONE_MINUS_SRC_ALPHA,gl.ONE,gl.ONE_MINUS_SRC_ALPHA)};_.extend(Renderer,{Group:Group,Element:Element,getStyles:getStyles,setStyles:setStyles}),_.extend(Renderer.prototype,Backbone.Events,CanvasRenderer.prototype,{setSize:function(width,height){CanvasRenderer.prototype.setSize.apply(this,arguments),width*=this.ratio,height*=this.ratio,this._matrix[0]=this._matrix[4]=this._scale=this.ratio,_.isNull(this.stage)||this.stage.updateMatrix(),this.ctx.viewport(0,0,width,height);var resolutionLocation=this.ctx.getUniformLocation(this.program,"u_resolution");return this.ctx.uniform2f(resolutionLocation,width,height),this},render:function(){if(_.isNull(this.stage))return this;var gl=this.ctx;return this.overdraw||gl.clear(gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT),this.stage.render(gl,this.program),this}})}(),function(){var Shape=Two.Shape=function(limited){this._matrix=new Two.Matrix;var updateMatrix=_.debounce(_.bind(function(){var transform=this._matrix.identity().translate(this.translation.x,this.translation.y).scale(this.scale).rotate(this.rotation);this.trigger(Two.Events.change,this.id,"matrix",transform,this.scale)},this),0);return this._rotation=0,Object.defineProperty(this,"rotation",{get:function(){return this._rotation},set:function(v){this._rotation=v,updateMatrix()}}),this._scale="scale",Object.defineProperty(this,"scale",{get:function(){return this._scale},set:function(v){this._scale=v,updateMatrix()}}),this.translation=new Two.Vector,this.rotation=0,this.scale=1,this.translation.bind(Two.Events.change,updateMatrix),limited?this:(Shape.MakeGetterSetter(this,Shape.Properties),this.fill="#fff",this.stroke="#000",this.linewidth=1,this.opacity=1,this.visible=!0,this.cap="round",this.join="round",this.miter=4,void 0)};_.extend(Shape,{Properties:["fill","stroke","linewidth","opacity","visible","cap","join","miter"],MakeGetterSetter:function(shape,properties){_.isArray(properties)||(properties=[properties]),_.each(properties,function(k){var secret="_"+k;Object.defineProperty(shape,k,{get:function(){return this[secret]},set:function(v){this[secret]=v,this.trigger(Two.Events.change,this.id,k,v,this)}})})}}),_.extend(Shape.prototype,Backbone.Events,{addTo:function(group){return group.add(this),this},noFill:function(){return this.fill="transparent",this},noStroke:function(){return this.stroke="transparent",this},clone:function(){var clone=new Shape;return clone.translation.copy(this.translation),_.each(Shape.Properties,function(k){clone[k]=this[k]},this),this}})}(),function(){var min=Math.min,max=Math.max,Group=Two.Group=function(){Two.Shape.call(this,!0),delete this.stroke,delete this.fill,delete this.linewidth,delete this.opacity,delete this.cap,delete this.join,delete this.miter,Group.MakeGetterSetter(this,Two.Shape.Properties),this.children={}};_.extend(Group,{MakeGetterSetter:function(group,properties){_.isArray(properties)||(properties=[properties]),_.each(properties,function(k){var secret="_"+k;Object.defineProperty(group,k,{get:function(){return this[secret]},set:function(v){this[secret]=v,_.each(this.children,function(child){child[k]=v})}})})}}),_.extend(Group.prototype,Two.Shape.prototype,{clone:function(parent){parent=parent||this.parent;var children=_.map(this.children,function(child){return child.clone(parent)}),group=new Group;return parent.add(group),group.add(children),group.translation.copy(this.translation),group.rotation=this.rotation,group.scale=this.scale,group},corner:function(){var rect=this.getBoundingClientRect(!0),corner={x:rect.left,y:rect.top};return _.each(this.children,function(child){child.translation.subSelf(corner)}),this},center:function(){var rect=this.getBoundingClientRect(!0);return rect.centroid={x:rect.left+rect.width/2,y:rect.top+rect.height/2},_.each(this.children,function(child){child.translation.subSelf(rect.centroid)}),this},add:function(o){var objects=(arguments.length,o),children=this.children,grandparent=this.parent,ids=[];_.isArray(o)||(objects=_.toArray(arguments));var broadcast=_.bind(function(id,property,value,closed,strokeChanged){this.trigger(Two.Events.change,id,property,value,closed,strokeChanged)},this);return _.each(objects,function(object){if(object){var id=object.id,parent=object.parent;_.isUndefined(id)&&(grandparent.add(object),id=object.id),_.isUndefined(children[id])&&(parent&&delete parent.children[id],children[id]=object,object.parent=this,object.unbind(Two.Events.change).bind(Two.Events.change,broadcast),ids.push(id))}},this),ids.length>0&&this.trigger(Two.Events.change,this.id,Two.Properties.hierarchy,ids),this},remove:function(o){var l=arguments.length,objects=o,children=this.children,grandparent=this.parent,ids=[];return 0>=l&&grandparent?(grandparent.remove(this),this):(_.isArray(o)||(objects=_.toArray(arguments)),_.each(objects,function(object){{var id=object.id;object.children}id in children&&(delete children[id],delete object.parent,object.unbind(Two.Events.change),ids.push(id))}),ids.length>0&&this.trigger(Two.Events.change,this.id,Two.Properties.demotion,ids),this)},getBoundingClientRect:function(shallow){var left=1/0,right=-1/0,top=1/0,bottom=-1/0;_.each(this.children,function(child){var rect=child.getBoundingClientRect(!0);_.isNumber(rect.top)&&_.isNumber(rect.left)&&_.isNumber(rect.right)&&_.isNumber(rect.bottom)&&(top=min(rect.top,top),left=min(rect.left,left),right=max(rect.right,right),bottom=max(rect.bottom,bottom))},this);var matrix=shallow?this._matrix:Two.Utils.getComputedMatrix(this),a=matrix.multiply(left,top,1),b=matrix.multiply(right,top,1),c=matrix.multiply(right,bottom,1),d=matrix.multiply(left,bottom,1);return top=min(a.y,b.y,c.y,d.y),left=min(a.x,b.x,c.x,d.x),right=max(a.x,b.x,c.x,d.x),bottom=max(a.y,b.y,c.y,d.y),{top:top,left:left,right:right,bottom:bottom,width:right-left,height:bottom-top}},noFill:function(){return _.each(this.children,function(child){child.noFill()}),this},noStroke:function(){return _.each(this.children,function(child){child.noStroke()}),this},subdivide:function(){return _.each(this.children,function(child){child.subdivide()}),this}})}(),function(){var min=Math.min,max=Math.max,round=Math.round,Polygon=Two.Polygon=function(vertices,closed,curved,manual){Two.Shape.call(this),this._closed=!!closed,this._curved=!!curved,this._automatic=!manual;var verticesCollection,beginning=0,ending=1,strokeChanged=!1,verticesChanged=!1,renderedVertices=[],updateVertices=_.debounce(_.bind(function(){var l,ia,ib,last;if(this._automatic&&this.plot(),strokeChanged||verticesChanged){l=verticesCollection.length,last=l-1,ia=round(beginning*last),ib=round(ending*last),renderedVertices.length=0;for(var i=ia;ib+1>i;i++){var v=verticesCollection[i];renderedVertices.push(v)}}this.trigger(Two.Events.change,this.id,"vertices",renderedVertices,this._closed,strokeChanged),strokeChanged=!1,verticesChanged=!1},this),0);return Object.defineProperty(this,"closed",{get:function(){return this._closed},set:function(v){this._closed=!!v,updateVertices()}}),Object.defineProperty(this,"curved",{get:function(){return this._curved},set:function(v){this._curved=!!v,updateVertices()}}),Object.defineProperty(this,"automatic",{get:function(){return this._automatic},set:function(v){if(v!==this._automatic){this._automatic=!!v;var method=this._automatic?"ignore":"listen";_.each(this.vertices,function(v){v[method]()},this),updateVertices()}}}),Object.defineProperty(this,"beginning",{get:function(){return beginning},set:function(v){beginning=min(max(v,0),1),strokeChanged=!0,updateVertices()}}),Object.defineProperty(this,"ending",{get:function(){return ending},set:function(v){ending=min(max(v,0),1),strokeChanged=!0,updateVertices()}}),Object.defineProperty(this,"vertices",{get:function(){return verticesCollection},set:function(vertices){var bindVerts=_.bind(function(items){_.each(items,function(v){v.bind(Two.Events.change,updateVertices)},this),verticesChanged=!0,updateVertices()},this),unbindVerts=_.bind(function(items){_.each(items,function(v){v.unbind(Two.Events.change,updateVertices)},this),verticesChanged=!0,updateVertices()},this);verticesCollection&&verticesCollection.unbind(),verticesCollection=new Two.Utils.Collection(vertices.slice(0)),verticesCollection.bind(Two.Events.insert,bindVerts),verticesCollection.bind(Two.Events.remove,unbindVerts),verticesChanged=!0,bindVerts(verticesCollection)}}),this.vertices=vertices,this._automatic?(this.plot(),this):(_.each(this.vertices,function(v){_.isFunction(v.listen)&&v.listen()}),void 0)};_.extend(Polygon.prototype,Two.Shape.prototype,{clone:function(){var points=_.map(this.vertices,function(v){return v.clone()}),clone=new Polygon(points,this._closed,this._curved);return _.each(Two.Shape.Properties,function(k){clone[k]=this[k]},this),clone.translation.copy(this.translation),clone.rotation=this.rotation,clone.scale=this.scale,clone},corner:function(){var rect=this.getBoundingClientRect(!0),corner={x:rect.left,y:rect.top};return _.each(this.vertices,function(v){v.subSelf(corner)}),this},center:function(){var rect=this.getBoundingClientRect(!0);return rect.centroid={x:rect.left+rect.width/2,y:rect.top+rect.height/2},_.each(this.vertices,function(v){v.subSelf(rect.centroid)}),this},remove:function(){return this.parent?(this.parent.remove(this),this):this},getBoundingClientRect:function(shallow){var border=this.linewidth/2,left=1/0,right=-1/0,top=1/0,bottom=-1/0;
_.each(this.vertices,function(v){var x=v.x,y=v.y;top=min(y,top),left=min(x,left),right=max(x,right),bottom=max(y,bottom)}),top-=border,left-=border,right+=border,bottom+=border;var matrix=shallow?this._matrix:Two.Utils.getComputedMatrix(this),a=matrix.multiply(left,top,1),b=matrix.multiply(right,top,1),c=matrix.multiply(right,bottom,1),d=matrix.multiply(left,bottom,1);return top=min(a.y,b.y,c.y,d.y),left=min(a.x,b.x,c.x,d.x),right=max(a.x,b.x,c.x,d.x),bottom=max(a.y,b.y,c.y,d.y),{top:top,left:left,right:right,bottom:bottom,width:right-left,height:bottom-top}},plot:function(){return this._curved?(Two.Utils.getCurveFromPoints(this.vertices,this._closed),this):(_.each(this.vertices,function(p,i){p._command=0===i?Two.Commands.move:Two.Commands.line},this),this)},subdivide:function(){var b,last=this.vertices.length-1,closed=this._closed||this.vertices[last].command===Two.Commands.close,points=[];return _.each(this.vertices,function(a,i){var x1,y1,x2,y2,x3,y3,x4,y4;return 0>=i&&!closed?(b=a,void 0):(x1=b.x,y1=b.y,x2=(b.controls&&b.controls.right||b).x,y2=(b.controls&&b.controls.right||b).y,x3=(a.controls&&a.controls.left||a).x,y3=(a.controls&&a.controls.left||a).y,x4=a.x,y4=a.y,points.push(Two.Utils.subdivide(x1,y1,x2,y2,x3,y3,x4,y4)),b=a,void 0)},this),this._manual=!1,this._curved=!1,this.vertices=_.flatten(points),this.plot(),this}})}(),!function(){"use strict";function initialize(object,s){object.s=null!==s&&void 0!==s?"string"==typeof s?s:s.toString():s,object.orig=s,null!==s&&void 0!==s?object.__defineGetter__?object.__defineGetter__("length",function(){return object.s.length}):object.length=s.length:object.length=-1}function S(s){initialize(this,s)}function extendPrototype(){for(var name in __sp)!function(name){var func=__sp[name];__nsp.hasOwnProperty(name)||(methodsAdded.push(name),__nsp[name]=function(){return String.prototype.s=this,func.apply(this,arguments)})}(name)}function restorePrototype(){for(var i=0;i<methodsAdded.length;++i)delete String.prototype[methodsAdded[i]];methodsAdded.length=0}function getNativeStringProperties(){for(var names=getNativeStringPropertyNames(),retObj={},i=0;i<names.length;++i){var name=names[i],func=__nsp[name];try{var type=typeof func.apply("teststring",[]);retObj[name]=type}catch(e){}}return retObj}function getNativeStringPropertyNames(){var results=[];if(Object.getOwnPropertyNames)return results=Object.getOwnPropertyNames(__nsp),results.splice(results.indexOf("valueOf"),1),results.splice(results.indexOf("toString"),1),results;var stringNames={};for(var name in String.prototype)stringNames[name]=name;for(var name in Object.prototype)delete stringNames[name];for(var name in stringNames)results.push(name);return results}function Export(str){return new S(str)}function multiArgs(args,fn){var i,result=[];for(i=0;i<args.length;i++)result.push(args[i]),fn&&fn.call(args,args[i],i);return result}var VERSION="1.6.0",ENTITIES={},__nsp=String.prototype,__sp=S.prototype={between:function(left,right){var s=this.s,startPos=s.indexOf(left),endPos=s.indexOf(right),start=startPos+left.length;return new this.constructor(endPos>startPos?s.slice(start,endPos):"")},camelize:function(){var s=this.trim().s.replace(/(\-|_|\s)+(.)?/g,function(mathc,sep,c){return c?c.toUpperCase():""});return new this.constructor(s)},capitalize:function(){return new this.constructor(this.s.substr(0,1).toUpperCase()+this.s.substring(1).toLowerCase())},charAt:function(index){return this.s.charAt(index)},chompLeft:function(prefix){var s=this.s;return 0===s.indexOf(prefix)?(s=s.slice(prefix.length),new this.constructor(s)):this},chompRight:function(suffix){if(this.endsWith(suffix)){var s=this.s;return s=s.slice(0,s.length-suffix.length),new this.constructor(s)}return this},collapseWhitespace:function(){var s=this.s.replace(/[\s\xa0]+/g," ").replace(/^\s+|\s+$/g,"");return new this.constructor(s)},contains:function(ss){return this.s.indexOf(ss)>=0},count:function(ss){for(var count=0,pos=this.s.indexOf(ss);pos>=0;)count+=1,pos=this.s.indexOf(ss,pos+1);return count},dasherize:function(){var s=this.trim().s.replace(/[_\s]+/g,"-").replace(/([A-Z])/g,"-$1").replace(/-+/g,"-").toLowerCase();return new this.constructor(s)},decodeHtmlEntities:function(){var s=this.s;return s=s.replace(/&#(\d+);?/g,function(_,code){return String.fromCharCode(code)}).replace(/&#[xX]([A-Fa-f0-9]+);?/g,function(_,hex){return String.fromCharCode(parseInt(hex,16))}).replace(/&([^;\W]+;?)/g,function(m,e){var ee=e.replace(/;$/,""),target=ENTITIES[e]||e.match(/;$/)&&ENTITIES[ee];return"number"==typeof target?String.fromCharCode(target):"string"==typeof target?target:m}),new this.constructor(s)},endsWith:function(suffix){var l=this.s.length-suffix.length;return l>=0&&this.s.indexOf(suffix,l)===l},escapeHTML:function(){return new this.constructor(this.s.replace(/[&<>"']/g,function(m){return"&"+reversedEscapeChars[m]+";"}))},ensureLeft:function(prefix){var s=this.s;return 0===s.indexOf(prefix)?this:new this.constructor(prefix+s)},ensureRight:function(suffix){var s=this.s;return this.endsWith(suffix)?this:new this.constructor(s+suffix)},humanize:function(){if(null===this.s||void 0===this.s)return new this.constructor("");var s=this.underscore().replace(/_id$/,"").replace(/_/g," ").trim().capitalize();return new this.constructor(s)},isAlpha:function(){return!/[^a-z\xC0-\xFF]/.test(this.s.toLowerCase())},isAlphaNumeric:function(){return!/[^0-9a-z\xC0-\xFF]/.test(this.s.toLowerCase())},isEmpty:function(){return null===this.s||void 0===this.s?!0:/^[\s\xa0]*$/.test(this.s)},isLower:function(){return this.isAlpha()&&this.s.toLowerCase()===this.s},isNumeric:function(){return!/[^0-9]/.test(this.s)},isUpper:function(){return this.isAlpha()&&this.s.toUpperCase()===this.s},left:function(N){if(N>=0){var s=this.s.substr(0,N);return new this.constructor(s)}return this.right(-N)},lines:function(){return this.replaceAll("\r\n","\n").s.split("\n")},pad:function(len,ch){if(ch=ch||" ",this.s.length>=len)return new this.constructor(this.s);len-=this.s.length;var left=Array(Math.ceil(len/2)+1).join(ch),right=Array(Math.floor(len/2)+1).join(ch);return new this.constructor(left+this.s+right)},padLeft:function(len,ch){return ch=ch||" ",this.s.length>=len?new this.constructor(this.s):new this.constructor(Array(len-this.s.length+1).join(ch)+this.s)},padRight:function(len,ch){return ch=ch||" ",this.s.length>=len?new this.constructor(this.s):new this.constructor(this.s+Array(len-this.s.length+1).join(ch))},parseCSV:function(delimiter,qualifier,escape,lineDelimiter){delimiter=delimiter||",",escape=escape||"\\","undefined"==typeof qualifier&&(qualifier='"');var i=0,fieldBuffer=[],fields=[],len=this.s.length,inField=!1,self=this,ca=function(i){return self.s.charAt(i)};if("undefined"!=typeof lineDelimiter)var rows=[];for(qualifier||(inField=!0);len>i;){var current=ca(i);switch(current){case escape:if(inField&&(escape!==qualifier||ca(i+1)===qualifier)){i+=1,fieldBuffer.push(ca(i));break}if(escape!==qualifier)break;case qualifier:inField=!inField;break;case delimiter:inField&&qualifier?fieldBuffer.push(current):(fields.push(fieldBuffer.join("")),fieldBuffer.length=0);break;case lineDelimiter:inField?fieldBuffer.push(current):rows&&(fields.push(fieldBuffer.join("")),rows.push(fields),fields=[],fieldBuffer.length=0);break;default:inField&&fieldBuffer.push(current)}i+=1}return fields.push(fieldBuffer.join("")),rows?(rows.push(fields),rows):fields},replaceAll:function(ss,r){var s=this.s.split(ss).join(r);return new this.constructor(s)},right:function(N){if(N>=0){var s=this.s.substr(this.s.length-N,N);return new this.constructor(s)}return this.left(-N)},setValue:function(s){return initialize(this,s),this},slugify:function(){var sl=new S(this.s.replace(/[^\w\s-]/g,"").toLowerCase()).dasherize().s;return"-"===sl.charAt(0)&&(sl=sl.substr(1)),new this.constructor(sl)},startsWith:function(prefix){return 0===this.s.lastIndexOf(prefix,0)},stripPunctuation:function(){return new this.constructor(this.s.replace(/[^\w\s]|_/g,"").replace(/\s+/g," "))},stripTags:function(){var s=this.s,args=arguments.length>0?arguments:[""];return multiArgs(args,function(tag){s=s.replace(RegExp("</?"+tag+"[^<>]*>","gi"),"")}),new this.constructor(s)},template:function(values,opening,closing){var s=this.s,opening=opening||Export.TMPL_OPEN,closing=closing||Export.TMPL_CLOSE,r=new RegExp(opening+"(.+?)"+closing,"g"),matches=s.match(r)||[];return matches.forEach(function(match){var key=match.substring(opening.length,match.length-closing.length);"undefined"!=typeof values[key]&&(s=s.replace(match,values[key]))}),new this.constructor(s)},times:function(n){return new this.constructor(new Array(n+1).join(this.s))},toBoolean:function(){if("string"==typeof this.orig){var s=this.s.toLowerCase();return"true"===s||"yes"===s||"on"===s}return this.orig===!0||1===this.orig},toFloat:function(precision){var num=parseFloat(this.s);return precision?parseFloat(num.toFixed(precision)):num},toInt:function(){return/^\s*-?0x/i.test(this.s)?parseInt(this.s,16):parseInt(this.s,10)},trim:function(){var s;return s="undefined"==typeof __nsp.trim?this.s.replace(/(^\s*|\s*$)/g,""):this.s.trim(),new this.constructor(s)},trimLeft:function(){var s;return s=__nsp.trimLeft?this.s.trimLeft():this.s.replace(/(^\s*)/g,""),new this.constructor(s)},trimRight:function(){var s;return s=__nsp.trimRight?this.s.trimRight():this.s.replace(/\s+$/,""),new this.constructor(s)},truncate:function(length,pruneStr){var str=this.s;if(length=~~length,pruneStr=pruneStr||"...",str.length<=length)return new this.constructor(str);var tmpl=function(c){return c.toUpperCase()!==c.toLowerCase()?"A":" "},template=str.slice(0,length+1).replace(/.(?=\W*\w*$)/g,tmpl);return template=template.slice(template.length-2).match(/\w\w/)?template.replace(/\s*\S+$/,""):new S(template.slice(0,template.length-1)).trimRight().s,(template+pruneStr).length>str.length?new S(str):new S(str.slice(0,template.length)+pruneStr)},toCSV:function(){function hasVal(it){return null!==it&&""!==it}var delim=",",qualifier='"',escape="\\",encloseNumbers=!0,keys=!1,dataArray=[];if("object"==typeof arguments[0]?(delim=arguments[0].delimiter||delim,delim=arguments[0].separator||delim,qualifier=arguments[0].qualifier||qualifier,encloseNumbers=!!arguments[0].encloseNumbers,escape=arguments[0].escape||escape,keys=!!arguments[0].keys):"string"==typeof arguments[0]&&(delim=arguments[0]),"string"==typeof arguments[1]&&(qualifier=arguments[1]),null===arguments[1]&&(qualifier=null),this.orig instanceof Array)dataArray=this.orig;else for(var key in this.orig)this.orig.hasOwnProperty(key)&&(keys?dataArray.push(key):dataArray.push(this.orig[key]));for(var rep=escape+qualifier,buildString=[],i=0;i<dataArray.length;++i){var shouldQualify=hasVal(qualifier);if("number"==typeof dataArray[i]&&(shouldQualify&=encloseNumbers),shouldQualify&&buildString.push(qualifier),null!==dataArray[i]&&void 0!==dataArray[i]){var d=new S(dataArray[i]).replaceAll(qualifier,rep).s;buildString.push(d)}else buildString.push("");shouldQualify&&buildString.push(qualifier),delim&&buildString.push(delim)}return buildString.length=buildString.length-1,new this.constructor(buildString.join(""))},toString:function(){return this.s},underscore:function(){var s=this.trim().s.replace(/([a-z\d])([A-Z]+)/g,"$1_$2").replace(/[-\s]+/g,"_").toLowerCase();return new S(this.s.charAt(0)).isUpper()&&(s="_"+s),new this.constructor(s)},unescapeHTML:function(){return new this.constructor(this.s.replace(/\&([^;]+);/g,function(entity,entityCode){var match;return entityCode in escapeChars?escapeChars[entityCode]:(match=entityCode.match(/^#x([\da-fA-F]+)$/))?String.fromCharCode(parseInt(match[1],16)):(match=entityCode.match(/^#(\d+)$/))?String.fromCharCode(~~match[1]):entity}))},valueOf:function(){return this.s.valueOf()}},methodsAdded=[],nativeProperties=getNativeStringProperties();for(var name in nativeProperties)!function(name){var stringProp=__nsp[name];"function"==typeof stringProp&&(__sp[name]||(__sp[name]="string"===nativeProperties[name]?function(){return new this.constructor(stringProp.apply(this,arguments))}:stringProp))}(name);__sp.repeat=__sp.times,__sp.include=__sp.contains,__sp.toInteger=__sp.toInt,__sp.toBool=__sp.toBoolean,__sp.decodeHTMLEntities=__sp.decodeHtmlEntities,__sp.constructor=S,Export.extendPrototype=extendPrototype,Export.restorePrototype=restorePrototype,Export.VERSION=VERSION,Export.TMPL_OPEN="{{",Export.TMPL_CLOSE="}}",Export.ENTITIES=ENTITIES,"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=Export:"function"==typeof define&&define.amd?define([],function(){return Export}):window.S=Export;var escapeChars={lt:"<",gt:">",quot:'"',apos:"'",amp:"&"},reversedEscapeChars={};for(var key in escapeChars)reversedEscapeChars[escapeChars[key]]=key;ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,"OElig;":338,"oelig;":339,"Scaron;":352,"scaron;":353,"Yuml;":376,"fnof;":402,"circ;":710,"tilde;":732,"Alpha;":913,"Beta;":914,"Gamma;":915,"Delta;":916,"Epsilon;":917,"Zeta;":918,"Eta;":919,"Theta;":920,"Iota;":921,"Kappa;":922,"Lambda;":923,"Mu;":924,"Nu;":925,"Xi;":926,"Omicron;":927,"Pi;":928,"Rho;":929,"Sigma;":931,"Tau;":932,"Upsilon;":933,"Phi;":934,"Chi;":935,"Psi;":936,"Omega;":937,"alpha;":945,"beta;":946,"gamma;":947,"delta;":948,"epsilon;":949,"zeta;":950,"eta;":951,"theta;":952,"iota;":953,"kappa;":954,"lambda;":955,"mu;":956,"nu;":957,"xi;":958,"omicron;":959,"pi;":960,"rho;":961,"sigmaf;":962,"sigma;":963,"tau;":964,"upsilon;":965,"phi;":966,"chi;":967,"psi;":968,"omega;":969,"thetasym;":977,"upsih;":978,"piv;":982,"ensp;":8194,"emsp;":8195,"thinsp;":8201,"zwnj;":8204,"zwj;":8205,"lrm;":8206,"rlm;":8207,"ndash;":8211,"mdash;":8212,"lsquo;":8216,"rsquo;":8217,"sbquo;":8218,"ldquo;":8220,"rdquo;":8221,"bdquo;":8222,"dagger;":8224,"Dagger;":8225,"bull;":8226,"hellip;":8230,"permil;":8240,"prime;":8242,"Prime;":8243,"lsaquo;":8249,"rsaquo;":8250,"oline;":8254,"frasl;":8260,"euro;":8364,"image;":8465,"weierp;":8472,"real;":8476,"trade;":8482,"alefsym;":8501,"larr;":8592,"uarr;":8593,"rarr;":8594,"darr;":8595,"harr;":8596,"crarr;":8629,"lArr;":8656,"uArr;":8657,"rArr;":8658,"dArr;":8659,"hArr;":8660,"forall;":8704,"part;":8706,"exist;":8707,"empty;":8709,"nabla;":8711,"isin;":8712,"notin;":8713,"ni;":8715,"prod;":8719,"sum;":8721,"minus;":8722,"lowast;":8727,"radic;":8730,"prop;":8733,"infin;":8734,"ang;":8736,"and;":8743,"or;":8744,"cap;":8745,"cup;":8746,"int;":8747,"there4;":8756,"sim;":8764,"cong;":8773,"asymp;":8776,"ne;":8800,"equiv;":8801,"le;":8804,"ge;":8805,"sub;":8834,"sup;":8835,"nsub;":8836,"sube;":8838,"supe;":8839,"oplus;":8853,"otimes;":8855,"perp;":8869,"sdot;":8901,"lceil;":8968,"rceil;":8969,"lfloor;":8970,"rfloor;":8971,"lang;":9001,"rang;":9002,"loz;":9674,"spades;":9824,"clubs;":9827,"hearts;":9829,"diams;":9830}}.call(this),function(root,factory){"function"==typeof define&&define.amd?define(factory):"undefined"!=typeof exports?module.exports=factory():root.Autolinker=factory()}(this,function(){var Autolinker=function(cfg){cfg=cfg||{};for(var prop in cfg)cfg.hasOwnProperty(prop)&&(this[prop]=cfg[prop])};return Autolinker.prototype={constructor:Autolinker,newWindow:!0,stripPrefix:!0,twitter:!0,email:!0,urls:!0,className:"",matcherRegex:function(){var twitterRegex=/(^|[^\w])@(\w{1,15})/,emailRegex=/(?:[\-;:&=\+\$,\w\.]+@)/,protocolRegex=/(?:[A-Za-z]{3,9}:(?:\/\/)?)/,wwwRegex=/(?:www\.)/,domainNameRegex=/[A-Za-z0-9\.\-]*[A-Za-z0-9\-]/,tldRegex=/\.(?:international|construction|contractors|enterprises|photography|productions|foundation|immobilien|industries|management|properties|technology|christmas|community|directory|education|equipment|institute|marketing|solutions|vacations|bargains|boutique|builders|catering|cleaning|clothing|computer|democrat|diamonds|graphics|holdings|lighting|partners|plumbing|supplies|training|ventures|academy|careers|company|cruises|domains|exposed|flights|florist|gallery|guitars|holiday|kitchen|neustar|okinawa|recipes|rentals|reviews|shiksha|singles|support|systems|agency|berlin|camera|center|coffee|condos|dating|estate|events|expert|futbol|kaufen|luxury|maison|monash|museum|nagoya|photos|repair|report|social|supply|tattoo|tienda|travel|viajes|villas|vision|voting|voyage|actor|build|cards|cheap|codes|dance|email|glass|house|mango|ninja|parts|photo|shoes|solar|today|tokyo|tools|watch|works|aero|arpa|asia|best|bike|blue|buzz|camp|club|cool|coop|farm|fish|gift|guru|info|jobs|kiwi|kred|land|limo|link|menu|mobi|moda|name|pics|pink|post|qpon|rich|ruhr|sexy|tips|vote|voto|wang|wien|wiki|zone|bar|bid|biz|cab|cat|ceo|com|edu|gov|int|kim|mil|net|onl|org|pro|pub|red|tel|uno|wed|xxx|xyz|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw)\b/,urlSuffixRegex=/(?:[\-A-Za-z0-9+&@#\/%?=~_()|!:,.;]*[\-A-Za-z0-9+&@#\/%=~_()|])?/;return new RegExp(["(",twitterRegex.source,")","|","(",emailRegex.source,domainNameRegex.source,tldRegex.source,")","|","(","(?:","(?:",protocolRegex.source,domainNameRegex.source,")","|","(?:",wwwRegex.source,domainNameRegex.source,")","|","(?:",domainNameRegex.source,tldRegex.source,")",")",urlSuffixRegex.source,")"].join(""),"g")}(),htmlRegex:function(){var tagNameRegex=/[0-9a-zA-Z:]+/,attrNameRegex=/[^\s\0"'>\/=\x01-\x1F\x7F]+/,attrValueRegex=/(?:".*?"|'.*?'|[^'"=<>`\s]+)/;return new RegExp(["<(/)?","("+tagNameRegex.source+")","(?:","\\s+",attrNameRegex.source,"(?:\\s*=\\s*"+attrValueRegex.source+")?",")*","\\s*",">"].join(""),"g")}(),urlPrefixRegex:/^(https?:\/\/)?(www\.)?/,link:function(textOrHtml){return this.processHtml(textOrHtml)},processHtml:function(html){for(var currentResult,inBetweenTagsText,htmlRegex=this.htmlRegex,lastIndex=0,anchorTagStackCount=0,resultHtml=[];null!==(currentResult=htmlRegex.exec(html));){var tagText=currentResult[0],tagName=currentResult[2],isClosingTag=!!currentResult[1];inBetweenTagsText=html.substring(lastIndex,currentResult.index),lastIndex=currentResult.index+tagText.length,"a"===tagName?isClosingTag?(anchorTagStackCount=Math.max(anchorTagStackCount-1,0),0===anchorTagStackCount&&resultHtml.push(inBetweenTagsText)):(anchorTagStackCount++,resultHtml.push(this.processTextNode(inBetweenTagsText))):0===anchorTagStackCount?resultHtml.push(this.processTextNode(inBetweenTagsText)):resultHtml.push(inBetweenTagsText),resultHtml.push(tagText)}if(lastIndex<html.length){var processedTextNode=this.processTextNode(html.substring(lastIndex));resultHtml.push(processedTextNode)}return resultHtml.join("")},processTextNode:function(text){var me=this,matcherRegex=this.matcherRegex,enableTwitter=this.twitter,enableEmailAddresses=this.email,enableUrls=this.urls;return text.replace(matcherRegex,function(matchStr,$1,$2,$3,$4,$5){var twitterMatch=$1,twitterHandlePrefixWhitespaceChar=$2,twitterHandle=$3,emailAddress=$4,urlMatch=$5,prefixStr="",suffixStr="",lastChar=matchStr.charAt(matchStr.length-1);if(")"===lastChar){var openParensMatch=matchStr.match(/\(/g),closeParensMatch=matchStr.match(/\)/g),numOpenParens=openParensMatch&&openParensMatch.length||0,numCloseParens=closeParensMatch&&closeParensMatch.length||0;numCloseParens>numOpenParens&&(matchStr=matchStr.substr(0,matchStr.length-1),suffixStr=")")}var anchorHref=matchStr,anchorText=matchStr;if(twitterMatch&&!enableTwitter||emailAddress&&!enableEmailAddresses||urlMatch&&!enableUrls||urlMatch&&-1===urlMatch.indexOf("."))return prefixStr+anchorText+suffixStr;var linkType="url";twitterMatch?(linkType="twitter",prefixStr=twitterHandlePrefixWhitespaceChar,anchorHref="https://twitter.com/"+twitterHandle,anchorText="@"+twitterHandle):emailAddress?(linkType="email",anchorHref="mailto:"+emailAddress,anchorText=emailAddress):/^[A-Za-z]{3,9}:/i.test(anchorHref)||(anchorHref="http://"+anchorHref);var anchorTag=me.createAnchorTag(linkType,anchorHref,anchorText);return prefixStr+anchorTag+suffixStr})},createAnchorTag:function(linkType,anchorHref,anchorText){var attributesStr=this.createAnchorAttrsStr(linkType,anchorHref);return anchorText=this.processAnchorText(anchorText),"<a "+attributesStr+">"+anchorText+"</a>"},createAnchorAttrsStr:function(linkType,anchorHref){var attrs=['href="'+anchorHref+'"'],cssClass=this.createCssClass(linkType);return cssClass&&attrs.push('class="'+cssClass+'"'),this.newWindow&&attrs.push('target="_blank"'),attrs.join(" ")},createCssClass:function(linkType){var className=this.className;return className?className+" "+className+"-"+linkType:""},processAnchorText:function(anchorText){return this.stripPrefix&&(anchorText=this.stripUrlPrefix(anchorText)),anchorText=this.removeTrailingSlash(anchorText),anchorText=this.doTruncate(anchorText)},stripUrlPrefix:function(text){return text.replace(this.urlPrefixRegex,"")},removeTrailingSlash:function(anchorText){return"/"===anchorText.charAt(anchorText.length-1)&&(anchorText=anchorText.slice(0,-1)),anchorText},doTruncate:function(anchorText){var truncateLen=this.truncate;return truncateLen&&anchorText.length>truncateLen&&(anchorText=anchorText.substring(0,truncateLen-2)+".."),anchorText}},Autolinker.link=function(text,options){var autolinker=new Autolinker(options);return autolinker.link(text)},Autolinker}),function(){angular.module("rails",["ng"])}(),function(){angular.module("rails").factory("RailsInflector",function(){function camelize(key){return angular.isString(key)?key.replace(/_[\w\d]/g,function(match,index,string){return 0===index?match:string.charAt(index+1).toUpperCase()}):key}function underscore(key){return angular.isString(key)?key.replace(/[A-Z]/g,function(match,index){return 0===index?match:"_"+match.toLowerCase()}):key}function pluralize(value){return value+"s"}return{camelize:camelize,underscore:underscore,pluralize:pluralize}})}(),function(undefined){angular.module("rails").factory("RailsResourceInjector",["$injector",function($injector){function getDependency(dependency){return dependency?angular.isString(dependency)?$injector.get(dependency):dependency:undefined}function createService(service){return service?$injector.instantiate(getDependency(service)):undefined}function getService(service){return angular.isObject(service)?service:service?createService(service):undefined}return{createService:createService,getService:getService,getDependency:getDependency}}])}(),function(){angular.module("rails").factory("railsUrlBuilder",["$interpolate",function($interpolate){return function(url){var expression;return angular.isFunction(url)||angular.isUndefined(url)?url:(-1===url.indexOf($interpolate.startSymbol())&&(url=url+"/"+$interpolate.startSymbol()+"id"+$interpolate.endSymbol()),expression=$interpolate(url),function(params){return url=expression(params),"/"===url.charAt(url.length-1)&&(url=url.substr(0,url.length-1)),url})}}])}(),function(undefined){angular.module("rails").provider("railsSerializer",function(){var defaultOptions={underscore:undefined,camelize:undefined,pluralize:undefined,exclusionMatchers:[]};this.underscore=function(fn){return defaultOptions.underscore=fn,this},this.camelize=function(fn){return defaultOptions.camelize=fn,this},this.pluralize=function(fn){return defaultOptions.pluralize=fn,this},this.exclusionMatchers=function(exclusions){return defaultOptions.exclusionMatchers=exclusions,this},this.$get=["$injector","RailsInflector","RailsResourceInjector",function($injector,RailsInflector,RailsResourceInjector){function railsSerializer(options,customizer){function Serializer(){angular.isFunction(options)&&(customizer=options,options={}),this.exclusions={},this.inclusions={},this.serializeMappings={},this.deserializeMappings={},this.customSerializedAttributes={},this.preservedAttributes={},this.customSerializers={},this.nestedResources={},this.options=angular.extend({excludeByDefault:!1},defaultOptions,options||{}),customizer&&customizer.call(this,this)}return Serializer.prototype.exclude=function(){var exclusions=this.exclusions;return angular.forEach(arguments,function(attributeName){exclusions[attributeName]=!1}),this},Serializer.prototype.only=function(){var inclusions=this.inclusions;return this.options.excludeByDefault=!0,angular.forEach(arguments,function(attributeName){inclusions[attributeName]=!0}),this},Serializer.prototype.nestedAttribute=function(){var self=this;return angular.forEach(arguments,function(attributeName){self.rename(attributeName,attributeName+"_attributes")}),this},Serializer.prototype.resource=function(attributeName,resource,serializer){return this.nestedResources[attributeName]=resource,serializer&&this.serializeWith(attributeName,serializer),this},Serializer.prototype.rename=function(javascriptName,jsonName,bidirectional){return this.serializeMappings[javascriptName]=jsonName,(bidirectional||bidirectional===undefined)&&(this.deserializeMappings[jsonName]=javascriptName),this},Serializer.prototype.add=function(attributeName,value){return this.customSerializedAttributes[attributeName]=value,this},Serializer.prototype.preserve=function(attributeName){return this.preservedAttributes[attributeName]=!0,this},Serializer.prototype.serializeWith=function(attributeName,serializer){return this.customSerializers[attributeName]=serializer,this},Serializer.prototype.isExcludedFromSerialization=function(attributeName){if(this.options.excludeByDefault&&!this.inclusions.hasOwnProperty(attributeName)||this.exclusions.hasOwnProperty(attributeName))return!0;if(this.options.exclusionMatchers){var excluded=!1;return angular.forEach(this.options.exclusionMatchers,function(matcher){angular.isString(matcher)?excluded=excluded||0===attributeName.indexOf(matcher):angular.isFunction(matcher)?excluded=excluded||matcher.call(undefined,attributeName):matcher instanceof RegExp&&(excluded=excluded||matcher.test(attributeName))}),excluded}return!1},Serializer.prototype.getSerializedAttributeName=function(attributeName){var mappedName=this.serializeMappings[attributeName]||attributeName,mappedNameExcluded=this.isExcludedFromSerialization(mappedName),attributeNameExcluded=this.isExcludedFromSerialization(attributeName);if(this.options.excludeByDefault){if(mappedNameExcluded&&attributeNameExcluded)return undefined}else if(mappedNameExcluded||attributeNameExcluded)return undefined;return this.underscore(mappedName)},Serializer.prototype.isExcludedFromDeserialization=function(){return!1},Serializer.prototype.getDeserializedAttributeName=function(attributeName){var camelizedName=this.camelize(attributeName);return camelizedName=this.deserializeMappings[attributeName]||this.deserializeMappings[camelizedName]||camelizedName,this.isExcludedFromDeserialization(attributeName)||this.isExcludedFromDeserialization(camelizedName)?undefined:camelizedName},Serializer.prototype.getNestedResource=function(attributeName){return RailsResourceInjector.getDependency(this.nestedResources[attributeName])},Serializer.prototype.getAttributeSerializer=function(attributeName){var resource=this.getNestedResource(attributeName),serializer=this.customSerializers[attributeName];return serializer?RailsResourceInjector.createService(serializer):resource?resource.config.serializer:undefined},Serializer.prototype.serializeValue=function(data){var result=data,self=this;if(angular.isArray(data))result=[],angular.forEach(data,function(value){result.push(self.serializeValue(value))});else if(angular.isObject(data)){if(angular.isDate(data))return data;result={},angular.forEach(data,function(value,key){angular.isFunction(value)||self.serializeAttribute(result,key,value)})}return result},Serializer.prototype.serializeAttribute=function(data,attribute,value){var serializer=this.getAttributeSerializer(attribute),serializedAttributeName=this.getSerializedAttributeName(attribute);serializedAttributeName!==undefined&&(data[serializedAttributeName]=serializer?serializer.serialize(value):this.serializeValue(value))},Serializer.prototype.serialize=function(data){var result=this.serializeValue(data),self=this;return angular.isObject(result)&&angular.forEach(this.customSerializedAttributes,function(value,key){angular.isFunction(value)&&(value=value.call(data,data)),self.serializeAttribute(result,key,value)}),result},Serializer.prototype.deserializeValue=function(data,Resource){var result=data,self=this;if(angular.isArray(data))result=[],angular.forEach(data,function(value){result.push(self.deserializeValue(value,Resource))});else if(angular.isObject(data)){if(angular.isDate(data))return data;result={},Resource&&(result=new Resource.config.resourceConstructor),angular.forEach(data,function(value,key){self.deserializeAttribute(result,key,value)})}return result},Serializer.prototype.deserializeAttribute=function(data,attribute,value){var serializer,NestedResource,attributeName=this.getDeserializedAttributeName(attribute);attributeName!==undefined&&(serializer=this.getAttributeSerializer(attributeName),NestedResource=this.getNestedResource(attributeName),data[attributeName]=this.preservedAttributes[attributeName]?value:serializer?serializer.deserialize(value,NestedResource):this.deserializeValue(value,NestedResource))},Serializer.prototype.deserialize=function(data,Resource){return this.deserializeValue(data,Resource)},Serializer.prototype.pluralize=function(value){return this.options.pluralize?this.options.pluralize(value):value},Serializer.prototype.underscore=function(value){return this.options.underscore?this.options.underscore(value):value},Serializer.prototype.camelize=function(value){return this.options.camelize?this.options.camelize(value):value},Serializer}return defaultOptions.underscore=defaultOptions.underscore||RailsInflector.underscore,defaultOptions.camelize=defaultOptions.camelize||RailsInflector.camelize,defaultOptions.pluralize=defaultOptions.pluralize||RailsInflector.pluralize,railsSerializer.defaultOptions=defaultOptions,railsSerializer}]})}(),function(undefined){angular.module("rails").factory("railsRootWrapper",function(){return{wrap:function(data,resource){var result={};return result[angular.isArray(data)?resource.config.pluralName:resource.config.name]=data,result},unwrap:function(response,resource){return response.data&&response.data.hasOwnProperty(resource.config.name)?response.data=response.data[resource.config.name]:response.data&&response.data.hasOwnProperty(resource.config.pluralName)&&(response.data=response.data[resource.config.pluralName]),response}}}),angular.module("rails").provider("RailsResource",function(){var defaultOptions={rootWrapping:!0,updateMethod:"put",httpConfig:{},defaultParams:undefined,underscoreParams:!0,fullResponse:!1,extensions:[]};this.rootWrapping=function(value){return defaultOptions.rootWrapping=value,this},this.updateMethod=function(value){return defaultOptions.updateMethod=value,this},this.httpConfig=function(value){return defaultOptions.httpConfig=value,this},this.defaultParams=function(value){return defaultOptions.defaultParams=value,this},this.underscoreParams=function(value){return defaultOptions.underscoreParams=value,this},this.fullResponse=function(value){return defaultOptions.fullResponse=value,this},this.extensions=function(){return defaultOptions.extensions=[],angular.forEach(arguments,function(value){defaultOptions.extensions=defaultOptions.extensions.concat(value)}),this},this.$get=["$http","$q","railsUrlBuilder","railsSerializer","railsRootWrapper","RailsResourceInjector",function($http,$q,railsUrlBuilder,railsSerializer,railsRootWrapper,RailsResourceInjector){function RailsResource(value){if(value){var response=this.constructor.deserialize({data:value});
this.constructor.config.rootWrapping&&(response=railsRootWrapper.unwrap(response,this.constructor)),angular.extend(this,response.data)}}function appendPath(url,path){return path&&("/"!==path[0]&&(url+="/"),url+=path),url}function forEachDependency(list,callback){for(var dependency,i=0,len=list.length;len>i;i++)dependency=list[i],angular.isString(dependency)&&(dependency=list[i]=RailsResourceInjector.getDependency(dependency)),callback(dependency)}function addMixin(Resource,destination,mixin,callback){var excludedKeys=["included","extended,","configure"];Resource.$mixins||(Resource.$mixins=[]),angular.isString(mixin)&&(mixin=RailsResourceInjector.getDependency(mixin)),mixin&&-1===Resource.$mixins.indexOf(mixin)&&(angular.forEach(mixin,function(value,key){-1===excludedKeys.indexOf(key)&&(destination[key]=value)}),Resource.$mixins.push(mixin),angular.isFunction(callback)&&callback(Resource,mixin))}function loadExtensions(extensions){var modules=[];return angular.forEach(extensions,function(extensionName){extensionName="RailsResource"+extensionName.charAt(0).toUpperCase()+extensionName.slice(1)+"Mixin",modules.push(RailsResourceInjector.getDependency(extensionName))}),modules}function booleanParam(value,defaultValue){return angular.isUndefined(value)?defaultValue:value}function createInterceptorSuccessCallback(thenFn,resourceConstructor,context){return function(data){return(thenFn||angular.identity)(data,resourceConstructor,context)}}function createInterceptorRejectionCallback(rejectFn,resourceConstructor,context){return function(rejection){return rejectFn?rejectFn(rejection,resourceConstructor,context):$q.reject(rejection)}}return RailsResource.extendTo=function(child){function ctor(){this.constructor=child}return angular.forEach(this,function(value,key){child[key]=value}),angular.isArray(this.$modules)&&(child.$modules=this.$modules.slice(0)),ctor.prototype=this.prototype,child.prototype=new ctor,child.__super__=this.prototype,child},RailsResource.extend=function(){return angular.forEach(arguments,function(mixin){addMixin(this,this,mixin,function(Resource,mixin){angular.isFunction(mixin.extended)&&mixin.extended(Resource)})},this),this},RailsResource.include=function(){return angular.forEach(arguments,function(mixin){addMixin(this,this.prototype,mixin,function(Resource,mixin){angular.isFunction(mixin.included)&&mixin.included(Resource)})},this),this},RailsResource.configure=function(cfg){cfg=cfg||{},this.config&&(cfg=angular.extend({},this.config,cfg)),this.config={},this.config.url=cfg.url,this.config.rootWrapping=booleanParam(cfg.rootWrapping,defaultOptions.rootWrapping),this.config.httpConfig=cfg.httpConfig||defaultOptions.httpConfig,this.config.httpConfig.headers=angular.extend({Accept:"application/json","Content-Type":"application/json"},this.config.httpConfig.headers||{}),this.config.defaultParams=cfg.defaultParams||defaultOptions.defaultParams,this.config.underscoreParams=booleanParam(cfg.underscoreParams,defaultOptions.underscoreParams),this.config.updateMethod=(cfg.updateMethod||defaultOptions.updateMethod).toLowerCase(),this.config.fullResponse=booleanParam(cfg.fullResponse,defaultOptions.fullResponse),this.config.requestTransformers=cfg.requestTransformers?cfg.requestTransformers.slice(0):[],this.config.responseInterceptors=cfg.responseInterceptors?cfg.responseInterceptors.slice(0):[],this.config.afterResponseInterceptors=cfg.afterResponseInterceptors?cfg.afterResponseInterceptors.slice(0):[],this.config.interceptors=cfg.interceptors?cfg.interceptors.slice(0):[],this.config.serializer=RailsResourceInjector.getService(cfg.serializer||railsSerializer()),this.config.name=this.config.serializer.underscore(cfg.name),this.config.name&&(this.config.pluralName=this.config.serializer.underscore(cfg.pluralName||this.config.serializer.pluralize(this.config.name))),this.config.urlBuilder=railsUrlBuilder(this.config.url),this.config.resourceConstructor=this,this.extend.apply(this,loadExtensions((cfg.extensions||[]).concat(defaultOptions.extensions))),angular.forEach(this.$mixins,function(mixin){angular.isFunction(mixin.configure)&&mixin.configure(this.config,cfg)},this)},RailsResource.setUrl=function(url){this.configure({url:url})},RailsResource.buildUrl=function(context){return this.config.urlBuilder(context)},RailsResource.addInterceptor=function(interceptor){this.config.interceptors.push(interceptor)},RailsResource.intercept=function(phase,fn){var interceptor={};fn=RailsResourceInjector.getDependency(fn),interceptor[phase]=function(value,resourceConstructor,context){return fn(value,resourceConstructor,context)||value},this.addInterceptor(interceptor)},RailsResource.interceptBeforeRequest=function(fn){this.intercept("beforeRequest",fn)},RailsResource.interceptBeforeRequestWrapping=function(fn){this.intercept("beforeRequestWrapping",fn)},RailsResource.interceptRequest=function(fn){this.intercept("request",fn)},RailsResource.interceptBeforeResponse=function(fn){this.intercept("beforeResponse",fn)},RailsResource.interceptBeforeResponseDeserialize=function(fn){this.intercept("beforeResponseDeserialize",fn)},RailsResource.interceptResponse=function(fn){this.intercept("response",fn)},RailsResource.interceptAfterResponse=function(fn){this.intercept("afterResponse",fn)},RailsResource.beforeResponse=function(fn){fn=RailsResourceInjector.getDependency(fn),this.interceptResponse(function(response,resource,context){return fn(response.data,resource.config.resourceConstructor,context),response})},RailsResource.afterResponse=function(fn){fn=RailsResourceInjector.getDependency(fn),this.interceptAfterResponse(function(response,resource,context){return fn(response,resource.config.resourceConstructor,context),response})},RailsResource.beforeRequest=function(fn){fn=RailsResourceInjector.getDependency(fn),this.interceptBeforeRequestWrapping(function(httpConfig,resource){return httpConfig.data=fn(httpConfig.data,resource.config.resourceConstructor)||httpConfig.data,httpConfig})},RailsResource.serialize=function(httpConfig){return httpConfig.data&&(httpConfig.data=this.config.serializer.serialize(httpConfig.data)),httpConfig},RailsResource.deserialize=function(response){return response.data=this.config.serializer.deserialize(response.data,this.config.resourceConstructor),response},RailsResource.callResponseInterceptors=function(promise,context){var config=this.config;return forEachDependency(config.responseInterceptors,function(interceptor){promise.resource=config.resourceConstructor,promise.context=context,promise=interceptor(promise)}),promise},RailsResource.callAfterResponseInterceptors=function(promise){var config=this.config;return forEachDependency(config.afterResponseInterceptors,function(interceptor){promise.resource=config.resourceConstructor,promise=interceptor(promise)}),promise},RailsResource.runInterceptorPhase=function(phase,context,promise){var config=this.config,chain=[];for(forEachDependency(config.interceptors,function(interceptor){(interceptor[phase]||interceptor[phase+"Error"])&&chain.push(interceptor[phase],interceptor[phase+"Error"])});chain.length;){var thenFn=chain.shift(),rejectFn=chain.shift();promise=promise.then(createInterceptorSuccessCallback(thenFn,config.resourceConstructor,context),createInterceptorRejectionCallback(rejectFn,config.resourceConstructor,context))}return promise},RailsResource.$http=function(httpConfig,context,resourceConfigOverrides){var config=angular.extend(angular.copy(this.config),resourceConfigOverrides||{}),resourceConstructor=config.resourceConstructor,promise=$q.when(httpConfig);return promise=this.runInterceptorPhase("beforeRequest",context,promise).then(function(httpConfig){return httpConfig=resourceConstructor.serialize(httpConfig),forEachDependency(config.requestTransformers,function(transformer){httpConfig.data=transformer(httpConfig.data,config.resourceConstructor)}),httpConfig}),promise=this.runInterceptorPhase("beforeRequestWrapping",context,promise),config.rootWrapping&&(promise=promise.then(function(httpConfig){return httpConfig.data=railsRootWrapper.wrap(httpConfig.data,config.resourceConstructor),httpConfig})),promise=this.runInterceptorPhase("request",context,promise).then(function(httpConfig){return $http(httpConfig)}),promise=this.runInterceptorPhase("beforeResponse",context,promise),promise=this.runInterceptorPhase("beforeResponse",context,promise).then(function(response){return response.originalData=response.data,response}),config.rootWrapping&&(promise=promise.then(function(response){return railsRootWrapper.unwrap(response,config.resourceConstructor)})),promise=this.runInterceptorPhase("beforeResponseDeserialize",context,promise).then(function(response){return resourceConstructor.deserialize(response)}),promise=this.callResponseInterceptors(promise,context),promise=this.runInterceptorPhase("response",context,promise).then(function(response){return context&&response.hasOwnProperty("data")&&angular.isObject(response.data)&&angular.extend(context,response.data),config.fullResponse?response:context||response.data}),promise=this.callAfterResponseInterceptors(promise,context),promise=this.runInterceptorPhase("afterResponse",context,promise),promise.resource=config.resourceConstructor,promise.context=context,promise},RailsResource.processParameters=function(queryParams){var newParams={};return angular.isObject(queryParams)&&this.config.underscoreParams?(angular.forEach(queryParams,function(v,k){newParams[this.config.serializer.underscore(k)]=v},this),newParams):queryParams},RailsResource.getParameters=function(queryParams){var params;return this.config.defaultParams&&(params=angular.copy(this.config.defaultParams)),angular.isObject(queryParams)&&(params=angular.extend(params||{},queryParams)),this.processParameters(params)},RailsResource.getHttpConfig=function(queryParams){var params=this.getParameters(queryParams);return params?angular.extend({params:params},this.config.httpConfig):angular.copy(this.config.httpConfig)},RailsResource.$url=RailsResource.resourceUrl=function(context,path){return angular.isObject(context)||(context={id:context}),appendPath(this.buildUrl(context||{}),path)},RailsResource.$get=function(url,queryParams){return this.$http(angular.extend({method:"get",url:url},this.getHttpConfig(queryParams)))},RailsResource.query=function(queryParams,context){return this.$get(this.resourceUrl(context),queryParams)},RailsResource.get=function(context,queryParams){return this.$get(this.resourceUrl(context),queryParams)},RailsResource.prototype.$url=function(path){return appendPath(this.constructor.resourceUrl(this),path)},RailsResource.prototype.$http=function(httpConfig){return this.constructor.$http(httpConfig,this,resourceConfigOvverides)},angular.forEach(["post","put","patch"],function(method){RailsResource["$"+method]=function(url,data){return data=angular.copy(data),this.$http(angular.extend({method:method,url:url,data:data},this.getHttpConfig()))},RailsResource.prototype["$"+method]=function(url){var data=angular.copy(this,{});return this.constructor.$http(angular.extend({method:method,url:url,data:data},this.constructor.getHttpConfig()),this)}}),RailsResource.prototype.create=function(){return this.$post(this.$url(),this)},RailsResource.prototype.update=function(){return this["$"+this.constructor.config.updateMethod](this.$url(),this)},RailsResource.prototype.isNew=function(){return angular.isUndefined(this.id)||null===this.id},RailsResource.prototype.save=function(){return this.isNew()?this.create():this.update()},RailsResource.$delete=function(url,queryParams){return this.$http(angular.extend({method:"delete",url:url},this.getHttpConfig(queryParams)))},RailsResource.prototype.$delete=function(url,queryParams){return this.constructor.$http(angular.extend({method:"delete",url:url},this.constructor.getHttpConfig(queryParams)),this)},RailsResource.prototype.remove=RailsResource.prototype["delete"]=function(){return this.$delete(this.$url())},RailsResource}]}),angular.module("rails").factory("railsResourceFactory",["RailsResource",function(RailsResource){return function(config){function Resource(){Resource.__super__.constructor.apply(this,arguments)}return RailsResource.extendTo(Resource),Resource.configure(config),Resource}}])}(),CodeMirror.defineMode("dart",function(config){function words(str){for(var obj={},words=str.split(" "),i=0;i<words.length;++i)obj[words[i]]=!0;return obj}function tokenBase(stream,state){var ch=stream.next();if('"'==ch||"'"==ch)return startString(ch,stream,state);if(/[\[\]{}\(\),;\:\.]/.test(ch))return curPunc=ch,null;if(/\d/.test(ch))return stream.eatWhile(/[\w\.]/),stream.eat(/eE/)&&(stream.eat(/\+\-/),stream.eatWhile(/\d/)),"number";if("/"==ch){if(stream.eat("*"))return state.tokenize.push(tokenComment),tokenComment(stream,state);if(stream.eat("/"))return stream.skipToEnd(),"comment";if(expectExpression(state.lastToken))return startString(ch,stream,state)}if("="==ch&&stream.eat(">"))return curPunc="=>",null;if(/=/.test(ch))return stream.eatWhile(/\s/),stream.eat(/\{/)?(curPunc="map",state.tokenize.push(tokenMap()),null):"operator";if(/[+\-*&%<>!?|\/~]/.test(ch))return stream.eatWhile(/[+\-*&%<>|~]/),"operator";if(stream.eatWhile(/[\w\$_]/),"@"==ch)return stream.eatWhile(/[\w\$_\.]/),"meta";if("."==state.lastToken)return"property";if(stream.eat(":"))return curPunc="proplabel","property";var cur=stream.current();return atoms.propertyIsEnumerable(cur)?"atom":keywords.propertyIsEnumerable(cur)?(blockKeywords.propertyIsEnumerable(cur)&&(curPunc="newstatement"),"keyword"):builtin.propertyIsEnumerable(cur)?(blockKeywords.propertyIsEnumerable(cur)&&(curPunc="newstatement"),"builtin"):"variable"}function startString(quote,stream,state){function t(stream,state){for(var next,escaped=!1,end=!tripleQuoted;null!=(next=stream.next());){if(next==quote&&!escaped){if(!tripleQuoted)break;if(stream.match(quote+quote)){end=!0;break}}if("$"===next&&!escaped)return state.tokenize.push(tokenInterpolatedString(quote)),"string-2";if("$"===stream.peek()&&"\\"!=next)return state.tokenize.push(tokenInterpolatedString(quote)),"string";escaped=!escaped&&"\\"==next}return end&&state.tokenize.pop(),"string"}var tripleQuoted=!1;if("/"!=quote&&stream.eat(quote)){if(!stream.eat(quote))return"string";tripleQuoted=!0}return state.tokenize.push(t),"string"}function tokenInterpolatedString(quote){return function(stream,state){var next=stream.next(),peek=stream.peek();return"\\"!=next&&peek===quote||/\s/.test(peek)?state.tokenize.pop():/\}/.test(next)&&state.tokenize.pop(),/\{/.test(next)&&state.tokenize.push(tokenBaseUntilBrace()),"string-2"}}function tokenBaseUntilBrace(){function t(stream,state){if("}"==stream.peek()){if(depth--,0==depth)return state.tokenize.pop(),state.tokenize[state.tokenize.length-1](stream,state)}else"{"==stream.peek()&&depth++;return tokenBase(stream,state)}var depth=1;return t.isBase=!0,t}function tokenBaseUntilCommaOrBrace(){function t(stream,state){if(/[\}\,]/.test(stream.peek())){if(depth--,0==depth)return state.tokenize.pop(),state.tokenize[state.tokenize.length-1](stream,state)}else"{"==stream.peek()&&depth++;return tokenBase(stream,state)}var depth=1;return t.isBase=!0,t}function tokenMap(){function t(stream,state){var next=stream.next();return"}"==next?(state.tokenize.pop(),null):/['"]/.test(next)?startString(next,stream,state):/\d/.test(next)?"number":/:/.test(next)?(state.tokenize.push(tokenBaseUntilCommaOrBrace()),null):null}return t.isBase=!0,t}function tokenComment(stream,state){for(var ch,maybeEnd=!1;ch=stream.next();){if("/"==ch&&maybeEnd){state.tokenize.pop();break}maybeEnd="*"==ch}return"comment"}function expectExpression(last){return!last||"operator"==last||"->"==last||/[\.\[\{\(,;:]/.test(last)||"newstatement"==last||"keyword"==last||"proplabel"==last||"variable"==last}function Context(indented,column,type,align,prev){this.indented=indented,this.column=column,this.type=type,this.align=align,this.prev=prev}function pushContext(state,col,type){return state.context=new Context(state.indented,col,type,null,state.context)}function popContext(state){var t=state.context.type;return(")"==t||"]"==t||"}"==t)&&(state.indented=state.context.indented),state.context=state.context.prev}var curPunc,keywords=words("abstract as assert break case catch char class const continue def default do else enum extends final finally float for goto if implements import in instanceof interface long native new package private protected public return short static strictfp super switch synchronized threadsafe throw throws transient try typedef var void volatile while with"),blockKeywords=words("catch class do else enum finally for if switch try typedef while with"),atoms=words("null true false this"),builtin=words("deprecated override proxy identical identityHashCode print BidirectionalIterator Comparable DateTime Deprecated Duration Expando Function Invocation Iterable Iterator List Map Match Null Object Pattern RegExp RuneIterator Runes Set StackTrace Stopwatch String StringBuffer StringSink Symbol Type Uri bool double int num Comparator AbstractClassInstantiationError ArgumentError AssertionError CastError ConcurrentModificationError CyclicInitializationError Error Exception FallThroughError FormatException IntegerDivisionByZeroException NoSuchMethodError NullThrownError OutOfMemoryError RangeError StackOverflowError StateError TypeError UnimplementedError UnsupportedError");return tokenBase.isBase=!0,{startState:function(basecolumn){return{tokenize:[tokenBase],context:new Context((basecolumn||0)-config.indentUnit,0,"top",!1),indented:0,startOfLine:!0,lastToken:null}},token:function(stream,state){var ctx=state.context;if(stream.sol()&&(null==ctx.align&&(ctx.align=!1),state.indented=stream.indentation(),state.startOfLine=!0,"statement"!=ctx.type||expectExpression(state.lastToken)||(popContext(state),ctx=state.context)),stream.eatSpace())return null;curPunc=null;var style=state.tokenize[state.tokenize.length-1](stream,state);if("comment"==style)return style;if(null==ctx.align&&(ctx.align=!0),";"!=curPunc&&":"!=curPunc||-1==["statement","map"].indexOf(ctx.type))if("{"==curPunc)pushContext(state,stream.column(),"}");else if("["==curPunc)pushContext(state,stream.column(),"]");else if("("==curPunc)pushContext(state,stream.column(),")");else if("map"==curPunc)pushContext(state,stream.column(),"map"),state.context.align=!1;else if("}"==curPunc){for(;"statement"==ctx.type;)ctx=popContext(state);for("map"==ctx.type&&(popContext(state),ctx=popContext(state)),"}"==ctx.type&&(ctx=popContext(state));"statement"==ctx.type;)ctx=popContext(state)}else curPunc==ctx.type?popContext(state):("}"==ctx.type||"top"==ctx.type||"statement"==ctx.type&&"newstatement"==curPunc)&&pushContext(state,stream.column(),"statement");else popContext(state);return state.startOfLine=!1,state.lastToken=curPunc||style,style},indent:function(state,textAfter){if(!state.tokenize[state.tokenize.length-1].isBase)return 0;var firstChar=textAfter&&textAfter.charAt(0),ctx=state.context;"statement"!=ctx.type||expectExpression(state.lastToken)||(ctx=ctx.prev);var closing=firstChar==ctx.type;return"statement"==ctx.type?ctx.indented+("{"==firstChar?0:config.indentUnit):"map"==ctx.type&&"}"==firstChar?ctx.indented:ctx.align?ctx.column+(closing?0:1):ctx.indented+(closing?0:config.indentUnit)},electricChars:"{}",blockCommentStart:"/*",blockCommentEnd:"*/",lineComment:"//",fold:"brace"}}),CodeMirror.defineMIME("text/dart","dart"),CodeMirror.defineMIME("application/dart","dart"),function(){angular.module("campusFilters",[])}.call(this),function(){angular.module("campusFilters").filter("validIndexNodes",function(){return function(nodes,options){var selectedNodes;return options||(options={}),selectedNodes=_.select(nodes,function(node){var isNotExcluded;return isNotExcluded=!_.include(options.exclude,node.node_label)})}})}.call(this),function(){angular.module("campusServices",[])}.call(this),function(){angular.module("campusServices").factory("FlashMessage",["$rootScope",function(){return{flashOpen:void 0,isShow:function(cb){return this.isShowCb=cb},show:function(options){return this.isShowCb(options)},isClear:function(cb){return this.isClearCb=cb},clear:function(){return this.isClearCb()}}}])}.call(this),function(){angular.module("campusServices").factory("NodeTreeTraverser",function(){var NodeTreeTraverser;return NodeTreeTraverser=function(){function NodeTreeTraverser(){}return NodeTreeTraverser.prototype.getNearestParentNodeType=function(courseIndex,startingNode,nodeType){var foundNode,foundNodeWithType,recursiveNodeSearch;return foundNode=!1,foundNodeWithType=!1,startingNode.node_label===nodeType?startingNode:(recursiveNodeSearch=function(node){return node.node_label!==nodeType||foundNode?node.attributes._uid!==startingNode.attributes._uid||foundNode||(foundNode=node):foundNodeWithType=node,foundNode&&foundNodeWithType?void 0:_.each(node.nodes,function(node){return recursiveNodeSearch(node)})},recursiveNodeSearch(courseIndex),foundNodeWithType)},NodeTreeTraverser.prototype.getNodeAndParent=function(queryString,startingNode){var foundNode,previousNode,recursiveNodeSearch;return foundNode=!1,previousNode=!1,recursiveNodeSearch=function(node){var _ref;if(!foundNode)return node.query_string===queryString?foundNode=node:(null!=(_ref=node.nodes)?_ref.length:void 0)>0&&(previousNode=node,_.each(node.nodes,function(n){return n.query_string===queryString?foundNode=n:void 0}),!foundNode)?_.each(node.nodes,function(n){return recursiveNodeSearch(n)}):void 0},recursiveNodeSearch(startingNode),{foundNode:foundNode,parentNode:previousNode}},NodeTreeTraverser.prototype.nodeIndexInTopLevelContainer=function(queryString,courseIndex){var containerIndex,foundContainerIndex,foundIndex,nodeFound,nodeIndex,recursiveNodeSearch,topContainerNode,totalCurrentContainerNodes;return containerIndex=0,nodeIndex=0,nodeFound=!1,topContainerNode=null,foundIndex=null,foundContainerIndex=null,totalCurrentContainerNodes=null,recursiveNodeSearch=function(node){return"page"===node.node_type&&(nodeIndex+=1),node.query_string!==queryString||nodeFound||(nodeFound=!0,foundIndex=nodeIndex,foundContainerIndex=containerIndex),node.nodes&&node.nodes.length>0?_.each(node.nodes,function(n){return recursiveNodeSearch(n)}):void 0},_.each(courseIndex.nodes,function(node){return"user"!==node.node_label&&"container"===node.node_type?(containerIndex+=1,node.query_string===queryString&&(nodeFound=!0,foundIndex=nodeIndex,foundContainerIndex=containerIndex),nodeFound||(topContainerNode=node),nodeFound&&topContainerNode&&node!==topContainerNode&&!totalCurrentContainerNodes&&(totalCurrentContainerNodes=nodeIndex),nodeIndex=0,_.each(node.nodes,function(n){return recursiveNodeSearch(n)})):void 0}),{containerIndex:foundContainerIndex,nodeIndex:foundIndex,topLevelContainerNode:topContainerNode,totalCurrentContainerNodes:totalCurrentContainerNodes}},NodeTreeTraverser}()})}.call(this),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}};angular.module("campusServices").factory("AttemptData",["Logger","$timeout","CampusApi","$q",function(Logger,$timeout,CampusApi,$q){var AttemptData,retryDelay;return retryDelay=2e3,AttemptData=function(){function AttemptData(courseIdentifier,queryString){this.generateAttempt=__bind(this.generateAttempt,this),this.recordAttempt=__bind(this.recordAttempt,this),this.courseIdentifier=courseIdentifier,this.queryString=queryString}return AttemptData.prototype.recordAttempt=function(report,contentArray){var deferred,params;return deferred=$q.defer(),params=this.generateAttempt(report,contentArray),new CampusApi(params.course_identifier).post({data:params}).success(function(){return function(){return deferred.resolve(!0),Logger.info("Attempt recorded successfully")}}(this)).error(function(){return function(){return $timeout(function(){return this.recordAttempt(report,contentArray)},retryDelay),Logger.error("Attempt failed to be recorded")}}(this)),deferred.promise},AttemptData.prototype.generateAttempt=function(report,contentArray){return{query_string:this.queryString,course_identifier:this.courseIdentifier,service:"attempts",service_method:"post_create_attempt",service_args:JSON.stringify([contentArray,{failures:report.success()?[]:[report.message()]}])}},AttemptData}()}])}.call(this),function(){angular.module("campusServices").factory("Autolinker",function(){return{link:function(text){return Autolinker.link(text)}}})}.call(this),function(){angular.module("campusServices").factory("CacheKey",["LocalStorageCache",function(LocalStorageCache){var CacheKey;return CacheKey=function(){function CacheKey(){this.cache=new LocalStorageCache("cacheKey")}return CacheKey.prototype.cache=null,CacheKey.prototype.cacheKeyNamespace="key",CacheKey.prototype.setCacheKey=function(courseIdentifier,cacheKey){return this.cache.cachePuts(courseIdentifier,this.cacheKeyNamespace,cacheKey)},CacheKey.prototype.getCacheKey=function(courseIdentifier){return this.cache.cacheGet(courseIdentifier,this.cacheKeyNamespace)},CacheKey.prototype.validateCacheKey=function(courseIdentifier,cacheKey){var currentKey;return currentKey=this.getCacheKey(courseIdentifier),cacheKey!==currentKey?(this.cache.clearCourse(courseIdentifier),this.setCacheKey(courseIdentifier,cacheKey)):void 0},CacheKey}()}])}.call(this),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}};angular.module("campusServices").factory("CampusApi",["$http","$state",function($http,$state){var CampusApi;return CampusApi=function(){function CampusApi(courseIdentifier){this.filterErrors=__bind(this.filterErrors,this),this.http=__bind(this.http,this),this.post=__bind(this.post,this),this.get=__bind(this.get,this),this.courseIdentifier=courseIdentifier}return CampusApi.prototype.get=function(options){return options.method="GET",this.http(options)},CampusApi.prototype.post=function(options){return options.method="POST",this.http(options)},CampusApi.prototype.http=function(options){var promise;return options.url="/courses/content/"+this.courseIdentifier,promise=$http(options),this.filterErrors(promise),promise},CampusApi.prototype.filterErrors=function(promise){return promise.error(function(data){return data.match(/^UserAccessError/)?$state.go("root.courseContent",{courseIdentifier:this.courseIdentifier,queryString:"subscribe"},{reload:!0}):(console.log("Api call has result in an error:"),console.log(data))})},CampusApi}()}])}.call(this),function(){angular.module("campusServices").factory("CampusUrl",["$rootScope","CurrentCourseConfig","RailsAssets","CacheKey",function($rootScope,CurrentCourseConfig,RailsAssets,CacheKey){var cacheKeyService,configData;return cacheKeyService=new CacheKey,configData=null,new CurrentCourseConfig($rootScope.courseIdentifier).data().then(function(data){return configData=data}),{currentUrl:function(){return""+this.protocol()+"//"+this.host()+"/courses/"+this.courseIdentifier()+"/"+$rootScope.queryString},badgeUrl:function(badgeName){return""+this.assetHost()+"/"+this.courseIdentifier()+"/achievements/badges/"+this.fingerPrintFile(badgeName)},appImageUrl:function(imageName){return""+this.assetHost()+"/assets/"+RailsAssets.path(imageName)},imageUrl:function(imageName){return""+this.assetHost()+"/"+this.courseIdentifier()+"/assets/images/"+this.fingerPrintFile(imageName)},courseAssetUrl:function(assetName){return""+this.assetHost()+"/"+this.courseIdentifier()+"/assets/"+this.fingerPrintFile(assetName)},baseCourseAssetUrl:function(assetName){return""+this.assetHost()+"/"+this.courseIdentifier()+"/assets/"+assetName},javascriptUrl:function(fileName){return""+this.assetHost()+"/"+this.courseIdentifier()+"/assets/javascripts/"+this.fingerPrintFile(fileName)},appAssetUrl:function(assetName){return""+this.assetHost()+"/assets/"+RailsAssets.path(assetName)},subtitleUrl:function(fileName){return""+this.assetHost()+"/"+this.courseIdentifier()+"/assets/subtitles/"+this.fingerPrintFile(fileName)},pdfUrl:function(pdfName){var assetHost;return assetHost=""+this.protocol()+"//"+this.host(),""+assetHost+"/"+this.courseIdentifier()+"/assets/pdf/"+this.fingerPrintFile(pdfName)},pdfExternalUrl:function(pdfName){return""+this.protocol()+"//"+pdfName},authUrl:function(){return""+this.protocol()+"//"+this.host()+"/auth/"+configData.authentication_provider},iframeUrl:function(){return configData.iframe_url||""+this.protocol()+"//d1ffx7ull4987f.cloudfront.net/sandbox/iframe.html"},host:function(){return window.location.host},protocol:function(){return window.location.protocol},courseIdentifier:function(){return $rootScope.courseIdentifier.replace(/-/g,"_")},cacheKey:function(){return cacheKeyService.getCacheKey($rootScope.courseIdentifier)},fingerPrintFile:function(fileName){var extension,strArray;return strArray=fileName.split("."),extension=strArray.pop(),""+strArray.join(".")+"-"+this.cacheKey()+"."+extension},assetHost:function(){var railsAssetHost;return railsAssetHost="dhg7upb7j7jqa.cloudfront.net",railsAssetHost?""+this.protocol()+"//"+railsAssetHost:""+this.protocol()+"//"+this.host()}}}])}.call(this),function(){angular.module("campusServices").factory("CampusUtil",function(){return{escapeHTML:function(string){return(""+string).replace(/&(?!\w+;|#\d+;|#x[\da-f]+;)/gi,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},unescapeHTML:function(string){return(""+string).replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#x27;/g,'"').replace(/&#x2F;/g,"/")},filterSyntax:function(syntax){var altSyntaxes;return altSyntaxes={html:"htmlmixed"},altSyntaxes[syntax]||syntax}}})}.call(this),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}};angular.module("campusServices").factory("ClientExecutorData",["Logger","$q","CampusApi",function(Logger,$q,CampusApi){var ClientExecutorData,allExecutorData,fetchInProgressDeferred;return allExecutorData={},fetchInProgressDeferred=null,ClientExecutorData=function(){function ClientExecutorData(courseIdentifier,queryString){this.fetchExecutorData=__bind(this.fetchExecutorData,this),this.courseIdentifier=courseIdentifier,this.queryString=queryString}return ClientExecutorData.prototype.get=function(){var deferred;return fetchInProgressDeferred?fetchInProgressDeferred.promise:(deferred=$q.defer(),this.executorData()?deferred.resolve(this.executorData()):this.fetchExecutorData(deferred),deferred.promise)},ClientExecutorData.prototype.fetchExecutorData=function(deferred){var params,self;return fetchInProgressDeferred=deferred,params={query_string:this.queryString,course_identifier:this.courseIdentifier,service:"executor",service_method:"get_executor_data"},Logger.info("Fetching executor data from the server"),self=this,new CampusApi(params.course_identifier).get({params:params}).success(function(data){return self.setExecutorData(data),deferred.resolve(data),fetchInProgressDeferred=null}).error(function(data){return deferred.reject(data),fetchInProgressDeferred=null})},ClientExecutorData.prototype.executorData=function(){return allExecutorData[this.queryString]},ClientExecutorData.prototype.setExecutorData=function(data){return allExecutorData[this.queryString]=data},ClientExecutorData}()}])}.call(this),function(){angular.module("campusServices").factory("ClientExecutorReporter",["ClientExecutorData","$interpolate","Markdown",function(ClientExecutorData,$interpolate,Markdown){var ClientExecutorReporter,Report;return Report=function(){function Report(report,failures,failureMessages,replaceErrorMessageData){this.report=report,this.failures=failures,this.failureMessages=failureMessages,this.replaceErrorMessageData=replaceErrorMessageData,this.firstFailure=this.report.failures[0]}return Report.prototype.toJson=function(){return this.report},Report.prototype.success=function(){return 0===this.report.failures.length},Report.prototype.details=function(){return this.report.details},Report.prototype.htmlMessage=function(){var m;return m=this.message(),m.match(/^<.+>.*<\/.+>$/)?m:Markdown.parse(m.replace(/\\n/g,"\n"))},Report.prototype.target=function(index){var _ref;return null==index&&(index=0),null!=(_ref=this.failureObject(index))?_ref.target:void 0},Report.prototype.failureObject=function(index){return null==index&&(index=0),this.failures[this.report.failures[index].title]},Report.prototype.failureCount=function(){return this.report.failures.length},Report.prototype.message=function(index){var _ref;return null==index&&(index=0),this.success()?void 0:null!=(_ref=this.parseMessage(this.report.failures[index]))?_ref.replace(/^\s+|\s+$/g,""):void 0},Report.prototype.parseMessage=function(failure){var errFunc,errorMessage,firstFailureTitle,_ref;return firstFailureTitle=failure.title,errorMessage=(null!=(_ref=failure.err)?_ref.message:void 0)||this.failureMessages[firstFailureTitle],this.isAssertionError(failure)&&(errorMessage=this.failureMessages[firstFailureTitle]?this.failureMessages[firstFailureTitle]:firstFailureTitle),errorMessage=this._replaceErrorMessage(errorMessage,failure),(errFunc=$interpolate(errorMessage))(this.failureMessages)
},Report.prototype.isAssertionError=function(failure){var assertionError,failureMessage,failureName,_ref,_ref1;return this.success()?!1:(assertionError=/AssertionError/,failureMessage=(null!=(_ref=failure.err)?_ref.message:void 0)||"",failureName=(null!=(_ref1=failure.err)?_ref1.name:void 0)||"",failureMessage.match(assertionError)&&failureName.match(assertionError))},Report.prototype._replaceErrorMessage=function(errorMessage,failure){var regex,replaceObj,_i,_len,_ref;if(this.replaceErrorMessageData){for(_ref=_.flatten(this.replaceErrorMessageData),_i=0,_len=_ref.length;_len>_i;_i++)if(replaceObj=_ref[_i],regex=new RegExp(replaceObj.pattern),regex.test(errorMessage))return failure.title=replaceObj["with"],this.failureMessages[replaceObj["with"]]||replaceObj["with"];return errorMessage}return errorMessage},Report}(),ClientExecutorReporter=function(){function ClientExecutorReporter(courseIdentifier,queryString,executorData){this.courseIdentifier=courseIdentifier,this.queryString=queryString,this.executorData=executorData,new ClientExecutorData(this.courseIdentifier,this.queryString).get().then(function(_this){return function(data){return _this.executorData||(_this.executorData=data),_this.replaceErrorMessageData=_this.executorData.replace_error_messages,_this.failures=_this.executorData.failures,_this.failureMessages={},_.each(_this.executorData.failures,function(failure,key){return _this.failureMessages[key]=failure.message})}}(this))}return ClientExecutorReporter.prototype.processReport=function(report){return this.failures?new Report(report,this.failures,this.failureMessages,this.replaceErrorMessageData):void 0},ClientExecutorReporter}()}])}.call(this),function(){angular.module("campusServices").factory("ContentData",["CampusApi","Logger","ContentDataCache","LoadQueue","$q",function(CampusApi,Logger,ContentDataCache,LoadQueue,$q){var ContentData;return ContentData=function(){function ContentData(){this._initializeCache(),this.loadQueue=new LoadQueue}return ContentData.prototype.queUniqueId=0,ContentData.prototype.queUniqueIndexId=0,ContentData.prototype.completeNonRequiredPage=function(courseIdentifier,queryString){var deferred,params;return deferred=$q.defer(),params={query_string:queryString,course_identifier:courseIdentifier,service:"progress",service_method:"post_complete_non_required_item"},Logger.info("Attempting to complete non-required page: "+courseIdentifier+":"+queryString),new CampusApi(params.course_identifier).post({data:params}).success(function(){return function(){return deferred.resolve(!0),Logger.info("Successfully completed non-required page: "+courseIdentifier+":"+queryString)}}(this)).error(function(_this){return function(data,status,headers,config){return _this._handleHttpError(deferred,data,status,headers,config)}}(this)),deferred.promise},ContentData.prototype.getIndex=function(courseIdentifier){var cachedData,deferred;return deferred=this.loadQueue.getDeferred(courseIdentifier,""+this._indexNamespace+"-"+this.queUniqueIndexId),cachedData=this._cache.indexGet(courseIdentifier,this._indexNamespace),this._responseDataHasData(cachedData)?deferred.resolve(cachedData):this.loadQueue.isLoadingFor(courseIdentifier,""+this._indexNamespace+"-"+this.queUniqueIndexId)||(this.loadQueue.load(courseIdentifier,""+this._indexNamespace+"-"+this.queUniqueIndexId),Logger.info("Fetching content index from the server for "+courseIdentifier+"!"),this._fetchContentIndex(courseIdentifier,deferred)),deferred.promise},ContentData.prototype.refreshIndex=function(courseIdentifier){return Logger.info("Refreshing cached index for "+courseIdentifier),this.queUniqueIndexId+=1,this._cache.clearNodeData(courseIdentifier,this._indexNamespace),this.getIndex(courseIdentifier)},ContentData.prototype.preloadIndex=function(courseIdentifier,data){var cachedData,deferred;return deferred=$q.defer(),this._responseDataHasData(data)?(this._cache.indexPuts(courseIdentifier,this._indexNamespace,data),Logger.info("Bootstrap Index Data for: "+courseIdentifier+" preloaded successfully"),deferred.resolve(data)):(cachedData=this._cache.contentNodeDataGet(courseIdentifier,this._indexNamespace),cachedData?deferred.resolve(cachedData):this.getIndex(courseIdentifier).then(function(data){return deferred.resolve(data),Logger.info("Index Data for: "+courseIdentifier+" preloaded successfully")})["catch"](function(e){return deferred.reject(e),Logger.info("Index Data for: "+courseIdentifier+" preload failure")})),deferred.promise},ContentData.prototype.preloadContent=function(courseIdentifier,queryString,data){var cachedData,deferred;return deferred=$q.defer(),this._responseDataHasData(data)?(this._cache.contentNodeDataPuts(courseIdentifier,data,queryString),Logger.info("Bootstrap data for: "+courseIdentifier+":"+queryString+" preloaded successfully"),deferred.resolve(data)):(cachedData=this._cache.contentNodeDataGet(courseIdentifier,queryString),cachedData?deferred.resolve(cachedData):this.getContent(courseIdentifier,queryString).then(function(data){return deferred.resolve(data),Logger.info("Data for: "+courseIdentifier+":"+queryString+" preloaded successfully")})["catch"](function(error){return deferred.reject(error),Logger.info("Data for: "+courseIdentifier+":"+queryString+" preload failure")})),deferred.promise},ContentData.prototype.refreshContent=function(courseIdentifier,queryString,options){return null==options&&(options={}),Logger.info("Refreshing cached content for "+courseIdentifier+":"+queryString),this.queUniqueId+=1,this._cache.clearNodeData(courseIdentifier,queryString),this.getContent(courseIdentifier,queryString,options)},ContentData.prototype.getContent=function(courseIdentifier,queryString,options){var cachedData,deferred;return null==options&&(options={}),deferred=this.loadQueue.getDeferred(courseIdentifier,""+queryString+"-"+this.queUniqueId),cachedData=this._cache.contentNodeDataGet(courseIdentifier,queryString),cachedData?deferred.resolve(cachedData):this.loadQueue.isLoadingFor(courseIdentifier,""+queryString+"-"+this.queUniqueId)||(this.loadQueue.load(courseIdentifier,""+queryString+"-"+this.queUniqueId),Logger.info("Fetching content for "+courseIdentifier+":"+queryString+" from the server"),this._fetchContentData(courseIdentifier,queryString,deferred,options)),deferred.promise},ContentData.prototype.clearAllCacheForCourse=function(courseIdentifier){return this._cache.clearCourse(courseIdentifier)},ContentData.prototype._cacheNamespace="courseData",ContentData.prototype._indexNamespace="_courseIndex",ContentData.prototype._cache=null,ContentData.prototype._fetchContentIndex=function(courseIdentifier,deferred){var params;return params={query_string:"/",course_identifier:courseIdentifier,service:"content_data",service_method:"get_index_data"},this._getContentData(params).success(function(_this){return function(data,status,headers,config){var cachedData;return _this._responseDataHasData(data)?(cachedData=_this._cache.indexPuts(courseIdentifier,_this._indexNamespace,data),deferred.resolve(cachedData)):_this._handleNullData(deferred,"IndexNotFoundError: Index data for "+courseIdentifier+" not found.",status,headers,config)}}(this)).error(function(_this){return function(data,status,headers,config){return _this._handleHttpError(deferred,data,status,headers,config)}}(this))},ContentData.prototype._fetchContentData=function(courseIdentifier,queryString,deferred,options){var params;return null==options&&(options={}),params={query_string:queryString,course_identifier:courseIdentifier,service:"content_data",service_method:"get_all_data",service_args:JSON.stringify([options])},this._getContentData(params).success(function(_this){return function(data,status,headers,config){var cachedData;return _this._responseDataHasData(data)?(cachedData=_this._cache.contentNodeDataPuts(courseIdentifier,data,queryString),deferred.resolve(cachedData)):_this._handleNullData(deferred,"ContentNotFoundError: Content for "+courseIdentifier+":"+queryString+" not found.",status,headers,config)}}(this)).error(function(_this){return function(data,status,headers,config){return _this._handleHttpError(deferred,data,status,headers,config)}}(this))},ContentData.prototype._handleNullData=function(deferred,errorMessage,status,headers,config){return deferred.reject(errorMessage,status,headers,config),Logger.error(errorMessage,status,headers,config)},ContentData.prototype._handleHttpError=function(deferred,data,status,headers,config){return deferred.reject(data,status,headers,config),Logger.error(data,status,headers,config)},ContentData.prototype._responseDataHasData=function(data){return"null"!==data&&!!data},ContentData.prototype._getContentData=function(params){return new CampusApi(params.course_identifier).get({params:params})},ContentData.prototype._initializeCache=function(){return this._cache=new ContentDataCache(this._cacheNamespace)},ContentData}()}])}.call(this),function(){angular.module("campusServices").factory("ContentDataCache",["LocalStorageCache",function(LocalStorageCache){var ContentDataCache;return ContentDataCache=function(){function ContentDataCache(cacheNamespace){this._cache=new LocalStorageCache(cacheNamespace)}return ContentDataCache.prototype._cache=null,ContentDataCache.prototype.indexPuts=function(courseIdentifier,indexNamespace,data){return this._cache.cachePuts(courseIdentifier,indexNamespace,data)},ContentDataCache.prototype.indexGet=function(courseIdentifier,indexNamespace){return this._cache.cacheGet(courseIdentifier,indexNamespace)},ContentDataCache.prototype.contentNodeDataPuts=function(courseIdentifier,nodeData,queryString){var fullNodes,queryStringArray;return nodeData.nodes&&nodeData.nodes.length>0&&(fullNodes=nodeData.nodes,queryStringArray=this._convertNodesToQueryStrings(nodeData.nodes,courseIdentifier),nodeData.nodes=queryStringArray),this._cache.cachePuts(courseIdentifier,queryString?queryString:nodeData.query_string,nodeData),fullNodes&&(nodeData.nodes=fullNodes),nodeData},ContentDataCache.prototype.clearNodeData=function(courseIdentifier,queryString){return this._cache.clearData(courseIdentifier,queryString)},ContentDataCache.prototype.contentNodeDataGet=function(courseIdentifier,queryString){var initialNodeData;return initialNodeData=this._cache.cacheGet(courseIdentifier,queryString),initialNodeData&&(initialNodeData.nodes=_.map(initialNodeData.nodes,function(_this){return function(nodeQueryString){return _this.contentNodeDataGet(courseIdentifier,nodeQueryString)}}(this))),initialNodeData},ContentDataCache.prototype._convertNodesToQueryStrings=function(nodes,courseIdentifier){return _.map(nodes,function(_this){return function(node){return _this.contentNodeDataPuts(courseIdentifier,node,node.query_string),node.query_string}}(this))},ContentDataCache}()}])}.call(this),function(){angular.module("campusServices").factory("ContentEdit",["CampusApi","$q",function(CampusApi,$q){var ContentEdit;return ContentEdit=function(){function ContentEdit(){}return ContentEdit.prototype.saveContentData=function(courseIdentifier,queryString,contentData){var deferred;return deferred=$q.defer(),this._postContentData(courseIdentifier,queryString,contentData,deferred),deferred.promise},ContentEdit.prototype._postContentData=function(courseIdentifier,queryString,contentData,deferred){var params;return params={query_string:queryString,course_identifier:courseIdentifier,service:"content_edit",service_method:"post_content_data",service_args:JSON.stringify([contentData])},new CampusApi(params.course_identifier).post({data:params}).success(function(){return function(data){return deferred.resolve(data)}}(this)).error(function(){return function(data){return deferred.reject(data)}}(this))},ContentEdit}()}])}.call(this),function(){angular.module("campusServices").factory("CourseConfig",["CampusApi","$q","Logger","LocalStorageCache",function(CampusApi,$q,Logger,LocalStorageCache){var CourseConfig;return CourseConfig=function(){function CourseConfig(){}return CourseConfig.prototype.cacheKey="_courseConfig",CourseConfig.prototype.cache=new LocalStorageCache("config"),CourseConfig.prototype.getConfig=function(courseIdentifier){var cachedData,deferred;return deferred=$q.defer(),cachedData=this.cache.cacheGet(courseIdentifier,this.cacheKey),cachedData?deferred.resolve(cachedData):(Logger.info("Fetching config data for "+courseIdentifier+" from the server"),this._fetchConfigData(courseIdentifier,deferred)),deferred.promise},CourseConfig.prototype.preloadData=function(courseIdentifier,data){var cachedData;return cachedData=this.cache.cacheGet(courseIdentifier,this.cacheKey),data?(this.cache.cachePuts(courseIdentifier,this.cacheKey,data),Logger.info("Bootstrap Config data for "+courseIdentifier+" preloaded successfully")):cachedData?void 0:this.getUser(courseIdentifier).then(function(){return Logger.info("Config Data for: "+courseIdentifier+" preload successful")})["catch"](function(){return Logger.info("Config Data for: "+courseIdentifier+" preload failed")})},CourseConfig.prototype._fetchConfigData=function(courseIdentifier,deferred){var params;return params={query_string:"/",course_identifier:courseIdentifier,service:"content_data",service_method:"get_course_config"},new CampusApi(params.course_identifier).get({params:params}).success(function(_this){return function(data){return deferred.resolve(data),_this.cache.cachePuts(courseIdentifier,_this.cacheKey,data)}}(this)).error(function(){return function(data){return deferred.reject(data)}}(this))},CourseConfig}()}])}.call(this),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}};angular.module("campusServices").factory("CurrentContentData",["ContentData","$rootScope","NodeTreeTraverser","$q","CurrentCourseConfig","UserData",function(ContentData,$rootScope,NodeTreeTraverser,$q,CurrentCourseConfig,UserData){var CurrentContentData;return CurrentContentData=function(){function CurrentContentData(courseIdentifier,queryString){this.completeChildCount=__bind(this.completeChildCount,this),this.courseIdentifier=courseIdentifier,this.queryString=queryString}return CurrentContentData.prototype.courseDataService=new ContentData,CurrentContentData.prototype.userDataService=new UserData,CurrentContentData.prototype.data=function(){return this.courseDataService.getContent(this.courseIdentifier,this.queryString)},CurrentContentData.prototype.indexData=function(){return this.courseDataService.getIndex(this.courseIdentifier)},CurrentContentData.prototype.completeNonRequiredPage=function(){var deferred;return deferred=this.newDeferred(),this.courseDataService.completeNonRequiredPage(this.courseIdentifier,this.queryString).then(function(){return deferred.resolve(!0)}),deferred.promise},CurrentContentData.prototype.refreshContent=function(){var deferred;return deferred=this.newDeferred(),this.courseDataService.refreshContent(this.courseIdentifier,this.queryString).then(function(data){return deferred.resolve(data),$rootScope.$emit("currentContentData:refreshContent",data)}),deferred.promise},CurrentContentData.prototype.refreshIndex=function(){var deferred;return deferred=this.newDeferred(),this.courseDataService.refreshIndex(this.courseIdentifier).then(function(data){return deferred.resolve(data),$rootScope.$emit("currentContentData:refreshIndex",data)}),deferred.promise},CurrentContentData.prototype.refreshAllData=function(scope){var deferred;return deferred=this.newDeferred(),$q.all([this.refreshIndex(),this.refreshContent(),this.userDataService.refreshUser(this.courseIdentifier)]).then(function(_this){return function(data){var contentData,indexData,userData;return indexData=data[0],contentData=data[1],userData=data[2],scope.$emit("page:update:content",{courseIdentifier:_this.courseIdentifier,queryString:_this.queryString,data:contentData}),scope.$emit("page:update:index",{courseIdentifier:_this.courseIdentifier,queryString:_this.queryString,data:indexData}),scope.$emit("page:update:user",{courseIdentifier:_this.courseIdentifier,queryString:_this.queryString,data:userData}),deferred.resolve({indexData:indexData,contentData:contentData})}}(this)),deferred.promise},CurrentContentData.prototype.preloadData=function(queryString){return this.courseDataService.preloadContent(this.courseIdentifier,queryString||this.queryString)},CurrentContentData.prototype.preloadIndexData=function(){return this.courseDataService.preloadIndex(this.courseIdentifier)},CurrentContentData.prototype.newDeferred=function(){return $q.defer()},CurrentContentData.prototype.attributes=function(){var deferred;return deferred=this.newDeferred(),this.data().then(function(data){return deferred.resolve(data.attributes)}),deferred.promise},CurrentContentData.prototype.attribute=function(attributeName){var deferred;return deferred=this.newDeferred(),this.data().then(function(data){return deferred.resolve(data.attributes[attributeName])}),deferred.promise},CurrentContentData.prototype.userPageNodes=function(){var deferred;return deferred=this.newDeferred(),indexData().then(function(indexData){var userNodes;return userNodes=_.select(indexData.nodes,function(node){return"user"===node.node_label}),deferred.resolve(userNodes[0].nodes)}),deferred.promise},CurrentContentData.prototype.currentLevelIndex=function(){var deferred,self;return deferred=this.newDeferred(),self=this,this.indexData().then(function(indexData){var indexResult;return indexResult=(new NodeTreeTraverser).nodeIndexInTopLevelContainer(self.queryString,indexData),deferred.resolve(indexResult.containerIndex)}),deferred.promise},CurrentContentData.prototype.totalPoints=function(node){var countPoints,deferred,totalPoints;return deferred=this.newDeferred(),totalPoints=0,countPoints=function(node){return(null!=node?node.attributes.required:void 0)&&(totalPoints+=node.points.points),_.each(node.nodes,function(n){return countPoints(n)})},countPoints(node),deferred.resolve(totalPoints),deferred.promise},CurrentContentData.prototype.completeChildCount=function(node){var childCounter,deferred;return deferred=$q.defer(),childCounter=function(n){var total;return total=0,_.each(n.nodes,function(node){return 100===node.progress&&node.attributes.required&&(total+=1),node.nodes?total+=childCounter(node):void 0}),total},deferred.resolve(childCounter(node)),deferred.promise},CurrentContentData.prototype.totalChildCount=function(givenNode){var deferred,totalCounter;return deferred=$q.defer(),totalCounter=function(n){var total;return total=0,_.each(n.nodes,function(node){return node.attributes.required&&(total+=1),node.nodes?total+=totalCounter(node):void 0}),total},givenNode?deferred.resolve(totalCounter(givenNode)):this.courseDataService.getIndex(this.courseIdentifier).then(function(contentIndex){return deferred.resolve(totalCounter(contentIndex))}),deferred.promise},CurrentContentData.prototype.courseAchievements=function(){var deferred;return deferred=$q.defer(),this.courseDataService.getContent(this.courseIdentifier,"/").then(function(courseData){return deferred.resolve(courseData.attributes.achievements)}),deferred.promise},CurrentContentData.prototype.achievementForLevel=function(levelNode){var deferred;return deferred=$q.defer(),this.courseAchievements().then(function(achievements){var foundAchievements;return foundAchievements=_.find(achievements,function(achievement){var foundEvent;return foundEvent=_.find(achievement.events,function(evt){return"complete"===evt.action&&"level"===evt.category&&evt.label===levelNode.attributes._uid}),!!foundEvent}),deferred.resolve(foundAchievements)}),deferred.promise},CurrentContentData.prototype.achievementForCourseComplete=function(){var deferred;return deferred=$q.defer(),this.courseAchievements().then(function(achievements){var foundAchievements;return foundAchievements=_.find(achievements,function(achievement){var foundEvent;return foundEvent=_.find(achievement.events,function(evt){return"complete"===evt.action&&"course"===evt.category}),!!foundEvent}),deferred.resolve(foundAchievements)}),deferred.promise},CurrentContentData.prototype.totalAvailablePoints=function(){var deferred;return deferred=this.newDeferred(),$q.all([new CurrentCourseConfig(this.courseIdentifier).data(),this.data()]).then(function(data){var configData,contentData,hintCount,hintValue,subtractValue,tasks,tasksWithAnswers,usedHints,_ref,_ref1;return configData=data[0],contentData=data[1],subtractValue=0,usedHints=(null!=(_ref=contentData.attributes.hints)?_ref.used_hints:void 0)||0,hintCount=(null!=(_ref1=contentData.attributes.hints)?_ref1.count:void 0)||0,hintValue=configData.hint_point_value,"last_hint"===configData.subtract_points_on&&hintCount===usedHints.length?subtractValue=hintValue:"each_hint"===configData.subtract_points_on&&(subtractValue=hintValue*usedHints.length),tasks=contentData.attributes.tasks,tasks&&(tasksWithAnswers=_.filter(tasks,function(task){return!!task.answer}),subtractValue+=tasksWithAnswers.length*(configData.points_per_task_answer||0)),deferred.resolve(contentData.points.possible_points-subtractValue)}),deferred.promise},CurrentContentData}()}])}.call(this),function(){angular.module("campusServices").factory("CurrentCourseConfig",["$rootScope","CourseConfig","$q",function($rootScope,CourseConfig,$q){var CurrentCourseConfig;return CurrentCourseConfig=function(){function CurrentCourseConfig(courseIdentifier){this.courseIdentifier=courseIdentifier}return CurrentCourseConfig.prototype.configService=new CourseConfig,CurrentCourseConfig.prototype.data=function(){return this.configService.getConfig(this.courseIdentifier)},CurrentCourseConfig.prototype.newDeferred=function(){return $q.defer()},CurrentCourseConfig.prototype.get=function(configAttribute){var deferred;return deferred=this.newDeferred(),this.data().then(function(configData){return deferred.resolve(configData[configAttribute])}),deferred.promise},CurrentCourseConfig}()}])}.call(this),function(){angular.module("campusServices").factory("CurrentIndexData",["ContentData","$rootScope","$q",function(ContentData,$rootScope,$q){var CurrentIndexData;return CurrentIndexData=function(){function CurrentIndexData(courseIdentifier){this.courseIdentifier=courseIdentifier}return CurrentIndexData.prototype.courseDataService=new ContentData,CurrentIndexData.prototype.data=function(){return this.courseDataService.getIndex(this.courseIdentifier)},CurrentIndexData.prototype.refreshIndex=function(){var deferred;return deferred=this.newDeferred(),this.courseDataService.refreshIndex(this.courseIdentifier).then(function(data){return deferred.resolve(data),$rootScope.$emit("currentIndexData:refreshIndex",data)}),deferred.promise},CurrentIndexData.prototype.userNodes=function(){var deferred;return deferred=this.newDeferred(),this.data().then(function(data){var userContainer;return userContainer=_.find(data.nodes,function(node){return"user"===node.node_label}),deferred.resolve(userContainer.nodes)}),deferred.promise},CurrentIndexData.prototype.newDeferred=function(){return $q.defer()},CurrentIndexData.prototype.getContainers=function(name){var deferred;return deferred=this.newDeferred(),this.data().then(function(indexData){return deferred.resolve(_.where(indexData.nodes,{node_label:name,node_type:"container"}))}),deferred.promise},CurrentIndexData.prototype.getPages=function(names){var deferred,findNode,foundPages;return deferred=this.newDeferred(),names=_.flatten([names]),foundPages=[],findNode=function(node,nodeNames){return nodeNames.indexOf(node.node_label)>=0&&foundPages.push(node),node.nodes&&node.nodes.length>0?_.each(node.nodes,function(n){return findNode(n,nodeNames)}):void 0},this.data().then(function(indexData){return findNode(indexData,names),deferred.resolve(foundPages)}),deferred.promise},CurrentIndexData.prototype.getRequiredPages=function(){var deferred,findNode,foundPages;return deferred=this.newDeferred(),foundPages=[],findNode=function(node){return node.attributes.required&&foundPages.push(node),node.nodes&&node.nodes.length>0?_.each(node.nodes,function(n){return findNode(n)}):void 0},this.data().then(function(indexData){return findNode(indexData),deferred.resolve(foundPages)}),deferred.promise},CurrentIndexData.prototype.getParentContainer=function(container,queryString){var currentQueryString,deferred,foundChild,foundParent,lookForItemInLevel;return deferred=this.newDeferred(),currentQueryString=queryString,foundParent=null,foundChild=null,lookForItemInLevel=function(node){return foundChild?void 0:(node.node_label===container&&(foundParent=node),node.query_string===currentQueryString&&(foundChild=node),node.nodes&&node.nodes.length>0?_.each(node.nodes,function(n){return lookForItemInLevel(n)}):void 0)},this.data().then(function(indexData){return lookForItemInLevel(indexData),deferred.resolve({parentContainer:foundParent,childItem:foundChild,fullIndex:indexData})}),deferred.promise},CurrentIndexData}()}])}.call(this),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}};angular.module("campusServices").factory("CurrentSubmitData",function(){var CurrentSubmitData,events,submitContent;return submitContent={},events={},CurrentSubmitData=function(){function CurrentSubmitData(courseIdentifier,queryString){this.getContent=__bind(this.getContent,this),this.on=__bind(this.on,this);var _base,_base1,_name,_name1,_name2,_name3;this.courseIdentifier=courseIdentifier,this.queryString=queryString,events[_name=this.courseIdentifier]||(events[_name]={}),(_base=events[this.courseIdentifier])[_name1=this.queryString]||(_base[_name1]={}),submitContent[_name2=this.courseIdentifier]||(submitContent[_name2]={}),(_base1=submitContent[this.courseIdentifier])[_name3=this.queryString]||(_base1[_name3]=[])}return CurrentSubmitData.prototype.reset=function(){return submitContent[this.courseIdentifier][this.queryString]=null,submitContent[this.courseIdentifier][this.queryString]=[],events[this.courseIdentifier][this.queryString]=null,events[this.courseIdentifier][this.queryString]={}},CurrentSubmitData.prototype.getEventCallbacks=function(eventName,reset){var _base;return null==reset&&(reset=!1),(_base=events[this.courseIdentifier][this.queryString])[eventName]||(_base[eventName]=[]),reset?(events[this.courseIdentifier][this.queryString][eventName]=null,events[this.courseIdentifier][this.queryString][eventName]=[]):events[this.courseIdentifier][this.queryString][eventName]},CurrentSubmitData.prototype.submitContent=function(){return submitContent[this.courseIdentifier][this.queryString]},CurrentSubmitData.prototype.on=function(eventName,callback){return this.getEventCallbacks(eventName).push(callback)},CurrentSubmitData.prototype.off=function(eventName,callback){var cbIndex;return callback?(cbIndex=this.getEventCallbacks(eventName).indexOf(callback),this.getEventCallbacks(eventName).splice(cbIndex,1)):this.getEventCallbacks(eventName,!0)},CurrentSubmitData.prototype.registerContent=function(contentFunction){return submitContent[this.courseIdentifier][this.queryString].push(contentFunction),function(_this){return function(){var index;return index=submitContent[_this.courseIdentifier][_this.queryString].indexOf(contentFunction),submitContent[_this.courseIdentifier][_this.queryString].splice(index,1)}}(this)},CurrentSubmitData.prototype.trigger=function(eventName,data){return _.each(this.getEventCallbacks(eventName),function(cb){return cb(data)})},CurrentSubmitData.prototype.getContent=function(){return _.map(this.submitContent(),function(submissionFunc){var dataObject;return dataObject=submissionFunc(),delete dataObject.changeObject,dataObject})},CurrentSubmitData}()})}.call(this),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}};angular.module("campusServices").factory("CurrentSyncData",function(){var CurrentSubmitData,events,syncContent;return syncContent={},events={},CurrentSubmitData=function(){function CurrentSubmitData(courseIdentifier,queryString){this.getContent=__bind(this.getContent,this),this.on=__bind(this.on,this);var _base,_base1,_name,_name1,_name2,_name3;this.courseIdentifier=courseIdentifier,this.queryString=queryString,events[_name=this.courseIdentifier]||(events[_name]={}),(_base=events[this.courseIdentifier])[_name1=this.queryString]||(_base[_name1]={}),syncContent[_name2=this.courseIdentifier]||(syncContent[_name2]={}),(_base1=syncContent[this.courseIdentifier])[_name3=this.queryString]||(_base1[_name3]=[])}return CurrentSubmitData.prototype.reset=function(){return syncContent[this.courseIdentifier][this.queryString]=null,syncContent[this.courseIdentifier][this.queryString]=[],events[this.courseIdentifier][this.queryString]=null,events[this.courseIdentifier][this.queryString]=[]},CurrentSubmitData.prototype.getEventCallbacks=function(eventName,reset){var _base;return null==reset&&(reset=!1),(_base=events[this.courseIdentifier][this.queryString])[eventName]||(_base[eventName]=[]),reset?(events[this.courseIdentifier][this.queryString][eventName]=null,events[this.courseIdentifier][this.queryString][eventName]=[]):events[this.courseIdentifier][this.queryString][eventName]},CurrentSubmitData.prototype.syncContent=function(){return syncContent[this.courseIdentifier][this.queryString]},CurrentSubmitData.prototype.on=function(eventName,callback){return this.getEventCallbacks(eventName).push(callback)},CurrentSubmitData.prototype.off=function(eventName,callback){var cbIndex;return callback?(cbIndex=this.getEventCallbacks(eventName).indexOf(callback),this.getEventCallbacks(eventName).splice(cbIndex,1)):this.getEventCallbacks(eventName,!0)},CurrentSubmitData.prototype.registerContent=function(contentFunction){return syncContent[this.courseIdentifier][this.queryString].push(contentFunction)},CurrentSubmitData.prototype.trigger=function(eventName,data){return _.each(this.getEventCallbacks(eventName),function(cb){return cb(data)})},CurrentSubmitData.prototype.getContent=function(){return this.syncContent()},CurrentSubmitData}()})}.call(this),function(){angular.module("campusServices").factory("CurrentUserData",["$rootScope","UserData","$q",function($rootScope,UserData,$q){var CurrentUserdata;return CurrentUserdata=function(){function CurrentUserdata(courseIdentifier){this.courseIdentifier=courseIdentifier}return CurrentUserdata.prototype.userDataService=new UserData,CurrentUserdata.prototype.data=function(){var deferred;return deferred=this.newDeferred(),this.userDataService.getUser(this.courseIdentifier).then(function(data){return"null"===data?deferred.resolve(null):deferred.resolve(data)}),deferred.promise},CurrentUserdata.prototype.refreshData=function(){var deferred;return deferred=this.newDeferred(),this.userDataService.refreshUser(this.courseIdentifier).then(function(data){return deferred.resolve(data),$rootScope.$emit("currentUserData:refreshContent",data)}),deferred.promise},CurrentUserdata.prototype.newDeferred=function(){return $q.defer()},CurrentUserdata.prototype.loggedIn=function(){var deferred;return deferred=this.newDeferred(),this.data().then(function(userData){return deferred.resolve(!!userData||!userData.visitor)}),deferred.promise},CurrentUserdata.prototype.isVisitor=function(){var deferred;return deferred=this.newDeferred(),this.data().then(function(userData){return deferred.resolve(userData&&userData.visitor)}),deferred.promise},CurrentUserdata.prototype.ensureUserExists=function(){var deferred,self;return deferred=this.newDeferred(),self=this,this.data().then(function(userData){return userData?void 0:self.userDataService.createVisitor().then(function(data){return deferred.resolve(data)})}),deferred.promise},CurrentUserdata.prototype.userName=function(){var deferred;return deferred=this.newDeferred(),this.data().then(function(userData){return userData?deferred.resolve(userData.user_name):deferred.resolve("Student")}),deferred.promise},CurrentUserdata.prototype.gravatar=function(){var deferred;return deferred=this.newDeferred(),this.data().then(function(userData){return userData?deferred.resolve(userData.gravatar):deferred.resolve("")}),deferred.promise},CurrentUserdata.prototype.awardedAchievements=function(){var deferred;return deferred=this.newDeferred(),this.data().then(function(userData){return userData?deferred.resolve(userData.achievements.awarded):deferred.resolve([])}),deferred.promise},CurrentUserdata.prototype.unawardedAchievements=function(){var deferred;return deferred=this.newDeferred(),this.data().then(function(userData){return userData?deferred.resolve(userData.achievements.unawarded):deferred.resolve([])}),deferred.promise},CurrentUserdata.prototype.totalAchievements=function(){var deferred;return deferred=this.newDeferred(),this.data().then(function(userData){var awardedAchievements,unawardedAchievements;return userData?(unawardedAchievements=userData.achievements.unawarded,awardedAchievements=userData.achievements.awarded,deferred.resolve(""+awardedAchievements.length+"/"+(awardedAchievements.length+unawardedAchievements.length))):deferred.resolve("N/A")
}),deferred.promise},CurrentUserdata.prototype.requiredPagesCompleteCount=function(){var deferred;return deferred=this.newDeferred(),this.data().then(function(userData){return userData?deferred.resolve(userData.pages.required_completed):deferred.resolve(0)}),deferred.promise},CurrentUserdata.prototype.totalRequiredPagesCount=function(){var deferred;return deferred=this.newDeferred(),this.data().then(function(userData){return userData?deferred.resolve(userData.pages.total_required):deferred.resolve(0)}),deferred.promise},CurrentUserdata.prototype.challengesCompleted=function(){var deferred;return deferred=this.newDeferred(),this.data().then(function(userData){var requiredPagesCompleteCount,totalRequiredPagesCount;return userData?(requiredPagesCompleteCount=userData.pages.required_completed,totalRequiredPagesCount=userData.pages.total_required,deferred.resolve(""+requiredPagesCompleteCount+"/"+totalRequiredPagesCount)):deferred.resolve("N/A")}),deferred.promise},CurrentUserdata.prototype.usedHintsCount=function(){var deferred;return deferred=this.newDeferred(),this.data().then(function(userData){return userData?deferred.resolve(userData.hints.used_count):deferred.resolve("N/A")}),deferred.promise},CurrentUserdata.prototype.totalPoints=function(){var deferred;return deferred=this.newDeferred(),this.data().then(function(userData){return userData?deferred.resolve(userData.points.total_points):deferred.resolve(0)})},CurrentUserdata.prototype.possiblePoints=function(){var deferred;return deferred=this.newDeferred(),this.data().then(function(userData){return userData?deferred.resolve(userData.points.possible_points):deferred.resolve("N/A")}),deferred.promise},CurrentUserdata.prototype.totalOutOfPossiblePoints=function(){var deferred;return deferred=this.newDeferred(),this.data().then(function(userData){var possiblePoints,totalPoints;return userData?(totalPoints=userData.points.total_points,possiblePoints=userData.points.possible_points,deferred.resolve(""+totalPoints+"/"+possiblePoints)):deferred.resolve("N/A")}),deferred.promise},CurrentUserdata}()}])}.call(this),function(){angular.module("campusServices").factory("DataBootstrapper",["$templateCache","ContentData","UserData","CourseConfig","GoogleAnalytics",function($templateCache,ContentData,UserData,CourseConfig,GoogleAnalytics){var DataBootstrapper;return DataBootstrapper=function(){function DataBootstrapper(){}return DataBootstrapper.prototype.indexDataId="_courseIndexData",DataBootstrapper.prototype.bootstrapedDataTemplateId="_courseData",DataBootstrapper.prototype.userDataId="_userData",DataBootstrapper.prototype.courseConfigId="_courseConfig",DataBootstrapper.prototype.googleAnalyticsData="_googleAnalyticsData",DataBootstrapper.prototype.courseDataService=new ContentData,DataBootstrapper.prototype.courseUserService=new UserData,DataBootstrapper.prototype.courseConfigService=new CourseConfig,DataBootstrapper.prototype.load=function(courseIdentifier){var bootstrappedCourseConfigData,bootstrappedData,bootstrappedGoogleAnalytics,bootstrappedIndexData,bootstrappedUserData;return bootstrappedData=JSON.parse($templateCache.get(this.bootstrapedDataTemplateId)),bootstrappedIndexData=JSON.parse($templateCache.get(this.indexDataId)),bootstrappedUserData=JSON.parse($templateCache.get(this.userDataId)),bootstrappedCourseConfigData=JSON.parse($templateCache.get(this.courseConfigId)),bootstrappedGoogleAnalytics=JSON.parse($templateCache.get(this.googleAnalyticsData)),this.courseDataService.preloadContent(courseIdentifier,bootstrappedData.query_string,bootstrappedData),this.courseDataService.preloadIndex(courseIdentifier,bootstrappedIndexData),this.courseUserService.preloadData(courseIdentifier,bootstrappedUserData),this.courseConfigService.preloadData(courseIdentifier,bootstrappedCourseConfigData),GoogleAnalytics.load(bootstrappedGoogleAnalytics)},DataBootstrapper}()}])}.call(this),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}};angular.module("campusServices").factory("DrawBadgeProgress",function(){var Progress;return Progress=function(){function Progress(options){this.options=options,this.arc=__bind(this.arc,this)}return Progress.prototype.init=function(options){return this.options=options,this.container=this.options.id?document.getElementById(this.options.id):this.options.element,this.svg=this.buildSvg(this.container),this.path=document.createElementNS("http://www.w3.org/2000/svg","path"),this.radius=this.options.radius||this.container.clientWidth/2,this.progressStart=.01,this.progressEnd=this.options.progress,this.container.appendChild(this.svg),this.svg.appendChild(this.path),this.svg.setAttribute("height",2*this.radius),this.svg.setAttribute("width",2*this.radius),this.arc(!0),setTimeout(function(_this){return function(){return _this.draw()}}(this),this.options.delay||0)},Progress.prototype.buildSvg=function(container){var existingSvg,svg,svgClass,_i,_len,_ref;for(svgClass="badge-progress-svg",svg=null,_ref=container.getElementsByTagName("svg"),_i=0,_len=_ref.length;_len>_i;_i++)if(existingSvg=_ref[_i],existingSvg.classList.toString().match(new RegExp(svgClass))){svg=existingSvg,svg.innerHTML="";break}return svg||(svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),svg.setAttribute("class",svgClass)),svg},Progress.prototype.draw=function(){return this.progressEnd>this.progressStart&&(this.animateId=requestAnimationFrame(this.arc)),this.progressStart++},Progress.prototype.arc=function(once){var angle,d,flag,x2,y2;return angle=this.progressStart/100*Math.PI*2-2*Math.PI,x2=this.radius+this.radius*Math.sin(angle),y2=this.radius-this.radius*Math.cos(angle),flag=angle>-Math.PI?0:1,d="M "+this.radius+", "+this.radius+"\nL "+this.radius+", 0\nA "+this.radius+", "+this.radius+" 1 "+flag+" 0 "+x2+", "+y2+"\nZ",this.path.setAttribute("d",d),once!==!0?this.draw():void 0},Progress.prototype.update=function(progressEnd){return this.progressEnd=progressEnd,this.draw()},Progress.prototype.teardown=function(){return this.container.removeChild(this.svg),this.svg=null,window.cancelAnimationFrame(this.animateId)},Progress}()})}.call(this),function(){angular.module("campusServices").factory("EventRebroadcaster",function(){var EventRebroadcaster;return EventRebroadcaster=function(){function EventRebroadcaster(scope){this.scope=scope}return EventRebroadcaster.prototype.add=function(eventName,options){return null==options&&(options={}),this.scope.$on(eventName,function(_this){return function(evt,data){return evt.targetScope===_this.scope||options.eventDataMatches&&!_this.eventDataMatches(data,options.eventDataMatches)?void 0:((null!=options?options.bubbles:void 0)&&evt.stopPropagation||"function"==typeof evt.stopPropagation&&evt.stopPropagation(),_this.scope.$broadcast(eventName,data))}}(this))},EventRebroadcaster.prototype.eventDataMatches=function(eventData,match){return eventData[match]===this.scope[match]},EventRebroadcaster}()})}.call(this),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}};angular.module("campusServices").factory("Executor",["$q","ClientExecutor","RemoteExecutor","CurrentSubmitData","CurrentContentData","$timeout",function($q,ClientExecutor,RemoteExecutor,CurrentSubmitData,CurrentContentData,$timeout){var Executor,submissionContent,updateDelay;return updateDelay=500,submissionContent={},Executor=function(){function Executor(courseIdentifier,queryString,executorData){var _base,_name,_name1;this.courseIdentifier=courseIdentifier,this.queryString=queryString,this.executorData=executorData,this.submit=__bind(this.submit,this),this.recordLastSubmission=__bind(this.recordLastSubmission,this),this.onChange=__bind(this.onChange,this),this.cleanUp=__bind(this.cleanUp,this),this.runSubmit=__bind(this.runSubmit,this),this.clientExecutor||(this.clientExecutor=new ClientExecutor(this.courseIdentifier,this.queryString,this.executorData)),this.remoteExecutor||(this.remoteExecutor=new RemoteExecutor(this.courseIdentifier,this.queryString,this.executorData)),this.submitDataService||(this.submitDataService=new CurrentSubmitData(this.courseIdentifier,this.queryString)),this.onChangeCallbacks=[],this.evaluationDelay=updateDelay,new CurrentContentData(this.courseIdentifier,this.queryString).data().then(function(_this){return function(contentData){var executor_options;return _this.executorName=contentData.attributes.executor.executor_name,executor_options=contentData.attributes.executor.executor_options,executor_options&&executor_options.refresh_delay?_this.evaluationDelay=executor_options.refresh_delay:void 0}}(this)),submissionContent[_name=this.courseIdentifier]||(submissionContent[_name]={}),(_base=submissionContent[this.courseIdentifier])[_name1=this.queryString]||(_base[_name1]={}),this.submitDataService.on("change",this.runSubmit)}return Executor.prototype.runSubmit=function(){return this.executorName?this.startDelayedSubmission():void 0},Executor.prototype.cleanUp=function(){return this.submitDataService.off("change",this.runSubmit),this.onChangeCallbacks=null},Executor.prototype.onChange=function(callback){return this.onChangeCallbacks.push(callback)},Executor.prototype.reset=function(){return submissionContent[this.courseIdentifier][this.queryString]={}},Executor.prototype.lastResult=function(reset){var _base;return null==reset&&(reset=!1),(_base=submissionContent[this.courseIdentifier][this.queryString]).lastResult||(_base.lastResult={}),reset?submissionContent[this.courseIdentifier][this.queryString].lastResult={}:submissionContent[this.courseIdentifier][this.queryString].lastResult},Executor.prototype.currentSubmission=function(reset){var _base;return null==reset&&(reset=!1),(_base=submissionContent[this.courseIdentifier][this.queryString]).currentSubmitting||(_base.currentSubmitting={}),reset?submissionContent[this.courseIdentifier][this.queryString].currentSubmitting={}:submissionContent[this.courseIdentifier][this.queryString].currentSubmitting},Executor.prototype.contentIsEqual=function(lastContent,newContent){return(lastContent||[]).length!==(newContent||[]).length?!1:_.all(newContent,function(_this){return function(content){return _this.contentInPreviousSubmission(lastContent,content)}}(this))},Executor.prototype.contentInPreviousSubmission=function(allContent,matchAgainstContent){return _.find(allContent,function(){return function(content){return content===matchAgainstContent?!0:content?_.isEqual(content,matchAgainstContent):!1}}(this))},Executor.prototype.startDelayedSubmission=function(){return this.timer&&($timeout.cancel(this.timer),this.timer=null),this.timer||(this.timer=$timeout(function(_this){return function(){return _this.submit(_this.submitDataService.getContent())}}(this),this.evaluationDelay))},Executor.prototype.recordLastSubmission=function(deferred,contentArray){return deferred.promise.then(function(_this){return function(report){return _this.lastResult().contentArray=contentArray,_this.lastResult().report=report,_.each(_this.onChangeCallbacks,function(cb){return cb(report)})}}(this))["finally"](function(_this){return function(){return _this.currentSubmission(!0)}}(this))},Executor.prototype.submit=function(contentArray,options){var abortDeferrer,deferred;return null==options&&(options={}),this.contentIsEqual(this.currentSubmission().contentArray,contentArray)?(deferred=this.currentSubmission().deferred,this.recordLastSubmission(deferred,contentArray),deferred.promise):(deferred=$q.defer(),this.recordLastSubmission(deferred,contentArray),this.contentIsEqual(this.lastResult().contentArray,contentArray)&&!options.disable_cache&&deferred.resolve(this.lastResult().report),this.currentSubmission().deferred=deferred,this.currentSubmission().contentArray=contentArray,"client_executor"===this.executorName?this.clientExecutor.submit(contentArray,options).then(function(report){return deferred.resolve(report)})["catch"](function(error){return deferred.reject(error)}):(this.currentSubmission().abortDeferrer&&!options.disable_request_canceling&&this.currentSubmission().abortDeferrer.resolve(),abortDeferrer=$q.defer(),this.currentSubmission().abortDeferrer=abortDeferrer,this.remoteExecutor.submit(contentArray,abortDeferrer.promise,options).then(function(report){return deferred.resolve(report)})["catch"](function(error){return deferred.reject(error)})),deferred.promise)},Executor}()}])}.call(this),function(){angular.module("campusServices").factory("ExecutorData",["Logger","CampusApi","FeedItemPresenter",function(Logger,CampusApi,FeedItemPresenter){var ExecutorData;return ExecutorData=function(){function ExecutorData(courseIdentifier,queryString){this.courseIdentifier=courseIdentifier,this.queryString=queryString}return ExecutorData.prototype.populateExecutorData=function(){var feedPresenter,params;return params={query_string:this.queryString,course_identifier:this.courseIdentifier,service:"executor",service_method:"get_executor_data"},this.defaultFeedPopulated=!0,Logger.info("Fetching executor data from the server"),feedPresenter=new FeedItemPresenter(this.courseIdentifier,this.queryString),new CampusApi(params.course_identifier).get({params:params}).success(function(_this){return function(data){return _this.executorData=data,_.each(data.attempts,function(attempt){return this.addAttempt(feedPresenter.testCaseFeedItem(attempt))})}}(this)).error(function(){return function(){return Logger.info("Fetching executor data from the server failed")}}(this))},ExecutorData.prototype.addAttempt=function(attempt){return this.attempts=_.flatten([attempt,this.attempts])},ExecutorData.prototype.getAttempts=function(){return this.defaultFeedPopulated||this.populateExecutorData(),this.attempts},ExecutorData.prototype.get=function(){return this.defaultFeedPopulated||this.populateExecutorData(),this.executorData},ExecutorData}()}])}.call(this),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}};angular.module("campusServices").factory("ClientExecutor",["$q","CampusUrl","CurrentCourseConfig","ClientExecutorData","ClientExecutorReporter","$timeout",function($q,CampusUrl,CurrentCourseConfig,ClientExecutorData,ClientExecutorReporter){var ClientExecutor,Submission;return Submission=function(){function Submission(sandbox,courseIdentifier,queryString,contentArray,executorData){this.sandbox=sandbox,this.courseIdentifier=courseIdentifier,this.queryString=queryString,this.contentArray=contentArray,this.executorData=executorData,this.runComplete=__bind(this.runComplete,this),this.runError=__bind(this.runError,this),this.process=__bind(this.process,this),this.remove=__bind(this.remove,this),this.deferred=$q.defer(),this.sandbox.on("complete",this.runComplete),this.sandbox.on("error",this.runError),this.sandbox.on("complete",this.remove),this.sandbox.on("error",this.remove),this.reporter=new ClientExecutorReporter(this.courseIdentifier,this.queryString,this.executorData)}return Submission.prototype.remove=function(){return this.sandbox.off("complete",this.runComplete),this.sandbox.off("error",this.runError),this.sandbox.off("complete",this.remove),this.sandbox.off("error",this.remove)},Submission.prototype.process=function(attemptData,failureData,testData){return this.attemptData=attemptData,this.failureData=failureData,this.testData=testData,this.sandbox.run(this.contentArray,this.testData),this.deferred.promise},Submission.prototype.runError=function(error){return this.deferred.reject(error)},Submission.prototype.runComplete=function(data){var report;return report=this.reporter.processReport(data),this.deferred.resolve(report),report},Submission}(),ClientExecutor=function(){function ClientExecutor(courseIdentifier,queryString,executorData){this.courseIdentifier=courseIdentifier,this.queryString=queryString,this.executorData=executorData,this.generateSandboxHtml=__bind(this.generateSandboxHtml,this),this.createSandbox=__bind(this.createSandbox,this),this.remove=__bind(this.remove,this),this.submit=__bind(this.submit,this),this.sandbox=null,new CurrentCourseConfig(this.courseIdentifier).data().then(function(_this){return function(configData){return _this.configData=configData}}(this))}return ClientExecutor.prototype.submit=function(contentArray,options){return null==options&&(options={}),this.deferred||(this.deferred=$q.defer()),new ClientExecutorData(this.courseIdentifier,this.queryString).get().then(function(_this){return function(data){var submission,tests;if(options.recycleSandbox)_this.sandbox||(_this.sandbox=_this.createSandbox(data.options));else{if(_this.sandbox)return _this.deferred.promise;_this.sandbox=_this.createSandbox(data.options),_this.sandbox.on("complete",_this.remove),_this.sandbox.on("error",_this.remove)}return submission=new Submission(_this.sandbox,_this.courseIdentifier,_this.queryString,contentArray,_this.executorData),tests=options.tests||data.tests,submission.process(data,data.failures,tests,options).then(function(report){return _this.deferred.resolve(report)})["catch"](function(error){return _this.deferred.reject(error)})["finally"](function(){return _this.deferred=null})}}(this)),this.deferred.promise},ClientExecutor.prototype.remove=function(){return this.sandbox.close(),this.sandbox.off("complete",this.remove),this.sandbox.off("error",this.remove),this.sandbox=null},ClientExecutor.prototype.createSandbox=function(options){return new window.Abecedary(CampusUrl.iframeUrl(),this.generateSandboxHtml(),options)},ClientExecutor.prototype.generateSandboxHtml=function(){return'<!DOCTYPE html>\n<html>\n  <head>\n    <title>Sanbdbox</title>\n  </head>\n  <body>\n    <script src="'+CampusUrl.javascriptUrl(this.configData.sandbox_script)+'"></script>\n  </body>\n</html>'},ClientExecutor}()}])}.call(this),function(){angular.module("campusServices").factory("RemoteExecutor",["$http","RemoteExecutorReporter","$q",function($http,RemoteExecutorReporter,$q){var RemoteExecutor;return RemoteExecutor=function(){function RemoteExecutor(courseIdentifier,queryString,executorData){this.courseIdentifier=courseIdentifier,this.queryString=queryString,this.executorData=executorData,this.reporter=new RemoteExecutorReporter(this.courseIdentifier,this.queryString,this.executorData)}return RemoteExecutor.prototype.submit=function(contentArray,timeout,options){var deferred,params;return null==options&&(options={}),deferred=$q.defer(),params={query_string:this.queryString,course_identifier:this.courseIdentifier,service:"submission",service_method:"post_submission",service_args:JSON.stringify([contentArray,options.tests])},$http({method:"POST",url:"/courses/content/"+params.course_identifier,data:params,timeout:timeout}).success(function(_this){return function(data){return deferred.resolve(_this.reporter.processReport(data))}}(this)).error(function(){return function(data){return deferred.reject(data)}}(this)),deferred.promise},RemoteExecutor}()}])}.call(this),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}};angular.module("campusServices").factory("FeedItemPresenter",["CampusUtil","CurrentContentData","Autolinker","Markdown",function(CampusUtil,CurrentContentData,Autolinker,Markdown){var FeedItemPresenter;return FeedItemPresenter=function(){function FeedItemPresenter(courseIdentifier,queryString,contentData){this.courseIdentifier=courseIdentifier,this.queryString=queryString,this.contentData=contentData,this.buildSubmissionResultHTML=__bind(this.buildSubmissionResultHTML,this)}return FeedItemPresenter.prototype.getHtmlFromElement=function(element){var wrapperElement;return wrapperElement=angular.element("<div></div>"),wrapperElement.append(element),wrapperElement[0].innerHTML},FeedItemPresenter.prototype.buildSubmissionResultHTML=function(submissionResult){var editors,submissionArray;return editors=_.compact(_.flatten([this.contentData.attributes.editor,this.contentData.attributes.editors])),submissionArray=_.map(submissionResult,function(submission){var matchingEditor;return matchingEditor=_.find(editors,function(editor){return editor.file_name===submission.fileName}),(null!=matchingEditor?matchingEditor.locked:void 0)?null:"<h4>"+submission.fileName+"</h4>\n<code-highlight syntax="+submission.codeType+">"+CampusUtil.escapeHTML(submission.code)+"</code-highlight>"}),_.compact(submissionArray).join("\n")},FeedItemPresenter.prototype.recentAttemptFeedItem=function(recentAttempt){var attemptElement,failure,message,submissionResult;return submissionResult=JSON.parse(recentAttempt.submission),recentAttempt.success?attemptElement=angular.element("<feed-item class='feed-item--success' item-title='Recent Successful Attempt'>\n  "+this.buildSubmissionResultHTML(submissionResult)+"\n</feed-item>"):(failure=JSON.parse(recentAttempt.response).failures[0],message=this.isSyntaxError(failure)?_.escape(failure):_.unescape(failure),message.match(/^<.+>.*<\/.+>$/)||(message=_.unescape(Markdown.parse(message.replace(/\\n/g,"\n")))),attemptElement=angular.element("<feed-item class='feed-item--error' item-title='Recent Failing Attempt'>\n  "+this.buildSubmissionResultHTML(submissionResult)+"\n</feed-item>"),attemptElement.prepend(message)),this.getHtmlFromElement(attemptElement)},FeedItemPresenter.prototype.isSyntaxError=function(message){return!!_.unescape(message).match(/^#?<?[A-Za-z0-9]*[Ee]rror:/)},FeedItemPresenter.prototype.usedHintsFeedItems=function(hintAttribute){var self,usedHints,usedHintsElements;return usedHints=hintAttribute.used_hints,self=this,usedHintsElements=_.map(usedHints,function(usedHint){return usedHints.indexOf(usedHint)===hintAttribute.count-1?self.usedAnswerFeedItem(usedHint):self.usedHintFeedItem(usedHint)})},FeedItemPresenter.prototype.usedHintFeedItem=function(hintData){var hintElement;return hintElement=angular.element("<feed-item class='feed-item--hint' item-title='Hint'>\n  <ul></ul>\n</feed-item>"),hintElement.find("> ul").append(_.map(hintData.files,function(file){var el;return el=angular.element('<li>\n  <h3 ng-if="'+!!file.file_name+'">'+file.file_name+"</h3>\n</li>"),file.code&&el.append("<code-highlight syntax='"+CampusUtil.filterSyntax(file.code_type)+"'>"+_.escape(file.code)+"</code-highlight>"),el})),hintElement.prepend(hintData.body),this.getHtmlFromElement(hintElement)},FeedItemPresenter.prototype.usedAnswerFeedItem=function(hintData){var hintElement;return hintElement=angular.element("<feed-item class='feed-item--answer feed-item--hint' item-title='Answer'>\n  <ul></ul>\n</feed-item>"),hintElement.find("> ul").append(_.map(hintData.files,function(file){var el;return el=angular.element('<li>\n  <h3 ng-if="'+!!file.file_name+'">'+file.file_name+"</h3>\n</li>"),file.code&&el.append("<code-highlight syntax='"+CampusUtil.filterSyntax(file.code_type)+"'>"+_.escape(file.code)+"</code-highlight>"),el})),hintElement.prepend(hintData.body),this.getHtmlFromElement(hintElement)},FeedItemPresenter.prototype.incorrectSubmissionFeedItem=function(submissionResult){var failure,failureName,hint,message,submissionElement;return failure=submissionResult.htmlMessage(),message=this.isSyntaxError(failure)?_.escape(failure):_.unescape(failure),failureName=submissionResult.firstFailure.title,failure=submissionResult.failures[failureName],hint=null!=failure?failure.hint:void 0,message=message.replace(/\$/g,"&#36"),message=Autolinker.link(message),submissionElement=angular.element("<feed-item class='feed-item--error incorrect-submission' item-title='Incorrect Submission'>\n  <!--"+this.buildSubmissionResultHTML(submissionResult.submission)+"-->\n  <adaptive-hint>\n  </adaptive-hint>\n</feed-item>"),submissionElement.find("adaptive-hint").html(hint),submissionElement.prepend(message),this.getHtmlFromElement(submissionElement)},FeedItemPresenter.prototype.correctSubmissionFeedItem=function(submissionResult){var submissionElement;return submissionElement=angular.element("<feed-item class='feed-item--success' item-title='Correct Submission'>\n  "+this.buildSubmissionResultHTML(submissionResult.submission)+"\n</feed-item>"),this.getHtmlFromElement(submissionElement)},FeedItemPresenter}()}])}.call(this),function(){angular.module("campusServices").factory("GoogleAnalytics",function(){var GoogleAnalytics;return GoogleAnalytics=function(){function GoogleAnalytics(){}return GoogleAnalytics.skipLoad=!0,GoogleAnalytics.load=function(trackers){this.trackers=trackers},GoogleAnalytics.trackCoursePageview=function(courseIdentifier,queryString){var fullQuery;return this.skipLoad?this.skipLoad=!1:(fullQuery="/courses/"+courseIdentifier+"/"+queryString,_.each(this.trackers,function(_this){return function(tracker){return window._gaq.push([""+_this._uniqueIdentifier(tracker.id)+"._trackPageview",_this._buildQuery(tracker,fullQuery)])}}(this)))},GoogleAnalytics._uniqueIdentifier=function(trackerID){return trackerID.replace(/-/g,"").toLowerCase()},GoogleAnalytics._buildQuery=function(tracker,query){var e;try{return tracker.path_modifier.replace("%{path}",query)}catch(_error){return e=_error,query}},GoogleAnalytics}()})}.call(this),function(){angular.module("campusServices").factory("HintsData",["CampusApi","$q","Logger",function(CampusApi,$q){var HintsData;return HintsData=function(){function HintsData(){}return HintsData.prototype.getNextHint=function(courseIdentifier,queryString){var deferred;return deferred=$q.defer(),this._fetchNextHintData(courseIdentifier,queryString,deferred),deferred.promise},HintsData.prototype._fetchNextHintData=function(courseIdentifier,queryString,deferred){var params;return params={query_string:queryString,course_identifier:courseIdentifier,service:"hints",service_method:"get_next_hint_data"},new CampusApi(params.course_identifier).get({params:params}).success(function(){return function(data){return deferred.resolve(data)}}(this)).error(function(){return function(data){return deferred.reject(data)}}(this))},HintsData}()}])}.call(this),function(){angular.module("campusServices").factory("KeyboardShortcuts",function(){return{key:window.key,unbind:window.key.unbind}})}.call(this),function(){angular.module("campusServices").factory("LoadQueue",["$q",function($q){var LoadQueue;return LoadQueue=function(){function LoadQueue(){window._loadQueue||(window._loadQueue={})}return LoadQueue.prototype.preloadingObjects=function(){return window._loadQueue},LoadQueue.prototype.getDeferred=function(courseIdentifier,dbKey){return this.preloadingObjects()[this._queKey(courseIdentifier,dbKey)]||(this.preloadingObjects()[this._queKey(courseIdentifier,dbKey)]={deferred:$q.defer(),hasLoaded:!1},this.preloadingObjects()[this._queKey(courseIdentifier,dbKey)].deferred.promise["finally"](function(_this){return function(){return _this._deletePreloadObject(courseIdentifier,dbKey)}}(this))),this.preloadingObjects()[this._queKey(courseIdentifier,dbKey)].deferred},LoadQueue.prototype.isLoadingFor=function(courseIdentifier,dbKey){return this.preloadingObjects()[this._queKey(courseIdentifier,dbKey)]&&this.preloadingObjects()[this._queKey(courseIdentifier,dbKey)].hasLoaded},LoadQueue.prototype.load=function(courseIdentifier,dbKey){return this.preloadingObjects()[this._queKey(courseIdentifier,dbKey)].hasLoaded=!0},LoadQueue.prototype._deletePreloadObject=function(courseIdentifier,dbKey){return delete this.preloadingObjects()[this._queKey(courseIdentifier,dbKey)]},LoadQueue.prototype._queKey=function(courseIdentifier,dbKey){return""+courseIdentifier+"-"+dbKey},LoadQueue}()}])}.call(this),function(){angular.module("campusServices").factory("LocalStorageCache",["$parse","$q",function(){var LocalStorageCache;return LocalStorageCache=function(){function LocalStorageCache(cacheNamespace,disableLocalStorage){null==disableLocalStorage&&(disableLocalStorage=!1),this.cacheNamespace=cacheNamespace,this.disableLocalStorage=disableLocalStorage,this.cacheApi().initializeCache()}return LocalStorageCache.prototype.cacheNamespace="",LocalStorageCache.prototype.cache={},LocalStorageCache.prototype.localStorageExists=function(){var e;try{return!(null===window.localStorage||!window.localStorage)}catch(_error){return e=_error,!1}},LocalStorageCache.prototype.cacheKey=function(courseIdentifier,label){return""+courseIdentifier+":"+this.cacheNamespace+":"+label},LocalStorageCache.prototype.clearData=function(courseIdentifier,label){return delete this.cache[this.cacheKey(courseIdentifier,label)]},LocalStorageCache.prototype.cachePuts=function(courseIdentifier,label,data){var error;if(data&&"null"!==data){try{this.cache[this.cacheKey(courseIdentifier,label)]=JSON.stringify(data)}catch(_error){error=_error,this.deleteOldestCourseData,this.cachePuts(courseIdentifier,label,data)}return this.updateOrdering(courseIdentifier),data}},LocalStorageCache.prototype.updateOrdering=function(courseIdentifier){var orderingArray,orderingJson;if(courseIdentifier)return orderingJson=this.cache._dataOrdering||"[]",orderingArray=JSON.parse(orderingJson),orderingArray.indexOf(courseIdentifier)<0?(orderingArray.push(courseIdentifier),this.cache._dataOrdering=JSON.stringify(orderingArray)):void 0},LocalStorageCache.prototype.deleteOldestCourseData=function(){var oldestEntry,orderingArray;return orderingArray=JSON.parse(this.cache._dataOrdering),oldestEntry=orderingArray.shift(),this.clearCourse(oldestEntry)},LocalStorageCache.prototype.deleteCourseFromOrdering=function(courseIdentifier){var courseIdentifierIndex,orderingArray,orderingJson;return orderingJson=this.cache._dataOrdering||"[]",orderingArray=JSON.parse(orderingJson),courseIdentifierIndex=orderingArray.indexOf(courseIdentifier),courseIdentifierIndex>-1&&orderingArray.splice(courseIdentifierIndex,1),this.cache._dataOrdering=JSON.stringify(orderingArray)},LocalStorageCache.prototype.cacheGet=function(courseIdentifier,queryString){var cachedValue;return cachedValue=this.cache[this.cacheKey(courseIdentifier,queryString)],cachedValue&&JSON.parse(cachedValue)},LocalStorageCache.prototype.clearCourse=function(courseIdentifier){var key,keyArray,regExp;keyArray=[],regExp=new RegExp(""+courseIdentifier+":[^,]*"),this.deleteCourseFromOrdering(courseIdentifier);for(key in this.cache)key.match(regExp)&&keyArray.push(key);return this.cacheApi().clearKeys(keyArray)},LocalStorageCache.prototype.clear=function(){return this.cacheApi().clear()},LocalStorageCache.prototype.cacheApi=function(){return this.localStorageExists()&&!this.disableLocalStorage?this._localStorageMethods():this._globalHashMethods()},LocalStorageCache.prototype._localStorageMethods=function(){return{initializeCache:function(_this){return function(){return _this.cache=localStorage}}(this),clear:function(_this){return function(){return _this.cache.clear()}}(this),clearKeys:function(){return function(keys){return _.each(keys,function(key){return localStorage.removeItem(key)}),keys}}(this)}},LocalStorageCache.prototype._globalHashMethods=function(){return{initializeCache:function(_this){return function(){return window.campusStorage||(window.campusStorage={}),_this.cache=window.campusStorage}}(this),clear:function(){return function(){return window.campusStorage={}}}(this),clearKeys:function(){return function(keys){return _.each(keys,function(key){return delete window.campusStorage[key]}),keys}}(this)}},LocalStorageCache}()}])}.call(this),function(){angular.module("campusServices").factory("Markdown",function(){return{parse:function(text){return markdown.toHTML(text)}}})}.call(this),function(){angular.module("campusServices").factory("OpenModal",["$rootScope",function(){return{isOpen:function(_this){return function(cb){return _this.isOpenCb=cb}}(this),open:function(_this){return function(options,modalContent){return null==options&&(options={}),options.content=modalContent,options.title||(options.title=""),options.htmlClass||(options.htmlClass=""),options.fullScreen||(options.fullScreen=!1),options.clear||(options.clear=!1),options.scope||(options.scope=null),_this.isOpenCb?_this.isOpenCb(options):void 0}}(this),isClose:function(_this){return function(cb){return _this.isCloseCb=cb}}(this),close:function(_this){return function(options){return null==options&&(options={}),options.clear||(options.clear=!1),_this.isCloseCb?_this.isCloseCb(options):void 0}}(this),scroll:function(_this){return function(value){return _this.scrollingCb?_this.scrollingCb(value):void 0}}(this),isScrolling:function(_this){return function(cb){return _this.scrollingCb=cb}}(this)}}])}.call(this),function(){angular.module("campusServices").factory("RailsAssets",["$templateCache",function($templateCache){var assetManifest;return assetManifest=JSON.parse($templateCache.get("_assetManifest")),{path:function(){return function(assetName){return assetManifest&&assetManifest[assetName]?assetManifest[assetName]:assetName}}(this)}}])}.call(this),function(){angular.module("campusServices").factory("RedirectManager",["$templateCache","$state","$location",function($templateCache){var RedirectManager;
return RedirectManager=function(){function RedirectManager(courseIdentifier,queryString){this.courseIdentifier=courseIdentifier,this.queryString=queryString}return RedirectManager.prototype.templateIndexId="_courseTemplateIndex",RedirectManager.prototype.checkforRedirect=function(){var redirectUrl,templateIndex,templateName;return templateIndex=JSON.parse($templateCache.get(this.templateIndexId)),templateName=templateIndex[this.queryString],redirectUrl=templateName.match(/redirect\((.*)\)/),redirectUrl?(redirectUrl=redirectUrl[1],window.location.href=redirectUrl,!0):!1},RedirectManager}()}])}.call(this),function(){angular.module("campusServices").factory("RemoteExecutorReporter",["ClientExecutorData","$interpolate","Markdown",function(ClientExecutorData,$interpolate,Markdown){var RemoteExecutorReporter,Report;return Report=function(){function Report(report,failures,failureMessages,replaceErrorMessageData){this.report=report,this.failures=failures,this.failureMessages=failureMessages,this.replaceErrorMessageData=replaceErrorMessageData,this.firstFailure=this.report.failures[0]}return Report.prototype.toJson=function(){return this.report},Report.prototype.success=function(){return 0===this.report.failures.length},Report.prototype.htmlMessage=function(){var m;return m=this.message(),m.match(/^<.+>.*<\/.+>$/)?m:Markdown.parse(m.replace(/\\n/g,"\n"))},Report.prototype.filterExceptions=function(message){var filteredData;return message=message.replace(/<script>/,"&lt;script&gt;"),filteredData=message.match(/^#.*[Ee]rror:([\s\S]*)>/),filteredData?filteredData[1]:message},Report.prototype.message=function(){var errFunc,errorMessage;if(!this.success())return errorMessage=this.report.failures[0],this.failureMessages[errorMessage]&&(errorMessage=this.failureMessages[errorMessage]),errFunc=$interpolate(errorMessage),this.filterExceptions(errFunc(this.failureMessages))},Report}(),RemoteExecutorReporter=function(){function RemoteExecutorReporter(courseIdentifier,queryString,executorData){this.courseIdentifier=courseIdentifier,this.queryString=queryString,this.executorData=executorData,new ClientExecutorData(this.courseIdentifier,this.queryString).get().then(function(_this){return function(data){return _this.executorData||(_this.executorData=data),_this.replaceErrorMessageData=_this.executorData.replace_error_messages,_this.failures=_this.executorData.failures,_this.failureMessages={},_.each(_this.executorData.failures,function(failure,key){return _this.failureMessages[key]=failure.message})}}(this))}return RemoteExecutorReporter.prototype.processReport=function(report){return this.failures?new Report(report,this.failures,this.failureMessages,this.replaceErrorMessageData):void 0},RemoteExecutorReporter}()}])}.call(this),function(){angular.module("campusServices").factory("SublimeLoader",["$q",function($q){var isLoaded,loadingDeferred;return isLoaded=!1,loadingDeferred=$q.defer(),{load:function(){return function(playerUrl){return isLoaded||(isLoaded=!0,$.getScript(playerUrl).done(function(){return loadingDeferred.resolve()}).fail(function(){return isLoaded=!1,loadingDeferred.reject()})),loadingDeferred.promise}}(this)}}])}.call(this),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}};angular.module("campusServices").factory("Submitter",["CurrentSubmitData","CurrentContentData","Executor","AttemptData","$q","FlashMessage",function(CurrentSubmitData,CurrentContentData,Executor,AttemptData,$q,FlashMessage){var Submitter;return Submitter=function(){function Submitter(courseIdentifier,queryString,options){this.courseIdentifier=courseIdentifier,this.queryString=queryString,this.options=options,this.submit=__bind(this.submit,this),this.currentContent=new CurrentContentData(this.courseIdentifier,this.queryString),this.submitContentService=new CurrentSubmitData(this.courseIdentifier,this.queryString),this.executorService=new Executor(this.courseIdentifier,this.queryString),this.attemptService=new AttemptData(this.courseIdentifier,this.queryString),this.currentContent.totalAvailablePoints().then(function(_this){return function(points){return _this.points=points}}(this)),void 0===this.options.useFlashSuccess&&(this.options.useFlashSuccess=!0)}return Submitter.prototype.cleanUp=function(){return this.executorService.cleanUp()},Submitter.prototype.showSuccessFlash=function(){var title;return title=this.progress<100?"Success! <span class='flash-label'>+"+this.points+" pts.</span>":"Success!",FlashMessage.show({htmlClass:"flash--success",closeButton:!1,closeDelay:2200,message:null,title:title})},Submitter.prototype.showErrorFlash=function(errorMessage){return FlashMessage.show({htmlClass:"flash--error",closeButton:!0,closeDelay:1e6,title:"Incorrect Submission",message:_.unescape(errorMessage)})},Submitter.prototype.submit=function(scope,options){var deferred,self;return deferred=$q.defer(),self=this,scope.$emit("submission:start",{courseIdentifier:this.courseIdentifier,queryString:this.queryString}),this.currentContent.data().then(function(_this){return function(contentData){var executorData,submitContent;return executorData=contentData.attributes.executor,_this.progress=contentData.progress,submitContent=_this.submitContentService.getContent(),_this.executorService.submit(submitContent,options).then(function(report){var syntax;return syntax=executorData.code_type,_this.attemptService.recordAttempt(report,submitContent).then(function(){return report.success()?_this.currentContent.refreshAllData(scope):void 0}),report.success()?(scope.$emit("submission:success",{result:report,executorData:executorData,courseIdentifier:_this.courseIdentifier,queryString:_this.queryString}),_this.options.useFlashSuccess&&_this.showSuccessFlash(),deferred.resolve({report:report,executorData:executorData})):(scope.$emit("submission:fail",{result:report,executorData:executorData,courseIdentifier:_this.courseIdentifier,queryString:_this.queryString}),_this.options.useFlashError&&_this.showErrorFlash(report.message()),deferred.resolve({report:report,executorData:executorData}))})["catch"](function(err){return deferred.reject(err)})["finally"](function(){return scope.$emit("submission:end",{courseIdentifier:this.courseIdentifier,queryString:this.queryString}),scope.$emit("page:submit")}),deferred.promise}}(this))},Submitter}()}])}.call(this),function(){angular.module("campusServices").factory("TaskData",["CampusApi","$q","Logger",function(CampusApi,$q){var TaskData;return TaskData=function(){function TaskData(){}return TaskData.prototype.getTaskData=function(courseIdentifier,queryString,taskName){var deferred;return deferred=$q.defer(),this._fetchTaskData(courseIdentifier,queryString,taskName,deferred),deferred.promise},TaskData.prototype._fetchTaskData=function(courseIdentifier,queryString,taskName,deferred){var params;return params={query_string:queryString,course_identifier:courseIdentifier,service:"tasks",service_method:"get_task_data",service_args:taskName},new CampusApi(params.course_identifier).get({params:params}).success(function(){return function(data){return deferred.resolve(data)}}(this)).error(function(){return function(data){return deferred.reject(data)}}(this))},TaskData}()}])}.call(this),function(){angular.module("campusServices").factory("TemplateIndex",["$templateCache",function($templateCache){var templateIndex;return templateIndex=JSON.parse($templateCache.get("_courseTemplateIndex")),{data:function(){return templateIndex}}}])}.call(this),function(){angular.module("campusServices").factory("TemplateRender",["$templateCache","$state","CurrentContentData",function($templateCache,$state,CurrentContentData){var TemplateRender;return TemplateRender=function(){function TemplateRender(courseIdentifier,queryString){this.courseIdentifier=courseIdentifier,this.queryString=queryString}return TemplateRender.prototype.templateIndexId="_courseTemplateIndex",TemplateRender.prototype.currentContent=function(){return this.currentContentData||(this.currentContentData=new CurrentContentData(this.courseIdentifier,this.queryString))},TemplateRender.prototype.checkForStateChange=function(){var templateIndex,templateName,templateQueryString;return templateIndex=JSON.parse($templateCache.get(this.templateIndexId)),templateQueryString=this.attemptToFindTemplateQueryString(templateIndex),templateName=templateIndex[templateQueryString],this.templateFromRender(templateName)?void 0:this.recoverFromUnknownUrl(templateQueryString)},TemplateRender.prototype.attemptToFindTemplateQueryString=function(templateIndex){var foundPaths,templateName,templatePaths;for(templateName=templateIndex[this.queryString],templatePaths=Object.keys(templateIndex),foundPaths=[this.queryString];!templateName&&0!==this.queryString.length;)foundPaths=_.select(templatePaths,function(path){return path.match(queryString)}),this.queryString=this.queryString.split("/"),this.queryString.pop(),this.queryString=this.queryString.join("/"),templateName=templateIndex[foundPaths[0]];return templateIndex[foundPaths[0]]?foundPaths[0]:this.courseIdentifier},TemplateRender.prototype.templateFromRender=function(templateName){var renderTarget,renderTemplate;return renderTemplate=templateName.match(/render\((.*)\)/),renderTemplate?(renderTarget=renderTemplate[1],this.currentContent().preloadData(renderTarget).then(function(){return $state.go("root.courseContent",{queryString:renderTarget},{location:"replace"})}),!0):!1},TemplateRender.prototype.recoverFromUnknownUrl=function(templateQueryString,originalQueryString){return templateQueryString!==originalQueryString?this.currentContent().preloadData(templateQueryString).then(function(){return $state.go("root.courseContent",{queryString:templateQueryString},{location:"replace"})}):void 0},TemplateRender}()}])}.call(this),function(){angular.module("campusServices").factory("UserCreation",["CurrentContentData","CurrentUserData",function(CurrentContentData,CurrentUserData){var UserCreation;return UserCreation=function(){function UserCreation(courseIdentifier,queryString){this.courseIdentifier=courseIdentifier,this.queryString=queryString}return UserCreation.prototype.ensureUserCreated=function(force){var courseIdentifier;return null==force&&(force=!1),courseIdentifier=this.courseIdentifier,new CurrentContentData(courseIdentifier,this.queryString).data().then(function(data){return data.attributes.required||force?new CurrentUserData(courseIdentifier).ensureUserExists(courseIdentifier):void 0})},UserCreation}()}])}.call(this),function(){angular.module("campusServices").factory("UserData",["$http","$q","Logger","LocalStorageCache",function($http,$q,Logger,LocalStorageCache){var UserData;return UserData=function(){function UserData(){}return UserData.prototype.cacheKey="_userData",UserData.prototype.cache=new LocalStorageCache("user",!0),UserData.prototype.fetchingPromise=null,UserData.prototype.createVisitor=function(){var deferred;return deferred=$q.defer(),$http({method:"POST",url:"/session"}).success(function(){return function(data){return deferred.resolve(data)}}(this)).error(function(){return function(data){return deferred.reject(data)}}(this)),deferred.promise},UserData.prototype.getUser=function(courseIdentifier){var cachedData,deferred;return this.fetchingPromise?this.fetchingPromise.promise:(deferred=$q.defer(),cachedData=this.cache.cacheGet(courseIdentifier,this.cacheKey),cachedData?deferred.resolve(cachedData):(Logger.info("Fetching user data for "+courseIdentifier+" from the server"),this._fetchUserData(courseIdentifier,deferred)),deferred.promise)},UserData.prototype.refreshUser=function(courseIdentifier){return Logger.info("Refreshing cached user data for "+courseIdentifier),this.cache.clearData(courseIdentifier,this.cacheKey),this.getUser(courseIdentifier)},UserData.prototype.preloadData=function(courseIdentifier,data){var cachedData;return cachedData=this.cache.cacheGet(courseIdentifier,this.cacheKey),data?(this.cache.cachePuts(courseIdentifier,this.cacheKey,data),Logger.info("Bootstrap User data for "+courseIdentifier+" preloaded successfully")):cachedData?void 0:this.getUser(courseIdentifier).then(function(){return Logger.info("User Data for: "+courseIdentifier+" preload successful")})["catch"](function(){return Logger.info("User Data for: "+courseIdentifier+" preload failed")})},UserData.prototype.updateLastPageViewed=function(url,courseIdentifier){var deferred;return deferred=$q.defer(),this.getUser(courseIdentifier).then(function(userData){var params;if(userData)return params={run_through:{last_page_viewed:url}},$http({method:"PUT",url:"/run_throughs/"+userData.current_run_through.id,params:params}).success(function(){return function(data){return deferred.resolve(data)}}(this)).error(function(){return function(data){return deferred.reject(data)}}(this))}),deferred.promise},UserData.prototype._fetchUserData=function(courseIdentifier,deferred){var params;return params={query_string:"/",course_identifier:courseIdentifier,service:"content_data",service_method:"get_user_data"},this.fetchingPromise=deferred,$http({method:"GET",url:"/courses/content/"+params.course_identifier,params:params}).success(function(_this){return function(data){var fetchingPromise;return"null"===data&&(data=null),deferred.resolve(data),_this.cache.cachePuts(courseIdentifier,_this.cacheKey,data),fetchingPromise=null}}(this)).error(function(){return function(data){var fetchingPromise;return deferred.reject(data),fetchingPromise=null}}(this))},UserData}()}])}.call(this),function(){angular.module("campusTemplateDirectives",[])}.call(this),function(){angular.module("campusTemplateDirectives").directive("achievementsList",["CampusUrl","CurrentUserData",function(CampusUrl,CurrentUserData){return{restrict:"E",replace:!0,scope:!0,template:"<ul class='achievementList'>\n  <li ng-repeat='achievement in userData.achievements.awarded' class='achievementList-item is-awarded'>\n    <div class='achievementList-item-inner'>\n      <div class='achievementList-item-media'>\n        <div class='badge'>\n          <img class='badge-img' ng-src='{{badgeUrl(achievement.badge)}}' alt='badge for achievement {{achievement.name}}'/>\n        </div>\n      </div>\n      <div class='achievementList-item-content'>\n        <h3 class='achievementList-item-title' ng-if='!!achievement.name'>{{achievement.name}}</h3>\n        <p class='achievementList-item-desc'>{{achievement.description}}</p>\n      </div>\n    </div>\n  </li>\n  <li ng-repeat='achievement in userData.achievements.unawarded' class='achievementList-item'>\n    <div class='achievementList-item-inner'>\n      <div class='achievementList-item-media'>\n        <div class='badge'>\n          <img class='badge-img' ng-src='{{badgeUrl(placeholder)}}' alt='placeholder badge'/>\n        </div>\n      </div>\n      <div class='achievementList-item-content'>\n        <h3 class='achievementList-item-title'>{{achievement.name}}</h3>\n        <p class='achievementList-item-desc'>{{achievement.description}}</p>\n      </div>\n    </div>\n  </li>\n</ul>",link:function(scope,element,attrs){return scope.placeholder=attrs.placeholder||"placeholder.png",scope.badgeUrl=function(path){return CampusUrl.badgeUrl(path)},new CurrentUserData(scope.courseIdentifier).data().then(function(userData){return scope.userData=userData}),scope.$on("page:update:user",function(evt,userData){return scope.userData=userData})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("activityPanel",function(){return{replace:!0,restrict:"E",scope:!0,transclude:!0,controller:["$scope","$timeout",function($scope){return this.fullscreen=function(isFullscreen){return isFullscreen?$scope.$emit("page:editor:fullscreen"):$scope.$emit("page:editor:collapse"),$scope.fullscreen=isFullscreen},this.collapse=function(){return $scope.collapsed=!0},this.expand=function(){return $scope.collapsed=!1},this}],template:'<div class="panel panel--activity panelList" ng-class=\'{"is-fullscreen": fullscreen, "is-collapsed": collapsed}\' ng-transclude>\n\n</div>',link:function(scope,element){return element.hasClass("is-collapsed")&&(scope.collapsed=!0),scope.$on("editor:fixed",function(){return element.addClass("is-fixed"),element.css({top:""})}),scope.$on("editor:notFixed",function(evt,eventData){return element.removeClass("is-fixed"),eventData.top?element.css({top:eventData.top}):void 0})}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("panelElement",["$compile",function($compile){return{restrict:"E",replace:!0,transclude:!0,require:"^activityPanel",scope:!0,controller:["$scope",function($scope){return this.fullScreenOff=function(){return $scope.disableFullScreen()},this}],template:"<div class='panel panelList-item' ng-class=\"{'is-fullscreen': isFullScreen}\">\n  <a href='' class='panelList-item-toggle panel-toggle toggle' ng-click='toggleFullscreen()' ng-if='controls.indexOf(\"fullscreen\") > -1'>\n    <b class='srt'>Fullscreen</b>\n  </a>\n</div>",link:function(scope,element,attrs,activityPanelCtrl,transclude){return scope.controls=attrs.controls.split(/\s?,\s?/),scope.cachedTotalElements=0,scope.cachedIndex=0,scope.isFullScreen=!1,transclude(scope,function(clonedElement){var childScope;return childScope=scope.$new(),element.append($compile(clonedElement)(childScope))}),scope.disableFullScreen=function(){return scope.isFullScreen=!1,activityPanelCtrl.fullscreen(!1),scope.index=scope.cachedIndex,scope.totalElements=scope.cachedTotalElements},scope.toggleFullscreen=function(){scope.isFullScreen?scope.disableFullScreen():(scope.isFullScreen=!0,activityPanelCtrl.fullscreen(!0),scope.cachedIndex=scope.index,scope.index=0,scope.cachedTotalElements=scope.totalElements,scope.totalElements=1)}}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("panelTabControls",["$timeout",function($timeout){return{restrict:"A",require:"^activityPanel",link:function(scope,element,attrs,activityPanelCtrl){return element.on("click",function(evt){return $timeout(function(){return $(evt.target).hasClass("is-open")?(activityPanelCtrl.collapse(),$(evt.target).removeClass("is-open")):(activityPanelCtrl.expand(),$(element).find(".is-open").removeClass("is-open"),$(evt.target).addClass("is-open"))})}),scope.$on("#destroy",function(){return element.off()})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("adaptiveHint",["$timeout",function(){return{replace:!0,restrict:"E",scope:!0,transclude:!0,template:"<div class=\"adaptive-hint\" ng-show=\"hint\">\n  <a href='' class='btn btn--hint' ng-click='showHint()' ng-hide=\"shownHint\">\n    <span class='loader-text'>Use A Hint</span>\n  </a>\n  <div class='hint-content' ng-show=\"shownHint\"></div>\n</div>",link:function(scope,element,attrs,ctrl,transclude){var hintContentEl;return scope.shownHint=void 0===scope.$parent.shownHint?!1:scope.shownHint,hintContentEl=element.find(".hint-content"),transclude(scope,function(clonedElement){return 0===$(clonedElement).text().replace(/\s/g,"").length||!clonedElement.text()||clonedElement.text().match(/^\s*undefined\s*$/g)?(scope.hint=null,clonedElement.empty(),clonedElement.remove(),clonedElement=null,scope.shownHint=!0):(scope.hint=!0,hintContentEl.empty(),hintContentEl.append(clonedElement))}),scope.showHint=function(){return scope.shownHint=!0,void 0!==scope.$parent.shownHint?scope.$parent.shownHint=!0:void 0}}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("adaptiveHints",function(){return{replace:!0,restrict:"E",scope:!0,template:"<div class=\"card card--error mbm\" ng-show=\"errorMessage\">\n  <h3>Error</h3>\n  <p ng-bind-html=\"errorMessage\"></p>\n  <a href='' class='btn btn--hint' ng-show='hint' ng-click='showHint()'>\n    <span class='loader-text'>Use A Hint</span>\n  </a>\n  <span ng-bind-html=\"shownHint\"></span>\n</div>",link:function(scope){return scope.$on("submission:success",function(){return scope.errorMessage=null,scope.shownHint="",scope.hint=null}),scope.$on("submission:fail",function(evt,submissionData){var failure,failureName;return failureName=submissionData.result.firstFailure.title,scope.errorMessage=submissionData.result.message(),scope.shownHint=null,failure=submissionData.executorData.failures[failureName],scope.hint=failure&&failure.hint?failure.hint:null}),scope.showHint=function(){return scope.shownHint=scope.hint,scope.hint=null}}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("badgeCount",function(){return{replace:!0,restrict:"E",scope:!0,template:"<span>{{badgeCount}}</span>",link:function(scope){return scope.currentContent.courseAchievements().then(function(achievements){return scope.badgeCount=achievements.length||0})}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("badgeList",["CampusUrl",function(CampusUrl){return{replace:!0,restrict:"E",scope:!0,template:'<ol class="badgeList">\n  <li class="badgeList-item" ng-repeat="achievement in achievements">\n    <div class="badge">\n      <img class="badge-img" ng-src="{{badgeUrl(achievement.badge)}}" alt="{{achievement.name}}" />\n    </div>\n  </li>\n</ol>',link:function(scope){return scope.currentContent.courseAchievements().then(function(achievements){return scope.achievements=achievements}),scope.badgeUrl=function(badge){return CampusUrl.badgeUrl(badge)}}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("badgeProgress",["DrawBadgeProgress",function(DrawBadgeProgress){return{replace:!1,restrict:"A",scope:!0,link:function(scope,element,attrs){var badgeProgress;return badgeProgress=new DrawBadgeProgress,scope.$watch(attrs.badgeProgress,function(progress){return void 0!==progress?badgeProgress.init({element:element[0],progress:progress,delay:1e3,radius:55}):void 0})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("burnedAttempts",["$compile",function(){return{replace:!0,restrict:"E",scope:!0,template:'  <div ng-show=\'filesExist()\' ng-class=\'{"is-pending": codeState == "is-pending", "is-correct": codeState == "is-correct", "is-incorrect": codeState == "is-incorrect"}\'>\n    <ul class=\'fileList\'>\n      <li class=\'fileList-item\' ng-repeat="file in files">\n        <p class=\'fileList-item-title\'>{{file.file_name || file.fileName}}</p>\n        <div class=\'fileList-item-content\'>\n          <textarea syntax="{{file.syntax || file.codeType}}" theme="{{file.theme}}" bind-options="file.editorOptions" convert-to-codemirror>\n{{file.content || file.code}}\n          </textarea>\n        </div>\n      </li>\n    </ul>\n  </div>',link:function(scope,element,attrs){var convertLockedLinesToCollapsed,getMultiLineOffsetIndex,multiIndexOf,showStartingFiles;return showStartingFiles=attrs.showStartingFiles,multiIndexOf=function(array,item){var indexes;return indexes=[],_.each(array,function(arrayItem,index){return arrayItem===item?indexes.push(index):void 0}),indexes},getMultiLineOffsetIndex=function(fromArray,referenceArray,referenceFromIndex,referenceToIndex){var indexes,range,trueArray,trueIndex;return indexes=multiIndexOf(fromArray,referenceArray[referenceFromIndex]),1===indexes.length?indexes[0]:(range=_.range(referenceToIndex-referenceFromIndex),trueArray=_.map(indexes,function(index){return _.every(range,function(i,rangeIndex){return fromArray[index+rangeIndex]===referenceArray[referenceFromIndex+rangeIndex]})}),trueIndex=trueArray.indexOf(!0),trueIndex>=0?indexes[trueIndex]:0)},convertLockedLinesToCollapsed=function(file,editor){var collapseOptions,editorLines,fileLines,lockedLineOptions;return editorLines=editor.content.split("\n"),fileLines=file.code.split("\n"),editorLines.length>10?(lockedLineOptions=_.filter(editor.marked_content,function(markedContent){return markedContent.options.readOnly}),collapseOptions=_.map(lockedLineOptions,function(lockOption){var editorEndLine,editorStartingLine,fileLineIndex,fromLine,lineOffset,toCh,toLine,_ref,_ref1;return fromLine=lockOption.from[0],toLine=(null!=(_ref=lockOption.to)?_ref[0]:void 0)||fromLine,editorStartingLine=editorLines[fromLine],editorEndLine=editorLines[toLine],fileLineIndex=getMultiLineOffsetIndex(fileLines,editorLines,fromLine,toLine),lineOffset=fileLineIndex-fromLine,fromLine=fileLineIndex,toLine+=lineOffset,0!==lockOption.from[1]&&(fromLine+=1),(null!=(_ref1=lockOption.to)?_ref1[1]:void 0)&&editorEndLine.length>lockOption.to[1]&&(toLine-=1),toCh=fileLines[toLine].length,[{line:fromLine,ch:0},{line:toLine,ch:toCh},{collapsed:!0}]})):void 0},scope.$on("page:update:content",function(evt,eventData){return eventData.queryString===scope.queryString?scope.currentContent.data().then(function(contentData){return scope.updateDisplay(contentData)}):void 0}),scope.filesExist=function(){return scope.files&&scope.files.length>0},scope.updateDisplay=function(contentData){var editorAttributes,filesToDisplay,lockedEditors,lockedFileNames,recentAttemptFiles,recentAttemptJson,_ref,_ref1;return editorAttributes=contentData.attributes.editors||[],contentData.attributes.editor&&editorAttributes.push(contentData.attributes.editor),recentAttemptJson=null!=(_ref=contentData.attempts)?null!=(_ref1=_ref.recent_attempt)?_ref1.submission:void 0:void 0,recentAttemptFiles=recentAttemptJson?JSON.parse(recentAttemptJson):[],lockedEditors=_.filter(editorAttributes,function(editor){return editor.locked}),lockedFileNames=_.pluck(lockedEditors,"file_name"),scope.files=[],recentAttemptFiles&&recentAttemptFiles.length>0?(filesToDisplay=_.filter(recentAttemptFiles,function(attemptFile){return lockedFileNames.indexOf(attemptFile.fileName)<0}),scope.files=_.map(filesToDisplay,function(file){return file.editorOptions={readOnly:!0,collapse:convertLockedLinesToCollapsed(file,_.find(editorAttributes,function(editor){return file.fileName===editor.file_name}))},file}),scope.codeState=contentData.attempts.recent_attempt.success?"is-correct":"is-incorrect"):showStartingFiles?(scope.files=_.filter(editorAttributes,function(attemptFile){return lockedFileNames.indexOf(attemptFile.file_name)<0}),scope.codeState="is-pending"):void 0},scope.currentContent.data().then(function(contentData){return scope.updateDisplay(contentData)})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("challengeFeed",["$compile","$timeout","FlashMessage","FeedItemPresenter",function($compile,$timeout,FlashMessage,FeedItemPresenter){return{restrict:"E",replace:!0,scope:!0,template:"<div class='feed'>\n\n</div>",link:function(scope,element,attrs){var compileFeedItem,errorWasScrolled,hintWasScrolled,openFirstItemOnly,scrollToNewFeedItem;return hintWasScrolled=!1,errorWasScrolled=!1,compileFeedItem=function(feedItem){var feedEl,highlightedCode,newFeedItem;return highlightedCode=[],feedEl=$(feedItem),_.each(feedEl.find("code-highlight"),function(el){var jqEl;return jqEl=$(el),highlightedCode.push(jqEl.text()),jqEl.empty()}),feedItem=$("<div></div>").append(feedEl[0]).html(),newFeedItem=$compile(feedItem)(scope),element.prepend(newFeedItem),_.each($(newFeedItem).find(".code-highlight"),function(highlight,index){return $(highlight).text(highlightedCode[index])})},openFirstItemOnly=function(){return $timeout(function(){return element.children().addClass("is-closed"),$(element.children()[0]).removeClass("is-closed")})},scrollToNewFeedItem=function(){return $timeout(function(){return scope.$emit("challengeFeed:scroll",{courseIdentifier:scope.courseIdentifier,queryString:scope.queryString,scrollToElement:element.children()[0]})})},scope.currentContent.data().then(function(data){var feedItem,feedItems,syntax,_ref;return scope.feedPresenter=new FeedItemPresenter(scope.courseIdentifier,scope.queryString,data),data.attributes.hints&&(feedItems=scope.feedPresenter.usedHintsFeedItems(data.attributes.hints),_.each(feedItems,function(feedItem){return compileFeedItem(feedItem)})),(null!=(_ref=data.attempts)?_ref.recent_attempt:void 0)&&(syntax=data.attributes.executor.code_type,feedItem=scope.feedPresenter.recentAttemptFeedItem(data.attempts.recent_attempt,syntax),compileFeedItem(feedItem)),openFirstItemOnly()}),attrs.hideFailures&&"false"!==attrs.hideFailures||scope.$on("submission:fail",function(evt,data){var feedItem;return feedItem=scope.feedPresenter.incorrectSubmissionFeedItem(data.result),compileFeedItem(feedItem),openFirstItemOnly(),errorWasScrolled?void 0:(scrollToNewFeedItem(),errorWasScrolled=!0)}),scope.$on("hints:new",function(evt,data){var feedItem;return feedItem=scope.feedPresenter.usedHintFeedItem(data.data),compileFeedItem(feedItem),openFirstItemOnly(),hintWasScrolled?void 0:(scrollToNewFeedItem(),hintWasScrolled=!0)}),scope.$on("hints:answer",function(evt,data){var feedItem;return feedItem=scope.feedPresenter.usedAnswerFeedItem(data.data),compileFeedItem(feedItem),openFirstItemOnly(),hintWasScrolled?void 0:(scrollToNewFeedItem(),hintWasScrolled=!0)}),scope.$on("page:task:success",function(evt,evtData){return evtData.queryString===scope.queryString?$(element).find(".incorrect-submission").remove():void 0}),scope.$on("$destroy",function(){var displayedFeedData;return displayedFeedData=null})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("clientExecutorTestRunner",["$q","ClientExecutor","Logger","$compile","CampusUtil",function($q,ClientExecutor,Logger,$compile){return{restrict:"E",replace:!0,scope:{},template:"<div class='client-executor-test-runner'>\n  <div id='tests'></div>\n  <div id='details'>\n    <h3></h3>\n    <div></div>\n    <ul id='attempts'></ul>\n  </div>\n</div>",link:function(scope,element){var executor_service,runAttempt;return scope.toggle=function(event){return $(event.target).closest("li").toggleClass("is-expanded")},runAttempt=function(attempt,tests,deferred){var e;attempt.sandbox=(new ClientExecutor).sandbox,attempt.sandbox.on("error",function(){return deferred.reject(attempt.sandbox)}),attempt.sandbox.on("complete",function(report){var firstFailure;return attempt.el.removeClass("test-success").removeClass("test-failure"),console.log("finished running tests: "),console.log(report),tests=attempt.el.find(".tests"),tests.empty(),_.each(report.passes,function(pass){return tests.append("<li class='test-success'>"+pass.title+"</li>")}),_.each(report.failures,function(failure){return tests.append("<li class='test-failure'>"+failure.title+"</li>")}),report.failures.length>0&&(firstFailure=report.failures[0].title),attempt.success?firstFailure?attempt.el.addClass("test-failure"):attempt.el.addClass("test-success"):firstFailure===attempt.message?attempt.el.addClass("test-success"):attempt.el.addClass("test-failure"),deferred.resolve(attempt.sandbox)});try{return attempt.sandbox.run(attempt.files,tests)}catch(_error){return e=_error,deferred.reject(attempt.sandbox)}},executor_service=new ClientExecutor,executor_service.getExecutorData(scope.courseIdentifier,scope.queryString).then(function(data){var attemptElements,debounce,runWrapper,tests;return scope.executorData=data,scope.attempts=data.attempts,attemptElements=_.collect(scope.attempts,function(attempt){return attempt.el=$('<li><input type="checkbox" checked="checked"><p class="objective"></p><pre class="code"></pre><ul class="tests"></ul><a class="btn btn--a btn--thin" href="" ng-click="toggle($event)">Toggle Code for <span class="test_name"></span></a></li>'),attempt.success?attempt.el.find("p.objective").text("Should pass."):attempt.el.find("p.objective").text("Should fail with message").append("<pre>"+attempt.message+"</pre>"),attempt.el.find("span").text(attempt.attempt_name),attempt.el.find("pre.code").data("syntax",attempt.files[0].code_type).text(attempt.files[0].code),attempt.el}),$("#attempts").append(attemptElements),$compile(element.contents())(scope),_.each($("#attempts pre.code"),function(el){var syntax,text;return $(el).data("syntax")?(text=$(el).text(),syntax="text/"+$(el).data("syntax"),CodeMirror.runMode(text,syntax,el),$(el).addClass("CodeMirror"),$(el).addClass("cm-s-default")):void 0}),tests=new CodeMirror($("#tests")[0],{value:scope.executorData.tests,mode:"javascript",indentUnit:2,tabSize:2,theme:"default",lineNumbers:!0,lineWrapping:!0}),debounce=function(func,threshold,execAsap){var debounced,timeout;return timeout=void 0,debounced=function(){var args,delayed,obj;return delayed=function(){return execAsap||func.apply(obj,args),timeout=null},obj=this,args=arguments,timeout?clearTimeout(timeout):execAsap&&func.apply(obj,args),timeout=setTimeout(delayed,threshold||100)}},runWrapper=debounce(function(){return function(){var promiseAttempts;return promiseAttempts=[],_.each(scope.attempts,function(attempt){var deferred;return attempt.el.find("input").is(":checked")?(attempt.el.removeClass("is-outofdate"),deferred=$q.defer(),promiseAttempts.push(deferred.promise),runAttempt(attempt,tests.getValue(),deferred)):attempt.el.addClass("is-outofdate")
}),$q.all(promiseAttempts).then(function(sandboxes){return sandboxes.length>0?sandboxes[0].close():void 0})}}(this),1e3),tests.on("change",runWrapper),runWrapper()})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("codeEditor",["CampusUtil","$q","CurrentCourseConfig","CurrentContentData","CurrentSubmitData","$timeout","Logger",function(CampusUtil,$q,CurrentCourseConfig,CurrentContentData,CurrentSubmitData,$timeout,Logger){return{restrict:"E",replace:!0,scope:!0,template:"<div class='codeEditor-pane' ng-class=\"{'is-locked': isLocked}\"></div>",link:function(scope,element,attrs){var foldLines,markLines,setCursor,submit,submitDataService,_markDataFor,_markDataOption,_markDataOptionReadOnly;return submitDataService=new CurrentSubmitData(scope.courseIdentifier,scope.queryString),submit=function(){return scope.$emit("page:trigger:submit",{courseIdentifier:scope.courseIdentifier,queryString:scope.queryString})},markLines=function(markedData){return _.each(markedData||[],function(data){var e;try{return _markDataFor(data)}catch(_error){return e=_error,Logger.error("Error marking lines: "+e+"\nTrace: "+e.stack+'")\nLogger.error("With mark data: '+JSON.stringify(data))}})},_markDataFor=function(data){var fetchedLine,from,fromLine,to,toCh,toLine;return fromLine=data.from[0],toLine=data.to?data.to[0]:fromLine,from={line:fromLine,ch:data.from[1]||0},void 0!==data.to?(fetchedLine=scope.codeEditor.getLine(toLine),toCh=void 0===data.to[1]?fetchedLine.length:data.to[1],to={line:toLine,ch:toCh}):(fetchedLine=scope.codeEditor.getLine(from.line),to={line:from.line,ch:fetchedLine.length}),_.each(data.options||{},function(value,key){return _markDataOption(data,from,to,key,value)}),scope.codeEditor.markText(from,to,data.options)},_markDataOption=function(data,from,to,option){return"readOnly"===option?(_markDataOptionReadOnly(from,to),data.options.className="is-locked"):void 0},_markDataOptionReadOnly=function(from,to){var endLineNum,fetchedToLine,partialLine,startLineNum;for(partialLine=null,startLineNum=from.ch>0?from.line+1:from.line,to&&(fetchedToLine=scope.codeEditor.getLine(to.line),endLineNum=to.ch<fetchedToLine.length-1?(partialLine=to,to.line-1):to.line);endLineNum>=startLineNum;)scope.codeEditor.addLineClass(startLineNum,"wrap","is-locked"),startLineNum+=1;return partialLine?scope.codeEditor.markText({line:partialLine.line,ch:0},{line:partialLine.line,ch:partialLine.ch},{className:"is-locked"}):void 0},setCursor=function(cursorData){var fetchedLine,indent,indentLength,toCh;return cursorData?(fetchedLine=scope.codeEditor.getLine(cursorData[0]),indent=fetchedLine.match(/(^\s*)/g),indentLength=indent.length>0?indent[0].length:0,toCh=void 0===cursorData[1]?indentLength:cursorData[1],scope.codeEditor.setCursor(cursorData[0],toCh)):void 0},foldLines=function(lines){return lines?_.each(lines,function(line){return scope.codeEditor.foldCode(line)}):void 0},$q.all([new CurrentContentData(scope.courseIdentifier,scope.queryString).attribute("editor"),new CurrentCourseConfig(scope.courseIdentifier).data()]).then(function(data){var configData,editorData,triggerChange;return editorData=data[0],configData=data[1],attrs.editor&&(editorData=scope.$parent[attrs.editor]),editorData?(scope.fileName=editorData.file_name,scope.syntax=editorData.syntax,scope.isLocked=editorData.locked,scope.codeEditor=CodeMirror(element[0],{value:editorData.content,mode:CampusUtil.filterSyntax(scope.syntax),theme:editorData.theme||configData.default_editor_theme||"default",tabSize:2,lineNumbers:!0,autofocus:!0,readOnly:editorData.locked,foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],extraKeys:{"Cmd-Enter":submit,"Ctrl-Enter":submit}}),markLines(editorData.marked_content),foldLines(editorData.fold_lines),setCursor(editorData.set_cursor),submitDataService.registerContent(function(){return{code:scope.codeEditor.doc.getValue(),fileName:scope.fileName,codeType:scope.syntax,changeObject:scope.codeEditor}}),triggerChange=_.debounce(function(){return submitDataService.trigger("change")},250),scope.codeEditor.on("change",triggerChange)):void 0}),scope.elementIsVisible=function(){return element.is(":visible")},scope.$watch("elementIsVisible()",function(result){return result&&scope.codeEditor?(scope.codeEditor.refresh(),scope.codeEditor.focus()):void 0}),scope.$on("page:editor:activate",function(){return scope.elementIsVisible?$timeout(function(){return scope.codeEditor.refresh(),scope.codeEditor.focus()},500):void 0}),scope.$on("$destroy",function(){return scope.codeEditor.off("change")})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("codeEditorTabs",["CampusUtil","$q","CurrentCourseConfig","CurrentContentData","CurrentSubmitData",function(){return{restrict:"E",replace:!0,scope:!0,template:"<div class='codeEditor'>\n  <div class='codeEditor-bar'>\n    <ul class='tabList tabList--editor has-toggle--fullscreen' ng-class=\"tabClass\">\n      <li class='tabList-item' ng-repeat=\"editor in editors\">\n        <a href='' class='tabList-link' ng-class=\"{'is-locked': editor.locked, 'is-active': activeEditor == editor}\" ng-click=\"activateEditor(editor)\" title=\"{{editor.file_name}}\">{{editor.file_name}}</a>\n      </li>\n    </ul>\n  </div>\n  <div ng-repeat=\"editor in editors\" ng-show=\"editorIsShown(editor)\">\n    <code-editor editor=\"editor\"></code-editor>\n  </div>\n<div>",link:function(scope){return scope.currentContent.data().then(function(contentData){return scope.editors=contentData.attributes.editors||[],contentData.attributes.editor&&scope.editors.push(contentData.attributes.editor),scope.tabClass="tabList--"+scope.editors.length,scope.activeEditor=scope.editors[0]}),scope.editorIsShown=function(editor){return scope.activeEditor.file_name===editor.file_name},scope.activateEditor=function(editor){return scope.activeEditor=editor}}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("completeNonRequiredPage",["NodeTreeTraverser",function(NodeTreeTraverser){return{restrict:"M",link:function(scope,element,attrs){var nodeTreeUtils,options;return options=attrs.completeNonRequiredPage.split(":")[1],nodeTreeUtils=new NodeTreeTraverser,"view"===options?scope.currentIndex.data().then(function(indexData){var currentNode;return currentNode=nodeTreeUtils.getNodeAndParent(scope.queryString,indexData).foundNode,currentNode.progress<100?scope.currentContent.completeNonRequiredPage().then(function(){return scope.currentContent.refreshIndex(),scope.currentIndex.refreshIndex()}):void 0}):void 0}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("console",["CurrentSubmitData","Submitter","$compile","$timeout","OpenModal","Executor",function(CurrentSubmitData,Submitter,$compile,$timeout,OpenModal,Executor){return{replace:!0,restrict:"E",scope:!0,template:'<div class="console console--single">\n  <div class="console-ui"></div>\n</div>',link:function(scope,element,attrs){var addStartingInput,buildConsoleFailure,buildConsoleSuccess,displayHelpMenu,displayHint,executorService,nextPage,parseCommand,resetChallenge,submitDataService,submitter;return submitDataService=new CurrentSubmitData(scope.courseIdentifier,scope.queryString),submitter=new Submitter(scope.courseIdentifier,scope.queryString,{useFlashSuccess:!1}),executorService=new Executor(scope.courseIdentifier,scope.queryString),scope.currectReport=null,scope.currentHint="",scope.focus="false"===attrs.consoleFocus||void 0===attrs.consoleFocus?!1:!0,addStartingInput=function(input){var cursorPosition,initialInput,innerConsole;return cursorPosition=input.indexOf("%c%"),initialInput=input.replace("%c%",""),scope.console.setValue(initialInput),cursorPosition>0?(innerConsole=scope.console.innerConsole(),innerConsole.setCursor({line:innerConsole.lineCount()-1,ch:cursorPosition+scope.console.promptLength()})):void 0},buildConsoleFailure=function(report){var newEl,wrapper,_ref;return newEl=$("<div></div>"),newEl.html(report.message()),wrapper=$('<div class="console-msg console-msg--error"></div>'),wrapper.append($compile(newEl)(scope)),scope.currentHint=null!=(_ref=report.failureObject())?_ref.hint:void 0,scope.console.buildWidget(scope.console.innerConsole().lineCount()-2,{content:wrapper[0]})},buildConsoleSuccess=function(){var successMessage,wrapper;return successMessage=scope.successMessage||"Correct!",wrapper=$("<div class='console-msg console-msg--success'>"+successMessage+"</div>"),$compile(wrapper)(scope),scope.console.buildWidget(scope.console.innerConsole().lineCount()-2,{content:wrapper[0]})},displayHelpMenu=function(report){return report({content:$compile('<div class="console-msg console-msg--help">\n  <p class="console-msg-title">The following commands are available:</p>\n  <ul>\n    <li><code>help</code> - Displays the help menu</li>\n    <li><code>hint</code> - Displays a hint related to the error that you see</li>\n    <li><code>next</code> - Moves to the next challenge</li>\n    <li><code>reset</code> - Resets the challenge as if you refreshed the page</li>\n  </ul>\n</div>')(scope)[0]})},displayHint=function(report){var hint;return scope.currentHint?(hint=$compile("<div class='console-hint'>"+scope.currentHint+"</div>")(scope)[0],report({content:hint})):executorService.submit([]).then(function(executorReport){var failureWithHint;return failureWithHint=_.find(executorReport.failures,function(f){return f.hint}),failureWithHint?(hint=$compile("<div class='console-hint'>"+failureWithHint.hint+"</div>")(scope)[0],report({content:hint})):report({content:$("<p class='console-msg console-msg--error'>There is no hint available for you yet<p>")[0]})})},nextPage=function(){return OpenModal.close({clear:!0}),scope.$emit("page:gotoNextChallenge",{courseIdentifier:scope.courseIdentifier,queryString:scope.queryString})},resetChallenge=function(report){return scope.sandboxReset=!0,scope.console.reset(),report(scope.startingContent),addStartingInput(scope.startingInput)},parseCommand=function(line,report){switch(!1){case!line.match(/^help\s*/):displayHelpMenu(report);break;case!line.match(/^hint\s*/):displayHint(report);break;case!line.match(/^next\s*/):nextPage();break;case!line.match(/^reset\s*/):resetChallenge(report);break;default:return!1}return!0},scope.currentContent.data().then(function(contentData){var consoleData;return scope.successMessage=contentData.attributes.correct_message,consoleData=contentData.attributes.console,scope.consoleName=consoleData.name,scope.console=new CSConsole($(element).find(".console-ui")[0],{prompt:consoleData.prompt||"> ",historyLabel:""+scope.courseIdentifier+"-"+consoleData.type,syntax:consoleData.type,welcomeMessage:$(consoleData.welcome_message)[0],autoFocus:scope.focus,initialValue:consoleData.starting_content,commandValidate:function(line){return line.length>0},commandHandle:function(line,report){return scope.currentReport=report,parseCommand(line,report)?void 0:(submitter.submit(scope,{recycleSandbox:!scope.sandboxReset})["catch"](function(){return scope.currentReport({content:"Uh oh, looks like there was an issue with the server. Contact support if this error persists",className:"console-msg console-msg--error"})}),scope.sandboxReset=!1)}}),scope.startingContent=consoleData.starting_content,consoleData.input?(scope.startingInput=consoleData.input,addStartingInput(scope.startingInput)):void 0}),scope.$on("submission:fail",function(evt,evtData){return evt.targetScope===scope?(scope.currentReport({content:evtData.result.details().output.result}),buildConsoleFailure(evtData.result),$timeout(function(){return scope.console.innerConsole().refresh()}),scope.currentReport=null):void 0}),scope.$on("submission:success",function(evt,evtData){return evt.targetScope===scope?(scope.currentReport({content:evtData.result.details().output.result}),buildConsoleSuccess(evtData.result),scope.currentReport=null):void 0}),submitDataService.registerContent(function(){return scope.console.getValue()}),scope.$on("$destroy",function(){return submitter.cleanUp()})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("contentAside",["CampusUrl",function(CampusUrl){return{replace:!0,restrict:"CE",scope:!0,transclude:!0,template:"<blockquote>\n  <div class='bucket bucket--flag'>\n    <div class='bucket-media'>\n      <img src='{{avatar}}' alt='{{title}}' class='content-aside-thumb thumb'/>\n      <p class='content-aside-author'>\n        <strong>{{title}}</strong>\n      </p>\n    </div>\n    <div class='bucket-content'>\n      <p ng-transclude></p>\n    </div>\n  </div>\n</blockquote>",link:function(scope,element,attrs){return scope.avatar=CampusUrl.imageUrl(attrs.avatar),scope.title=attrs.title,element.hasClass("content-aside")?void 0:element.addClass("content-aside")}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("correctmessage",["$compile","$timeout",function(){return{restrict:"E",replace:!0,scope:!0,template:'<div class=\'correct-message\' ng-if="isShown" compile-html="{{correctMessage}}"></div>',link:function(scope){var updateIsShown;return updateIsShown=function(contentData){return contentData.query_string===scope.queryString?scope.isShown=100===contentData.progress:void 0},scope.currentContent.data().then(function(contentData){return updateIsShown(contentData),scope.correctMessage=contentData.attributes.correct_message}),scope.$on("page:update:content",function(evt,evtData){return updateIsShown(evtData.data)})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("courseLevelList",function(){return{replace:!0,restrict:"E",scope:!0,template:"<dl class='levelList'>\n  <div class='levelList-item' ng-repeat='level in levels'>\n    <dt class='levelList-item-title'>\n      Level {{formatIndex($index)}}\n    </dt>\n    <dd class='levelList-item-body'>\n      {{level.name}}\n    </dd>\n  </div>\n</dl>",link:function(scope){return scope.currentIndex.getContainers("level").then(function(levels){return scope.levels=levels}),scope.formatIndex=function(index){return scope.levels?(index+=1,10>index&&scope.levels.length>9?""+index+"  ":""+index):void 0}}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("courseMap",["OpenModal","$timeout","$rootScope","CurrentIndexData","CurrentContentData","CurrentCourseConfig","$q",function(OpenModal,$timeout,$rootScope,CurrentIndexData,CurrentContentData,CurrentCourseConfig,$q){return{replace:!0,restrict:"E",scope:!0,template:"<div class='map'>\n  <ol class='map-list'>\n    <course-map-level ng-repeat='level in levels' class=\"{{isExpanded(level)}}\" ng-mouseenter='preloadLevel(level)' data='level' url-params=\"{{appendToUrls}}\" level-index='{{$index}}'></course-map-level>\n  </ol>\n</div>",link:function(scope,element,attrs){var courseConfig,currentIndex,expandedEl;return scope.scrollElementSelector=attrs.scrollElementSelector,expandedEl=null,currentIndex=new CurrentIndexData(scope.courseIdentifier),courseConfig=new CurrentCourseConfig(scope.courseIdentifier),scope.urlParams=attrs.urlParams,scope.isExpanded=function(level){return scope.expandedLevel===level?"is-expanded":void 0},scope.preloadLevel=function(level){return level.preloadDisabled?void 0:new CurrentContentData(scope.courseIdentifier,level.query_string).preloadData(level.query_string)},$q.all([currentIndex.getContainers("level"),courseConfig.data()]).then(function(data){var configData,currentLevels;return currentLevels=data[0],configData=data[1],"paid"!==configData.course_type||$rootScope.userHasAccess||_.each(currentLevels,function(level){var matchingFreePattern;return matchingFreePattern=_.filter(configData.free_pages,function(matcher){return!!level.query_string.match(new RegExp(matcher))}),0===matchingFreePattern.length?(level.disabled=!0,level.preloadDisabled=!configData.development_mode):void 0}),scope.expandedLevel=_.find(currentLevels,function(level){return $rootScope.queryString.match(new RegExp("^"+level.query_string))}),scope.levels=currentLevels,scope.$on("mapListFinished",function(){return expandedEl=$(element).find(".is-expanded"),expandedEl.length<1?$(element).find(">ol>li").first().addClass("is-expanded"):scope.scrollElementSelector?$timeout(function(){return $(scope.scrollElementSelector).scrollTop(expandedEl[0].offsetTop-100)},300):void 0})}),scope.$on("$destroy",function(){return expandedEl=null})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("courseMapLevel",["$compile","CurrentContentData","$timeout","CampusUrl",function($compile,CurrentContentData,$timeout,CampusUrl){return{replace:!0,restrict:"E",scope:{data:"=",levelIndex:"@",urlParams:"@"},template:"<li class='map-level' ng-class=\"{'is-complete': isComplete(), 'is-disabled': disabled}\">\n  <div class='map-badge badge' badge-progress=\"progress\" ng-click='expandContainer($event)'>\n    <img width=110 height=110 ng-src='{{badgeUrl}}' alt='Placeholder Badge' class='badge-img' ng-error='usePlaceholder($event)' />\n  </div>\n\n  <header class='map-level-header map-level-cell' ng-click='expandContainer($event)'>\n    <h2 class='map-level-label'>Level {{index}}</h2>\n    <h3 class='map-level-title'>\n      <a href='' class='expand-on-click'>{{levelName}}</a>\n      <span class='map-level-title-label'>{{totalComplete}}/{{totalPages}} Complete</span>\n    </h3>\n  </header>\n\n  <div class='map-level-section map-level-cell'>\n    <ol class='map-level-section-list'>\n    </ol>\n  </div>\n</li>",link:function(scope,element){var childScope,currentContent,list,listItems;return scope.$parent.$last&&$timeout(function(){return scope.$parent.$parent.$emit("mapListFinished")}),currentContent=new CurrentContentData(scope.$parent.courseIdentifier,scope.$parent.courseIdentifier),scope.progress=scope.data.progress,scope.levelName=scope.data.name,scope.index=parseInt(scope.levelIndex,10)+1,scope.nodes=scope.data.nodes,scope.courseIdentifier=scope.$parent.courseIdentifier,scope.queryString=scope.data.query_string,scope.disabled=scope.data.disabled,currentContent.completeChildCount(scope.data).then(function(count){return scope.totalComplete=count}),currentContent.totalChildCount(scope.data).then(function(count){return scope.totalPages=count}),currentContent.achievementForLevel(scope.data).then(function(achievement){return scope.badgeUrl=CampusUrl.badgeUrl(achievement.badge)}),scope.usePlaceholder=function(evt){$(evt.currentTarget).attr("src",CampusUrl.appImageUrl("badge-default.png"))},scope.isComplete=function(){return 100===scope.progress},scope.expandContainer=function(){element.hasClass("is-expanded")?element.removeClass("is-expanded"):element.addClass("is-expanded")},listItems=[],childScope=scope.$new(),list=element.find("ol"),_.each(scope.data.nodes,function(node,index){if("container"===node.node_type||"page"===node.node_type){if("page"===node.node_type&&"level_wrap_up"!==node.node_label)return list.append($compile("<course-map-page data='nodes["+index+"]' url-params='"+scope.urlParams+"'></course-map-page>")(childScope));if("section"===node.node_label)return list.append($compile("<course-map-section data='nodes["+index+"]' url-params='"+scope.urlParams+"'></course-map-section>")(childScope))}}),scope.$on("$destroy",function(){return list.remove(),list=null})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("courseMapPage",["CurrentContentData","$state","$rootScope","ContentData","$parse",function(CurrentContentData,$state,$rootScope,ContentData){return{replace:!0,restrict:"E",scope:{data:"=",urlParams:"@"},template:"<li class='map-level-item map-level-item--{{pageType()}}' ng-class='{\"is-complete\": isComplete(), \"is-active\": isCurrentPage(), \"is-current\": isCurrentPage()}'>\n  <a href='{{queryString}}' ng-click='gotoPage($event)'>{{pageTitle}}</a>\n</li>",link:function(scope){var contentDataService;return contentDataService=new ContentData,scope.pageTitle=scope.data.name,scope.queryString=scope.data.query_string,scope.courseIdentifier=scope.$parent.courseIdentifier,scope.progress=scope.data.progress,scope.$on("page:update:index",function(){return contentDataService.getContent(scope.courseIdentifier,scope.data.query_string).then(function(contentData){return scope.progress=contentData.progress})}),scope.isComplete=function(){return 100===scope.progress},scope.isCurrentPage=function(){return $rootScope.queryString===scope.data.query_string},scope.pageType=function(){return scope.data.node_label.replace(/_/,"-")},scope.gotoPage=function(evt){var additionalParams,button,urlParams;return button=evt.which||evt.button,0!==button&&1!==button||evt.ctrlKey||evt.metaKey||evt.shiftKey?void 0:(evt.preventDefault(),additionalParams=scope.urlParams||{},urlParams=_.extend({queryString:scope.queryString},additionalParams),new CurrentContentData(scope.courseIdentifier,scope.queryString).preloadData(scope.queryString).then(function(){return $state.go("root.courseContent",urlParams)}))}}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("courseMapSection",["CurrentContentData","$state",function(CurrentContentData,$state){return{replace:!0,restrict:"E",scope:{data:"=",urlParams:"@"},template:"<li ng-class='isComplete()'>\n  <h4 class='map-level-section-title'>\n    <a href='{{queryString}}' ng-click='gotoPage($event)' >{{title}}</a>\n  </h4>\n  <ol class='map-level-list'>\n    <course-map-page ng-repeat='page in pages' data='page' append-to-urls=\"{{appendToUrls}}\"></course-map-page>\n  </ol>\n</li>",link:function(scope){return scope.title=scope.data.name,scope.pages=scope.data.nodes,scope.queryString=scope.data.query_string,scope.progress=scope.data.progress,scope.courseIdentifier=scope.$parent.courseIdentifier,scope.isComplete=function(){return 100===scope.progress?"is-complete":""},scope.gotoPage=function(evt){var additionalParams,button,urlParams;return button=evt.which||evt.button,0!==button&&1!==button||evt.ctrlKey||evt.metaKey||evt.shiftKey?void 0:(evt.preventDefault(),additionalParams=scope.urlParams||{},urlParams=_.extend({queryString:scope.queryString},additionalParams),new CurrentContentData(scope.courseIdentifier,scope.queryString).preloadData(scope.queryString).then(function(){return $state.go("root.courseContent",urlParams)}))}}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("courseMapButton",["$rootScope","OpenModal",function($rootScope,OpenModal){return{replace:!0,restrict:"E",scope:!0,template:"<a class='toggle toggle--menu' href='' ng-click='openMapModal()'>\n  <b class='srt'>Menu</b>\n</a>",link:function(scope){return scope.openMapModal=function(){return $rootScope.$emit("video:stop"),OpenModal.open({htmlClass:"modal--page modal--map",fullScreen:!0,scope:scope},"<course-map scroll-element-selector='.modal'></course-map>")}}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("courseResources",["CurrentCourseConfig",function(CurrentCourseConfig){return{replace:!0,restrict:"E",template:'<div class="cell cell--xs" ng-if="resources">\n  <h2>Resources</h2>\n  <ul class="list mbxl">\n    <li class="list-item" ng-repeat="resource in resources">\n      <i class="icn icn--middle mrs tcs" ng-class="getClassForResource(resource)"></i>\n      <a class="bdrcb tcb" href="{{resource.url}}">{{resource.name}}</a>\n    </li>\n  </ul>\n</div>',link:function(scope){return new CurrentCourseConfig(scope.courseIdentifier,scope.queryString).data().then(function(configData){return configData.resources?scope.resources=configData.resources:void 0}),scope.getClassForResource=function(resource){var url;if(url=resource.url)switch(!1){case!url.match(/\.pdf$/):return"icn--slides";case!url.match(/\.mp4\?/):return"icn--video--alt--b"}}}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("editorOffButton",function(){return{restrict:"E",replace:!0,scope:!0,template:"<a href='' class='panel-close close' ng-click='closeEditor()'>x</div>",link:function(scope){return scope.closeEditor=function(){return scope.$emit("page:editor:deactivate",{courseIdentifier:scope.courseIdentifier,queryString:scope.queryString})}}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("ensureUserIsHandled",function(){return{replace:!1,restrict:"M",controller:["UserCreation","$rootScope",function(UserCreation,$rootScope){return new UserCreation($rootScope.courseIdentifier,$rootScope.queryString).ensureUserCreated(!0)}]}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("feedScrollElement",function(){return{replace:!1,restrict:"A",scope:!0,link:function(scope,element){return scope.$on("challengeFeed:scroll",function(evt,evtData){var scrollToElement,scrollToPosition;return evt.stopPropagation(),scrollToElement=$(evtData.scrollToElement),scrollToPosition=scrollToElement.offset().top-element.height()-element.offset().top+scrollToElement.height(),element.animate({scrollTop:scrollToPosition},"500","swing")})}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("fillInBlank",["$compile","CurrentSubmitData","Executor",function($compile,CurrentSubmitData,Executor){return{replace:!0,restrict:"E",scope:!0,template:'<div class="fill-in-blank">\n  <p>\n  </p>\n  <submit-button hide-next-challenge-button="true">Submit Answer</submit-button>\n</div>',link:function(scope,element){var broadcastSubmissionResult,deRegisterContent,executorService,submitDataService;return executorService=new Executor(scope.courseIdentifier,scope.queryString),submitDataService=new CurrentSubmitData(scope.courseIdentifier,scope.queryString),scope.fieldContent=[],broadcastSubmissionResult=function(report){return scope.$broadcast("fillInBlank:failure",{report:report})},scope.currentContent.data().then(function(contentData){var childScope,content,contentEl,foundElements,recentAttempt,recentAttemptInput;return content=contentData.attributes.fill_in_blank,foundElements=content.match(/%([a-zA-Z_]*): ([a-zA-z0-9:\s\.\-_\/]*)?%/g),recentAttempt=contentData.attempts.recent_attempt,recentAttemptInput=recentAttempt?JSON.parse(recentAttempt.submission)[0]:void 0,childScope=scope.$new(),childScope.successes=[],childScope.data={},_.each(foundElements,function(foundElement){var attemptInput,elementType,elementValue,parsedElement,replacementElement,_ref;return parsedElement=foundElement.match(/%([a-zA-Z_]*): ([a-zA-z0-9:\s\.\-_\/]*)?%/),elementType=parsedElement[1],elementValue=parsedElement[2],attemptInput="",recentAttempt&&(attemptInput=(null!=(_ref=_.where(recentAttemptInput,{name:elementValue})[0])?_ref.content:void 0)||"",recentAttempt.success?childScope.successes.push(elementValue):submitDataService.trigger("change")),replacementElement="<fill-in-blank-input class='fill-in-blank-content' type='"+elementType+"' label='"+elementValue+"'></fill-in-blank-input>",childScope.data[elementValue]=attemptInput,content=content.replace(foundElement,replacementElement)}),contentEl=$(element).find(">p"),contentEl.empty(),contentEl.append($compile(content)(childScope))}),executorService.onChange(function(report){return broadcastSubmissionResult(report)}),scope.$on("submission:fail",function(evt,evtData){return evt.stopPropagation?broadcastSubmissionResult(evtData.result):void 0}),scope.$on("submission:success",function(evt,evtData){return evt.stopPropagation?broadcastSubmissionResult(evtData.result):void 0}),deRegisterContent=submitDataService.registerContent(function(){return _.map(scope.fieldContent,function(content){return content()})}),scope.$on("$destroy",function(){return executorService.cleanUp(),deRegisterContent()})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("fillInBlankInput",["$compile","$timeout",function($compile){return{replace:!0,restrict:"E",scope:!0,template:'<span class="has-stateInput" ng-class="{\'is-correct\': isCorrect, \'is-incorrect\': isIncorrect}">\n  <span class="stateInput-icn" popover ng-show="errorMessage" popover-message="errorMessage" popover-placement="bottom">\n    <a class="stateInput-icn-link" href="">\n      <b class="srt">X</b>\n    </a>\n  </span>\n  <span class="stateInput-icn" ng-show=\'isCorrect\'>\n    <a class="stateInput-icn-link" href="">\n      <b class="srt">Correct</b>\n    </a>\n  </span>\n</span>',link:function(scope,element,attrs){var inputEl,insertError,updateIndicators;switch(scope.type=attrs.type,scope.label=attrs.label,scope.title="Incorrect",scope.shownHint=!1,scope.content=scope.data[attrs.label]||"",scope.successes.indexOf(scope.label)>=0&&(scope.isCorrect=!0,scope.isIncorrect=!1),scope.handleKeyDown=function(evt){return 13===evt.which||13===evt.keyCode?scope.$emit("page:trigger:submit",{courseIdentifier:scope.courseIdentifier,queryString:scope.queryString}):void 0},scope.type){case"text":inputEl='<input class="stateInput" ng-class="{\'is-incorrect\': isIncorrect, \'is-correct\': isCorrect }" type="text" ng-model="content" ng-keydown="handleKeyDown($event)"/>'}return inputEl=$compile(inputEl)(scope),element.prepend(inputEl),scope.fieldContent.push(function(){return scope.popoverClose(),scope.shownHint=!1,{name:scope.label,content:scope.content}}),updateIndicators=function(){return scope.content&&!scope.errorMessage?(scope.isCorrect=!0,scope.isIncorrect=!1):(scope.isCorrect=!1,scope.isIncorrect=!0)},insertError=function(data){var failureCount,failureFound,failureTarget,hint,index;for(failureCount=data.report.failureCount()+1,failureFound=!1;failureCount-=1;)index=failureCount-1,failureTarget=data.report.target(index),failureTarget===scope.label&&(failureFound=!0,scope.errorMessage=data.report.message(index),hint=data.report.failureObject(index).hint,hint&&(scope.errorMessage+="<adaptive-hint class='popover-precompile-hide'>"+hint+"</adaptive-hint>"));return failureFound||(scope.errorMessage=null),updateIndicators()},scope.$on("fillInBlank:failure",function(evt,evtData){return insertError(evtData)})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("hintButton",["$timeout","HintsData",function($timeout,HintsData){return{restrict:"E",replace:!0,scope:!0,template:"<a class='btn btn--hint course-hint-button' ng-class='{\"is-disabled\": buttonDisabled, \"is-submitting\": buttonDisabled}' href='' ng-click='getNextHint()'>\n  <span class='loader-el'></span>\n  <span class='loader-text'>{{buttonText}}</span>\n</a>",link:function(scope,element){var hintsDataService,previousHintsRemaining;return $timeout(function(){return element.addClass("is--left")}),previousHintsRemaining=scope.hintsRemaining,hintsDataService=new HintsData,scope.hintsRemaining=0,scope.currentContent.attribute("hints").then(function(hintsData){var totalHintCount,usedHintsCount;if(hintsData)return totalHintCount=hintsData.count,usedHintsCount=hintsData.used_hints.length,scope.hintsRemaining=totalHintCount-usedHintsCount,scope.updateButtonText()}),scope.getNextHint=function(){return scope.hasMoreHints()&&!scope.buttonDisabled?(scope.buttonDisabled=!0,scope.$emit("hints:requestNew",{courseIdentifier:scope.courseIdentifier,queryString:scope.queryString}),hintsDataService.getNextHint(scope.courseIdentifier,scope.queryString).then(function(data){return scope.hintsRemaining-=1,scope.buttonDisabled=!1,scope.updateButtonText(),scope.hintsRemaining<=0?scope.$emit("hints:answer",{courseIdentifier:scope.courseIdentifier,queryString:scope.queryString,data:data[0]}):scope.$emit("hints:new",{courseIdentifier:scope.courseIdentifier,queryString:scope.queryString,data:data[0]}),scope.currentContent.refreshAllData(scope)})):void 0},scope.hasMoreHints=function(){return scope.hintsRemaining>0},scope.updateButtonText=function(){return scope.courseConfig.data().then(function(configData){var pluralized_hints;return pluralized_hints=1===Math.abs(scope.hintsRemaining-1)?"Hint":"Hints",scope.buttonText="last_hint"===configData.subtract_points_on?scope.hintsRemaining>1?""+(scope.hintsRemaining-1)+" "+pluralized_hints+" Remaining":1===scope.hintsRemaining?"Buy Answer ("+configData.hint_point_value+" Points)":""+scope.hintsRemaining+" "+pluralized_hints+" Remaining":"each_hint"===configData.subtract_points_on?scope.hintsRemaining>1?""+scope.hintsRemaining+" "+pluralized_hints+" Remaining ("+configData.hint_point_value+" Points)":"Buy Answer ("+configData.hint_point_value+" Points)":""+scope.hintsRemaining+" "+pluralized_hints+" Remaining"})},scope.$watch("hintsRemaining",function(hintsRemaining){return element.removeClass("is-"+previousHintsRemaining+"-left"),element.removeClass("is-empty"),previousHintsRemaining=hintsRemaining,0===hintsRemaining?element.addClass("is-"+hintsRemaining+"-left is-empty"):element.addClass("is-"+hintsRemaining+"-left")})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("htmlPreview",["CurrentSubmitData","$timeout","Executor","CampusUrl",function(CurrentSubmitData,$timeout,Executor,CampusUrl){return{replace:!0,restrict:"E",scope:!0,template:"<div class='resource resource--preview'>\n  <p class='resource-msg' ng-if='!hasContent'>Preview will automatically update.</p>\n  <iframe>\n    <!DOCTYPE html>\n  </iframe>\n<div>",link:function(scope,element,attrs){var executorService,sourceElements,updatePreview;
return scope.html=attrs.html,scope.hasContent=!1,scope.baseUrl=CampusUrl.baseCourseAssetUrl("demo/"),executorService=new Executor(scope.courseIdentifier,scope.queryString),sourceElements=_.map(scope.html.match(/(%[a-zA-z0-9:\s\.\-_\/|]*%)/g),function(source){var parsedElements;return parsedElements=source.match(/^%source: ([a-zA-z0-9:\s\.\-_\/]*)(\s*\|\s*([a-zA-Z]*))?/),{element:source,fileName:parsedElements[1].replace(/\s*$/,""),filter:parsedElements[3]}}),updatePreview=function(){var iframeEl,iframeHtml,submitData;return scope.hasContent=!0,submitData=new CurrentSubmitData(scope.courseIdentifier,scope.queryString).getContent(),iframeEl=element.find("iframe")[0],iframeEl.sandbox="allow-scripts",iframeHtml=scope.html,_.each(sourceElements,function(sourceElement){var data,dataContent;return data=_.where(submitData,{fileName:sourceElement.fileName})[0],dataContent=sourceElement.filter?scope[sourceElement.filter](data.code):data.code,iframeHtml=iframeHtml.replace(new RegExp(sourceElement.element),dataContent)}),$timeout(function(){var iframeDoc,iframeWindow;return iframeWindow=iframeEl.contentWindow,iframeWindow.$editors=submitData,iframeWindow._=_,iframeDoc=iframeEl.contentDocument,iframeDoc.innerHTML="",iframeDoc.open(),iframeDoc.write("<base href='"+scope.baseUrl+"'/>"),iframeDoc.write(iframeHtml),iframeDoc.close()})},scope.stripNewlines=function(str){return str.split("\n").join()},scope.isActive=function(){return element.is(":visible")},executorService.onChange(function(){return scope.isActive()?updatePreview():void 0}),scope.$watch("isActive()",function(active){return active?updatePreview():void 0})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("instructions",["$compile","$timeout",function($compile){return{restrict:"E",replace:!0,scope:!0,template:"<div class='objective-body'></div>",link:function(scope,element){return scope.currentContent.attribute("instructions").then(function(instructions){return element.empty(),element.html(instructions),$compile(element.contents())(scope)})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("keyShortcut",["$parse","KeyboardShortcuts",function($parse,KeyboardShortcuts){return scope.unbind=function(){return unbind()},scope.$on("$destroy",function(){var func,parentEl,shortCutObj;return unbind(),parentEl=null,func=null,shortCutObj=null})}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("levelBadge",["CampusUrl","NodeTreeTraverser","$q",function(CampusUrl,NodeTreeTraverser,$q){return{restrict:"E",replace:!0,scope:!0,template:"<div class='badge'>\n  <img class='badge-img' ng-src='{{badgeUrl}}' width='110' height='110' />\n<div/>",link:function(scope){var nodeTreeUtil;return nodeTreeUtil=new NodeTreeTraverser,$q.all([scope.currentIndex.data(),scope.currentContent.data()]).then(function(data){var contentData,index,indexData;return indexData=data[0],contentData=data[1],_.where(indexData.nodes,{query_string:contentData.query_string,node_type:"page"})[0]?scope.currentContent.achievementForCourseComplete().then(function(achievement){return scope.badgeUrl=CampusUrl.badgeUrl(null!=achievement?achievement.badge:void 0)}):(index=nodeTreeUtil.nodeIndexInTopLevelContainer(scope.queryString,indexData),scope.currentContent.achievementForLevel(index.topLevelContainerNode).then(function(achievement){return scope.badgeUrl=CampusUrl.badgeUrl(null!=achievement?achievement.badge:void 0)}))})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("levelNumber",function(){return{replace:!0,restrict:"E",scope:!0,template:"<span>{{levelNumber}}</span>",link:function(scope){return scope.currentContent.currentLevelIndex().then(function(index){return scope.levelNumber=index})}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("levelPoints",["ContentData",function(ContentData){return{replace:!0,restrict:"E",scope:!0,template:"<span>{{levelPoints}}</span>",link:function(scope){var contentDataService;return contentDataService=new ContentData,scope.currentContent.currentLevelIndex().then(function(levelIndex){return contentDataService.getContent(scope.courseIdentifier,"level/"+levelIndex).then(function(data){return scope.currentContent.totalPoints(data).then(function(points){return scope.levelPoints=points})})})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("levelTitle",["NodeTreeTraverser","$q",function(NodeTreeTraverser,$q){return{replace:!0,restrict:"E",scope:!0,template:"<span>{{levelTitle}}</span>",link:function(scope){var treeTraverser;return treeTraverser=new NodeTreeTraverser,$q.all([scope.currentContent.data(),scope.currentIndex.data()]).then(function(data){var contentData,indexData,_ref;return contentData=data[0],indexData=data[1],scope.levelTitle=null!=(_ref=treeTraverser.getNearestParentNodeType(indexData,contentData,"level"))?_ref.attributes.name:void 0})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("limitToChildOf",["$parse","$q","NodeTreeTraverser","TemplateIndex","$location",function($parse,$q,NodeTreeTraverser,TemplateIndex){return{replace:!1,restrict:"M",scope:!1,require:"^courseData",link:function(scope,element,attrs,courseDataCtrl){var options,parentItem,splitArgs;return courseDataCtrl.elementTemplateIsDirectChild(element)?(splitArgs=attrs.limitToChildOf.split(" "),parentItem=splitArgs[0],options=$parse(splitArgs[1])()||{},options.scrollTo&&(options.scrollTo=scope.queryString),$q.all([scope.currentUser.data(),scope.courseConfig.data(),scope.currentIndex.data(),scope.currentContent.data()]).then(function(data){var closestParentElement,configData,contentData,indexData,template,userData;return userData=data[0],configData=data[1],indexData=data[2],contentData=data[3],closestParentElement=(new NodeTreeTraverser).getNearestParentNodeType(indexData,contentData,parentItem),options.queryString=closestParentElement.query_string,template=TemplateIndex.data()[closestParentElement.query_string],courseDataCtrl.setTemplate(template,{setOnScope:options})})):void 0}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("longformPage",["$templateCache","$compile","CurrentContentData","EventRebroadcaster","$rootScope","$timeout","CurrentSubmitData",function($templateCache,$compile,CurrentContentData,EventRebroadcaster,$rootScope,$timeout,CurrentSubmitData){return{restrict:"E",replace:!0,scope:!0,template:'<section class=\'content-section\' ng-class=\'{"is-editing": isEditing, "is-editing-start": isEditingStart, "is-editing-end": isEditingEnd, "is-complete": isComplete}\'>\n\n</section>',link:function(scope,element,attrs){var isEditing,isFixed,isNotEditing,mainElement,mainHeight,mainTop,pageTemplate,rebroadcast,refreshContentData,refreshIndexData,refreshUserData,updateAll;return mainElement=$("main"),mainTop=mainElement.offset().top,mainHeight=mainElement.innerHeight(),isFixed=!1,$("main").on("scroll.fixedEditor",function(){var elHeight,elTop,elementAbsoluteBottom,elementAbsoluteTop,topValue;if(scope.isEditing){if(elHeight=element.innerHeight(),elTop=element.offset().top,elementAbsoluteTop=elTop-mainTop,elementAbsoluteBottom=elHeight+elTop-mainTop-mainHeight,!isFixed&&0>elementAbsoluteTop&&elementAbsoluteBottom>0)return isFixed=!0,scope.$broadcast("editor:fixed",{courseIdentifier:scope.courseIdentifier,queryString:scope.queryString});if(isFixed&&(elementAbsoluteTop>0||0>elementAbsoluteBottom))return 0>elementAbsoluteBottom&&(topValue=Math.abs(elementAbsoluteTop)),isFixed=!1,scope.$broadcast("editor:notFixed",{courseIdentifier:scope.courseIdentifier,queryString:scope.queryString,top:topValue})}}),scope.isEditing=!1,new CurrentSubmitData(scope.courseIdentifier,scope.queryString).reset(),isEditing=function(){return scope.isEditingStart=!0,$timeout(function(){return scope.isEditingStart=!1,scope.isEditing=!0},400)},isNotEditing=function(){return scope.isEditing?(scope.isEditingEnd=!0,$timeout(function(){return scope.isEditingEnd=!1,scope.isEditing=!1},400)):void 0},refreshUserData=function(courseIdentifier,queryString){return scope.currentUser.refreshData().then(function(userData){var eventData,eventName;return eventData={courseIdentifier:courseIdentifier,queryString:queryString,data:userData},eventName="page:update:user",scope.$broadcast(eventName,eventData),$rootScope.$broadcast(eventName,eventData),scope.$parent.$emit(eventName,eventData)})},refreshContentData=function(courseIdentifier,queryString){return scope.currentContent.refreshContent().then(function(contentData){var eventData,eventName;return eventData={courseIdentifier:courseIdentifier,queryString:queryString,data:contentData},eventName="page:update:content",scope.$broadcast(eventName,eventData),scope.$parent.$emit(eventName,eventData),scope.isComplete=100===contentData.progress})},refreshIndexData=function(courseIdentifier,queryString){return scope.currentIndex.refreshIndex().then(function(indexData){var eventData,eventName;return eventData={courseIdentifier:courseIdentifier,queryString:queryString,data:indexData},eventName="page:update:index",scope.$broadcast(eventName,eventData),scope.$parent.$emit(eventName,eventData),$rootScope.$broadcast(eventName,eventData)})},updateAll=function(courseIdentifier,queryString){return refreshUserData(courseIdentifier,queryString),refreshContentData(courseIdentifier,queryString),refreshIndexData(courseIdentifier,queryString)},scope.$on("submission:success",function(evt,data){return evt.targetScope!==scope?updateAll(data.courseIdentifier,data.queryString):void 0}),scope.$on("submission:fail",function(evt,data){return evt.targetScope!==scope?updateAll(data.courseIdentifier,data.queryString):void 0}),scope.$on("hints:new",function(evt,data){return evt.targetScope!==scope?updateAll(data.courseIdentifier,data.queryString):void 0}),scope.$on("hints:answer",function(evt,data){return evt.targetScope!==scope?updateAll(data.courseIdentifier,data.queryString):void 0}),scope.$on("page:editor:activate",function(evt){return evt.targetScope!==scope?(isEditing(),$("main").scrollTop(element[0].offsetTop)):void 0}),scope.$on("page:editor:deactivate",function(evt){return evt.targetScope!==scope?isNotEditing():void 0}),scope.$on("longformSection:closeAllExcept",function(evt,data){return data.courseIdentifier!==scope.courseIdentifier||data.queryString!==scope.queryString?isNotEditing():void 0}),scope.$on("page:gotoNextChallenge",function(){return scope.$emit("page:editor:deactivate",{courseIdentifier:scope.courseIdentifier,queryString:scope.queryString}),isNotEditing()}),scope.$on("page:trigger:submit",function(evt,eventData){return evt.targetScope!==scope?(evt.stopPropagation(),scope.isEditing?scope.$broadcast("page:trigger:submit",eventData):void 0):void 0}),rebroadcast=new EventRebroadcaster(scope),rebroadcast.add("submission:fail"),rebroadcast.add("submission:success"),rebroadcast.add("submission:start"),rebroadcast.add("submission:end"),rebroadcast.add("page:update:content"),rebroadcast.add("page:update:user"),rebroadcast.add("page:update:index"),rebroadcast.add("page:update:config"),rebroadcast.add("page:editor:collapse"),rebroadcast.add("page:editor:fullscreen"),rebroadcast.add("hints:requestNew"),rebroadcast.add("hints:new"),rebroadcast.add("hints:answer"),pageTemplate=$templateCache.get(attrs.template),$timeout(function(){return element.append(pageTemplate),$compile(element.contents())(scope)}),scope.currentContent.data().then(function(contentData){return scope.isComplete=100===contentData.progress}),scope.$on("$destroy",function(){return $("main").off("scroll.fixedEditor")})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("longformLevel",["TemplateIndex","$compile","$timeout","$parse","CurrentContentData","$q","NodeTreeTraverser","$state",function(TemplateIndex,$compile,$timeout,$parse,CurrentContentData,$q,NodeTreeTraverser,$state){return{replace:!0,restrict:"E",scope:!0,template:"<div class='longform-level' ng-class=\"{'is-editing': isEditing}\">\n</div>",link:function(scope,element,attrs){var createPage,excludedTemplates,idName,previousPage,scrollToUsed,templateIndex,updateDisplayedChallenges;return templateIndex=TemplateIndex.data(),excludedTemplates=$parse(attrs.excludeTemplates)(),scope.$on("page:editor:activate",function(evt,data){return evt.stopPropagation(),scope.isEditing=!0,scope.$broadcast("longformSection:closeAllExcept",{courseIdentifier:data.courseIdentifier,queryString:data.queryString})}),scope.$on("page:editor:deactivate",function(){return scope.isEditing=!1}),scope.$on("page:update:content",function(){return scope.currentContent.data().then(function(contentData){return updateDisplayedChallenges(contentData),100===contentData.progress?scope.currentContent.preloadData(contentData.next_query_string):void 0})}),idName=function(queryString){return queryString.replace(/\//g,"-")},previousPage=null,scrollToUsed=!1,createPage=function(node){var childScope,pageElement,templateName;if("page"===node.node_type){if(templateName=templateIndex[node.query_string],excludedTemplates&&!(excludedTemplates.indexOf(templateName)<0))return;if(pageElement=angular.element('<longform-page id="'+idName(node.query_string)+'" page-data=\'{courseIdentifier: "{{courseIdentifier}}", queryString: "'+node.query_string+'"}\' template="'+templateName+'"></longform-page>")'),childScope=scope.$new(),childScope.previousPage=previousPage,previousPage=node,element.append($compile(pageElement)(childScope)),!scrollToUsed&&scope.scrollTo&&$timeout(function(){return $("main").scrollTop(pageElement[0].offsetTop)}),scope.scrollTo===node.query_string)return scrollToUsed=!0}},updateDisplayedChallenges=function(contentData){var recursiveAdd,stopped;return previousPage=null,stopped=!1,recursiveAdd=function(node){return createPage(node),_.each(node.nodes,function(n){var childElementsCount,foundElement;return childElementsCount=element.children().length,foundElement=element.find("#"+idName(n.query_string)),foundElement.length>0&&n.attributes.required&&n.progress<100&&!n.attributes.pending&&(stopped=!0),(1>childElementsCount||!stopped)&&0===foundElement.length?(n.attributes.required&&100!==n.progress&&!n.attributes.pending&&(stopped=!0),recursiveAdd(n)):void 0})},recursiveAdd(contentData),scrollToUsed=!0},scope.currentContent.data().then(function(contentData){return updateDisplayedChallenges(contentData)}),scope.$on("page:gotoNextChallenge",function(evt,eventData){return evt.stopPropagation(),$q.all([scope.currentIndex.data(),new CurrentContentData(scope.courseIdentifier,eventData.queryString).data()]).then(function(data){var contentData,indexData,nodeIndexData,parentNodes,traverser;return contentData=data[1],indexData=data[0],traverser=new NodeTreeTraverser,nodeIndexData=traverser.getNodeAndParent(scope.queryString,indexData),parentNodes=nodeIndexData.parentNode.nodes,contentData.next_query_string.match(new RegExp(scope.queryString))?void 0:$state.go("root.courseContent",{queryString:contentData.next_query_string})})})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("multipleChoice",["CurrentSubmitData","$compile",function(CurrentSubmitData,$compile){return{replace:!0,restrict:"E",scope:!0,template:'<div class="multiple-choice">\n  <ul class="selectList pbm">\n    <li class="selectList-item" ng-repeat="choice in choices" ng-class="selectedClassFor(choice)">\n      <a class="selectList-item-link" href=\'\' ng-click="selectChoice($event, choice)" compile-html="{{choice.content}}"></a>\n    </li>\n  </ul>\n  <submit-button hide-next-challenge-button="true">Submit Answer</submit-button>\n</div>',link:function(scope,element){var clearErrors,deRegisterContent,submitDataService;return submitDataService=new CurrentSubmitData(scope.courseIdentifier,scope.queryString),clearErrors=function(){return $(element).find(".selectList-item-error, .selectList-error").remove()},scope.currentContent.data().then(function(contentData){return scope.choices=contentData.attributes.multiple_choice,contentData.attempts.recent_attempt.success?(scope.isCorrect=!0,scope.selectedChoice=JSON.parse(contentData.attempts.recent_attempt.submission)[0].rawInput):void 0}),scope.selectedClassFor=function(choice){return scope.selectedChoice===choice.name?scope.isCorrect?"is-correct":scope.isCorrect===!1?"is-incorrect":"is-selected":""},scope.selectChoice=function(evt,choice){return scope.isSubmitting?void 0:(scope.isCorrect=null,clearErrors(),scope.selectedElement=evt.currentTarget,scope.selectedChoice=choice.name)},scope.isCorrect=function(){},scope.$on("submission:start",function(evt){return evt.stopPropagation?scope.isSubmitting=!0:void 0}),scope.$on("submission:end",function(evt){return evt.stopPropagation?scope.isSubmitting=!1:void 0}),scope.$on("submission:fail",function(evt,data){var errorElement;return evt.stopPropagation?(scope.isCorrect=!1,clearErrors(),scope.selectedElement?(errorElement=$compile("<div class='selectList-item-error'>"+data.result.message()+"</div>")(scope),$(scope.selectedElement).append(errorElement)):element.find("ul").before("<div class='selectList-error'><p>You need to select an element!</p></div>")):void 0}),scope.$on("submission:success",function(evt){return evt.stopPropagation?(scope.isCorrect=!0,$(element).find(".error-message").remove()):void 0}),deRegisterContent=submitDataService.registerContent(function(){return scope.selectedChoice||""}),scope.$on("$destroy",function(){return deRegisterContent()})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("nextChallengeButton",["OpenModal","$parse","NodeTreeTraverser","$q",function(OpenModal){return{restrict:"E",replace:!0,transclude:!0,scope:!0,template:"<a href='' class='btn btn--next' ng-class='{\"is-inactive\": isInactive}' ng-click='gotoNextChallenge()' ng-transclude></a>",link:function(scope,element,attrs){var currentLevelProgress,updateProgress;return currentLevelProgress=null,attrs.waitForPageComplete&&(scope.isInactive=!0),scope.progress=0,updateProgress=function(progress){return scope.progress=progress,attrs.waitForPageComplete?scope.isInactive=100===progress&&scope.nextPagePath?!1:!0:void 0},attrs.waitForPageComplete&&(scope.currentContent.data().then(function(contentData){return updateProgress(contentData.progress)}),scope.$on("page:update:content",function(evt,evtData){return updateProgress(evtData.data.progress)})),scope.currentIndex.getParentContainer("level",scope.queryString).then(function(data){var _ref;return currentLevelProgress=null!=(_ref=data.parentContainer)?_ref.progress:void 0}),scope.nextPagePath=null,scope.currentContent.data().then(function(data){return scope.nextPagePath=data.next_query_string,attrs.waitForPageComplete&&100===scope.progress?scope.isInactive=!scope.nextPagePath:void 0}),scope.gotoNextChallenge=function(){return scope.isInactive?void 0:(OpenModal.close({clear:!0}),scope.$emit("page:gotoNextChallenge",{courseIdentifier:scope.courseIdentifier,queryString:scope.queryString}))}}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("objectiveHeader",["NodeTreeTraverser",function(NodeTreeTraverser){return{restrict:"E",replace:!0,scope:!0,template:"<header class='header'>\n  <h1 class='header-title'>\n    <b class='header-num' ng-if=\"!disableNumbers\">{{levelNumber}}</b>\n    {{pageName}} <span class='header-label label' ng-if='isPending'>Pending</span>\n\n    <page-points possible-points=true class='header-label label' ng-if='isRequiredPage'></page-points>\n  </h1>\n</header>",link:function(scope,element,attrs){return scope.numberDivider=attrs.numberDivider,scope.disableNumbers=attrs.disableNumbers,scope.currentContent.indexData().then(function(indexData){var divider,result;return divider=scope.numberDivider||"-",result=(new NodeTreeTraverser).nodeIndexInTopLevelContainer(scope.queryString,indexData),scope.levelNumber=""+result.containerIndex+divider+result.nodeIndex}),scope.currentContent.data().then(function(contentData){return scope.isPending=contentData.attributes.pending,scope.pageName=contentData.attributes.name,scope.isRequiredPage=contentData.attributes.required})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("pageContent",["$compile","$timeout","CampusUrl",function($compile,$timeout,CampusUrl){return{restrict:"A",transclude:!0,scope:!0,link:function(scope,element,attrs,ctrl,transclude){var childScope,transferTextToHtml;return scope.courseAsset=function(assetName){return CampusUrl.fingerPrintFile(assetName)},scope.courseUrl=function(url){return CampusUrl.courseAssetUrl(url)},transferTextToHtml=function(){return element.find("span").html(element.find("span").text())},childScope=scope.$new(),scope.currentContent.attribute("page_content").then(function(pageContent){return scope.pageContent=pageContent,_.each(_.pairs(pageContent),function(content){var contentName,contentValue;return contentName=content[0],contentValue=content[1],scope[contentName]=contentValue}),transclude(scope,function(clonedElement){return element.append(clonedElement),$compile(element.contents())(childScope),"html"===attrs.pageContent?$timeout(function(){return transferTextToHtml(),$compile(element.contents())(childScope)}):void 0})})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("pageCount",function(){return{replace:!0,restrict:"E",scope:!0,template:"<span>{{totalPages}}</span>",link:function(scope,element,attrs){return scope.pages=attrs.pages,scope.required=attrs.required,scope.required?scope.currentIndex.getRequiredPages().then(function(pages){return scope.totalPages=pages.length}):scope.currentIndex.getPages(scope.pages.split(",")).then(function(pages){return scope.totalPages=pages.length})}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("pageHints",["$compile",function($compile){return{replace:!0,restrict:"E",scope:!0,template:"<div class='page-hints' ng-show='hasElements'>\n  <ol class='feed'></ol>\n</div>",link:function(scope,element){var addAnswer,addHint,listElement;return listElement=element.find("ol"),scope.hasElements=!1,addAnswer=function(answerData){var answerElement,childScope;return scope.hasElements=!0,answerElement=angular.element("<li class='widget feed-item feed-item--hint'>\n  <div class='widget-row widget-row--header feed-item-row feed-item-row--header'>\n    <div class='widget-header'>\n      <h3 class='widget-title feed-item-title'>Answer</h3>\n    </div>\n  </div>\n  <div class='widget-row widget-row--content'>\n    <div class='widget-content'>\n      <p>"+answerData.body+"</p>\n      <div ng-repeat='file in files'>\n        <h4>{{file.file_name}}</h4>\n        <code-highlight syntax=\"{{file.code_type}}\" bind-content='file.code'></code-highlight>\n      </div>\n    </div>\n  </div>\n</li>"),childScope=scope.$new(),childScope.files=answerData.files,listElement.append($compile(answerElement)(childScope))},addHint=function(hintData){var childScope,hintElement,index;return scope.hasElements=!0,index=listElement.children().length+1,hintElement=angular.element("<li class='widget feed-item feed-item--hint'>\n  <div class='widget-row widget-row--header feed-item-row feed-item-row--header'>\n    <div class='widget-header'>\n      <h3 class='widget-title feed-item-title'>Hint #"+index+"</h3>\n    </div>\n  </div>\n  <div class='widget-row widget-row--content'>\n    <div class='widget-content'>\n      <p>"+hintData.body+"</p>\n      <div ng-repeat='file in files'>\n        <h4>{{file.file_name}}</h4>\n        <code-highlight syntax=\"{{file.code_type}}\" bind-content='file.code'></code-highlight>\n      </div>\n    </div>\n  </div>\n</li>"),childScope=scope.$new(),childScope.files=hintData.files,listElement.append($compile(hintElement)(childScope))},scope.$on("hints:new",function(evt,eventData){return addHint(eventData.data)}),scope.$on("hints:answer",function(evt,eventData){return addAnswer(eventData.data)}),scope.currentContent.data().then(function(contentData){var hintCount,_ref,_ref1;return hintCount=null!=(_ref=contentData.attributes.hints)?_ref.count:void 0,_.each(null!=(_ref1=contentData.attributes.hints)?_ref1.used_hints:void 0,function(hint,index){return index===hintCount-1?addAnswer(hint):addHint(hint)})})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("pagePoints",function(){return{replace:!0,restrict:"E",scope:!0,template:"<span>{{points}} pts</span>",link:function(scope,elements,attrs){var updatePoints;return updatePoints=function(data){return attrs.possiblePoints?scope.currentContent.totalAvailablePoints().then(function(points){return scope.points=points}):scope.points=data.points.points},scope.currentContent.data().then(function(data){return updatePoints(data)}),scope.$on("page:update:content",function(evt,data){return updatePoints(data)})}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("pageVideo",function(){return{replace:!0,restrict:"E",scope:!0,template:"<div class='page-video video-frame'>\n  <sublime-video-player ng-if='normalVideoExists' player-url=\"{{playerUrl}}\" autoplay='{{autoplay}}' extra-controls='{{extraControls}}'></sublime-video-player>\n  <youtube-video ng-if='youtubeVideoExists'></youtube-video>\n</div>",link:function(scope,element,attrs){return scope.playerUrl=attrs.playerUrl,scope.autoplay=attrs.autoplay,scope.extraControls=attrs.extraControls,scope.startAtTime=attrs.startAtTime,scope.currentContent.data().then(function(contentData){return scope.youtubeVideoExists=!!contentData.attributes.youtube_video,scope.normalVideoExists=!!contentData.attributes.video})}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("pdf",["$sce","CampusUrl",function($sce,CampusUrl){return{restrict:"E",replace:!0,scope:{assetUrl:"@",externalUrl:"@",page:"@"},template:"<div class='resource resource--pdf'>\n  <iframe ng-src='{{pdfUrl()}}'></iframe>\n</div>",link:function(scope){return scope.secureUrl=$sce.trustAsResourceUrl(scope.url),scope.pdfUrl=function(){var baseUrlString;return baseUrlString="/viewer.html?file=",scope.assetUrl?baseUrlString+=CampusUrl.pdfUrl(scope.assetUrl):scope.externalUrl&&(baseUrlString+=CampusUrl.pdfExternalUrl(scope.externalUrl)),scope.page&&(baseUrlString+="#page="+scope.page),baseUrlString}}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("popover",["$compile","$timeout",function($compile,$timeout){return{replace:!1,restrict:"A",scope:!1,link:function(scope,element,attrs){var closeDelay,compilePopoverElement,delayedClose,popoverElement,resetDelayed,timer;return closeDelay=parseInt(attrs.popoverCloseDelay,10),popoverElement=angular.element("<span></span>"),$(element).popover({trigger:"click",html:!0,content:function(){return popoverElement.empty(),popoverElement.html(scope[attrs.popoverMessage]),popoverElement.find(".popover-precompile-hide").hide(),popoverElement},title:function(){return scope[attrs.popoverTitle]||attrs.popoverTitle},placement:function(){return scope[attrs.popoverPlacement]||attrs.popoverPlacement||"right"}}),compilePopoverElement=function(){return $timeout(function(){return $compile(popoverElement.contents())(scope),popoverElement.find(".popover-precompile-hide").show()})},timer=null,delayedClose=function(){return $timeout.cancel(timer),timer=$timeout(function(){return scope.popoverClose()},closeDelay)},resetDelayed=function(){return $timeout.cancel(timer)},$(element).on("shown.bs.popover",compilePopoverElement),closeDelay&&($(popoverElement).on("mouseout",delayedClose),$(popoverElement).on("mouseover",resetDelayed),$(element).on("mouseout",delayedClose)),scope.popoverClose=function(){return $(element).popover("hide")},scope.elementIsVisible=function(){return element.is(":visible")},scope.$watch("elementIsVisible()",function(visible){return visible?void 0:$(element).popover("hide")}),scope.$on("$destroy",function(){return $(element).off("shown.bs.popover",compilePopoverElement),$(element).off("mouseout",delayedClose),$(popoverElement).off("mouseout",delayedClose),$(popoverElement).off("mouseout",resetDelayed),$(element).popover("destroy")})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("requireCompleteAchievement",["NodeTreeTraverser","$q",function(NodeTreeTraverser,$q){return{restrict:"M",replace:!0,require:"^courseData",scope:!0,template:"<button class='btn btn--dev' ng-click='toggleIncompleteTemplate()' ng-if='isDevelopment'>render incomplete template</button>",link:function(scope,element,attrs,courseDataCtrl){var elementParent,elementParentParent,elseTemplateToRender,originalTemplate,requiredToComplete;return elementParent=element.parent(),elementParentParent=element.parent().parent(),requiredToComplete=attrs.requireCompleteAchievement.split(" ")[0],elseTemplateToRender=attrs.requireCompleteAchievement.split(" ")[1].split(":")[1],originalTemplate=courseDataCtrl.getTemplate(),$q.all([scope.currentUser.data(),scope.courseConfig.data(),scope.currentIndex.data(),scope.currentContent.data()]).then(function(data){var closestParentElement,configData,contentData,foundAchievement,indexData,userData;return userData=data[0],configData=data[1],indexData=data[2],contentData=data[3],closestParentElement=(new NodeTreeTraverser).getNearestParentNodeType(indexData,contentData,requiredToComplete),scope.isDevelopment=configData.development_mode,configData.development_mode?void 0:(foundAchievement=_.find(userData.achievements.awarded,function(achievement){var foundEvent;return foundEvent=_.find(achievement.events,function(evt){return"course"===requiredToComplete?evt.category===requiredToComplete&&"complete"===evt.action:evt.category===requiredToComplete&&"complete"===evt.action&&evt.label===closestParentElement.attributes._uid}),!!foundEvent}),foundAchievement?courseDataCtrl.setTemplate(originalTemplate):courseDataCtrl.setTemplate(elseTemplateToRender))}),scope.toggleIncompleteTemplate=function(){return courseDataCtrl.setTemplate(elseTemplateToRender)}}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("safeImage",function(){return{replace:!1,restrict:"A",scope:!0,link:function(scope,element){return element.on("error",function(){return element.css("visibility","hidden")})}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("socialShare",function(){return{replace:!0,restrict:"E",transclude:!0,scope:!0,template:'<div class="share" ng-mouseenter=\'activate()\' ng-mouseleave=\'deactivate()\' ng-class=\'{"is-inactive": isBeta}\'>\n  <a class="share-btn btn" href="">\n    <b>\n      Share This\n    </b>\n  </a>\n  <ul class="share-panel" ng-transclude></ul>\n</div>',link:function(scope,element,attrs){return scope.popupWidth=attrs.popupWidth||575,scope.popupHeight=attrs.popupHeight||400,scope.popupTop=attrs.popupTop||0,scope.popupLeft=attrs.popupLeft||0,scope.courseConfig.get("state").then(function(courseState){return scope.isBeta="beta"===courseState||"alpha"===courseState}),scope.activate=function(){scope.isBeta||element.addClass("is-active")},scope.deactivate=function(){element.removeClass("is-active")}}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("shareItemFacebook",function(){return{replace:!0,restrict:"E",scope:!0,template:'<li class="share-service">\n  <a class="share-service-item share-service-item--facebook" href="" ng-click=\'openPopup()\'>\n    <b class="srt">\n      Facebook\n    </b>\n  </a>\n</li>',link:function(scope){return scope.openPopup=function(){scope.courseConfig.data().then(function(configData){var options,url;return url="https://www.facebook.com/sharer/sharer.php?u="+configData.share_url,options="width="+scope.popupWidth+", height="+scope.popupHeight+", top="+scope.popupTop+", left="+scope.popupLeft,window.open(url,"Facebook",options)})}}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("shareItemGoogle",function(){return{replace:!0,restrict:"E",scope:!0,template:'<li class="share-service">\n  <a class="share-service-item share-service-item--google" href="" ng-click=\'openPopup()\'>\n    <b class="srt">\n      Google\n    </b>\n  </a>\n</li>',link:function(scope){return scope.openPopup=function(){scope.courseConfig.data().then(function(configData){var options,url;return url="https://plus.google.com/share?url="+configData.share_url,options="width="+scope.popupWidth+", height="+scope.popupHeight+", top="+scope.popupTop+", left="+scope.popupLeft,window.open(url,"Google",options)})}}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("shareItemTwitter",["$interpolate","NodeTreeTraverser",function($interpolate,NodeTreeTraverser){return{replace:!0,restrict:"E",scope:!0,template:'<li class="share-service share-service--twitter" data-text="">\n  <a class="share-service-item share-service-item--twitter" href="" ng-click=\'openPopup()\'>\n    <b class="srt">\n      Twitter\n    </b>\n  </a>\n</li>',link:function(scope){return scope.currentContent.indexData().then(function(indexData){var levelData;
return levelData=(new NodeTreeTraverser).nodeIndexInTopLevelContainer(scope.queryString,indexData),scope.levelNumber=levelData.containerIndex,scope.levelName=levelData.topLevelContainerNode.name}),scope.openPopup=function(){scope.courseConfig.data().then(function(configData){var message,options,url;return message=$interpolate(configData.twitter_message)(scope),url="https://twitter.com/share?text="+message+"&url="+configData.share_url,options="width="+scope.popupWidth+", height="+scope.popupHeight+", top="+scope.popupTop+", left="+scope.popupLeft,window.open(url,"Twitter",options)})}}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("splitCourseProgress",["CurrentIndexData","CampusUrl","$compile","$rootScope",function(CurrentIndexData,CampusUrl,$compile,$rootScope){return{restrict:"E",replace:!0,scope:!0,template:"<ol ng-class='progressClass' class='progressList'>\n\n</ol>",link:function(scope,element){var buildProgressList,childScopes,progressElements;return childScopes=null,progressElements=null,buildProgressList=function(data){var containerNodes;return _.each(childScopes,function(childScope){return childScope.$destroy(),childScope=null}),_.each(progressElements,function(element){return element.remove(),element=null}),childScopes=[],progressElements=[],data?(element.empty(),containerNodes=_.filter(data.nodes,function(node){return"container"===node.node_type&&"user"!==node.node_label}),_.each(containerNodes,function(node,index){var childScope,progressElement;return progressElement=angular.element("<li class='progressList-item progress'>\n  <a href='' ui-sref='root.courseContent({queryString: \""+node.query_string+"\"})' class='progressList-link' tooltip title='"+(node.progress||0)+"% of "+S(node.node_label).capitalize().s+" "+(index+1)+"'>\n    <div class='progress-bar' style='width: "+(node.progress||0)+"%;'></div>\n  </a>\n</li>"),childScope=scope.$new(),progressElements.push(progressElement),childScopes.push(childScope),element.append($compile(progressElement)(childScope))}),scope.progressClass="progressList--"+element.find("li").length):void 0},new CurrentIndexData(scope.courseIdentifier).data().then(function(data){return buildProgressList(data)}),$rootScope.$on("page:update:index",function(evt,eventData){return buildProgressList(eventData.data)}),scope.$on("$destroy",function(){return _.each(childScopes,function(childScope){return childScope.$destroy(),childScope=null}),_.each(progressElements,function(element){return element.remove(),element=null})})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("startEditButton",function(){return{replace:!0,restrict:"E",scope:!0,template:"<a href='' class='content-codeEditor-btn btn' ng-click='showEditor()'><b>{{buttonLabel}}</b></a>",link:function(scope){var updateButtonText;return updateButtonText=function(contentData){var _ref;return scope.buttonLabel=100===contentData.progress?"Restart Challenge":(null!=(_ref=contentData.attempts)?_ref.recent_attempt:void 0)?"Resume Challenge":"Start Challenge"},scope.showEditor=function(){return scope.$emit("page:editor:activate",{courseIdentifier:scope.courseIdentifier,queryString:scope.queryString})},scope.$on("page:update:content",function(evt,eventData){return eventData.queryString===scope.queryString?scope.currentContent.data().then(function(contentData){return updateButtonText(contentData)}):void 0}),scope.currentContent.data().then(function(contentData){return updateButtonText(contentData)})}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("sublimeVideoPlayer",["CampusUrl","$cookies","$rootScope","$timeout","SublimeLoader",function(CampusUrl,$cookies,$rootScope,$timeout,SublimeLoader){return{restrict:"E",replace:!0,scope:!0,template:"<div>\n  <div class='video-frame'>\n    <video data-autoresize='fit' title=\"{{name}}\" data-autoplay='{{autoplay}}' poster='{{poster}}' data-fullmode-priority='window'></video>\n  </div>\n  <div class='video-controls' ng-if='extraControlsEnabled()'>\n    <div class='video-speed'>\n      <dropdown class='video-speed-dropdown' repeat='speed in speeds' label='Playback Speed' model='currentSpeed' on-select='updateSpeed($value)'>\n        <a href='' class='dropdown-link'>{{speed}}x</a>\n      </dropdown>\n    </div>\n    <div class='video-download'>\n      <dropdown class='video-download-dropdown' repeat='file in downloads' label='Download'>\n        <a href='{{file.url}}' target='_blank' class='dropdown-link'>{{file.label}}</a>\n      </dropdown>\n    </div>\n  </div>\n</div>",link:function(scope,element,attrs){var addVideoFiles,cacheVideoQuality,currentQuality,getDownloads,getEmbedElement,getVideoElement,initializeScopeVideoData,isHd,parseDownloadSizes,preparedVideoElement,resizePollInterval,videoEl;return scope.playerUrl=attrs.playerUrl,scope.downloadFileType=attrs.downloadFileType,scope.downloadSizes=attrs.downloadSizes,scope.autoplay=attrs.autoplay,scope.extraControls=attrs.extraControls,scope.startAtTime=attrs.startAtTime,preparedVideoElement=null,resizePollInterval=null,videoEl=$(element).find(".video-frame"),getVideoElement=function(){return element.find("video")[0]},getEmbedElement=function(){return element.find("embed")[0]},currentQuality=null,cacheVideoQuality=function(videoElement){return currentQuality=$(videoElement).find("[src='"+videoElement.currentSrc+"']").data("quality")||"sd",currentQuality!==localStorage["sublimeVideoPlayer:currentVideoQuality"]?localStorage["sublimeVideoPlayer:currentVideoQuality"]=currentQuality:void 0},isHd=function(testFile,files){var largerFiles,sameFileTypes;return sameFileTypes=_.where(files,{type:testFile.type}),sameFileTypes.length>1?(largerFiles=_.filter(sameFileTypes,function(file){return file.width<testFile.width}),largerFiles.length>0?!1:!0):!1},parseDownloadSizes=function(){var downloadSizes;return downloadSizes=_.map(scope.downloadSizes.split(","),function(sizeStr){var labelArr,sizeArr;return sizeArr=sizeStr.split("x"),labelArr=sizeArr[0].split(":"),{width:labelArr[1],10:10,height:sizeArr[1],label:labelArr[0].replace(/^\s*/,"")}})},getDownloads=function(videoData){var allFiles,downloadFileTypes,downloadSizes,downloads;return allFiles=videoData.files,downloadFileTypes=_.filter(allFiles,function(file){return file.type.match(new RegExp(scope.downloadFileType))}),downloadSizes=parseDownloadSizes(),downloads=_.filter(downloadFileTypes,function(file){var foundItems;return foundItems=0,_.each(downloadSizes,function(size){var _ref;return file.width===size.width&&file.height===size.height&&(null!=(_ref=file.url)?_ref.length:void 0)>0?(file.label=size.label,foundItems+=1):void 0}),foundItems>0})},addVideoFiles=function(videoData){var sourceTags,trackTags,videoFiles,video_element;return videoFiles=videoData.files,videoFiles.sort(function(a){return a.type.match(/mp4/)?-1:1}),sourceTags=_.map(videoFiles,function(file){return file.type.match(/quicktime/)?void 0:"<source src='"+file.url+"' "+(isHd(file,videoFiles)?"data-quality='hd'":"")+"/>"}),"hd"===localStorage["sublimeVideoPlayer:currentVideoQuality"]?sourceTags.sort(function(a){return a.match(/data-quality=['"]hd['"]/)?-1:1}):sourceTags.sort(function(a){return a.match(/data-quality=['"]hd['"]/)?1:-1}),trackTags=_.map(videoData.subtitles,function(subtitle){var label;return label=subtitle.label?" label='"+subtitle.label+"' ":void 0,"<track src='"+CampusUrl.subtitleUrl(subtitle.path)+"' srclang='"+subtitle.lang+"' "+label+"/>"}),video_element=element.find("video"),video_element.append(sourceTags.join("\n")),video_element.append(trackTags.join("\n")),video_element=null},scope.speeds=[.5,1,1.5,2,3],scope.currentContent.attribute("name").then(function(name){return scope.name=name}),scope.extraControlsEnabled=function(){return"hide"!==scope.extraControls},scope.currentSpeed=scope.extraControlsEnabled()?parseFloat($cookies.videoPlaybackSpeed)||1:1,scope.updateSpeed=function(speed){return $cookies.videoPlaybackSpeed=speed.toString(),getVideoElement().playbackRate=speed},scope.seekTo=function(time){var hours,minutes,seconds,timeArr;return time.constructor===String&&(timeArr=time.split(":"),hours=parseInt(3===timeArr.length?timeArr[0]:0,10),minutes=parseInt(3===timeArr.length?timeArr[1]:timeArr[0],10),seconds=parseInt(3===timeArr.length?timeArr[2]:timeArr[1],10),minutes+=60*hours,seconds+=60*minutes,time=seconds),scope.player&&scope.player.seekTo?scope.player.seekTo(time):void 0},scope.initializeSublime=function(videoData){return"undefined"==typeof sublime?SublimeLoader.load(scope.playerUrl).then(function(){return scope.loadSublime(videoData)}):(sublime.unprepare(preparedVideoElement),$timeout(function(){return scope.loadSublime(videoData)}))},scope.loadSublime=function(videoData){return"hide"!==scope.extraControls&&(scope.downloads=getDownloads(videoData)),addVideoFiles(videoData),sublime.load(),preparedVideoElement=getVideoElement(),sublime.ready(function(){return function(){return sublime.prepare(preparedVideoElement,function(player){return player?(scope.player=player,scope.updateSpeed(scope.currentSpeed),scope.startAtTime&&scope.player.on("metadata",function(){return scope.seekTo(scope.startAtTime)}),player.on("timeUpdate",function(){var videoElement,_ref;return videoElement=getVideoElement(),cacheVideoQuality(videoElement),$(videoElement).is(":visible")||(null!=(_ref=$(getEmbedElement()))?_ref.is(":visible"):void 0)?videoElement=null:(scope.player.pause(),videoElement=null)})):void 0})}}(this))},scope.initializeVideoResize=function(){var setWidth;if(!scope.resizePollInterval)return setWidth=0,resizePollInterval=setInterval(function(){var newHeight,videoHeight,videoWidth,width;if(scope.player)return width=videoEl.width(),width!==setWidth?(videoHeight=scope.player.videoHeight()||720,videoWidth=scope.player.videoWidth()||1280,newHeight=videoHeight/videoWidth*width,scope.player.setSize(width,newHeight),setWidth=width):void 0},100)},initializeScopeVideoData=function(videoData){return scope.poster=videoData.poster,scope.startAtTime=videoData.start_at_time,scope.initializeVideoResize(videoData),scope.initializeSublime(videoData)},scope.videoData?initializeScopeVideoData(scope.videoData):scope.currentContent.attribute("video").then(function(videoData){return initializeScopeVideoData(videoData)}),$rootScope.$on("video:stop",function(){return scope.player?scope.player.pause():void 0}),scope.$on("$destroy",function(){return window.clearInterval(resizePollInterval),resizePollInterval=null,sublime&&sublime.unprepare&&sublime.unprepare(preparedVideoElement),videoEl.remove(),videoEl=null,preparedVideoElement.remove(),preparedVideoElement=null,element.find("source").remove(),element.find("track").remove(),element.find(".sublimevideo-View").remove(),element.remove(),element=null})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("submitButton",["KeyboardShortcuts","$timeout","Submitter",function(KeyboardShortcuts,$timeout,Submitter){return{restrict:"E",replace:!0,scope:!0,transclude:!0,template:"<div class=\"submit-button\">\n  <a ng-click='submit($event)' href='' class='btn btn--next' ng-class=\"{'btn--next--complete': pageIsComplete, 'is-submitting': isSubmitting}\">\n    <b class='loader-text' ng-transclude></b>\n    <span class='loader-el'></span>\n  </a>\n  <next-challenge-button class='btn--continue' ng-show='pageIsComplete'>Continue</next-challenge-button>\n</div>",link:function(scope,element,attrs){var submitter,updatePoints;return scope.isSubmitting=!1,scope.hideNextChallengeButton=attrs.hideNextChallengeButton,submitter=new Submitter(scope.courseIdentifier,scope.queryString,{useFlashError:attrs.flashError}),updatePoints=function(){return scope.currentContent.totalAvailablePoints().then(function(points){return scope.points=points})},scope.currentContent.data().then(function(contentData){return updatePoints(),scope.progress=contentData.progress}),scope.$on("page:trigger:submit",function(){return scope.submit()}),KeyboardShortcuts.key("⌘+enter, ctrl+enter, ctrl+s, ⌘+s",function(){return scope.submit()}),scope.updatePageIsComplete=function(contentData){return scope.hideNextChallengeButton?void 0:scope.pageIsComplete=100===contentData.progress||contentData.attributes.pending},scope.currentContent.data().then(function(data){return scope.updatePageIsComplete(data)}),scope.submit=function(){return scope.isSubmitting=!0,submitter.submit(scope)["finally"](function(){return $timeout(function(){return scope.isSubmitting=!1},200)})},scope.$on("page:editor:collapse",function(){var useFlashError;return useFlashError=attrs.flashError}),scope.$on("page:editor:fullscreen",function(){var useFlashError;return useFlashError=!0}),scope.$on("page:update:content",function(evt,evtData){return updatePoints(),scope.updatePageIsComplete(evtData.data)}),scope.$on("$destroy",function(){return KeyboardShortcuts.unbind("⌘+enter, ctrl+enter, ctrl+s, ⌘+s"),submitter.cleanUp()})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("tabbedResources",["$timeout",function($timeout){return{restrict:"E",replace:!0,require:"?^panelElement",scope:!0,controller:["$scope",function($scope){return this.setActiveResource=function(resource){return $scope.setActiveResource(resource)},this.getActiveResource=function(){return $scope.activeResource},this}],template:"<div ng-if='resourcesExist()'>\n  <div class='bar bar--resources'>\n    <ul class='tabList tabList--resources'>\n      <li class='tabList-item' ng-repeat='resource in resources'>\n        <a class='tabList-link {{resource.name}}' ng-class=\"{'is-active': resourceIsActive(resource)}\" href='' ng-click='toggleActiveResource(resource)'>{{resource.name}}</a>\n      </li>\n    </ul>\n  </div>\n  <resource-display resources='resources' active-resource='activeResource'></resources-display>\n</div>",link:function(scope,element,attrs,activityCtrl){var activatePreviewResource,successWatcherOff;return scope.defaultSelected=attrs.defaultSelected,scope.activeResource="",scope.currentContent.attribute("resources").then(function(resources){return scope.resources=resources}),scope.toggleActiveResource=function(resource){scope.activeResource===resource.name?(scope.activeResource=!1,activityCtrl&&activityCtrl.fullScreenOff()):scope.activeResource=resource.name},scope.resourcesExist=function(){return scope.resources&&scope.resources.length>0},scope.resourceIsActive=function(resource){return resource.name===scope.activeResource},activatePreviewResource=function(){var previewResource,resourceEl,_ref;return previewResource=_.find(scope.resources,function(resource){return!!resource.html_preview}),previewResource&&(resourceEl=null!=(_ref=$(element).next())?_ref.find("."+previewResource.name):void 0)?$timeout(function(){return resourceEl.trigger("click")}):void 0},successWatcherOff=scope.$on("submission:success",function(evt,evtData){var _ref,_ref1;if(!(null!=(_ref=evtData.result.firstFailure)?null!=(_ref1=_ref.err)?_ref1.line:void 0:void 0))return successWatcherOff(),activatePreviewResource()}),scope.defaultSelected?scope.$watch("resources",function(resources){var index;return!scope.activeResource&&(null!=resources?resources.length:void 0)>0?(index=parseInt(scope.defaultSelected,10)-1||0,scope.activeResource=resources[index].name):$timeout(function(){return scope.$apply()})}):void 0}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("resourceDisplay",["$compile","CampusUtil",function($compile,CampusUtil){return{restrict:"E",replace:!0,require:"^tabbedResources",scope:!0,template:"<div>\n</div>",link:function(scope,element,attrs,tabbedResourcesCtrl){var childScope;return attrs.resources&&scope.$watch(attrs.resources,function(resources){return resources?scope.resources=resources:void 0}),scope.setActiveResource=function(resource){return tabbedResourcesCtrl.setActiveResource(resource)},scope.getActiveResource=function(){return tabbedResourcesCtrl.getActiveResource()},childScope=null,scope.renderedResources=[],scope.$watch("resources",function(resources){return _.each(resources,function(resource){var attributes,elementName,resourceElement,resourceKey,_i,_len,_ref,_results;for(_ref=Object.keys(resource),_results=[],_i=0,_len=_ref.length;_len>_i;_i++){if(resourceKey=_ref[_i],"name"!==resourceKey&&!resourceKey.match(/^\$\$/)&&resource[resourceKey]&&scope.renderedResources.indexOf(resource.name)<0){elementName=resourceKey.replace("_","-"),attributes=[],_.each(resource[resourceKey],function(value,contentName){return attributes.push(""+contentName.replace("_","-")+"='"+CampusUtil.escapeHTML(value)+"'")}),scope.renderedResources.push(resource.name),resourceElement=angular.element("<"+elementName+" "+attributes.join(" ")+" tabbed-resource='true' ng-show='getActiveResource() === \""+resource.name+"\"'></"+elementName+">"),element.append(resourceElement);break}_results.push(void 0)}return _results}),childScope&&(childScope.$destroy(),childScope=null),childScope=scope.$new(),$compile(element.contents())(childScope)})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("taskList",["Executor","CurrentSubmitData","$timeout","FlashMessage","AttemptData",function(Executor,CurrentSubmitData,$timeout,FlashMessage,AttemptData){return{replace:!0,restrict:"E",scope:!0,controller:["$scope",function($scope){return $scope.setCurrentActiveIndex=function(index){return $scope.currentActiveIndex=index}}],template:'<div>\n  <div class="group mbs">\n    <h3 class="fl">Objectives</h3>\n    <ol class="dotList fr">\n      <task-list-dot ng-repeat="task in tasks" task-data="task" index="{{$index + 1}}"></task-list-dot>\n    </ol>\n  </div>\n\n  <div ng-class="tasks-complete" ng-if=\'tasksComplete\'>\n    <p>You have successfully completed all objectives.</p>\n  </div>\n\n  <ol class="lr mbm">\n    <task-list-task ng-repeat="task in tasks" task-data="task" index="{{$index + 1}}"></task-list-task>\n  </ol>\n</div>',link:function(scope){var executorService,getTaskByTaskName,previousSentIndex,runningCheck,showSuccessFlash,submitDataService,submitSuccess,timer,updatePoints;return scope.currentContent.attribute("executor").then(function(executorData){return scope.executorName=executorData.executor_name}),updatePoints=function(){return scope.currentContent.totalAvailablePoints().then(function(points){return scope.points=points})},scope.currentContent.data().then(function(contentData){return scope.tasks=contentData.attributes.tasks,scope.executorData=contentData.attributes.executor,scope.progress=contentData.progress,updatePoints()}),scope.$on("page:update:content",function(){return updatePoints()}),executorService=new Executor(scope.courseIdentifier,scope.queryString),submitDataService=new CurrentSubmitData(scope.courseIdentifier,scope.queryString),timer=null,runningCheck=!1,previousSentIndex=1,showSuccessFlash=function(){var title;return title=100===scope.progress?"Success! <span class='flash-label'>+"+scope.points+" pts.</span>":"Success!",FlashMessage.show({htmlClass:"flash--success",closeButton:!1,closeDelay:2200,message:null,title:title})},submitSuccess=function(report){var attemptService,submitContent;return 100!==scope.progress?(scope.progress=100,attemptService=new AttemptData(scope.courseIdentifier,scope.queryString),submitContent=submitDataService.getContent(),attemptService.recordAttempt(report,submitContent).then(function(){return scope.currentContent.refreshAllData(scope)}),scope.$emit("submission:success",{result:report,executorData:scope.executorData,courseIdentifier:scope.courseIdentifier,queryString:scope.queryString}),showSuccessFlash()):void 0},getTaskByTaskName=function(taskName){return _.find(scope.tasks,function(task){return task.name===taskName})},executorService.onChange(function(report){var failureName,failureObj,failureTask,taskIndex;return failureName=report.firstFailure&&report.firstFailure.title,failureObj=report.failures[failureName],scope.$broadcast("task:attempt"),failureObj&&failureObj.task?(failureTask=getTaskByTaskName(failureObj.task),taskIndex=scope.tasks.indexOf(failureTask)+1,previousSentIndex=taskIndex,scope.$broadcast("task:failure",{taskIndex:taskIndex})):failureName?void 0:(scope.tasksComplete=!0,scope.$broadcast("task:failure",{taskIndex:scope.tasks.length+1}),scope.$emit("page:task:success",{courseIdentifier:scope.courseIdentifier,queryString:scope.queryString}),submitSuccess(report))}),scope.$on("$destroy",function(){return executorService.cleanUp()})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("taskListDot",["TaskData","CurrentContentData","FeedItemPresenter","$timeout",function(TaskData,CurrentContentData,FeedItemPresenter,$timeout){return{replace:!0,restrict:"E",scope:!0,template:'<li class="dotList-item" ng-class="{\'is-active\': isActive, \'is-complete\': isComplete, \'is-submitting\': isSubmitting}">\n  <a href="" class="dotList-item-link" ng-click="activateResource()">\n    <b class="srt">{{index}}</b>\n  </a>\n</li>',link:function(scope,element,attrs){return scope.task=scope.$parent[attrs.taskData],scope.index=attrs.index,scope.isComplete=!1,scope.activateResource=function(){return scope.setCurrentActiveIndex(scope.index)},scope.$watch("currentActiveIndex",function(index){return void 0!==index?scope.isActive=index===scope.index?!0:!1:void 0}),1===parseInt(scope.index,10)&&(scope.isActive=!0),scope.$on("task:attempt",function(){var timer;return scope.isSubmitting=!1,scope.isActive?timer=$timeout(function(){return scope.isSubmitting=!0},100):void 0}),scope.$on("task:failure",function(evt,evtData){return scope.isSubmitting=!1,scope.isActive=parseInt(scope.index,10)<=evtData.taskIndex?!0:!1,evtData.taskIndex>parseInt(scope.index,10)?(scope.isActive=!1,scope.isComplete=!0):scope.isComplete=!1}),parseInt(scope.index,10)>1?scope.isActive=!1:void 0}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("taskListTask",["TaskData","CurrentContentData","FeedItemPresenter","CurrentCourseConfig","$timeout",function(TaskData,CurrentContentData,FeedItemPresenter,CurrentCourseConfig,$timeout){return{replace:!0,restrict:"E",scope:!0,template:"<li class=\"widget widget--task\" ng-class=\"{'is-complete': isComplete, 'is-active': !isHidden}\">\n  <div class='widget-row widget-row--content'>\n    <div class='widget-content'>\n      <div compile-html=\"{{task.body}}\"></div>\n\n      <div class=\"widget-section task-answer\" compile-html=\"{{taskAnswer}}\" ng-if=\"taskAnswer\"></div>\n    </div>\n  </div>\n\n  <div class='widget-row widget-row--a'>\n    <div class='widget-btnList btnList'>\n      <watch-video-button class=\"btnList-btn\" video-data=\"task.video\" video-directive=\"sublime-video-player\" directive-options=\"player-url='//cdn.sublimevideo.net/js/33r2xa49.js' download-file-type='mp4' download-sizes='HD:1280x720,SD:854x480' autoplay='true'\"></watch-video-button>\n      <a class='btn btn--hint' href='' ng-click='getTaskAnswer(task.name)' ng-if=\"!taskAnswer && answerAvailable\" ng-click=\"{'is-submitting': answerIsSubmitting}\">\n        <span class='loader-el'></span>\n        <span class='loader-text'>{{answerButtonLabel}}</span>\n      </a>\n    </div>\n  </div>\n</li>",link:function(scope,element,attrs){return scope.task=scope.$parent[attrs.taskData],scope.index=attrs.index,scope.taskAnswer=scope.task.answer,scope.answerAvailable=scope.task.answer_available,scope.isComplete=!1,scope.isHidden=!0,$timeout(function(){return $(element).find(".btn--hint").css({left:"1px"})}),$timeout(function(){return $(element).find(".btn--hint").css({left:""})}),1===parseInt(scope.index,10)&&(scope.isHidden=!1),new CurrentCourseConfig(scope.courseIdentifier).data().then(function(configData){var taskPoints;return taskPoints=configData.points_per_task_answer,scope.answerButtonLabel=taskPoints>0?"Solution (-"+taskPoints+" pts)":"Solution"}),scope.$watch("currentActiveIndex",function(index){return void 0!==index?scope.isHidden=index===scope.index?!1:!0:void 0}),scope.$on("task:failure",function(evt,evtData){return scope.isHidden=parseInt(scope.index,10)<=evtData.taskIndex?!1:!0,evtData.taskIndex>parseInt(scope.index,10)?(scope.isHidden=!0,scope.isComplete=!0):scope.isComplete=!1}),scope.getTaskAnswer=function(taskName){return scope.answerIsSubmitting=!0,(new TaskData).getTaskData(scope.courseIdentifier,scope.queryString,taskName).then(function(taskData){return scope.taskAnswer=taskData.answer,new CurrentContentData(scope.courseIdentifier,scope.queryString).refreshContent().then(function(data){return scope.$emit("page:update:content",{courseIdentifier:scope.courseIdentifier,queryString:scope.queryString,data:data})})})["finally"](function(){return scope.answerIsSubmitting=!1})}}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("taskSummary",function(){return{replace:!0,restrict:"E",scope:!0,template:'<ul class="list list--md">\n  <li class="list-item" ng-repeat="task in tasks">\n    <h4>Objective {{$index + 1}}</h4>\n    <div compile-html="{{task.body}}"></div>\n  </li>\n</ul>',link:function(scope){return scope.currentContent.data().then(function(contentData){return scope.tasks=contentData.attributes.tasks})}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("attributeEditorTabs",["$compile",function(){return{restrict:"E",replace:!0,scope:!0,transclude:!0,template:"<div class='codeEditor'>\n  <div class='codeEditor-bar'>\n    <ul class='tabList tabList--editor'>\n      <li class='tabList-item' ng-repeat=\"file in files\">\n        <a href='' class='tabList-link' ng-class=\"{'is-active': activeEditor == file}\" ng-click=\"activateEditor(file)\">{{file}}</a>\n      </li>\n    </ul>\n  </div>\n\n  <div class=\"test-editors\">\n\n  </div>\n<div>",link:function(scope,element,attrs,ctrl,transclude){var testEditorsEl;return testEditorsEl=element.find(".test-editors"),scope.files=[],scope.activateEditor=function(file){scope.activeEditor=file,testEditorsEl.children().hide(),$(testEditorsEl).find("[title="+scope.activeEditor+"]").show()},transclude(scope,function(clonedHtml){var htmlElements;return htmlElements=_.filter(clonedHtml,function(el){return el.constructor.toString().match(/HTML.*Element/)}),_.each(htmlElements,function(el){var fileName;return fileName=$(el).attr("title")||"NONAME",$(el).attr("title",fileName),scope.activeEditor||(scope.activeEditor=fileName),scope.files.push(fileName),testEditorsEl.append(el)}),scope.activateEditor(scope.activeEditor)})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("contentSync",["CurrentSyncData","ContentEdit","ContentData",function(CurrentSyncData,ContentEdit,ContentData){return{replace:!1,restrict:"M",scope:!1,link:function(scope){var courseDataService,deepExtend,getSyncContent;return courseDataService=new ContentData,courseDataService.refreshContent(scope.courseIdentifier,scope.queryString,{builder:!0,secure:!1}).then(function(contentData){return scope.contentData=contentData}),getSyncContent=function(){return new CurrentSyncData(scope.courseIdentifier,scope.queryString).getContent()},deepExtend=function(destination,source){var mainArguments;return mainArguments=arguments,_.each(Object.keys(source),function(property){return source[property]&&source[property].constructor&&source[property].constructor===Object?(destination[property]=destination[property]||{},mainArguments.callee(destination[property],source[property])):destination[property]=source[property]}),destination},scope.$parent.$on("content:save",function(){var contentEdit,newAttributesContent,newContent;return newAttributesContent={},_.each(getSyncContent(),function(contentFn){return newAttributesContent=deepExtend(newAttributesContent,contentFn())}),newContent={attributes:newAttributesContent},contentEdit=(new ContentEdit).saveContentData(scope.courseIdentifier,scope.queryString,newContent)})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("testAttemptFeed",["ClientExecutorData","CurrentSyncData",function(ClientExecutorData,CurrentSyncData){return{restrict:"E",replace:!0,scope:!0,template:"<div class='feed plm prm test-attempt-feed'>\n  <test-feed-item ng-repeat=\"attempt in attempts\" data-attempt='{{attempt.attempt_name}}'></test-feed-item>\n  <!-- <div class='btnList mtm'>\n    <a class='btnList-btn btn btn--b' href=\"\" ng-click='newSuccess()'>New Success</a>\n    <a class='btnList-btn btn btn--b' href=\"\" ng-click='newFailure()'>New Failure</a>\n  </div> -->\n</div>",link:function(scope){var cloneAttempt,setAttributesNull,stopWatching,syncDataService;return syncDataService=new CurrentSyncData(scope.courseIdentifier,scope.queryString),stopWatching=scope.$watch("contentData",function(contentData){return contentData?(stopWatching(),scope.attempts=contentData.attributes.executor.attempts):void 0}),cloneAttempt=function(attempt){var jsonCopy,newAttempt;return jsonCopy=JSON.stringify(attempt),newAttempt=JSON.parse(jsonCopy),delete newAttempt.$$hashKey,newAttempt.attempt_name=attempt.success?"NEW SUCCESS!":"NEW FAILURE!",newAttempt},scope.newFailure=function(){var failureAttempts,lastFailure;return failureAttempts=_.where(scope.attempts,{success:void 0}),lastFailure=failureAttempts[failureAttempts.length-1],scope.attempts.push(cloneAttempt(lastFailure))},scope.newSuccess=function(){var insertIndex,lastSuccess,successAttempts;return successAttempts=_.where(scope.attempts,{success:!0}),insertIndex=scope.attempts.indexOf(successAttempts[successAttempts.length-1])+1,lastSuccess=successAttempts[successAttempts.length-1],scope.attempts.splice(insertIndex,0,cloneAttempt(lastSuccess))},scope.$on("attempt:delete",function(evt,attempt){var indexToDelete;return indexToDelete=scope.attempts.indexOf(attempt),scope.attempts.splice(indexToDelete,1)}),setAttributesNull=function(attributes,attributeNames){return _.each(attributeNames,function(attribute){var _ref;return""===(null!=(_ref=attributes[attribute])?_ref.replace(/\n/g,""):void 0)?attributes[attribute]=null:void 0}),attributes}}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("testFeed",["$compile","$timeout","ExecutorData",function($compile,$timeout,ExecutorData){return{restrict:"E",replace:!0,scope:!0,template:"<div class='feed'>\n\n</div>",link:function(scope,element){return scope.getAttempts=function(){return new ExecutorData(scope.courseIdentifier,scope.queryString).getAttempts()},scope.$watch("getAttempts()",function(feedData){var displayedFeedData,newItems;return newItems=_.difference(feedData,displayedFeedData),displayedFeedData=feedData,_.each(newItems,function(item){return element.prepend($compile(item)(scope))}),$timeout(function(){return element.children().addClass("is-closed"),$(element.children()[0]).removeClass("is-closed")})},!0)}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("testFeedItem",["Executor","CurrentSyncData","OpenModal",function(Executor,CurrentSyncData,OpenModal){return{restrict:"E",replace:!0,scope:!0,template:"<div class='widget feed-item is-closed {{classifyTitle()}}' ng-dblclick=\"toggle($event)\">\n  <div class='widget-row widget-row--header feed-item-row feed-item-row--header'>\n    <div class='widget-header'>\n      <a href='' class='widget-toggle feed-item-toggle toggle' ng-click='toggle($event)'>\n        <b class='srt'>Toggle</b>\n      </a>\n      <h3 class='widget-title feed-item-title'>\n        <a class='widget-title-link' href=''>{{attemptType()}}: {{attempt.attempt_name}}</a>\n      </h3>\n    </div>\n  </div>\n  <div class='widget-row widget-row--content'>\n    <a class='btnList-btn btn btn--control' href='' ng-click='submit()'>Run</a>\n    <div class='widget-content'>\n      <h3>Executor: {{executorName}}</h3>\n\n      <h4>Expected {{matchTitle(attempt)}}</h4>\n      <p compile-html='{{attemptMessage(attempt)}}'></p>\n\n      <h4 ng-show=\"actualResponse\">Actual</h4>\n      <p ng-show=\"actualResponse\">{{actualResponse}}</p>\n\n      <div class=\"mbm\" ng-repeat=\"file in attempt.files\" ng-if=\"attempt.files\">\n        <b>{{file.file_name}}</b>\n        <code-highlight syntax={{file.code_type}} bind-content=\"file.code\" ng-dblclick=\"cancelDblClick($event)\"></code-highlight>\n      </div>\n      \n      <div ng-if=\"attempt.raw_input\">\n        <b>Raw Input</b>\n        <pre>{{attempt.raw_input}}</pre>\n      </div>\n    </div>\n  </div>\n  <div class='widget-row widget-row--a widget-row--footer'>\n    <div class='widget-btnList btnList'>\n      <!-- <a class='btnList-btn btn btn--control' href='' ng-click='edit()'>{{editButtonLabel || 'Edit'}}</a> -->\n      <a class='btnList-btn btn btn--control' href='' ng-click='submit()'>Run</a>\n    </div>\n  </div>\n</div>",link:function(scope,element,attrs){var executorService,getSubmitContent,getTests,renameTask,stopWatching,submitContent;
return scope.attempt=scope.$parent.attempt,scope.state=attrs.state,executorService=null,null===scope.attempt.task&&(scope.attempt.task=""),scope.attempt.files=_.map(scope.attempt.files,function(file){return null===file.code&&(file.code=""),file}),stopWatching=scope.$watch("contentData",function(contentData){return contentData?(stopWatching(),executorService=new Executor(scope.courseIdentifier,scope.queryString,contentData.attributes.executor)):void 0}),renameTask=function(newTasks){var attemptTasks,currentTasks,differences,leftDifference,rightDifference;return attemptTasks=_.pluck(scope.$parent.attempts,"task"),currentTasks=_.pluck(newTasks,"name"),leftDifference=_.difference(attemptTasks,currentTasks),rightDifference=_.difference(currentTasks,attemptTasks),differences=_.filter(_.flatten([leftDifference,rightDifference]),function(item){return!!item&&item!==scope.attempt.task}),1===differences.length?scope.attempt.task=differences[0]:void 0},scope.$watch("contentData.attributes.tasks",function(tasks){return tasks?(-1===tasks.indexOf(scope.attempt.task)&&renameTask(tasks),scope.tasks=tasks,scope.taskOptions=_.map(tasks,function(task){return{value:task.name,name:task.name}}),scope.taskOptions.unshift({value:"",name:"None"})):void 0},!0),getTests=function(){var allContent,syncService,testsObj;return syncService=new CurrentSyncData(scope.courseIdentifier,scope.queryString),allContent=_.map(syncService.getContent(),function(itemFn){return itemFn()}),testsObj=_.find(allContent,function(content){return content.executor&&content.executor.attributes&&content.executor.attributes.tests}),testsObj.executor.attributes.tests},submitContent=[],scope.cancelDblClick=function(evt){return evt.stopPropagation()},scope.newFile=function(){return scope.attempt.files.push({})},scope.deleteFile=function(file){var indexToDelete;return indexToDelete=scope.attempt.files.indexOf(file),scope.attempt.files.splice(indexToDelete,1)},scope.deleteAttempt=function(){return scope.$emit("attempt:delete",scope.attempt)},getSubmitContent=function(){var _ref;return submitContent=(null!=(_ref=scope.attempt.files)?_ref.length:void 0)>0?_.map(scope.attempt.files,function(file){return{code:file.code,fileName:file.file_name,codeType:file.code_type}}):[eval(scope.attempt.raw_input)],_.each(scope.contentData.attributes.editors,function(editor){var matchingSubmittedFile;return matchingSubmittedFile=_.find(submitContent,function(content){return editor.content===content.code&&editor.file_name===content.fileName&&editor.syntax===content.codeType}),editor.locked&&!matchingSubmittedFile?submitContent.push({code:editor.content,fileName:editor.file_name,codeType:editor.syntax}):void 0}),submitContent},scope.submit=function(){return scope.executorName=scope.contentData.attributes.executor.executor_name,executorService.submit(getSubmitContent(),{tests:getTests(),disable_cache:!0}).then(function(report){var failureMessageMatchedExpectedPattern,sameFailureMessage,successExpectedAndReceived,_ref;return element.removeClass("feed-item--success").removeClass("feed-item--error"),sameFailureMessage=(null!=(_ref=report.message())?_ref.replace(/\n\n/g,"\n"):void 0)===scope.attempt.message,successExpectedAndReceived=scope.attempt.success&&report.success(),failureMessageMatchedExpectedPattern=scope.attempt.pass_with_pattern&&new RegExp(scope.attempt.pass_with_pattern).test(report.message()),sameFailureMessage||successExpectedAndReceived||failureMessageMatchedExpectedPattern?element.addClass("feed-item--success"):element.addClass("feed-item--error"),scope.actualResponse=report.message()})},scope.$on("submission:start",function(){return scope.submit()}),scope.attemptType=function(){return scope.attempt.success?"Success":"Failure"},scope.matchTitle=function(attempt){return attempt.pass_with_pattern?"to match":void 0},scope.attemptMessage=function(attempt){return attempt.pass_with_pattern?attempt.pass_with_pattern:attempt.message||"This code should pass."},scope.toggle=function(evt){return evt.preventDefault(),element.hasClass("is-closed")?element.removeClass("is-closed"):element.addClass("is-closed"),!1},scope.edit=function(){return scope.executorData=scope.contentData.attributes.executor,OpenModal.close({clear:!0}),OpenModal.open({htmlClass:"modal--page modal--map",fullScreen:!0,scope:scope},"<div class='card cell cell--sm well--l'>\n  <fieldset class='form-field'>\n    <label class='form-label'>Name</label>\n    <input class='form-input' type='text' ng-model='attempt.attempt_name'></input>\n  </fieldset>\n\n  <fieldset class='form-field' ng-hide=\"attempt.success\">\n    <label class='form-label'>Message</label>\n    <textarea class='form-input' ng-model=\"attempt.message\" wrap='true' convert-to-codemirror></textarea>\n  </fieldset>\n\n  <fieldset class='form-field' ng-hide=\"attempt.success\">\n    <label class='form-label'>Task Name</label>\n    <select class='form-select' ng-model=\"attempt.task\" ng-options=\"task.value as task.name for task in taskOptions\">\n\n    </select>\n  </fieldset>\n\n  <fieldset class='form-field' ng-hide=\"attempt.success\">\n    <label class='form-label'>Hint</label>\n    <textarea class='form-input' type='text' ng-model='attempt.hint' wrap='true' convert-to-codemirror></textarea>\n  </fieldset>\n\n  <fieldset class='form-field' ng-if=\"attempt.files\">\n    <label class='form-label'>Files</label>\n    <ul class='list'>\n      <li class='list-item' ng-repeat='file in attempt.files'>\n        <fieldset class='form-field'>\n          <label class='form-label'>File Name</label>\n          <input class='form-input' type='text' ng-model='file.file_name'></input>\n        </fieldset>\n\n        <fieldset class='form-field'>\n          <label class='form-label'>Code Type</label>\n          <input class='form-input' type='text' ng-model='file.code_type'></input>\n        </fieldset>\n\n        <fieldset class='form-field'>\n          <label class='form-label'>File Code</label>\n          <textarea rows='7' class='form-input' ng-model='file.code' bind-syntax=\"file.code_type\" convert-to-codemirror></textarea>\n        </fieldset>\n      </li>\n    </ul>\n  </fieldset>\n  \n  <fieldset class='form-field' ng-if=\"attempt.raw_input\">\n    <label class='form-label'>Raw Input</label>\n    <textarea class='form-input' type='text' ng-model='attempt.raw_input' wrap='true' convert-to-codemirror></textarea>\n  </fieldset>\n\n  <div class='grid'>\n    <div class='grid-box grid-box--1of2'>\n      <div class='btnList'>\n        <a class='btnList-btn btn btn--b' href=\"\" ng-click=\"deleteFile(file)\">Delete File</a>\n        <a class='btnList-btn btn btn--b' href=\"\" ng-click=\"newFile()\">New File</a>\n      </div>\n    </div>\n    <div class='grid-box grid-box--1of2'>\n      <a class='btn btn--a fr' href=\"\" ng-click=\"deleteAttempt()\">Delete {{attemptType()}}</a>\n    </div>\n  </div>\n\n</div>")}}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("testSaveButton",["KeyboardShortcuts","$timeout",function(KeyboardShortcuts,$timeout){return{restrict:"E",replace:!0,scope:!0,template:"<div class='omnibar-btn bar-item--w--xl test-save-button'>\n  <a ng-click='save()' href='' class='btn btn--next' ng-class=\"{'is-inactive': isInactive}\">\n    <b class='loader-text'>Save Page</b>\n    <span class='loader-el'></span>\n  </a>\n</div>",link:function(scope){return scope.save=function(){return scope.isDisabled?void 0:(scope.$emit("content:save",{courseIdentifier:scope.courseIdentifier,queryString:scope.queryString}),scope.isInactive=!0,$timeout(function(){return scope.isInactive=!1},2e3))},KeyboardShortcuts.key("⌘+enter, ctrl+enter, ctrl+s, ⌘+s",function(){return scope.submit()}),scope.$on("$destroy",function(){return KeyboardShortcuts.unbind("⌘+enter, ctrl+enter, ctrl+s, ⌘+s")})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("testSubmitButton",["KeyboardShortcuts","$rootScope","ClientExecutorData","$q","ClientExecutor","CurrentSubmitData","ClientExecutorReporter",function(KeyboardShortcuts,$rootScope){return{restrict:"E",replace:!0,scope:!0,template:"<div class='omnibar-btn'>\n  <a ng-click='submit()' href='' class='btn btn--next' ng-class=\"{'is-submitting': isSubmitting}\">\n    <b class='loader-text'>Run Tests</b>\n    <span class='loader-el'></span>\n  </a>\n</div>",link:function(scope){var submitListenerOff;return scope.submit=function(){return scope.$emit("submission:start",{courseIdentifier:scope.courseIdentifier,queryString:scope.queryString})},submitListenerOff=$rootScope.$on("page:testSubmit",function(){return scope.submit()}),scope.$on("$destroy",function(){return submitListenerOff()})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("testTaskDisplay",["CurrentSyncData",function(CurrentSyncData){return{replace:!0,restrict:"E",scope:!0,template:'<ul class="list">\n  <li class="list-item" ng-repeat="task in tasks">\n    <fieldset class="form-field">\n      <label class="form-label">Task Name</label>\n      <input class="form-input" type="text" ng-model="task.name"></input>\n    </fieldset>\n\n    <fieldset class="form-field">\n      <label class="form-label">Video ID</label>\n      <input class="form-input" type="text" ng-model="task.video.id"></input><br>\n    </fieldset>\n\n    <fieldset class="form-field">\n      <label class="form-label">Video Start at Time</label>\n      <input class="form-input" type="text" ng-model="task.video.start_at_time"></input>\n    </fieldset>\n\n    <fieldset class="form-field">\n      <label class="form-label">Body</label>\n      <textarea rows="5" class="form-input" ng-model="task.body" wrap=\'true\' convert-to-codemirror></textarea>\n    </fieldset>\n\n    <fieldset class="form-field">\n      <label class="form-label">Answer</label>\n      <textarea rows="5" class="form-input" ng-model="task.answer" wrap=\'true\' convert-to-codemirror></textarea>\n    </fieldset>\n\n  </li>\n</ul>',link:function(scope){var syncDataService,watcherOff;return syncDataService=new CurrentSyncData(scope.courseIdentifier,scope.queryString),watcherOff=scope.$watch("contentData",function(data){return data?(watcherOff(),scope.tasks=scope.contentData.attributes.tasks):void 0})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("testsEditor",["CurrentSyncData","ClientExecutorData",function(CurrentSyncData,ClientExecutorData){return{restrict:"E",replace:!0,scope:!0,template:"<div class='codeEditor-pane'></div>",link:function(scope,element){var submit,syncDataService;return syncDataService=new CurrentSyncData(scope.courseIdentifier,scope.queryString),new ClientExecutorData(scope.courseIdentifier,scope.queryString).get().then(function(data){return scope.editor=CodeMirror(element[0],{value:data.tests,mode:"text/javascript",theme:"default",tabSize:2,lineNumbers:!0,autofocus:!0,extraKeys:{"Cmd-Enter":submit,"Ctrl-Enter":submit}}),syncDataService.registerContent(function(){return{executor:{attributes:{tests:scope.editor.doc.getValue()}}}}),scope.elementIsVisible=function(){return element.is(":visible")},scope.$watch("elementIsVisible()",function(result){return result&&scope.editor?(scope.editor.refresh(),scope.editor.focus()):void 0})}),submit=function(){return $rootScope.$emit("page:testSubmit")}}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("textContent",function(){return{restrict:"E",replace:!0,scope:!0,template:"<div class='course-text-content' ng-bind-html='textContent'></div>",link:function(scope){return scope.currentContent.attribute("text_content").then(function(textContent){return scope.textContent=textContent})}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("textFile",["$compile","CampusUtil",function($compile,CampusUtil){return{restrict:"E",replace:!0,scope:{content:"@",syntax:"@",theme:"@",fileName:"@",tabbedResource:"@"},template:"<div class='resource resource--text'>\n  <p class='resource-fileName' ng-hide='tabbedResource'>{{fileName}}</p>\n</div>",link:function(scope,element){var codeElement;return codeElement=angular.element("<code-highlight theme='{{theme}}' syntax='{{syntax}}'>"+CampusUtil.escapeHTML(scope.content)+"</code-highlight>"),element.append(codeElement),$compile(element.contents())(scope)}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("totalCourseProgress",["CurrentIndexData",function(CurrentIndexData){return{restrict:"E",replace:!0,scope:!0,template:'<div class="progress">\n  <div class="progress-bar" style="width: {{progress}}%;"></div>\n</div>',link:function(scope){return new CurrentIndexData(scope.courseIdentifier).data().then(function(indexData){return scope.progress=indexData.progress}),scope.$on("page:update:index",function(evt,indexData){return scope.progress=indexData.data.progress})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("userAchievementsEarned",["CurrentUserData",function(CurrentUserData){return{restrict:"E",replace:!0,scope:!0,template:"<div class='course-user-data achievements-earned'>{{totalAchievements}}</div>",link:function(scope){var updateTotalAchievements,userData;return userData=new CurrentUserData(scope.courseIdentifier),updateTotalAchievements=function(){return userData.totalAchievements().then(function(achievements){return scope.totalAchievements=achievements})},updateTotalAchievements(),scope.$on("page:update:user",function(){return updateTotalAchievements()})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("userAvatar",["CurrentUserData","CurrentCourseConfig",function(CurrentUserData,CurrentCourseConfig){return{restrict:"E",replace:!0,scope:!0,template:'<div class=\'user-media\'>\n  <img class=\'thumb\' ng-src="http://www.gravatar.com/avatar/{{gravatar}}" width="{{width}}" height="{{height}}" />\n</div>',link:function(scope,element,attrs){return scope.height=attrs.height,scope.width=attrs.width,new CurrentUserData(scope.courseIdentifier).gravatar().then(function(gravatar){return gravatar.length>0?scope.gravatar=gravatar:new CurrentCourseConfig(scope.courseIdentifier).get("default_gravatar").then(function(defaultGravatar){return scope.gravatar=defaultGravatar})})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("userChallengesCompleted",["CurrentUserData",function(CurrentUserData){return{restrict:"E",replace:!0,scope:!0,template:"<div class='course-user-data challenges-completed'>{{challengesCompleted}}</div>",link:function(scope){var updateCompleteCount,userData;return userData=new CurrentUserData(scope.courseIdentifier),updateCompleteCount=function(){return userData.challengesCompleted().then(function(completed){return scope.challengesCompleted=completed})},updateCompleteCount(),scope.$on("page:update:user",function(){return updateCompleteCount()})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("userHintsUsed",["CurrentUserData",function(CurrentUserData){return{restrict:"E",replace:!0,scope:!0,template:"<div class='course-user-data hints-used'>{{usedHintsCount}}</div>",link:function(scope){var updateHintsCount,userData;return userData=new CurrentUserData(scope.courseIdentifier),updateHintsCount=function(){return userData.usedHintsCount().then(function(count){return scope.usedHintsCount=count})},updateHintsCount(),scope.$on("page:update:user",function(){return updateHintsCount()})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("userLoginLink",["CampusUrl",function(CampusUrl){return{replace:!0,restrict:"E",scope:!0,transclude:!0,template:"<a href='{{authUrl()}}' ng-transclude></a>",link:function(scope){return scope.authUrl=function(){return CampusUrl.authUrl()}}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("userName",["CurrentUserData",function(CurrentUserData){return{restrict:"E",replace:!0,scope:!0,template:"<h1 class='user-name'>{{userName}}</h1>",link:function(scope){return new CurrentUserData(scope.courseIdentifier).userName().then(function(name){return scope.userName=name})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("userStats",["$templateCache","KeyboardShortcuts","CurrentIndexData",function($templateCache,KeyboardShortcuts,CurrentIndexData){return{replace:!0,restrict:"E",scope:!0,template:"<div>\n  <div ng-include='getTemplate()'></div>\n  <div class='pagerNav'>\n    <a class='pagerNav-toggle pagerNav-toggle--prev toggle' href='' ng-click='getPreviousPage()'><b class=\"srt\">Previous User Page</b></a>\n    <a class='pagerNav-toggle pagerNav-toggle--next toggle' href='' ng-click='getNextPage()' id='next'><b class=\"srt\">Next User Page</b></a>\n    <ol class='pagerNav-list'>\n      <li ng-repeat='node in userPages' class='pagerNav-list-item'>\n        <a class='pagerNav-list-link {{getPlaceHolderElementClass($index)}}' href='' ng-click='setIndex($index)'></a>\n      </li>\n    </ol>\n  </div>\n</div>",link:function(scope){return scope.templateIndex=JSON.parse($templateCache.get("_courseTemplateIndex")),scope.currentUserPageIndex=0,new CurrentIndexData(scope.courseIdentifier).userNodes().then(function(userPages){return scope.userPages=userPages}),scope.setIndex=function(index){return scope.currentUserPageIndex=index},scope.currentUserPage=function(){return scope.userPages?scope.userPages[scope.currentUserPageIndex]:void 0},scope.getTemplate=function(){return scope.currentUserPage()?scope.templateIndex[scope.currentUserPage().query_string]:void 0},scope.getNextPage=function(){return scope.userPages&&(scope.currentUserPageIndex+=1,scope.currentUserPageIndex===scope.userPages.length)?scope.currentUserPageIndex=0:void 0},scope.getPreviousPage=function(){return scope.userPages&&(scope.currentUserPageIndex-=1,scope.currentUserPageIndex<0)?scope.currentUserPageIndex=scope.userPages.length-1:void 0},scope.getPlaceHolderElementClass=function(index){return index===scope.currentUserPageIndex?"is-active":void 0},KeyboardShortcuts.key("left",function(){return scope.getPreviousPage(),scope.$apply()}),KeyboardShortcuts.key("right",function(){return scope.getNextPage(),scope.$apply()}),scope.$on("$destroy",function(){return KeyboardShortcuts.unbind("right"),KeyboardShortcuts.unbind("left")})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("userTotalPoints",["CurrentUserData",function(CurrentUserData){return{restrict:"E",replace:!0,scope:!0,template:"<div class='course-user-data total-points'>{{totalPoints}}</div>",link:function(scope){var rootListenerOff;return new CurrentUserData(scope.courseIdentifier).totalOutOfPossiblePoints().then(function(totalPoints){return scope.totalPoints=totalPoints}),rootListenerOff=scope.$on("page:update:user",function(evt,userData){return scope.totalPoints=userData.data.points.total_points})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("userVideosWatched",["CurrentIndexData",function(CurrentIndexData){return{restrict:"E",replace:!0,scope:!0,template:"<div class='course-user-data videos-watched'>{{videosWatched}}</div>",link:function(scope){var indexData,rootListenerOff,updateVideosWatched;return indexData=new CurrentIndexData(scope.courseIdentifier),updateVideosWatched=function(){return indexData.getPages("video").then(function(videos){var completedVideoCount;return completedVideoCount=0,_.each(videos,function(video){return 100===video.progress?completedVideoCount+=1:void 0}),scope.videosWatched=""+completedVideoCount+"/"+(videos.length||0)})},updateVideosWatched(),rootListenerOff=scope.$on("page:update:index",function(){return updateVideosWatched()})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("watchVideoButton",["OpenModal",function(OpenModal){return{restrict:"E",replace:!0,scope:!0,template:"<a href='' class='btn btn--video' ng-click='showVideo()'>Watch Video</a>",link:function(scope,element,attrs){return scope.videoDirective=attrs.videoDirective,scope.directiveOptions=attrs.directiveOptions,attrs.videoData&&scope.$parent.$watch(attrs.videoData,function(videoData){return scope.videoData=videoData}),scope.showVideo=function(){return OpenModal.open({htmlClass:"modal--video",scope:scope},"<"+scope.videoDirective+" "+scope.directiveOptions+" class='video--modal'></"+scope.videoDirective+">")}}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("whenLoggedIn",function(){return{restrict:"A",link:function(scope,element){return scope.currentUser.loggedIn().then(function(isLoggedIn){return isLoggedIn?void 0:element.remove()})}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("whenNotLoggedIn",function(){return{restrict:"A",link:function(scope,element){return scope.currentUser.loggedIn().then(function(isLoggedIn){return isLoggedIn?element.remove():void 0})}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("youtubeVideo",["$sce",function($sce){return{replace:!0,restrict:"E",scope:!0,template:'<iframe width="1280" height="720" src="{{youtubeVideoId}}" frameborder="0" allowfullscreen></iframe>',link:function(scope){return scope.currentContent.data().then(function(contentData){return scope.youtubeVideoId=$sce.trustAsResourceUrl("http://www.youtube.com/embed/"+contentData.attributes.youtube_video+"?rel=0&showinfo=0&autohide=1")})}}}])}.call(this),function(){angular.module("campus",["ui.router","ngSanitize","ngCookies","campusServices","campusTemplateDirectives","campusFilters"]),angular.module("campus").run(["$rootScope","$state","$stateParams",function($rootScope,$state,$stateParams){return $rootScope.$state=$state,$rootScope.$stateParams=$stateParams}])}.call(this),function(){angular.module("campus").provider("Logger",function(){var options;options={errorEnabled:!0,infoEnabled:!0,debuggerEnabled:!0,warnEnabled:!0},this.errorEnabled=function(value){return options.errorEnabled=value},this.infoEnabled=function(value){return options.infoEnabled=value},this.debugEnabled=function(value){return options.debugEnabled=value},this.warnEnabled=function(value){return options.warnEnabled=value},this.$get=["$log",function($log){var logger;return logger=$log,new function(){return{error:options.errorEnabled?logger.error:function(){return{}},info:options.infoEnabled?logger.info:function(){return{}},debug:options.debugEnabled?logger.debug:function(){return{}},warn:options.warnEnabled?logger.warn:function(){return{}}}}}]})}.call(this),function(){angular.module("campus").config(["LoggerProvider","$logProvider","$httpProvider",function(LoggerProvider,$logProvider,$httpProvider){return LoggerProvider.debugEnabled(!1),LoggerProvider.errorEnabled(!1),LoggerProvider.infoEnabled(!1),LoggerProvider.warnEnabled(!1),$httpProvider.defaults.headers.common["X-CSRF-Token"]=$("meta[name=csrf-token]").attr("content")}])}.call(this),function(){angular.module("campus").controller("pageTitleController",["$scope","CurrentContentData","$rootScope","$q",function($scope,CurrentContentData,$rootScope,$q){var stopRootWatch,updateTitle;return $scope.pageTitle="",updateTitle=function(courseTitle,pageTitle){return $scope.pageTitle=pageTitle?""+pageTitle+" - "+courseTitle:courseTitle},stopRootWatch=$rootScope.$watch("queryString",function(queryString){return $rootScope.courseIdentifier&&queryString?$q.all([new CurrentContentData($rootScope.courseIdentifier,"/").data(),new CurrentContentData($rootScope.courseIdentifier,$rootScope.queryString).data()]).then(function(data){var contentData,rootContentData;return rootContentData=data[0],contentData=data[1],updateTitle(rootContentData.attributes.name,contentData.attributes.name)}):$rootScope.courseIdentifier?new CurrentContentData($rootScope.courseIdentifier,"/").data().then(function(rootContentData){return updateTitle(rootContentData.attributes.name,null)}):void 0}),$scope.$on("$destroy",function(){return stopRootWatch()})}])}.call(this),function(){angular.module("campus").directive("builderOmnibar",["$state",function(){return{restrict:"E",replace:!0,scope:!0,template:"<div class='omnibar'>\n  <div class='omnibar-toggle'>\n    <course-map-button url-params=\"{'template': 'client_tests'}\"></course-map-button>\n  </div>\n</div>"}}])}.call(this),function(){angular.module("campus").directive("campus",["CurrentCourseConfig","$templateCache","CacheKey","DataBootstrapper","$rootScope","LocalStorageCache",function(CurrentCourseConfig,$templateCache,CacheKey,DataBootstrapper,$rootScope,LocalStorageCache){return{restrict:"E",replace:!0,transclude:!0,scope:{cacheKey:"@",courseIdentifier:"@",userHasAccess:"@"},template:"<div class='campus-course'>\n  <div class='campus-course-view' ui-view></div>\n  <modal modal-class='modalClass' modal-content=\"modalContent\" modal-open=\"openModal\" modal-title='modalTitle'></modal>\n</div>",link:function(scope,element){return $rootScope.courseIdentifier=scope.courseIdentifier,"true"===scope.userHasAccess?$rootScope.userHasAccess=!0:($rootScope.userHasAccess=!1,console.log("clearing cache for: "+scope.courseIdentifier),(new LocalStorageCache).clearCourse(scope.courseIdentifier)),(new CacheKey).validateCacheKey(scope.courseIdentifier,scope.cacheKey),(new DataBootstrapper).load(scope.courseIdentifier),new CurrentCourseConfig(scope.courseIdentifier).get("course_state").then(function(courseState){return"beta"===courseState?element.addClass("is-beta"):"alpha"===courseState?element.addClass("is-alpha"):void 0})}}}])}.call(this),function(){angular.module("campus").directive("codeHighlight",["CampusUtil",function(CampusUtil){return{restrict:"E",replace:!0,transclude:!0,scope:!0,template:"<pre data-lang='{{syntax}}' class=\"code-highlight\"></pre>",link:function(scope,element,attrs,ctrl,transclude){var isDomElement;return scope.syntax=attrs.syntax,scope.theme=attrs.theme,scope.bindContent=attrs.bindContent,transclude(scope,function(clonedElement){return element.empty(),element.text(clonedElement.text())}),scope.bindContent&&scope.$parent.$watch(scope.bindContent,function(content){return element.empty(),element.text(content),scope.updateHighlight()}),isDomElement=function(object){return"object"==typeof HTMLElement?object instanceof HTMLElement:object&&"object"==typeof object&&null!==object&&1===object.nodeType&&"string"==typeof object.nodeName},scope.syntax=CampusUtil.filterSyntax(scope.syntax),"null"===scope.theme&&(scope.theme=null),scope.updateHighlight=function(){return scope.courseConfig.data().then(function(config){var content;return"true"===attrs.lineNumbers?(content=element.text(),element.empty(),scope.codeEditor=CodeMirror(element[0],{value:content,mode:CampusUtil.filterSyntax(scope.syntax),theme:scope.theme||config.default_editor_theme||"default",tabSize:2,lineNumbers:!0,autofocus:!1,readOnly:!0,cursorBlinkRate:0,foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"]})):(CodeMirror.runMode(element.text(),scope.syntax,element[0]),element.addClass("cm-s-"+(scope.theme||config.default_editor_theme||"default")))})},scope.updateHighlight()}}}])}.call(this),function(){angular.module("campus").directive("compileHtml",["$compile",function($compile){return{restrict:"A",link:function(scope,element,attrs){return attrs.$observe("compileHtml",function(val){var compileScope;return val&&(element.empty(),element.html(val)),compileScope=scope[attrs.scope]||scope,$compile(element.contents())(compileScope)})}}}])}.call(this),function(){angular.module("campus").directive("convertToCodemirror",["CurrentContentData","CurrentCourseConfig","$timeout","$parse","CampusUtil",function(CurrentContentData,CurrentCourseConfig,$timeout,$parse,CampusUtil){return{replace:!1,restrict:"A",require:"?ngModel",scope:!0,link:function(scope,element,attrs,ctrl){var content,lineWidgets,ngModelGet,options,syntax,theme;return options=$parse(attrs.convertToCodemirror)(scope)||{},syntax=options.syntax||attrs.syntax||"default",theme=options.theme||attrs.theme||"default",content=element.val(),lineWidgets=[],attrs.bindSyntax&&(syntax=CampusUtil.filterSyntax($parse(attrs.bindSyntax)(scope)),scope.$watch(attrs.bindSyntax,function(boundSyntax){return scope.codemirrorEditor?(scope.codemirrorEditor.setOption("mode",CampusUtil.filterSyntax(boundSyntax)),scope.codemirrorEditor.refresh()):void 0})),attrs.bindOptions&&(options=$parse(attrs.bindOptions)(scope),scope.$watch(attrs.bindOptions,function(boundOptions){return options=boundOptions,scope.codemirrorEditor?(_.each(bindOptions,function(value,key){return scope.codemirrorEditor.setOption(key,value)}),scope.codemirrorEditor.refresh()):void 0})),attrs.ngModel&&(ngModelGet=$parse(attrs.ngModel),content=ngModelGet(scope)),scope.elementIsVisible=function(){return scope.codemirrorEditor?$(scope.codemirrorEditor.getWrapperElement()).is(":visible"):void 0},scope.getContent=function(){return scope.codemirrorEditor?scope.codemirrorEditor.doc.getValue():void 0},scope.$watch("elementIsVisible()",function(isVisible){return isVisible?$timeout(function(){return scope.codemirrorEditor.refresh()}):void 0}),new CurrentCourseConfig(scope.courseIdentifier).data().then(function(configData){return theme=options.theme||configData.default_editor_theme||"default",scope.codemirrorEditor=CodeMirror.fromTextArea(element[0],{value:content,mode:syntax,theme:theme,tabSize:2,lineNumbers:!0,readOnly:options.readOnly||!1,foldGutter:!0,lineWrapping:!!attrs.wrap,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"]}),$timeout(function(){return scope.codemirrorEditor.refresh()},1e3),options.collapse&&_.each(options.collapse,function(option){var el,mark;if(option)return mark=scope.codemirrorEditor.markText(option[0],option[1],option[2]),el=$("<a href=''>...</a>")[0],lineWidgets.push({widget:scope.codemirrorEditor.addLineWidget(option[0].line,el),mark:mark,el:el}),$(el).on("click",function(evt){var foundWidget,thisEl;return evt.preventDefault(),thisEl=this,foundWidget=_.find(lineWidgets,function(widget){return widget.el===thisEl}),foundWidget.mark.clear(),foundWidget.widget.clear()})}),ctrl?(scope.codemirrorEditor.on("change",function(){return ctrl.$setViewValue(scope.getContent())}),ctrl.$render=function(){return scope.codemirrorEditor.setValue(ctrl.$viewValue)},ctrl.$setViewValue(content)):void 0}),scope.$on("$destroy",function(){return scope.codemirrorEditor.off("change"),_.each(lineWidgets,function(widget){return widget.mark.clear(),widget.widget.clear(),widget=null})})}}}])}.call(this),function(){angular.module("campus").directive("courseBar",["CampusUrl","CurrentCourseConfig",function(CampusUrl,CurrentCourseConfig){return{restrict:"E",replace:!0,scope:!0,template:"<header class='courseBar'>\n  <div class='courseBar-brand'>\n    <div class='brand' itemscope itemtype='http://schema.org/Organization'>\n      <a itemprop='url' class='brand-link' ui-sref='root.courseContent({queryString: \"\"})'>\n        <img itemprop='logo' class='brand-img' ng-src='{{logoImage}}' />\n      </a>\n    </div>\n  </div>\n\n  <div class='courseBar-session'>\n    <session class='has-menu'></session>\n  </div>\n</header>",link:function(scope){return new CurrentCourseConfig(scope.courseIdentifier).data().then(function(courseConfig){return scope.logoImage=CampusUrl.imageUrl(courseConfig.course_logo||"logo-course.png")})}}}])}.call(this),function(){angular.module("campus").directive("courseData",["$timeout","$templateCache","$compile","$rootScope","CurrentSubmitData","TemplateIndex","$state","CurrentContentData","CurrentIndexData","EventRebroadcaster","$stateParams",function($timeout,$templateCache,$compile,$rootScope,CurrentSubmitData,TemplateIndex,$state,CurrentContentData,CurrentIndexData,EventRebroadcaster,$stateParams){return{replace:!0,restrict:"E",scope:{},controller:["$scope","$rootScope",function($scope,$rootScope){return $scope.courseIdentifier=$rootScope.courseIdentifier,$scope.queryString=$rootScope.queryString,this.setTemplate=function(template,options){return(null!=options?options.setOnScope:void 0)&&_.each(options.setOnScope,function(value,key){return $scope[key]=value}),$scope.templateUrl=template},this.getTemplate=function(){return $scope.templateUrl},this.elementTemplateIsDirectChild=function(element){return $scope.elementTemplateIsDirectChild(element)},this}],template:"<div class= 'content-data is-loading' ng-class='{\"is-complete\": isComplete, \"is-editing\": isEditing}' page-data='{courseIdentifier: \"{{courseIdentifier}}\", queryString: \"{{queryString}}\"}'>\n  <div class='course-content {{getTemplateUrl()}}'></div>\n</div>",link:function(scope,element){var childScope,rebroadcast,templateEl,updateIsComplete;return scope.templateUrl=$stateParams.template||TemplateIndex.data()[scope.queryString],templateEl=element.find("div"),childScope=null,updateIsComplete=function(contentData){return scope.isComplete=100===contentData.progress
},scope.elementTemplateIsDirectChild=function(el){return el.parent()[0]===element.children()[0]},scope.$watch("templateUrl",function(templateUrl){return childScope&&(childScope.$destroy(),childScope=null),childScope=scope.$new(),templateEl.html($templateCache.get(templateUrl)),$compile(templateEl.contents())(childScope)}),scope.currentContent.preloadData(scope.queryString).then(function(){return $timeout(function(){return element.removeClass("is-loading")})}),scope.$watch("queryString",function(){return scope.currentContent.data().then(function(data){return updateIsComplete(data)})}),new CurrentSubmitData(scope.courseIdentifier,scope.queryString).reset(),scope.getTemplateUrl=function(){return $templateCache.get(scope.templateUrl)?scope.templateUrl:void 0},scope.$on("page:gotoNextChallenge",function(evt,eventData){return new CurrentContentData(eventData.courseIdentifier,eventData.queryString).data().then(function(contentData){var lastNode;return"page"===contentData.node_type?new CurrentIndexData(eventData.courseIdentifier).getParentContainer("level",eventData.queryString).then(function(data){var currentLevelProgress,lastNode,levelProgress,_ref,_ref1,_ref2;return levelProgress=null!=(_ref=data.parentContainer)?_ref.progress:void 0,lastNode=null!=(_ref1=data.parentContainer)?_ref1.nodes[data.parentContainer.nodes.length-1]:void 0,currentLevelProgress=null!=(_ref2=data.parentContainer)?_ref2.progress:void 0,100===levelProgress&&100!==currentLevelProgress&&"page"===lastNode.node_type?$state.go("root.courseContent",{queryString:lastNode.query_string}):$state.go("root.courseContent",{queryString:contentData.next_query_string})}):"container"===contentData.node_type&&"level"===contentData.node_label?(lastNode=contentData.nodes[contentData.nodes.length-1],contentData.nodes&&"page"===lastNode.node_type?$state.go("root.courseContent",{queryString:lastNode.query_string}):$state.go("root.courseContent",{queryString:contentData.next_query_string})):void 0})}),scope.$on("page:editor:activate",function(evt){return evt.targetScope!==scope?scope.isEditing=!0:void 0}),scope.$on("page:editor:deactivate",function(evt){return evt.targetScope!==scope?scope.isEditing=!1:void 0}),rebroadcast=new EventRebroadcaster(scope),rebroadcast.add("submission:fail"),rebroadcast.add("submission:success"),rebroadcast.add("submission:start"),rebroadcast.add("submission:end"),rebroadcast.add("page:update:content"),rebroadcast.add("page:update:user",{bubbles:!0,eventDataMatches:"queryString"}),rebroadcast.add("page:update:index",{bubbles:!0,eventDataMatches:"queryString"}),rebroadcast.add("page:update:config",{bubbles:!0,eventDataMatches:"queryString"}),rebroadcast.add("page:editor:collapse"),rebroadcast.add("page:editor:fullscreen"),rebroadcast.add("page:trigger:submit"),rebroadcast.add("page:editor:activate"),rebroadcast.add("page:editor:deactivate"),rebroadcast.add("page:task:success"),rebroadcast.add("hints:requestNew"),rebroadcast.add("hints:new"),rebroadcast.add("hints:answer"),scope.$on("$destroy",function(){return templateEl.remove(),templateEl=null})}}}])}.call(this),function(){angular.module("campus").directive("courseWindow",function(){return{restrict:"E",replace:!0,scope:!0,controller:["$scope","$rootScope",function($scope,$rootScope){var defaultUiOptions,rootListenerOff,setDefaultOptions;defaultUiOptions={omnibar:!0,courseBar:!0},rootListenerOff=$rootScope.$on("$stateChangeStart",function(){return setDefaultOptions()}),setDefaultOptions=function(){return $scope.optionalUi=_.clone(defaultUiOptions)},setDefaultOptions(),this.go=function(to,toParams,options,transitionClass){return $scope.go(to,toParams,options,transitionClass)},this.enableNav=function(navName){return $scope.optionalUi[navName]=!0},this.disableNav=function(navName){return $scope.optionalUi[navName]=!1},this.navEnabled=function(navName){return $scope.optionalUi[navName]},$scope.enabledUiClasses=function(){var classArray;return classArray=[],_.each($scope.optionalUi,function(value,uiName){return value?classArray.push("is-"+S(uiName).dasherize().s+"-enabled"):void 0}),classArray.join(" ")},$scope.$on("$destroy",function(){return rootListenerOff()})}],template:"<div class='campus-course-window' ng-class='enabledUiClasses()'>\n  <course-bar ng-if='optionalUi.courseBar'></course-bar>\n  <flash-message></flash-message>\n  <main class='content' ui-view ></main>\n  <omnibar ng-if='optionalUi.omnibar'></omnibar>\n  <builder-omnibar ng-if='optionalUi.builderOmnibar'></builder-omnibar>\n</div>"}})}.call(this),function(){angular.module("campus").directive("disableOptionalNav",["$stateParams",function(){return{restrict:"M",require:"^courseWindow",link:function(scope,element,attrs,coursewindowCtrl){return coursewindowCtrl.disableNav(attrs.disableOptionalNav)}}}])}.call(this),function(){angular.module("campus").directive("dropdown",["$compile","$parse",function($compile,$parse){return{restrict:"E",replace:!0,scope:{label:"@",model:"="},transclude:"true",template:"<div ng-mouseleave='hideDropdown()' class='dropdown'>\n  <a href='' class='dropdown-btn btn' ng-mouseover='showDropdown()'>{{label}}</a>\n  <ul class='dropdown-menu'></ul>\n</div>",link:function(scope,element,attrs,ctrl,transclude){var arrayString,containerElement,createMouseMask,maskElement,modelMatch,newScope,onSelectFn,removeMouseMask,repeatLoop,selectorElements,singleItemString;return maskElement=angular.element('<div class="dropdown-mask"></div>'),onSelectFn=$parse(attrs.onSelect),createMouseMask=function(){var elementBounds,labelBounds,listBounds,mostBottom,mostLeft,mostRight,mostTop;return labelBounds=element.find("a")[0].getBoundingClientRect(),listBounds=element.find("ul")[0].getBoundingClientRect(),elementBounds=element[0].getBoundingClientRect(),mostLeft=labelBounds.left<listBounds.left?labelBounds.left:listBounds.left,mostRight=labelBounds.right>listBounds.right?labelBounds.right:listBounds.right,mostTop=labelBounds.top<listBounds.top?labelBounds.top:listBounds.top,mostBottom=labelBounds.bottom>listBounds.bottom?labelBounds.bottom:listBounds.bottom,maskElement.css({height:""+Math.abs(mostTop-mostBottom)+"px",width:""+Math.abs(mostLeft-mostRight)+"px",top:""+(mostTop-elementBounds.top)+"px",left:""+(mostLeft-elementBounds.left)+"px"}),element.append(maskElement)},removeMouseMask=function(){return maskElement.remove()},scope.setModel=function(evt,item){var modelValue;return element.find("li").removeClass("is-active"),$(evt.currentTarget).addClass("is-active"),modelValue=attrs.valueKey?item[attrs.valueKey]:item,scope.model&&(scope.model=modelValue),onSelectFn(scope.$parent,{$value:modelValue})},scope.showDropdown=function(){createMouseMask(),element.addClass("is-active")},scope.hideDropdown=function(){removeMouseMask(),element.removeClass("is-active")},repeatLoop=attrs.repeat,modelMatch=repeatLoop.match(/^\s*(.+)\s+in\s+(.*?)\s*(\s+track\s+by\s+(.+)\s*)?$/),singleItemString=modelMatch[1],arrayString=modelMatch[2],containerElement=element.find("ul"),selectorElements=[],newScope=null,scope.$parent.$watch(arrayString,function(array){return newScope&&(newScope.$destroy(),newScope=null),newScope=scope.$new(),selectorElements.length>0&&(_.each(selectorElements,function(selectorElement){return selectorElement.el.remove(),selectorElement.scope.$destroy()}),selectorElements=[]),scope.items=array,_.each(array,function(item,index){var childscope;return childscope=newScope.$new(),childscope[singleItemString]=item,transclude(childscope,function(clonedElement){var createdElement,listItemElement,valueString;return valueString=attrs.valueKey?'ng-class="model == items['+index+"]."+attrs.valueKey+" ? 'is-active': ''\"":'ng-class="model == items['+index+"] ? 'is-active': ''\"",listItemElement=angular.element("<li class='dropdown-item' "+valueString+" ng-click='setModel($event, items["+index+"])'></li>"),listItemElement.append(clonedElement),containerElement.append(listItemElement),createdElement={},createdElement.el=listItemElement,createdElement.scope=childscope,selectorElements.push(createdElement)})}),$compile(containerElement)(newScope)})}}}])}.call(this),function(){angular.module("campus").directive("enableOptionalNav",["$stateParams",function(){return{restrict:"M",require:"^courseWindow",link:function(scope,element,attrs,coursewindowCtrl){return coursewindowCtrl.enableNav(attrs.enableOptionalNav)}}}])}.call(this),function(){angular.module("campus").directive("feedItem",function(){return{restrict:"E",replace:!0,transclude:!0,scope:{itemTitle:"@",state:"@"},template:"<div class='widget feed-item is-closed {{classifyTitle()}}'>\n  <div class='widget-row widget-row--header feed-item-row feed-item-row--header'>\n    <div class='widget-header'>\n      <a href='' class='widget-toggle feed-item-toggle toggle' ng-click='toggle()'>\n        <b class='srt'>Toggle</b>\n      </a>\n      <h3 class='widget-title feed-item-title'>\n        <a href='' class='widget-title-link feed-item-title-link' ng-click='toggle()'>{{itemTitle}}</a>\n      </h3>\n    </div>\n  </div>\n  <div class='widget-row widget-row--content'>\n    <div class='widget-content' ng-transclude></div>\n  </div>\n</div>",link:function(scope,element){return scope.classifyTitle=function(){return scope.itemTitle.toLowerCase().replace(/\s/,"-")},scope.toggle=function(){element.hasClass("is-closed")?element.removeClass("is-closed"):element.addClass("is-closed")}}}})}.call(this),function(){angular.module("campus").directive("flashMessage",["FlashMessage","$timeout",function(FlashMessage,$timeout){return{replace:!0,restrict:"E",scope:{},template:"<div class='flash {{options.htmlClass}}' ng-class='{\"is-active\": isActive}' ng-click='close()' ng-if='!isHidden'>\n  <a class='flash-close' href='' ng-if='!!options.closeButton' ng-click='close()'>x</a>\n  <h2 class='flash-title' ng-if='!!options.title' compile-html=\"{{options.title}}\"></h2>\n  <p class='flash-msg' ng-if='!!options.message' compile-html=\"{{options.message}}\"></p>\n</div>",link:function(scope){var defaultOptions;return defaultOptions={closeDelay:2200,closeButton:!0,clickToClose:!0,title:null,message:null,htmlClass:""},scope.isHidden=!0,FlashMessage.isShow(function(options){return scope.options=_.extend(scope.options,options),scope.isActive=!0,$timeout(function(){return scope.isHidden=!1})}),FlashMessage.isClear(function(){return scope.isActive=!1}),scope.$watch("isActive",function(isActive){return isActive?$timeout(function(){return scope.isActive=!1},scope.options.closeDelay||3):$timeout(function(){return scope.options=_.clone(defaultOptions),scope.isHidden=!0},1e3)}),scope.isActive=!1,scope.close=function(){return scope.isActive=!1},scope.$on("$destroy",function(){return FlashMessage.isClear(null),FlashMessage.isShow(null)})}}}])}.call(this),function(){angular.module("campus").directive("modal",["OpenModal","$timeout",function(OpenModal,$timeout){return{restrict:"E",replace:!0,scope:{modalContent:"=",modalOpen:"=",modalTitle:"=",modalClass:"="},template:'<div class="modal fade {{modalClass}}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">\n  <div class="modal-dialog">\n    <div class="modal-content">\n      <div class="modal-header">\n        <button type="button" class="modal-close" data-dismiss="modal" aria-hidden="true">&times;</button>\n        <h4 class="modal-title" id="myModalLabel" ng-if=\'!!modalTitle\'>{{modalTitle}}</h4>\n      </div>\n\n      <div class="modal-body" ng-click=\'bodyCloseModal($event)\' compile-html=\'{{modalContent}}\' scope="compileScope"></div>\n\n      <!-- <div class="modal-footer">\n        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n      </div> -->\n    </div>\n  </div>\n</div>',link:function(scope,element){var jqueryEl;return jqueryEl=$(element),jqueryEl.on("hidden.bs.modal",function(){return scope.modalOpen=!1,OpenModal.modalOpen=!1,scope.fullScreen=!1}),scope.bodyCloseModal=function(evt){scope.fullScreen&&$(evt.target).hasClass("modal-body")&&(scope.modalOpen=!1)},OpenModal.isOpen(function(options){return options.scope!==scope.compileScope&&scope.modalContent===options.content&&(scope.modalContent=null),$timeout(function(){return scope.modalContent=options.content,scope.modalTitle=options.title,scope.modalClass=options.htmlClass,scope.fullScreen=options.fullScreen,scope.modalOpen=!0,scope.compileScope=options.scope,jqueryEl.modal("show"),options.clear?scope.modalContent=null:void 0})}),OpenModal.isClose(function(options){jqueryEl.modal("hide"),scope.modalOpen=!1,options.clear&&(scope.modalContent=null)}),OpenModal.isScrolling(function(scrollValue){return jqueryEl.scrollTop(scrollValue)}),scope.$watch("modalOpen",function(newVal){return newVal?jqueryEl.modal("show"):newVal===!1?jqueryEl.modal("hide"):void 0}),scope.$on("$destroy",function(){return jqueryEl.off("hidden.bs.modal"),jqueryEl=null,OpenModal.isOpen(null),OpenModal.isClose(null),OpenModal.isScrolling(null),scope.compileScope.destroy()})}}}])}.call(this),function(){angular.module("campus").directive("ngError",["$parse",function($parse){return{compile:function($element,attr){var fn;return fn=$parse(attr.ngError),function(scope,element){return element.on("error",function(event){return scope.$apply(function(){return fn(scope,{$event:event})})})}}}}])}.call(this),function(){angular.module("campus").directive("omnibar",["$state",function(){return{restrict:"E",replace:!0,scope:!0,template:"<div class='omnibar'>\n  <div class='omnibar-toggle'>\n    <course-map-button />\n  </div>\n  <split-course-progress></split-course-progress>\n</div>"}}])}.call(this),function(){angular.module("campus").directive("pageData",["$parse","CurrentContentData","CurrentUserData","CurrentCourseConfig","CurrentIndexData",function($parse,CurrentContentData,CurrentUserData,CurrentCourseConfig,CurrentIndexData){return{replace:!1,restrict:"A",scope:!1,link:function(scope,element,attrs){var pageData;return pageData=$parse(attrs.pageData)(scope),scope.courseIdentifier=pageData.courseIdentifier,scope.queryString=pageData.queryString,scope.currentUser=new CurrentUserData(scope.courseIdentifier),scope.courseConfig=new CurrentCourseConfig(scope.courseIdentifier),scope.currentIndex=new CurrentIndexData(scope.courseIdentifier),scope.currentContent=new CurrentContentData(scope.courseIdentifier,scope.queryString),scope.$watch("queryString",function(queryString){return queryString?scope.currentContent=new CurrentContentData(scope.courseIdentifier,queryString):void 0})}}}])}.call(this),function(){angular.module("campus").directive("session",["$compile","CurrentUserData","CurrentCourseConfig","CampusUrl","$q",function($compile,CurrentUserData,CurrentCourseConfig,CampusUrl,$q){return{restrict:"E",replace:!0,scope:!0,template:'<div class=\'session\' ng-mouseleave=\'clearActive()\'>\n  <a href=\'http://www.codeschool.com\' class=\'session-logo\'>\n    <svg xmlns="http://www.w3.org/2000/svg" width="135" height="22.1" viewBox="-17.5 -3 135 22.1" enable-background="new -17.5 -3 135 22.1"><path d="M10 11.2l-6.2-6.2c-.2-.2-.2-.2-.3-.2s-.3 0-.3.2l-.3.2v1.7c0 .1 0 .3.1.3l4.1 4.1-4.1 4.1c-.1.1-.1.1-.1.3v1.7c0 .1 0 .3.1.3.1.1.1.1.3.1s.3 0 .3-.1l6.2-6.2c.3.1.3-.2.2-.3z"/><path d="M-5.9 11.2l6.3-6.2c.1-.1.1-.1.3-.1s.3-.1.3.1c.1.1.1.3.1.3v1.7c0 .1 0 .3-.1.3l-4.1 4.1 4.1 4.1c.1.1.1.1.1.3v1.7c0 .1 0 .3-.1.3-.1.1-.1.1-.3.1s-.3 0-.3-.1l-6.2-6.2c-.2 0-.2-.3-.1-.4z"/><path d="M-10.7 6.3c1.4 0 2.5.7 3.5 1.8l1.4-1c-1.3-1.3-3-2.1-4.9-2.1-3.9-.1-6.8 2.8-6.8 6.8s2.8 6.8 6.8 6.8c1.8 0 3.5-.7 4.7-2.2l-1.2-1.1c-.8 1.1-2.1 1.8-3.5 1.8-3.2 0-5.1-2.3-5.1-5.2s1.9-5.6 5.1-5.6z"/><path d="M33.4 4.8c-3.7 0-6.5 2.9-6.5 6.8 0 4 2.6 6.9 6.5 6.9 2.3 0 4.3-.8 5.7-2.8l-1.2-1.1c-.9 1.4-2.7 2.4-4.3 2.4-3.9 0-5-3.5-5-4.8h10.9v-1.2c0-3.1-2.2-6.2-6.1-6.2zm-4.8 5.8c0-.7 1.1-4.1 4.7-4.1 2.5 0 4.4 1.9 4.4 4.1h-9.1z"/><path d="M47.4 8.4c0-1.4 1.5-2.1 2.8-2.1 1.5 0 2.3.7 3 1.8l1.5-.8c-.8-1.7-2.5-2.5-4.6-2.5s-4.4 1.2-4.4 3.7c0 5 7.7 2.5 7.7 5.9 0 1.5-1.5 2.3-3 2.3s-3-.7-3.7-2.1l-1.5 1c1 1.8 3 2.6 5.2 2.6 2.5 0 4.7-1.4 4.7-4-.1-5-7.7-2.2-7.7-5.8z"/><path d="M63.3 6.3c1.4 0 2.5.7 3.5 1.8l1.4-1c-1.4-1.3-3-2.1-4.9-2.1-4 0-6.8 2.9-6.8 6.8s2.8 6.8 6.8 6.8c1.8 0 3.5-.7 4.8-2.2l-1.4-1.1c-.8 1.1-2.1 1.8-3.5 1.8-3.2 0-5.1-2.3-5.1-5.2s2-5.6 5.2-5.6z"/><path d="M88.9 4.8c-4 0-6.8 2.9-6.8 6.8s2.9 6.8 6.8 6.8 6.8-2.9 6.8-6.8-2.9-6.8-6.8-6.8zm0 12.2c-3.2 0-5.1-2.3-5.1-5.2s1.9-5.2 5.1-5.2c3.2 0 5.1 2.3 5.1 5.2s-1.9 5.2-5.1 5.2z"/><path d="M104.1 4.8c-4 0-6.8 2.9-6.8 6.8s2.9 6.8 6.8 6.8 6.8-2.9 6.8-6.8-2.8-6.8-6.8-6.8zm0 12.2c-3.2 0-5.1-2.3-5.1-5.2s1.9-5.2 5.1-5.2c3.2 0 5.1 2.3 5.1 5.2s-1.9 5.2-5.1 5.2z"/><path d="M80.2 15.7v-5.2c0-2.9-.8-5.5-5-5.5-2.1 0-3.7 1.2-4.4 2.6v-10.6h-1.7v21.1h1.7v-6.5c0-3.6 1.9-5.2 4.4-5.2 2.6 0 3.3 2.1 3.3 4.1v5.2c0 .1 0 .8.1 1.4.1.4.4.8.7 1.2 1.1 1.2 3.3.4 3.9.3-.4-.4-.7-.7-1-1.1-2 1.1-2-1.8-2-1.8z"/><path d="M24.9 16v-19h-1.7v10.5c-1.1-1.8-3.3-2.6-5.2-2.6-4 0-6.8 2.9-6.8 6.8s2.8 6.8 6.8 6.8c1.9 0 4.1-.8 5.2-2.6 0 .3 0 .8.1 1.2.1.4.4.8.7 1.2 1.1 1.2 3.3.4 3.9.3-.4-.4-.7-.7-1-1.1-1.6.9-1.9-.8-2-1.5zm-6.9 1c-3.2 0-5.1-2.3-5.1-5.2s1.9-5.2 5.1-5.2c3 0 5.4 2.3 5.4 5.2s-2.4 5.2-5.4 5.2z"/><path d="M116.5 17.5c-1.8 1-2.1-1-2.1-1.5v-19h-1.7v18.8c0 .1 0 .8.1 1.4.1.4.4.8.7 1.2 1.1 1.2 3.3.4 3.9.3-.3-.5-.6-.8-.9-1.2z"/></svg>\n  </a>\n\n  <a href=\'\' class=\'session-toggle\' ng-mouseover=\'setActive()\'>\n    <user-avatar class="user-media--session" width="40" height="40"></user-avatar>\n  </a>\n\n  <nav>\n    <ul class=\'session-menu\'>\n\n    </ul>\n  </nav>\n</div>',link:function(scope,element){var currentCourseConfig,currentUserData,listItems;return scope.authUrl=CampusUrl.authUrl(),currentUserData=new CurrentUserData(scope.courseIdentifier),currentCourseConfig=new CurrentCourseConfig(scope.courseIdentifier),scope.getUserName=function(){return scope.userName?scope.userName:"Student"},scope.imageUrl=function(imageName){return CampusUrl.imageUrl(imageName)},scope.setActive=function(){element.addClass("is-active")},scope.clearActive=function(){element.removeClass("is-active")},listItems="",$q.all([currentUserData.data(),currentCourseConfig.data()]).then(function(data){var config,userData;return userData=data[0],config=data[1],scope.marketingSiteUrl=config.marketing_site_url,scope.marketingSiteName=config.marketing_site_name,scope.marketingSiteAccountUrl=config.marketing_site_account_url,scope.forumUrl=config.forum_url,scope.supportUrl=config.support_url,scope.userName=null!=userData?userData.user_name:void 0,(null!=userData?userData.visitor:void 0)||!userData?listItems+="<li class='session-item'>\n  <a class='session-link' href='{{authUrl}}'>\n    Sign in to {{marketingSiteName}}\n  </a>\n</li>":(listItems+="<li class='session-item'>\n  <user-stats-button class='session-link'>\n    My Stats\n  </user-stats-button>\n</li>",scope.marketingSiteAccountUrl&&(listItems+="<li class='session-item session-item--user'>\n  <a class='session-link' href='{{marketingSiteAccountUrl}}'>My Account</a>\n</li>")),scope.supportUrl&&(listItems+="<li class='session-item'>\n  <a class='session-link' href='{{supportUrl}}'>\n    Support\n  </a>\n</li>"),scope.forumUrl&&(listItems+="<li class='session-item'>\n  <a class='session-link' href='{{forumUrl}}'>\n    Discuss\n  </a>\n</li>"),element.find("ul").html(listItems),$compile(element.contents())(scope)})}}}])}.call(this),function(){angular.module("campus").directive("submitContent",["CurrentSubmitData",function(CurrentSubmitData){return{restrict:"A",link:function(scope){return scope.content?new CurrentSubmitData(scope.courseIdentifier,scope.queryString).registerContent(scope.content):void 0}}}])}.call(this),function(){angular.module("campus").directive("tooltip",["$state",function(){return{restrict:"A",scope:{},link:function(scope,element,attrs){return $(element).tooltip({animation:attrs.animation,html:attrs.html,placement:attrs.placement,selector:attrs.selector,title:attrs.title,trigger:attrs.trigger,delay:attrs.delay,container:attrs.container||"body"}),scope.$on("$destroy",function(){return $(element).tooltip("destroy")})}}}])}.call(this),function(){angular.module("campus").directive("userStatsButton",["OpenModal",function(OpenModal){return{restrict:"E",replace:!0,transclude:!0,scope:!0,template:"<a href='' ng-click='openUserStatsModal()' ng-transclude></a>",link:function(scope){return scope.openUserStatsModal=function(){return OpenModal.open({htmlClass:"modal--page modal--user",fullScreen:!0,scope:scope},"<user-stats></user-stats>")}}}}])}.call(this),function(){angular.module("campus").config(["$stateProvider","$urlRouterProvider","$locationProvider",function($stateProvider,$urlRouterProvider,$locationProvider){return $locationProvider.html5Mode(!0),$stateProvider.state("root",{url:"/?login","abstract":!0,template:"<course-window></course-window>",controller:function($scope,$stateParams,$location){return $stateParams.login?$location.url($location.path(),!0):void 0}}).state("root.courseContent",{url:"*queryString?template",template:"<course-data></course-data>",controller:function($scope,TemplateRender,$stateParams,OpenModal,$rootScope,UserData,FlashMessage,GoogleAnalytics){return FlashMessage.clear(),OpenModal.close({clear:!0}),$scope.queryString=$stateParams.queryString||$scope.courseIdentifier,GoogleAnalytics.trackCoursePageview($scope.courseIdentifier,$scope.queryString),$rootScope.queryString=$scope.queryString,(new UserData).updateLastPageViewed($scope.queryString,$scope.courseIdentifier),new TemplateRender($rootScope.courseIdentifier,$rootScope.queryString).checkForStateChange()}})}])}.call(this);